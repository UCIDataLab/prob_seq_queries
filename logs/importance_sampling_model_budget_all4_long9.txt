==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 16:36:37.367886] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 16:36:37.371741] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 16:36:37.375107] batch_size ................. 4096
[2022-05-16 16:36:37.375121] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 16:36:37.375139] cuda ....................... True
[2022-05-16 16:36:37.375145] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 16:36:37.375151] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:36:37.375157] device ..................... 6
[2022-05-16 16:36:37.375163] device_num ................. 0
[2022-05-16 16:36:37.375169] disable_tqdm ............... True
[2022-05-16 16:36:37.375175] do_test .................... False
[2022-05-16 16:36:37.375181] do_valid ................... True
[2022-05-16 16:36:37.375186] dont_print_args ............ True
[2022-05-16 16:36:37.375193] dont_shuffle ............... None
[2022-05-16 16:36:37.375205] dropout .................... 0.3
[2022-05-16 16:36:37.375213] estimate_type .............. <function beam_search_lower_bound at 0x7f09756ece50>
[2022-05-16 16:36:37.375221] excluded_terms ............. [1]
[2022-05-16 16:36:37.375229] excluded_terms_list ........ [[]]
[2022-05-16 16:36:37.375234] finetune ................... False
[2022-05-16 16:36:37.375241] grad_clip .................. 1.0
[2022-05-16 16:36:37.375246] hidden_size ................ 128
[2022-05-16 16:36:37.375252] hist_len ................... 18
[2022-05-16 16:36:37.375258] hybrid_max_num_beams ....... 1500
[2022-05-16 16:36:37.375264] interp_func ................ <function lin_interp at 0x7f09756ecd30>
[2022-05-16 16:36:37.375270] log_interval ............... 100
[2022-05-16 16:36:37.375277] lr ......................... 0.001
[2022-05-16 16:36:37.375283] lr_decay_style ............. constant
[2022-05-16 16:36:37.375289] masked_lm .................. False
[2022-05-16 16:36:37.375295] max_k ...................... None
[2022-05-16 16:36:37.375300] max_num_mc_samples ......... 100000
[2022-05-16 16:36:37.375306] max_num_queries ............ 1000
[2022-05-16 16:36:37.375311] min_num_mc_samples ......... 10000
[2022-05-16 16:36:37.375317] min_phase_shift ............ 0
[2022-05-16 16:36:37.375323] min_var_reduction .......... 0.1
[2022-05-16 16:36:37.375328] min_variance ............... True
[2022-05-16 16:36:37.375334] model_budget_filepath ...... None
[2022-05-16 16:36:37.375340] num_beams .................. 0.0
[2022-05-16 16:36:37.375345] num_layers ................. 2
[2022-05-16 16:36:37.375352] num_mc_samples ............. 100
[2022-05-16 16:36:37.375356] num_workers ................ 0
[2022-05-16 16:36:37.375362] optimizer .................. adam
[2022-05-16 16:36:37.375368] proposal_func .............. <function lm_proposal at 0x7f09756d8d30>
[2022-05-16 16:36:37.375374] rnn_type ................... LSTM
[2022-05-16 16:36:37.375379] save_epochs ................ 1
[2022-05-16 16:36:37.375385] seed ....................... 42
[2022-05-16 16:36:37.375390] seq_len .................... 100
[2022-05-16 16:36:37.375396] shuffle .................... True
[2022-05-16 16:36:37.375401] store_intermediate_lbs ..... True
[2022-05-16 16:36:37.375407] sub_estimates .............. []
[2022-05-16 16:36:37.375412] tau_a_excl_terms ........... []
[2022-05-16 16:36:37.375418] tau_b_excl_terms ........... []
[2022-05-16 16:36:37.375423] terms_of_interest .......... []
[2022-05-16 16:36:37.375429] text_dict .................. None
[2022-05-16 16:36:37.375434] top_k ...................... 0
[2022-05-16 16:36:37.375439] top_p ...................... 0
[2022-05-16 16:36:37.375444] total_seq_len .............. 20
[2022-05-16 16:36:37.375450] train_data_pct ............. 0.9
[2022-05-16 16:36:37.375456] train_epochs ............... 40
[2022-05-16 16:36:37.375461] use_gpt2 ................... False
[2022-05-16 16:36:37.375467] val_data_pct ............... 0.05
[2022-05-16 16:36:37.375474] val_metrics ................ ['accuracy']
[2022-05-16 16:36:37.375479] valid_epochs ............... 1
[2022-05-16 16:36:37.375488] variance_epsilon ........... 5e-06
[2022-05-16 16:36:37.375493] vocab_size ................. 68
[2022-05-16 16:36:37.375499] warmup_pct ................. 0.01
[2022-05-16 16:36:37.375504] weight_decay ............... 0.0
==================================================
[2022-05-16 16:36:37.376356] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 1000 | Hist length 14 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-16 16:37:04.894270] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-16 16:37:04.897492] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-16 16:37:04.969488] batch_size ................. 4096
[2022-05-16 16:37:04.969505] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-16 16:37:04.969515] cuda ....................... True
[2022-05-16 16:37:04.969521] data_path .................. data/moocs/mooc.csv
[2022-05-16 16:37:04.969526] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:37:04.969533] device ..................... 6
[2022-05-16 16:37:04.969538] device_num ................. 0
[2022-05-16 16:37:04.969544] disable_tqdm ............... True
[2022-05-16 16:37:04.969550] do_test .................... False
[2022-05-16 16:37:04.969556] do_valid ................... True
[2022-05-16 16:37:04.969561] dont_print_args ............ True
[2022-05-16 16:37:04.969568] dont_shuffle ............... None
[2022-05-16 16:37:04.969580] dropout .................... 0.3
[2022-05-16 16:37:04.969588] estimate_type .............. <function beam_search_lower_bound at 0x7f09756ece50>
[2022-05-16 16:37:04.969596] excluded_terms ............. [1]
[2022-05-16 16:37:04.969609] excluded_terms_list ........ [[]]
[2022-05-16 16:37:04.969615] finetune ................... False
[2022-05-16 16:37:04.969622] grad_clip .................. 1.0
[2022-05-16 16:37:04.969627] hidden_size ................ 128
[2022-05-16 16:37:04.969634] hist_len ................... 18
[2022-05-16 16:37:04.969640] hybrid_max_num_beams ....... 1500
[2022-05-16 16:37:04.969646] interp_func ................ <function lin_interp at 0x7f09756ecd30>
[2022-05-16 16:37:04.969652] log_interval ............... 100
[2022-05-16 16:37:04.969665] lr ......................... 0.001
[2022-05-16 16:37:04.969670] lr_decay_style ............. constant
[2022-05-16 16:37:04.969676] masked_lm .................. False
[2022-05-16 16:37:04.969682] max_k ...................... None
[2022-05-16 16:37:04.969688] max_num_mc_samples ......... 100000
[2022-05-16 16:37:04.969694] max_num_queries ............ 1000
[2022-05-16 16:37:04.969700] min_num_mc_samples ......... 10000
[2022-05-16 16:37:04.969705] min_phase_shift ............ 0
[2022-05-16 16:37:04.969712] min_var_reduction .......... 0.1
[2022-05-16 16:37:04.969717] min_variance ............... True
[2022-05-16 16:37:04.969723] model_budget_filepath ...... None
[2022-05-16 16:37:04.969729] needs_encoding ............. False
[2022-05-16 16:37:04.969736] num_beams .................. 0.0
[2022-05-16 16:37:04.969741] num_layers ................. 2
[2022-05-16 16:37:04.969747] num_mc_samples ............. 100
[2022-05-16 16:37:04.969752] num_workers ................ 0
[2022-05-16 16:37:04.969757] optimizer .................. adam
[2022-05-16 16:37:04.969764] proposal_func .............. <function lm_proposal at 0x7f09756d8d30>
[2022-05-16 16:37:04.969770] rnn_type ................... LSTM
[2022-05-16 16:37:04.969776] save_epochs ................ 1
[2022-05-16 16:37:04.969781] seed ....................... 42
[2022-05-16 16:37:04.969787] seq_len .................... 15
[2022-05-16 16:37:04.969792] shuffle .................... True
[2022-05-16 16:37:04.969798] store_intermediate_lbs ..... True
[2022-05-16 16:37:04.969804] sub_estimates .............. []
[2022-05-16 16:37:04.969810] tau_a_excl_terms ........... []
[2022-05-16 16:37:04.969816] tau_b_excl_terms ........... []
[2022-05-16 16:37:04.969821] terms_of_interest .......... []
[2022-05-16 16:37:04.969827] text_dict .................. None
[2022-05-16 16:37:04.969832] top_k ...................... 0
[2022-05-16 16:37:04.969838] top_p ...................... 0
[2022-05-16 16:37:04.969843] total_seq_len .............. 20
[2022-05-16 16:37:04.969849] train_data_pct ............. 0.9
[2022-05-16 16:37:04.969856] train_epochs ............... 40
[2022-05-16 16:37:04.969862] use_gpt2 ................... False
[2022-05-16 16:37:04.969867] val_data_pct ............... 0.01
[2022-05-16 16:37:04.969874] val_metrics ................ ['accuracy']
[2022-05-16 16:37:04.969880] valid_epochs ............... 1
[2022-05-16 16:37:04.969889] variance_epsilon ........... 5e-06
[2022-05-16 16:37:04.969894] vocab_size ................. 98
[2022-05-16 16:37:04.969900] warmup_pct ................. 0.01
[2022-05-16 16:37:04.969906] weight_decay ............... 0.0
==================================================
[2022-05-16 16:37:04.971532] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 9 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-16 16:38:04.771591] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-16 16:38:04.784031] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-16 16:38:05.115900] batch_size ................. 4096
[2022-05-16 16:38:05.115931] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-16 16:38:05.115939] cuda ....................... True
[2022-05-16 16:38:05.115943] data_path .................. data/apps/lsapp.tsv
[2022-05-16 16:38:05.115947] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:38:05.115951] device ..................... 6
[2022-05-16 16:38:05.115954] device_num ................. 0
[2022-05-16 16:38:05.115958] disable_tqdm ............... True
[2022-05-16 16:38:05.115962] do_test .................... False
[2022-05-16 16:38:05.115966] do_valid ................... True
[2022-05-16 16:38:05.115970] dont_print_args ............ True
[2022-05-16 16:38:05.115975] dont_shuffle ............... None
[2022-05-16 16:38:05.115984] dropout .................... 0.3
[2022-05-16 16:38:05.115990] estimate_type .............. <function beam_search_lower_bound at 0x7f09756ece50>
[2022-05-16 16:38:05.115996] excluded_terms ............. [1]
[2022-05-16 16:38:05.116012] excluded_terms_list ........ [[]]
[2022-05-16 16:38:05.116016] finetune ................... False
[2022-05-16 16:38:05.116021] grad_clip .................. 1.0
[2022-05-16 16:38:05.116025] hidden_size ................ 512
[2022-05-16 16:38:05.116030] hist_len ................... 18
[2022-05-16 16:38:05.116034] hybrid_max_num_beams ....... 1500
[2022-05-16 16:38:05.116038] interp_func ................ <function lin_interp at 0x7f09756ecd30>
[2022-05-16 16:38:05.116041] log_interval ............... 100
[2022-05-16 16:38:05.116057] lr ......................... 0.001
[2022-05-16 16:38:05.116060] lr_decay_style ............. constant
[2022-05-16 16:38:05.116064] masked_lm .................. False
[2022-05-16 16:38:05.116068] max_k ...................... None
[2022-05-16 16:38:05.116071] max_num_mc_samples ......... 100000
[2022-05-16 16:38:05.116077] max_num_queries ............ 1000
[2022-05-16 16:38:05.116080] min_num_mc_samples ......... 10000
[2022-05-16 16:38:05.116084] min_phase_shift ............ 0
[2022-05-16 16:38:05.116088] min_var_reduction .......... 0.1
[2022-05-16 16:38:05.116092] min_variance ............... True
[2022-05-16 16:38:05.116095] model_budget_filepath ...... None
[2022-05-16 16:38:05.116101] needs_encoding ............. True
[2022-05-16 16:38:05.116105] num_beams .................. 0.0
[2022-05-16 16:38:05.116109] num_layers ................. 2
[2022-05-16 16:38:05.116112] num_mc_samples ............. 100
[2022-05-16 16:38:05.116116] num_workers ................ 0
[2022-05-16 16:38:05.116119] optimizer .................. adam
[2022-05-16 16:38:05.116123] proposal_func .............. <function lm_proposal at 0x7f09756d8d30>
[2022-05-16 16:38:05.116127] rnn_type ................... LSTM
[2022-05-16 16:38:05.116131] save_epochs ................ 1
[2022-05-16 16:38:05.116134] seed ....................... 42
[2022-05-16 16:38:05.116138] seq_len .................... 15
[2022-05-16 16:38:05.116141] shuffle .................... True
[2022-05-16 16:38:05.116145] store_intermediate_lbs ..... True
[2022-05-16 16:38:05.116149] sub_estimates .............. []
[2022-05-16 16:38:05.116153] tau_a_excl_terms ........... []
[2022-05-16 16:38:05.116157] tau_b_excl_terms ........... []
[2022-05-16 16:38:05.116160] terms_of_interest .......... []
[2022-05-16 16:38:05.116164] text_dict .................. None
[2022-05-16 16:38:05.116167] top_k ...................... 0
[2022-05-16 16:38:05.116171] top_p ...................... 0
[2022-05-16 16:38:05.116174] total_seq_len .............. 20
[2022-05-16 16:38:05.116178] train_data_pct ............. 0.9
[2022-05-16 16:38:05.116182] train_epochs ............... 40
[2022-05-16 16:38:05.116185] use_gpt2 ................... False
[2022-05-16 16:38:05.116189] val_data_pct ............... 0.001
[2022-05-16 16:38:05.116194] val_metrics ................ ['accuracy']
[2022-05-16 16:38:05.116198] valid_epochs ............... 1
[2022-05-16 16:38:05.116203] variance_epsilon ........... 5e-06
[2022-05-16 16:38:05.116207] vocab_size ................. 88
[2022-05-16 16:38:05.116210] warmup_pct ................. 0.01
[2022-05-16 16:38:05.116214] weight_decay ............... 0.0
==================================================
[2022-05-16 16:38:05.117465] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 9 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-16 16:39:49.885080] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-16 16:39:49.894029] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-16 16:39:50.072973] batch_size ................. 4096
[2022-05-16 16:39:50.073000] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-16 16:39:50.073011] cuda ....................... True
[2022-05-16 16:39:50.073015] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-16 16:39:50.073019] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:39:50.073026] device ..................... 6
[2022-05-16 16:39:50.073029] device_num ................. 0
[2022-05-16 16:39:50.073033] disable_tqdm ............... True
[2022-05-16 16:39:50.073037] do_test .................... False
[2022-05-16 16:39:50.073041] do_valid ................... True
[2022-05-16 16:39:50.073044] dont_print_args ............ True
[2022-05-16 16:39:50.073049] dont_shuffle ............... None
[2022-05-16 16:39:50.073057] dropout .................... 0.3
[2022-05-16 16:39:50.073063] estimate_type .............. <function beam_search_lower_bound at 0x7f09756ece50>
[2022-05-16 16:39:50.073069] excluded_terms ............. [1]
[2022-05-16 16:39:50.073076] excluded_terms_list ........ [[]]
[2022-05-16 16:39:50.073080] finetune ................... False
[2022-05-16 16:39:50.073085] grad_clip .................. 1.0
[2022-05-16 16:39:50.073088] hidden_size ................ 512
[2022-05-16 16:39:50.073092] hist_len ................... 18
[2022-05-16 16:39:50.073096] hybrid_max_num_beams ....... 1500
[2022-05-16 16:39:50.073100] interp_func ................ <function lin_interp at 0x7f09756ecd30>
[2022-05-16 16:39:50.073103] log_interval ............... 100
[2022-05-16 16:39:50.073108] lr ......................... 0.001
[2022-05-16 16:39:50.073112] lr_decay_style ............. constant
[2022-05-16 16:39:50.073116] masked_lm .................. False
[2022-05-16 16:39:50.073119] max_k ...................... None
[2022-05-16 16:39:50.073123] max_num_mc_samples ......... 100000
[2022-05-16 16:39:50.073127] max_num_queries ............ 1000
[2022-05-16 16:39:50.073130] min_num_mc_samples ......... 10000
[2022-05-16 16:39:50.073134] min_phase_shift ............ 0
[2022-05-16 16:39:50.073138] min_var_reduction .......... 0.1
[2022-05-16 16:39:50.073141] min_variance ............... True
[2022-05-16 16:39:50.073145] model_budget_filepath ...... None
[2022-05-16 16:39:50.073149] num_beams .................. 0.0
[2022-05-16 16:39:50.073152] num_layers ................. 2
[2022-05-16 16:39:50.073155] num_mc_samples ............. 100
[2022-05-16 16:39:50.073159] num_workers ................ 0
[2022-05-16 16:39:50.073162] optimizer .................. adam
[2022-05-16 16:39:50.073166] proposal_func .............. <function lm_proposal at 0x7f09756d8d30>
[2022-05-16 16:39:50.073169] rnn_type ................... LSTM
[2022-05-16 16:39:50.073173] save_epochs ................ 1
[2022-05-16 16:39:50.073176] seed ....................... 42
[2022-05-16 16:39:50.073180] seq_len .................... 15
[2022-05-16 16:39:50.073183] shuffle .................... True
[2022-05-16 16:39:50.073187] store_intermediate_lbs ..... True
[2022-05-16 16:39:50.073190] sub_estimates .............. []
[2022-05-16 16:39:50.073193] tau_a_excl_terms ........... []
[2022-05-16 16:39:50.073197] tau_b_excl_terms ........... []
[2022-05-16 16:39:50.073200] terms_of_interest .......... []
[2022-05-16 16:39:50.073204] text_dict .................. None
[2022-05-16 16:39:50.073207] top_k ...................... 0
[2022-05-16 16:39:50.073210] top_p ...................... 0
[2022-05-16 16:39:50.073214] total_seq_len .............. 20
[2022-05-16 16:39:50.073217] train_data_pct ............. 0.9
[2022-05-16 16:39:50.073221] train_epochs ............... 40
[2022-05-16 16:39:50.073224] use_gpt2 ................... False
[2022-05-16 16:39:50.073228] val_data_pct ............... 0.0001
[2022-05-16 16:39:50.073233] val_metrics ................ ['accuracy']
[2022-05-16 16:39:50.073236] valid_epochs ............... 1
[2022-05-16 16:39:50.073242] variance_epsilon ........... 5e-06
[2022-05-16 16:39:50.073246] vocab_size ................. 30
[2022-05-16 16:39:50.073250] warmup_pct ................. 0.01
[2022-05-16 16:39:50.073254] weight_decay ............... 0.0
==================================================
[2022-05-16 16:39:50.073557] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 9 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
