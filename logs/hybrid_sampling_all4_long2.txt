==================================================
* Running for dataset shakespeare
==================================================
[2022-05-15 20:06:25.008736] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-15 20:06:25.012560] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-15 20:06:25.015561] batch_size ................. 4096
[2022-05-15 20:06:25.015582] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-15 20:06:25.015598] cuda ....................... True
[2022-05-15 20:06:25.015604] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-15 20:06:25.015609] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 20:06:25.015615] device ..................... 3
[2022-05-15 20:06:25.015621] device_num ................. 0
[2022-05-15 20:06:25.015627] disable_tqdm ............... True
[2022-05-15 20:06:25.015632] do_test .................... False
[2022-05-15 20:06:25.015638] do_valid ................... True
[2022-05-15 20:06:25.015644] dont_print_args ............ True
[2022-05-15 20:06:25.015650] dont_shuffle ............... None
[2022-05-15 20:06:25.015661] dropout .................... 0.3
[2022-05-15 20:06:25.015671] estimate_type .............. <function beam_search_lower_bound at 0x7fd29bb21af0>
[2022-05-15 20:06:25.015678] excluded_terms ............. [1]
[2022-05-15 20:06:25.015686] excluded_terms_list ........ [[]]
[2022-05-15 20:06:25.015691] finetune ................... False
[2022-05-15 20:06:25.015698] grad_clip .................. 1.0
[2022-05-15 20:06:25.015703] hidden_size ................ 128
[2022-05-15 20:06:25.015709] hist_len ................... 18
[2022-05-15 20:06:25.015714] hybrid_max_num_beams ....... 1500
[2022-05-15 20:06:25.015722] interp_func ................ <function lin_interp at 0x7fd29bb219d0>
[2022-05-15 20:06:25.015728] k_range .................... []
[2022-05-15 20:06:25.015733] log_interval ............... 100
[2022-05-15 20:06:25.015740] lr ......................... 0.001
[2022-05-15 20:06:25.015746] lr_decay_style ............. constant
[2022-05-15 20:06:25.015751] masked_lm .................. False
[2022-05-15 20:06:25.015757] max_num_mc_samples ......... 100000
[2022-05-15 20:06:25.015762] max_num_queries ............ 1000
[2022-05-15 20:06:25.015768] min_num_mc_samples ......... 10000
[2022-05-15 20:06:25.015773] min_phase_shift ............ 0
[2022-05-15 20:06:25.015779] min_var_reduction .......... 0.1
[2022-05-15 20:06:25.015784] min_variance ............... True
[2022-05-15 20:06:25.015790] model_budget_filepath ...... None
[2022-05-15 20:06:25.015796] num_beams .................. 0.0
[2022-05-15 20:06:25.015802] num_layers ................. 2
[2022-05-15 20:06:25.015807] num_mc_samples ............. 100
[2022-05-15 20:06:25.015813] num_workers ................ 0
[2022-05-15 20:06:25.015818] optimizer .................. adam
[2022-05-15 20:06:25.015824] proposal_func .............. <function lm_proposal at 0x7fd29bb0e9d0>
[2022-05-15 20:06:25.015830] rnn_type ................... LSTM
[2022-05-15 20:06:25.015835] save_epochs ................ 1
[2022-05-15 20:06:25.015840] seed ....................... 42
[2022-05-15 20:06:25.015846] seq_len .................... 100
[2022-05-15 20:06:25.015851] shuffle .................... True
[2022-05-15 20:06:25.015857] store_intermediate_lbs ..... True
[2022-05-15 20:06:25.015862] sub_estimates .............. []
[2022-05-15 20:06:25.015868] terms_of_interest .......... []
[2022-05-15 20:06:25.015874] text_dict .................. None
[2022-05-15 20:06:25.015879] top_k ...................... 0
[2022-05-15 20:06:25.015884] top_p ...................... 0
[2022-05-15 20:06:25.015890] total_seq_len .............. 20
[2022-05-15 20:06:25.015896] train_data_pct ............. 0.9
[2022-05-15 20:06:25.015901] train_epochs ............... 40
[2022-05-15 20:06:25.015907] use_gpt2 ................... False
[2022-05-15 20:06:25.015913] val_data_pct ............... 0.05
[2022-05-15 20:06:25.015921] val_metrics ................ ['accuracy']
[2022-05-15 20:06:25.015926] valid_epochs ............... 1
[2022-05-15 20:06:25.015934] variance_epsilon ........... 5e-06
[2022-05-15 20:06:25.015939] vocab_size ................. 68
[2022-05-15 20:06:25.015945] warmup_pct ................. 0.01
[2022-05-15 20:06:25.015951] weight_decay ............... 0.0
==================================================
[2022-05-15 20:06:25.016650] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 15 | Total Seq Length 20 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-15 20:17:12.371164] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 13 | Total Seq Length 20 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-15 20:31:06.434078] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 20 | Max num queries: 1000

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-15 20:45:32.416387] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-15 20:45:32.420349] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-15 20:45:32.574393] batch_size ................. 4096
[2022-05-15 20:45:32.574422] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-15 20:45:32.574430] cuda ....................... True
[2022-05-15 20:45:32.574436] data_path .................. data/moocs/mooc.csv
[2022-05-15 20:45:32.574442] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 20:45:32.574449] device ..................... 3
[2022-05-15 20:45:32.574454] device_num ................. 0
[2022-05-15 20:45:32.574460] disable_tqdm ............... True
[2022-05-15 20:45:32.574467] do_test .................... False
[2022-05-15 20:45:32.574473] do_valid ................... True
[2022-05-15 20:45:32.574478] dont_print_args ............ True
[2022-05-15 20:45:32.574486] dont_shuffle ............... None
[2022-05-15 20:45:32.574499] dropout .................... 0.3
[2022-05-15 20:45:32.574507] estimate_type .............. <function beam_search_lower_bound at 0x7fd29bb21af0>
[2022-05-15 20:45:32.574517] excluded_terms ............. [1]
[2022-05-15 20:45:32.574525] excluded_terms_list ........ [[]]
[2022-05-15 20:45:32.574530] finetune ................... False
[2022-05-15 20:45:32.574537] grad_clip .................. 1.0
[2022-05-15 20:45:32.574542] hidden_size ................ 128
[2022-05-15 20:45:32.574548] hist_len ................... 18
[2022-05-15 20:45:32.574554] hybrid_max_num_beams ....... 1500
[2022-05-15 20:45:32.574560] interp_func ................ <function lin_interp at 0x7fd29bb219d0>
[2022-05-15 20:45:32.574565] k_range .................... []
[2022-05-15 20:45:32.574571] log_interval ............... 100
[2022-05-15 20:45:32.574578] lr ......................... 0.001
[2022-05-15 20:45:32.574584] lr_decay_style ............. constant
[2022-05-15 20:45:32.574589] masked_lm .................. False
[2022-05-15 20:45:32.574595] max_num_mc_samples ......... 100000
[2022-05-15 20:45:32.574601] max_num_queries ............ 1000
[2022-05-15 20:45:32.574606] min_num_mc_samples ......... 10000
[2022-05-15 20:45:32.574612] min_phase_shift ............ 0
[2022-05-15 20:45:32.574618] min_var_reduction .......... 0.1
[2022-05-15 20:45:32.574623] min_variance ............... True
[2022-05-15 20:45:32.574629] model_budget_filepath ...... None
[2022-05-15 20:45:32.574635] needs_encoding ............. False
[2022-05-15 20:45:32.574641] num_beams .................. 0.0
[2022-05-15 20:45:32.574647] num_layers ................. 2
[2022-05-15 20:45:32.574652] num_mc_samples ............. 100
[2022-05-15 20:45:32.574659] num_workers ................ 0
[2022-05-15 20:45:32.574664] optimizer .................. adam
[2022-05-15 20:45:32.574670] proposal_func .............. <function lm_proposal at 0x7fd29bb0e9d0>
[2022-05-15 20:45:32.574676] rnn_type ................... LSTM
[2022-05-15 20:45:32.574682] save_epochs ................ 1
[2022-05-15 20:45:32.574688] seed ....................... 42
[2022-05-15 20:45:32.574693] seq_len .................... 15
[2022-05-15 20:45:32.574699] shuffle .................... True
[2022-05-15 20:45:32.574704] store_intermediate_lbs ..... True
[2022-05-15 20:45:32.574710] sub_estimates .............. []
[2022-05-15 20:45:32.574715] terms_of_interest .......... []
[2022-05-15 20:45:32.574721] text_dict .................. None
[2022-05-15 20:45:32.574726] top_k ...................... 0
[2022-05-15 20:45:32.574731] top_p ...................... 0
[2022-05-15 20:45:32.574737] total_seq_len .............. 20
[2022-05-15 20:45:32.574742] train_data_pct ............. 0.9
[2022-05-15 20:45:32.574748] train_epochs ............... 40
[2022-05-15 20:45:32.574753] use_gpt2 ................... False
[2022-05-15 20:45:32.574759] val_data_pct ............... 0.01
[2022-05-15 20:45:32.574766] val_metrics ................ ['accuracy']
[2022-05-15 20:45:32.574771] valid_epochs ............... 1
[2022-05-15 20:45:32.574780] variance_epsilon ........... 5e-06
[2022-05-15 20:45:32.574785] vocab_size ................. 98
[2022-05-15 20:45:32.574791] warmup_pct ................. 0.01
[2022-05-15 20:45:32.574796] weight_decay ............... 0.0
==================================================
[2022-05-15 20:45:32.581395] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 10 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-15 20:58:16.242591] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 7 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-15 21:13:28.405418] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 6 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-15 21:30:36.390980] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-15 21:30:36.409438] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-15 21:30:36.683588] batch_size ................. 4096
[2022-05-15 21:30:36.683624] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-15 21:30:36.683633] cuda ....................... True
[2022-05-15 21:30:36.683639] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-15 21:30:36.683646] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 21:30:36.683653] device ..................... 3
[2022-05-15 21:30:36.683658] device_num ................. 0
[2022-05-15 21:30:36.683665] disable_tqdm ............... True
[2022-05-15 21:30:36.683673] do_test .................... False
[2022-05-15 21:30:36.683679] do_valid ................... True
[2022-05-15 21:30:36.683685] dont_print_args ............ True
[2022-05-15 21:30:36.683693] dont_shuffle ............... None
[2022-05-15 21:30:36.683705] dropout .................... 0.3
[2022-05-15 21:30:36.683714] estimate_type .............. <function beam_search_lower_bound at 0x7fd29bb21af0>
[2022-05-15 21:30:36.683723] excluded_terms ............. [1]
[2022-05-15 21:30:36.683735] excluded_terms_list ........ [[]]
[2022-05-15 21:30:36.683740] finetune ................... False
[2022-05-15 21:30:36.683747] grad_clip .................. 1.0
[2022-05-15 21:30:36.683752] hidden_size ................ 512
[2022-05-15 21:30:36.683758] hist_len ................... 18
[2022-05-15 21:30:36.683763] hybrid_max_num_beams ....... 1500
[2022-05-15 21:30:36.683771] interp_func ................ <function lin_interp at 0x7fd29bb219d0>
[2022-05-15 21:30:36.683777] k_range .................... []
[2022-05-15 21:30:36.683782] log_interval ............... 100
[2022-05-15 21:30:36.683805] lr ......................... 0.001
[2022-05-15 21:30:36.683811] lr_decay_style ............. constant
[2022-05-15 21:30:36.683817] masked_lm .................. False
[2022-05-15 21:30:36.683822] max_num_mc_samples ......... 100000
[2022-05-15 21:30:36.683828] max_num_queries ............ 1000
[2022-05-15 21:30:36.683833] min_num_mc_samples ......... 10000
[2022-05-15 21:30:36.683838] min_phase_shift ............ 0
[2022-05-15 21:30:36.683845] min_var_reduction .......... 0.1
[2022-05-15 21:30:36.683850] min_variance ............... True
[2022-05-15 21:30:36.683855] model_budget_filepath ...... None
[2022-05-15 21:30:36.683861] num_beams .................. 0.0
[2022-05-15 21:30:36.683869] num_layers ................. 2
[2022-05-15 21:30:36.683874] num_mc_samples ............. 100
[2022-05-15 21:30:36.683889] num_workers ................ 0
[2022-05-15 21:30:36.683894] optimizer .................. adam
[2022-05-15 21:30:36.683901] proposal_func .............. <function lm_proposal at 0x7fd29bb0e9d0>
[2022-05-15 21:30:36.683907] rnn_type ................... LSTM
[2022-05-15 21:30:36.683912] save_epochs ................ 1
[2022-05-15 21:30:36.683918] seed ....................... 42
[2022-05-15 21:30:36.683923] seq_len .................... 15
[2022-05-15 21:30:36.683930] shuffle .................... True
[2022-05-15 21:30:36.683935] store_intermediate_lbs ..... True
[2022-05-15 21:30:36.683941] sub_estimates .............. []
[2022-05-15 21:30:36.683947] terms_of_interest .......... []
[2022-05-15 21:30:36.683954] text_dict .................. None
[2022-05-15 21:30:36.683961] top_k ...................... 0
[2022-05-15 21:30:36.683967] top_p ...................... 0
[2022-05-15 21:30:36.683972] total_seq_len .............. 20
[2022-05-15 21:30:36.683978] train_data_pct ............. 0.9
[2022-05-15 21:30:36.683983] train_epochs ............... 40
[2022-05-15 21:30:36.683989] use_gpt2 ................... False
[2022-05-15 21:30:36.683995] val_data_pct ............... 0.0001
[2022-05-15 21:30:36.684005] val_metrics ................ ['accuracy']
[2022-05-15 21:30:36.684010] valid_epochs ............... 1
[2022-05-15 21:30:36.684021] variance_epsilon ........... 5e-06
[2022-05-15 21:30:36.684026] vocab_size ................. 30
[2022-05-15 21:30:36.684034] warmup_pct ................. 0.01
[2022-05-15 21:30:36.684040] weight_decay ............... 0.0
==================================================
[2022-05-15 21:30:36.684584] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 10 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-15 21:41:04.962437] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 7 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-15 21:53:38.684839] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 6 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-15 22:04:04.627116] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-15 22:04:04.635695] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-15 22:04:05.028209] batch_size ................. 4096
[2022-05-15 22:04:05.028239] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-15 22:04:05.028247] cuda ....................... True
[2022-05-15 22:04:05.028253] data_path .................. data/apps/lsapp.tsv
[2022-05-15 22:04:05.028259] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 22:04:05.028265] device ..................... 3
[2022-05-15 22:04:05.028270] device_num ................. 0
[2022-05-15 22:04:05.028276] disable_tqdm ............... True
[2022-05-15 22:04:05.028283] do_test .................... False
[2022-05-15 22:04:05.028289] do_valid ................... True
[2022-05-15 22:04:05.028294] dont_print_args ............ True
[2022-05-15 22:04:05.028301] dont_shuffle ............... None
[2022-05-15 22:04:05.028312] dropout .................... 0.3
[2022-05-15 22:04:05.028320] estimate_type .............. <function beam_search_lower_bound at 0x7fd29bb21af0>
[2022-05-15 22:04:05.028328] excluded_terms ............. [1]
[2022-05-15 22:04:05.028336] excluded_terms_list ........ [[]]
[2022-05-15 22:04:05.028342] finetune ................... False
[2022-05-15 22:04:05.028349] grad_clip .................. 1.0
[2022-05-15 22:04:05.028354] hidden_size ................ 512
[2022-05-15 22:04:05.028360] hist_len ................... 18
[2022-05-15 22:04:05.028366] hybrid_max_num_beams ....... 1500
[2022-05-15 22:04:05.028372] interp_func ................ <function lin_interp at 0x7fd29bb219d0>
[2022-05-15 22:04:05.028378] k_range .................... []
[2022-05-15 22:04:05.028383] log_interval ............... 100
[2022-05-15 22:04:05.028390] lr ......................... 0.001
[2022-05-15 22:04:05.028396] lr_decay_style ............. constant
[2022-05-15 22:04:05.028401] masked_lm .................. False
[2022-05-15 22:04:05.028407] max_num_mc_samples ......... 100000
[2022-05-15 22:04:05.028412] max_num_queries ............ 1000
[2022-05-15 22:04:05.028418] min_num_mc_samples ......... 10000
[2022-05-15 22:04:05.028423] min_phase_shift ............ 0
[2022-05-15 22:04:05.028429] min_var_reduction .......... 0.1
[2022-05-15 22:04:05.028435] min_variance ............... True
[2022-05-15 22:04:05.028441] model_budget_filepath ...... None
[2022-05-15 22:04:05.028446] needs_encoding ............. True
[2022-05-15 22:04:05.028452] num_beams .................. 0.0
[2022-05-15 22:04:05.028458] num_layers ................. 2
[2022-05-15 22:04:05.028463] num_mc_samples ............. 100
[2022-05-15 22:04:05.028469] num_workers ................ 0
[2022-05-15 22:04:05.028474] optimizer .................. adam
[2022-05-15 22:04:05.028480] proposal_func .............. <function lm_proposal at 0x7fd29bb0e9d0>
[2022-05-15 22:04:05.028486] rnn_type ................... LSTM
[2022-05-15 22:04:05.028491] save_epochs ................ 1
[2022-05-15 22:04:05.028496] seed ....................... 42
[2022-05-15 22:04:05.028502] seq_len .................... 15
[2022-05-15 22:04:05.028507] shuffle .................... True
[2022-05-15 22:04:05.028513] store_intermediate_lbs ..... True
[2022-05-15 22:04:05.028518] sub_estimates .............. []
[2022-05-15 22:04:05.028524] terms_of_interest .......... []
[2022-05-15 22:04:05.028529] text_dict .................. None
[2022-05-15 22:04:05.028535] top_k ...................... 0
[2022-05-15 22:04:05.028540] top_p ...................... 0
[2022-05-15 22:04:05.028545] total_seq_len .............. 20
[2022-05-15 22:04:05.028551] train_data_pct ............. 0.9
[2022-05-15 22:04:05.028557] train_epochs ............... 40
[2022-05-15 22:04:05.028562] use_gpt2 ................... False
[2022-05-15 22:04:05.028568] val_data_pct ............... 0.001
[2022-05-15 22:04:05.028575] val_metrics ................ ['accuracy']
[2022-05-15 22:04:05.028580] valid_epochs ............... 1
[2022-05-15 22:04:05.028589] variance_epsilon ........... 5e-06
[2022-05-15 22:04:05.028594] vocab_size ................. 88
[2022-05-15 22:04:05.028600] warmup_pct ................. 0.01
[2022-05-15 22:04:05.028606] weight_decay ............... 0.0
==================================================
[2022-05-15 22:04:05.029182] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 10 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-15 22:11:08.605160] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 7 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-15 22:20:32.271129] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 6 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
