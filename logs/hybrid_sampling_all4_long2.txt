==================================================
* Running for dataset shakespeare
==================================================
[2022-05-15 20:06:25.008736] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-15 20:06:25.012560] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-15 20:06:25.015561] batch_size ................. 4096
[2022-05-15 20:06:25.015582] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-15 20:06:25.015598] cuda ....................... True
[2022-05-15 20:06:25.015604] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-15 20:06:25.015609] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 20:06:25.015615] device ..................... 3
[2022-05-15 20:06:25.015621] device_num ................. 0
[2022-05-15 20:06:25.015627] disable_tqdm ............... True
[2022-05-15 20:06:25.015632] do_test .................... False
[2022-05-15 20:06:25.015638] do_valid ................... True
[2022-05-15 20:06:25.015644] dont_print_args ............ True
[2022-05-15 20:06:25.015650] dont_shuffle ............... None
[2022-05-15 20:06:25.015661] dropout .................... 0.3
[2022-05-15 20:06:25.015671] estimate_type .............. <function beam_search_lower_bound at 0x7fd29bb21af0>
[2022-05-15 20:06:25.015678] excluded_terms ............. [1]
[2022-05-15 20:06:25.015686] excluded_terms_list ........ [[]]
[2022-05-15 20:06:25.015691] finetune ................... False
[2022-05-15 20:06:25.015698] grad_clip .................. 1.0
[2022-05-15 20:06:25.015703] hidden_size ................ 128
[2022-05-15 20:06:25.015709] hist_len ................... 18
[2022-05-15 20:06:25.015714] hybrid_max_num_beams ....... 1500
[2022-05-15 20:06:25.015722] interp_func ................ <function lin_interp at 0x7fd29bb219d0>
[2022-05-15 20:06:25.015728] k_range .................... []
[2022-05-15 20:06:25.015733] log_interval ............... 100
[2022-05-15 20:06:25.015740] lr ......................... 0.001
[2022-05-15 20:06:25.015746] lr_decay_style ............. constant
[2022-05-15 20:06:25.015751] masked_lm .................. False
[2022-05-15 20:06:25.015757] max_num_mc_samples ......... 100000
[2022-05-15 20:06:25.015762] max_num_queries ............ 1000
[2022-05-15 20:06:25.015768] min_num_mc_samples ......... 10000
[2022-05-15 20:06:25.015773] min_phase_shift ............ 0
[2022-05-15 20:06:25.015779] min_var_reduction .......... 0.1
[2022-05-15 20:06:25.015784] min_variance ............... True
[2022-05-15 20:06:25.015790] model_budget_filepath ...... None
[2022-05-15 20:06:25.015796] num_beams .................. 0.0
[2022-05-15 20:06:25.015802] num_layers ................. 2
[2022-05-15 20:06:25.015807] num_mc_samples ............. 100
[2022-05-15 20:06:25.015813] num_workers ................ 0
[2022-05-15 20:06:25.015818] optimizer .................. adam
[2022-05-15 20:06:25.015824] proposal_func .............. <function lm_proposal at 0x7fd29bb0e9d0>
[2022-05-15 20:06:25.015830] rnn_type ................... LSTM
[2022-05-15 20:06:25.015835] save_epochs ................ 1
[2022-05-15 20:06:25.015840] seed ....................... 42
[2022-05-15 20:06:25.015846] seq_len .................... 100
[2022-05-15 20:06:25.015851] shuffle .................... True
[2022-05-15 20:06:25.015857] store_intermediate_lbs ..... True
[2022-05-15 20:06:25.015862] sub_estimates .............. []
[2022-05-15 20:06:25.015868] terms_of_interest .......... []
[2022-05-15 20:06:25.015874] text_dict .................. None
[2022-05-15 20:06:25.015879] top_k ...................... 0
[2022-05-15 20:06:25.015884] top_p ...................... 0
[2022-05-15 20:06:25.015890] total_seq_len .............. 20
[2022-05-15 20:06:25.015896] train_data_pct ............. 0.9
[2022-05-15 20:06:25.015901] train_epochs ............... 40
[2022-05-15 20:06:25.015907] use_gpt2 ................... False
[2022-05-15 20:06:25.015913] val_data_pct ............... 0.05
[2022-05-15 20:06:25.015921] val_metrics ................ ['accuracy']
[2022-05-15 20:06:25.015926] valid_epochs ............... 1
[2022-05-15 20:06:25.015934] variance_epsilon ........... 5e-06
[2022-05-15 20:06:25.015939] vocab_size ................. 68
[2022-05-15 20:06:25.015945] warmup_pct ................. 0.01
[2022-05-15 20:06:25.015951] weight_decay ............... 0.0
==================================================
[2022-05-15 20:06:25.016650] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 15 | Total Seq Length 20 | Max num queries: 1000

..............................................................................