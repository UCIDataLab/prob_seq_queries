==================================================
* Running for dataset shakespeare
==================================================
[2022-05-09 12:02:23.421573] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-09 12:02:23.424946] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-09 12:02:23.427132] batch_size ................. 4096
[2022-05-09 12:02:23.427149] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-09 12:02:23.427157] cuda ....................... True
[2022-05-09 12:02:23.427162] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-09 12:02:23.427165] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-09 12:02:23.427169] device ..................... 1
[2022-05-09 12:02:23.427173] device_num ................. 0
[2022-05-09 12:02:23.427177] disable_tqdm ............... True
[2022-05-09 12:02:23.427181] do_test .................... False
[2022-05-09 12:02:23.427184] do_valid ................... True
[2022-05-09 12:02:23.427188] dont_print_args ............ True
[2022-05-09 12:02:23.427193] dont_shuffle ............... None
[2022-05-09 12:02:23.427202] dropout .................... 0.3
[2022-05-09 12:02:23.427209] estimate_type .............. <function beam_search_lower_bound at 0x7f9a7c76adc0>
[2022-05-09 12:02:23.427214] excluded_terms ............. [1]
[2022-05-09 12:02:23.427220] finetune ................... False
[2022-05-09 12:02:23.427224] grad_clip .................. 1.0
[2022-05-09 12:02:23.427228] hidden_size ................ 128
[2022-05-09 12:02:23.427232] hist_len ................... 18
[2022-05-09 12:02:23.427236] interp_func ................ <function lin_interp at 0x7f9a7c76aca0>
[2022-05-09 12:02:23.427240] log_interval ............... 100
[2022-05-09 12:02:23.427244] lr ......................... 0.001
[2022-05-09 12:02:23.427248] lr_decay_style ............. constant
[2022-05-09 12:02:23.427251] masked_lm .................. False
[2022-05-09 12:02:23.427255] min_phase_shift ............ 0
[2022-05-09 12:02:23.427259] min_var_reduction .......... 0.9
[2022-05-09 12:02:23.427263] min_variance ............... False
[2022-05-09 12:02:23.427266] model_budget_filepath ...... None
[2022-05-09 12:02:23.427270] num_beams .................. 0.0
[2022-05-09 12:02:23.427274] num_layers ................. 2
[2022-05-09 12:02:23.427277] num_mc_samples ............. 1000
[2022-05-09 12:02:23.427281] num_workers ................ 0
[2022-05-09 12:02:23.427284] optimizer .................. adam
[2022-05-09 12:02:23.427288] proposal_func .............. <function lm_proposal at 0x7f9a7c766ee0>
[2022-05-09 12:02:23.427292] rnn_type ................... LSTM
[2022-05-09 12:02:23.427295] save_epochs ................ 1
[2022-05-09 12:02:23.427298] seed ....................... 1234321
[2022-05-09 12:02:23.427302] seq_len .................... 100
[2022-05-09 12:02:23.427305] shuffle .................... True
[2022-05-09 12:02:23.427309] store_intermediate_lbs ..... True
[2022-05-09 12:02:23.427312] sub_estimates .............. []
[2022-05-09 12:02:23.427316] text_dict .................. None
[2022-05-09 12:02:23.427319] top_k ...................... 0
[2022-05-09 12:02:23.427322] top_p ...................... 0
[2022-05-09 12:02:23.427326] total_seq_len .............. 20
[2022-05-09 12:02:23.427329] train_data_pct ............. 0.9
[2022-05-09 12:02:23.427333] train_epochs ............... 40
[2022-05-09 12:02:23.427337] val_data_pct ............... 0.05
[2022-05-09 12:02:23.427343] val_metrics ................ ['accuracy']
[2022-05-09 12:02:23.427347] valid_epochs ............... 1
[2022-05-09 12:02:23.427351] vocab_size ................. 68
[2022-05-09 12:02:23.427355] warmup_pct ................. 0.01
[2022-05-09 12:02:23.427358] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.95 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl does not exist
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl does not exist
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-09 12:06:09.571237] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-09 12:06:09.588508] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-09 12:06:09.588768] batch_size ................. 4096
[2022-05-09 12:06:09.588778] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-09 12:06:09.588790] cuda ....................... True
[2022-05-09 12:06:09.588796] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-09 12:06:09.588802] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-09 12:06:09.588810] device ..................... 1
[2022-05-09 12:06:09.588816] device_num ................. 0
[2022-05-09 12:06:09.588822] disable_tqdm ............... True
[2022-05-09 12:06:09.588829] do_test .................... False
[2022-05-09 12:06:09.588835] do_valid ................... True
[2022-05-09 12:06:09.588841] dont_print_args ............ True
[2022-05-09 12:06:09.588848] dont_shuffle ............... None
[2022-05-09 12:06:09.588863] dropout .................... 0.3
[2022-05-09 12:06:09.588872] estimate_type .............. <function beam_search_lower_bound at 0x7f9a7c76adc0>
[2022-05-09 12:06:09.588880] excluded_terms ............. [1]
[2022-05-09 12:06:09.588886] finetune ................... False
[2022-05-09 12:06:09.588892] grad_clip .................. 1.0
[2022-05-09 12:06:09.588898] hidden_size ................ 512
[2022-05-09 12:06:09.588904] hist_len ................... 18
[2022-05-09 12:06:09.588910] interp_func ................ <function lin_interp at 0x7f9a7c76aca0>
[2022-05-09 12:06:09.588918] log_interval ............... 100
[2022-05-09 12:06:09.588925] lr ......................... 0.001
[2022-05-09 12:06:09.588931] lr_decay_style ............. constant
[2022-05-09 12:06:09.588937] masked_lm .................. False
[2022-05-09 12:06:09.588942] min_phase_shift ............ 0
[2022-05-09 12:06:09.588949] min_var_reduction .......... 0.9
[2022-05-09 12:06:09.588955] min_variance ............... False
[2022-05-09 12:06:09.588961] model_budget_filepath ...... None
[2022-05-09 12:06:09.588968] num_beams .................. 0.0
[2022-05-09 12:06:09.588973] num_layers ................. 2
[2022-05-09 12:06:09.588979] num_mc_samples ............. 1000
[2022-05-09 12:06:09.588985] num_workers ................ 0
[2022-05-09 12:06:09.588991] optimizer .................. adam
[2022-05-09 12:06:09.588997] proposal_func .............. <function lm_proposal at 0x7f9a7c766ee0>
[2022-05-09 12:06:09.589003] rnn_type ................... LSTM
[2022-05-09 12:06:09.589008] save_epochs ................ 1
[2022-05-09 12:06:09.589014] seed ....................... 1234321
[2022-05-09 12:06:09.589020] seq_len .................... 15
[2022-05-09 12:06:09.589026] shuffle .................... True
[2022-05-09 12:06:09.589031] store_intermediate_lbs ..... True
[2022-05-09 12:06:09.589037] sub_estimates .............. []
[2022-05-09 12:06:09.589043] text_dict .................. None
[2022-05-09 12:06:09.589049] top_k ...................... 0
[2022-05-09 12:06:09.589055] top_p ...................... 0
[2022-05-09 12:06:09.589060] total_seq_len .............. 20
[2022-05-09 12:06:09.589067] train_data_pct ............. 0.9
[2022-05-09 12:06:09.589073] train_epochs ............... 40
[2022-05-09 12:06:09.589079] val_data_pct ............... 0.0001
[2022-05-09 12:06:09.589088] val_metrics ................ ['accuracy']
[2022-05-09 12:06:09.589094] valid_epochs ............... 1
[2022-05-09 12:06:09.589099] vocab_size ................. 30
[2022-05-09 12:06:09.589106] warmup_pct ................. 0.01
[2022-05-09 12:06:09.589112] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.95 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.85 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................