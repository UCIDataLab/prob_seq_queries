==================================================
* Running for dataset shakespeare
==================================================
[2022-05-08 16:06:48.747983] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-08 16:06:48.753498] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-08 16:06:48.757643] batch_size ................. 4096
[2022-05-08 16:06:48.757673] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-08 16:06:48.757685] cuda ....................... True
[2022-05-08 16:06:48.757692] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-08 16:06:48.757700] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-08 16:06:48.757708] device ..................... 4
[2022-05-08 16:06:48.757716] device_num ................. 0
[2022-05-08 16:06:48.757724] disable_tqdm ............... True
[2022-05-08 16:06:48.757731] do_test .................... False
[2022-05-08 16:06:48.757739] do_valid ................... True
[2022-05-08 16:06:48.757747] dont_print_args ............ True
[2022-05-08 16:06:48.757756] dont_shuffle ............... None
[2022-05-08 16:06:48.757772] dropout .................... 0.3
[2022-05-08 16:06:48.757791] estimate_type .............. <function beam_search_lower_bound at 0x7f530d02bdc0>
[2022-05-08 16:06:48.757803] excluded_terms ............. [1]
[2022-05-08 16:06:48.757812] finetune ................... False
[2022-05-08 16:06:48.757821] grad_clip .................. 1.0
[2022-05-08 16:06:48.757828] hidden_size ................ 128
[2022-05-08 16:06:48.757835] hist_len ................... 18
[2022-05-08 16:06:48.757845] interp_func ................ <function lin_interp at 0x7f530d02bca0>
[2022-05-08 16:06:48.757852] log_interval ............... 100
[2022-05-08 16:06:48.757861] lr ......................... 0.001
[2022-05-08 16:06:48.757868] lr_decay_style ............. constant
[2022-05-08 16:06:48.757876] masked_lm .................. False
[2022-05-08 16:06:48.757883] min_phase_shift ............ 0
[2022-05-08 16:06:48.757891] min_var_reduction .......... 0.9
[2022-05-08 16:06:48.757899] min_variance ............... False
[2022-05-08 16:06:48.757907] model_budget_filepath ...... None
[2022-05-08 16:06:48.757915] num_beams .................. 0.0
[2022-05-08 16:06:48.757922] num_layers ................. 2
[2022-05-08 16:06:48.757929] num_mc_samples ............. 1000
[2022-05-08 16:06:48.757936] num_workers ................ 0
[2022-05-08 16:06:48.757944] optimizer .................. adam
[2022-05-08 16:06:48.757952] proposal_func .............. <function lm_proposal at 0x7f530d026ee0>
[2022-05-08 16:06:48.757960] rnn_type ................... LSTM
[2022-05-08 16:06:48.757967] save_epochs ................ 1
[2022-05-08 16:06:48.757975] seed ....................... 1234321
[2022-05-08 16:06:48.757982] seq_len .................... 100
[2022-05-08 16:06:48.757989] shuffle .................... True
[2022-05-08 16:06:48.757997] store_intermediate_lbs ..... True
[2022-05-08 16:06:48.758004] sub_estimates .............. []
[2022-05-08 16:06:48.758012] text_dict .................. None
[2022-05-08 16:06:48.758019] top_k ...................... 0
[2022-05-08 16:06:48.758026] top_p ...................... 0
[2022-05-08 16:06:48.758033] total_seq_len .............. 20
[2022-05-08 16:06:48.758041] train_data_pct ............. 0.9
[2022-05-08 16:06:48.758049] train_epochs ............... 40
[2022-05-08 16:06:48.758056] val_data_pct ............... 0.05
[2022-05-08 16:06:48.758075] val_metrics ................ ['accuracy']
[2022-05-08 16:06:48.758082] valid_epochs ............... 1
[2022-05-08 16:06:48.758089] vocab_size ................. 68
[2022-05-08 16:06:48.758097] warmup_pct ................. 0.01
[2022-05-08 16:06:48.758105] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.95 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl does not exist
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl does not exist
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-08 16:10:05.450639] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-08 16:10:05.472008] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-08 16:10:05.472471] batch_size ................. 4096
[2022-05-08 16:10:05.472482] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-08 16:10:05.472498] cuda ....................... True
[2022-05-08 16:10:05.472505] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-08 16:10:05.472512] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-08 16:10:05.472519] device ..................... 4
[2022-05-08 16:10:05.472525] device_num ................. 0
[2022-05-08 16:10:05.472531] disable_tqdm ............... True
[2022-05-08 16:10:05.472541] do_test .................... False
[2022-05-08 16:10:05.472547] do_valid ................... True
[2022-05-08 16:10:05.472553] dont_print_args ............ True
[2022-05-08 16:10:05.472561] dont_shuffle ............... None
[2022-05-08 16:10:05.472596] dropout .................... 0.3
[2022-05-08 16:10:05.472606] estimate_type .............. <function beam_search_lower_bound at 0x7f530d02bdc0>
[2022-05-08 16:10:05.472617] excluded_terms ............. [1]
[2022-05-08 16:10:05.472624] finetune ................... False
[2022-05-08 16:10:05.472648] grad_clip .................. 1.0
[2022-05-08 16:10:05.472655] hidden_size ................ 512
[2022-05-08 16:10:05.472661] hist_len ................... 18
[2022-05-08 16:10:05.472669] interp_func ................ <function lin_interp at 0x7f530d02bca0>
[2022-05-08 16:10:05.472765] log_interval ............... 100
[2022-05-08 16:10:05.472774] lr ......................... 0.001
[2022-05-08 16:10:05.472781] lr_decay_style ............. constant
[2022-05-08 16:10:05.472787] masked_lm .................. False
[2022-05-08 16:10:05.472793] min_phase_shift ............ 0
[2022-05-08 16:10:05.472811] min_var_reduction .......... 0.9
[2022-05-08 16:10:05.472817] min_variance ............... False
[2022-05-08 16:10:05.472823] model_budget_filepath ...... None
[2022-05-08 16:10:05.472830] num_beams .................. 0.0
[2022-05-08 16:10:05.472836] num_layers ................. 2
[2022-05-08 16:10:05.472842] num_mc_samples ............. 1000
[2022-05-08 16:10:05.472857] num_workers ................ 0
[2022-05-08 16:10:05.472863] optimizer .................. adam
[2022-05-08 16:10:05.472870] proposal_func .............. <function lm_proposal at 0x7f530d026ee0>
[2022-05-08 16:10:05.472877] rnn_type ................... LSTM
[2022-05-08 16:10:05.472883] save_epochs ................ 1
[2022-05-08 16:10:05.472889] seed ....................... 1234321
[2022-05-08 16:10:05.472895] seq_len .................... 15
[2022-05-08 16:10:05.472909] shuffle .................... True
[2022-05-08 16:10:05.472916] store_intermediate_lbs ..... True
[2022-05-08 16:10:05.472922] sub_estimates .............. []
[2022-05-08 16:10:05.472929] text_dict .................. None
[2022-05-08 16:10:05.472935] top_k ...................... 0
[2022-05-08 16:10:05.472942] top_p ...................... 0
[2022-05-08 16:10:05.472948] total_seq_len .............. 20
[2022-05-08 16:10:05.472969] train_data_pct ............. 0.9
[2022-05-08 16:10:05.472974] train_epochs ............... 40
[2022-05-08 16:10:05.472981] val_data_pct ............... 0.0001
[2022-05-08 16:10:05.472989] val_metrics ................ ['accuracy']
[2022-05-08 16:10:05.472998] valid_epochs ............... 1
[2022-05-08 16:10:05.473004] vocab_size ................. 30
[2022-05-08 16:10:05.473012] warmup_pct ................. 0.01
[2022-05-08 16:10:05.473018] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.95 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.85 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-08 16:51:28.973551] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-08 16:51:28.990626] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-08 16:51:29.036223] batch_size ................. 4096
[2022-05-08 16:51:29.036284] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-08 16:51:29.036296] cuda ....................... True
[2022-05-08 16:51:29.036303] data_path .................. data/apps/lsapp.tsv
[2022-05-08 16:51:29.036309] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-08 16:51:29.036317] device ..................... 4
[2022-05-08 16:51:29.036323] device_num ................. 0
[2022-05-08 16:51:29.036329] disable_tqdm ............... True
[2022-05-08 16:51:29.036336] do_test .................... False
[2022-05-08 16:51:29.036343] do_valid ................... True
[2022-05-08 16:51:29.036349] dont_print_args ............ True
[2022-05-08 16:51:29.036359] dont_shuffle ............... None
[2022-05-08 16:51:29.036375] dropout .................... 0.3
[2022-05-08 16:51:29.036386] estimate_type .............. <function beam_search_lower_bound at 0x7f530d02bdc0>
[2022-05-08 16:51:29.036398] excluded_terms ............. [1]
[2022-05-08 16:51:29.036408] finetune ................... False
[2022-05-08 16:51:29.036416] grad_clip .................. 1.0
[2022-05-08 16:51:29.036432] hidden_size ................ 512
[2022-05-08 16:51:29.036440] hist_len ................... 18
[2022-05-08 16:51:29.036451] interp_func ................ <function lin_interp at 0x7f530d02bca0>
[2022-05-08 16:51:29.036458] log_interval ............... 100
[2022-05-08 16:51:29.036468] lr ......................... 0.001
[2022-05-08 16:51:29.036481] lr_decay_style ............. constant
[2022-05-08 16:51:29.036644] masked_lm .................. False
[2022-05-08 16:51:29.036652] min_phase_shift ............ 0
[2022-05-08 16:51:29.036661] min_var_reduction .......... 0.9
[2022-05-08 16:51:29.036671] min_variance ............... False
[2022-05-08 16:51:29.036679] model_budget_filepath ...... None
[2022-05-08 16:51:29.036692] num_beams .................. 0.0
[2022-05-08 16:51:29.036699] num_layers ................. 2
[2022-05-08 16:51:29.036707] num_mc_samples ............. 1000
[2022-05-08 16:51:29.036716] num_workers ................ 0
[2022-05-08 16:51:29.036724] optimizer .................. adam
[2022-05-08 16:51:29.036733] proposal_func .............. <function lm_proposal at 0x7f530d026ee0>
[2022-05-08 16:51:29.036748] rnn_type ................... LSTM
[2022-05-08 16:51:29.036756] save_epochs ................ 1
[2022-05-08 16:51:29.036764] seed ....................... 1234321
[2022-05-08 16:51:29.036772] seq_len .................... 15
[2022-05-08 16:51:29.036780] shuffle .................... True
[2022-05-08 16:51:29.036787] store_intermediate_lbs ..... True
[2022-05-08 16:51:29.036796] sub_estimates .............. []
[2022-05-08 16:51:29.036813] text_dict .................. None
[2022-05-08 16:51:29.036820] top_k ...................... 0
[2022-05-08 16:51:29.036827] top_p ...................... 0
[2022-05-08 16:51:29.036835] total_seq_len .............. 20
[2022-05-08 16:51:29.036843] train_data_pct ............. 0.9
[2022-05-08 16:51:29.036850] train_epochs ............... 40
[2022-05-08 16:51:29.036859] val_data_pct ............... 0.001
[2022-05-08 16:51:29.036877] val_metrics ................ ['accuracy']
[2022-05-08 16:51:29.036885] valid_epochs ............... 1
[2022-05-08 16:51:29.036892] vocab_size ................. 88
[2022-05-08 16:51:29.036902] warmup_pct ................. 0.01
[2022-05-08 16:51:29.036910] weight_decay ............... 0.0
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.92 | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.87 | Hist length 11 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.75 | Hist length 10 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset shakespeare
==================================================
[2022-05-08 17:06:11.972679] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-08 17:06:11.976549] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-08 17:06:11.976727] batch_size ................. 4096
[2022-05-08 17:06:11.976738] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-08 17:06:11.976752] cuda ....................... True
[2022-05-08 17:06:11.976760] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-08 17:06:11.976768] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-08 17:06:11.976777] device ..................... 4
[2022-05-08 17:06:11.976785] device_num ................. 0
[2022-05-08 17:06:11.976793] disable_tqdm ............... True
[2022-05-08 17:06:11.976802] do_test .................... False
[2022-05-08 17:06:11.976810] do_valid ................... True
[2022-05-08 17:06:11.976819] dont_print_args ............ True
[2022-05-08 17:06:11.976828] dont_shuffle ............... None
[2022-05-08 17:06:11.976842] dropout .................... 0.3
[2022-05-08 17:06:11.976852] estimate_type .............. <function beam_search_lower_bound at 0x7f530d02bdc0>
[2022-05-08 17:06:11.976862] excluded_terms ............. [1]
[2022-05-08 17:06:11.976872] finetune ................... False
[2022-05-08 17:06:11.976882] grad_clip .................. 1.0
[2022-05-08 17:06:11.976890] hidden_size ................ 128
[2022-05-08 17:06:11.976898] hist_len ................... 18
[2022-05-08 17:06:11.976908] interp_func ................ <function lin_interp at 0x7f530d02bca0>
[2022-05-08 17:06:11.976916] log_interval ............... 100
[2022-05-08 17:06:11.976926] lr ......................... 0.001
[2022-05-08 17:06:11.976934] lr_decay_style ............. constant
[2022-05-08 17:06:11.976942] masked_lm .................. False
[2022-05-08 17:06:11.976951] min_phase_shift ............ 0
[2022-05-08 17:06:11.976960] min_var_reduction .......... 0.9
[2022-05-08 17:06:11.976968] min_variance ............... False
[2022-05-08 17:06:11.976977] model_budget_filepath ...... None
[2022-05-08 17:06:11.976986] num_beams .................. 0.0
[2022-05-08 17:06:11.976994] num_layers ................. 2
[2022-05-08 17:06:11.977002] num_mc_samples ............. 1000
[2022-05-08 17:06:11.977010] num_workers ................ 0
[2022-05-08 17:06:11.977018] optimizer .................. adam
[2022-05-08 17:06:11.977027] proposal_func .............. <function lm_proposal at 0x7f530d026ee0>
[2022-05-08 17:06:11.977035] rnn_type ................... LSTM
[2022-05-08 17:06:11.977043] save_epochs ................ 1
[2022-05-08 17:06:11.977051] seed ....................... 1234321
[2022-05-08 17:06:11.977059] seq_len .................... 100
[2022-05-08 17:06:11.977068] shuffle .................... True
[2022-05-08 17:06:11.977076] store_intermediate_lbs ..... True
[2022-05-08 17:06:11.977084] sub_estimates .............. []
[2022-05-08 17:06:11.977093] text_dict .................. None
[2022-05-08 17:06:11.977101] top_k ...................... 0
[2022-05-08 17:06:11.977109] top_p ...................... 0
[2022-05-08 17:06:11.977117] total_seq_len .............. 20
[2022-05-08 17:06:11.977126] train_data_pct ............. 0.9
[2022-05-08 17:06:11.977134] train_epochs ............... 40
[2022-05-08 17:06:11.977142] val_data_pct ............... 0.05
[2022-05-08 17:06:11.977152] val_metrics ................ ['accuracy']
[2022-05-08 17:06:11.977160] valid_epochs ............... 1
[2022-05-08 17:06:11.977168] vocab_size ................. 68
[2022-05-08 17:06:11.977177] warmup_pct ................. 0.01
[2022-05-08 17:06:11.977185] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.95 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl does not exist
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl does not exist
==================================================
