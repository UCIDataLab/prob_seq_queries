==================================================
* Running for dataset amazon
==================================================
[2022-05-08 21:47:41.445900] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-08 21:47:41.456179] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-08 21:47:41.456337] batch_size ................. 4096
[2022-05-08 21:47:41.456344] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-08 21:47:41.456350] cuda ....................... True
[2022-05-08 21:47:41.456354] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-08 21:47:41.456357] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-08 21:47:41.456361] device ..................... 4
[2022-05-08 21:47:41.456365] device_num ................. 0
[2022-05-08 21:47:41.456369] disable_tqdm ............... True
[2022-05-08 21:47:41.456373] do_test .................... False
[2022-05-08 21:47:41.456376] do_valid ................... True
[2022-05-08 21:47:41.456380] dont_print_args ............ True
[2022-05-08 21:47:41.456384] dont_shuffle ............... None
[2022-05-08 21:47:41.456394] dropout .................... 0.3
[2022-05-08 21:47:41.456400] estimate_type .............. <function beam_search_lower_bound at 0x7f082a24cdc0>
[2022-05-08 21:47:41.456407] excluded_terms ............. [1]
[2022-05-08 21:47:41.456411] finetune ................... False
[2022-05-08 21:47:41.456416] grad_clip .................. 1.0
[2022-05-08 21:47:41.456419] hidden_size ................ 512
[2022-05-08 21:47:41.456423] hist_len ................... 18
[2022-05-08 21:47:41.456427] interp_func ................ <function lin_interp at 0x7f082a24cca0>
[2022-05-08 21:47:41.456430] log_interval ............... 100
[2022-05-08 21:47:41.456435] lr ......................... 0.001
[2022-05-08 21:47:41.456438] lr_decay_style ............. constant
[2022-05-08 21:47:41.456442] masked_lm .................. False
[2022-05-08 21:47:41.456446] min_phase_shift ............ 0
[2022-05-08 21:47:41.456450] min_var_reduction .......... 0.9
[2022-05-08 21:47:41.456453] min_variance ............... False
[2022-05-08 21:47:41.456457] model_budget_filepath ...... None
[2022-05-08 21:47:41.456461] num_beams .................. 0.0
[2022-05-08 21:47:41.456465] num_layers ................. 2
[2022-05-08 21:47:41.456468] num_mc_samples ............. 1000
[2022-05-08 21:47:41.456472] num_workers ................ 0
[2022-05-08 21:47:41.456475] optimizer .................. adam
[2022-05-08 21:47:41.456479] proposal_func .............. <function lm_proposal at 0x7f082a248ee0>
[2022-05-08 21:47:41.456482] rnn_type ................... LSTM
[2022-05-08 21:47:41.456485] save_epochs ................ 1
[2022-05-08 21:47:41.456489] seed ....................... 1234321
[2022-05-08 21:47:41.456492] seq_len .................... 15
[2022-05-08 21:47:41.456496] shuffle .................... True
[2022-05-08 21:47:41.456499] store_intermediate_lbs ..... True
[2022-05-08 21:47:41.456503] sub_estimates .............. []
[2022-05-08 21:47:41.456508] text_dict .................. None
[2022-05-08 21:47:41.456512] top_k ...................... 0
[2022-05-08 21:47:41.456515] top_p ...................... 0
[2022-05-08 21:47:41.456518] total_seq_len .............. 20
[2022-05-08 21:47:41.456523] train_data_pct ............. 0.9
[2022-05-08 21:47:41.456526] train_epochs ............... 40
[2022-05-08 21:47:41.456530] val_data_pct ............... 0.0001
[2022-05-08 21:47:41.456536] val_metrics ................ ['accuracy']
[2022-05-08 21:47:41.456540] valid_epochs ............... 1
[2022-05-08 21:47:41.456543] vocab_size ................. 30
[2022-05-08 21:47:41.456547] warmup_pct ................. 0.01
[2022-05-08 21:47:41.456551] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.95 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.85 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-08 22:05:25.794280] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-08 22:05:25.804874] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-08 22:05:25.835876] batch_size ................. 4096
[2022-05-08 22:05:25.835914] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-08 22:05:25.835922] cuda ....................... True
[2022-05-08 22:05:25.835926] data_path .................. data/apps/lsapp.tsv
[2022-05-08 22:05:25.835929] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-08 22:05:25.835934] device ..................... 4
[2022-05-08 22:05:25.835937] device_num ................. 0
[2022-05-08 22:05:25.835941] disable_tqdm ............... True
[2022-05-08 22:05:25.835945] do_test .................... False
[2022-05-08 22:05:25.835949] do_valid ................... True
[2022-05-08 22:05:25.835952] dont_print_args ............ True
[2022-05-08 22:05:25.835960] dont_shuffle ............... None
[2022-05-08 22:05:25.835973] dropout .................... 0.3
[2022-05-08 22:05:25.835980] estimate_type .............. <function beam_search_lower_bound at 0x7f082a24cdc0>
[2022-05-08 22:05:25.835988] excluded_terms ............. [1]
[2022-05-08 22:05:25.835993] finetune ................... False
[2022-05-08 22:05:25.835998] grad_clip .................. 1.0
[2022-05-08 22:05:25.836002] hidden_size ................ 512
[2022-05-08 22:05:25.836005] hist_len ................... 18
[2022-05-08 22:05:25.836011] interp_func ................ <function lin_interp at 0x7f082a24cca0>
[2022-05-08 22:05:25.836014] log_interval ............... 100
[2022-05-08 22:05:25.836019] lr ......................... 0.001
[2022-05-08 22:05:25.836022] lr_decay_style ............. constant
[2022-05-08 22:05:25.836026] masked_lm .................. False
[2022-05-08 22:05:25.836030] min_phase_shift ............ 0
[2022-05-08 22:05:25.836034] min_var_reduction .......... 0.9
[2022-05-08 22:05:25.836037] min_variance ............... False
[2022-05-08 22:05:25.836041] model_budget_filepath ...... None
[2022-05-08 22:05:25.836059] num_beams .................. 0.0
[2022-05-08 22:05:25.836063] num_layers ................. 2
[2022-05-08 22:05:25.836066] num_mc_samples ............. 1000
[2022-05-08 22:05:25.836069] num_workers ................ 0
[2022-05-08 22:05:25.836073] optimizer .................. adam
[2022-05-08 22:05:25.836077] proposal_func .............. <function lm_proposal at 0x7f082a248ee0>
[2022-05-08 22:05:25.836080] rnn_type ................... LSTM
[2022-05-08 22:05:25.836084] save_epochs ................ 1
[2022-05-08 22:05:25.836087] seed ....................... 1234321
[2022-05-08 22:05:25.836090] seq_len .................... 15
[2022-05-08 22:05:25.836094] shuffle .................... True
[2022-05-08 22:05:25.836097] store_intermediate_lbs ..... True
[2022-05-08 22:05:25.836101] sub_estimates .............. []
[2022-05-08 22:05:25.836105] text_dict .................. None
[2022-05-08 22:05:25.836108] top_k ...................... 0
[2022-05-08 22:05:25.836111] top_p ...................... 0
[2022-05-08 22:05:25.836115] total_seq_len .............. 20
[2022-05-08 22:05:25.836119] train_data_pct ............. 0.9
[2022-05-08 22:05:25.836122] train_epochs ............... 40
[2022-05-08 22:05:25.836126] val_data_pct ............... 0.001
[2022-05-08 22:05:25.836133] val_metrics ................ ['accuracy']
[2022-05-08 22:05:25.836136] valid_epochs ............... 1
[2022-05-08 22:05:25.836140] vocab_size ................. 88
[2022-05-08 22:05:25.836144] warmup_pct ................. 0.01
[2022-05-08 22:05:25.836147] weight_decay ............... 0.0
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.92 | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.87 | Hist length 11 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.75 | Hist length 10 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset shakespeare
==================================================
[2022-05-08 22:11:32.524970] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-08 22:11:32.528366] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-08 22:11:32.528526] batch_size ................. 4096
[2022-05-08 22:11:32.528535] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-08 22:11:32.528542] cuda ....................... True
[2022-05-08 22:11:32.528548] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-08 22:11:32.528554] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-08 22:11:32.528559] device ..................... 4
[2022-05-08 22:11:32.528565] device_num ................. 0
[2022-05-08 22:11:32.528571] disable_tqdm ............... True
[2022-05-08 22:11:32.528577] do_test .................... False
[2022-05-08 22:11:32.528582] do_valid ................... True
[2022-05-08 22:11:32.528588] dont_print_args ............ True
[2022-05-08 22:11:32.528594] dont_shuffle ............... None
[2022-05-08 22:11:32.528613] dropout .................... 0.3
[2022-05-08 22:11:32.528621] estimate_type .............. <function beam_search_lower_bound at 0x7f082a24cdc0>
[2022-05-08 22:11:32.528629] excluded_terms ............. [1]
[2022-05-08 22:11:32.528642] finetune ................... False
[2022-05-08 22:11:32.528649] grad_clip .................. 1.0
[2022-05-08 22:11:32.528654] hidden_size ................ 128
[2022-05-08 22:11:32.528660] hist_len ................... 18
[2022-05-08 22:11:32.528667] interp_func ................ <function lin_interp at 0x7f082a24cca0>
[2022-05-08 22:11:32.528672] log_interval ............... 100
[2022-05-08 22:11:32.528681] lr ......................... 0.001
[2022-05-08 22:11:32.528686] lr_decay_style ............. constant
[2022-05-08 22:11:32.528696] masked_lm .................. False
[2022-05-08 22:11:32.528702] min_phase_shift ............ 0
[2022-05-08 22:11:32.528709] min_var_reduction .......... 0.9
[2022-05-08 22:11:32.528714] min_variance ............... False
[2022-05-08 22:11:32.528720] model_budget_filepath ...... None
[2022-05-08 22:11:32.528728] num_beams .................. 0.0
[2022-05-08 22:11:32.528733] num_layers ................. 2
[2022-05-08 22:11:32.528739] num_mc_samples ............. 1000
[2022-05-08 22:11:32.528744] num_workers ................ 0
[2022-05-08 22:11:32.528749] optimizer .................. adam
[2022-05-08 22:11:32.528755] proposal_func .............. <function lm_proposal at 0x7f082a248ee0>
[2022-05-08 22:11:32.528762] rnn_type ................... LSTM
[2022-05-08 22:11:32.528767] save_epochs ................ 1
[2022-05-08 22:11:32.528773] seed ....................... 1234321
[2022-05-08 22:11:32.528778] seq_len .................... 100
[2022-05-08 22:11:32.528783] shuffle .................... True
[2022-05-08 22:11:32.528789] store_intermediate_lbs ..... True
[2022-05-08 22:11:32.528795] sub_estimates .............. []
[2022-05-08 22:11:32.528800] text_dict .................. None
[2022-05-08 22:11:32.528806] top_k ...................... 0
[2022-05-08 22:11:32.528812] top_p ...................... 0
[2022-05-08 22:11:32.528817] total_seq_len .............. 20
[2022-05-08 22:11:32.528823] train_data_pct ............. 0.9
[2022-05-08 22:11:32.528829] train_epochs ............... 40
[2022-05-08 22:11:32.528834] val_data_pct ............... 0.05
[2022-05-08 22:11:32.528842] val_metrics ................ ['accuracy']
[2022-05-08 22:11:32.528848] valid_epochs ............... 1
[2022-05-08 22:11:32.528853] vocab_size ................. 68
[2022-05-08 22:11:32.528859] warmup_pct ................. 0.01
[2022-05-08 22:11:32.528865] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.95 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl does not exist
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl does not exist
==================================================
