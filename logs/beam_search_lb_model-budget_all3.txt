==================================================
* Running for dataset shakespeare
==================================================
[2022-05-09 12:51:37.426822] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-09 12:51:37.431735] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-09 12:51:37.436874] batch_size ................. 4096
[2022-05-09 12:51:37.436913] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-09 12:51:37.436924] cuda ....................... True
[2022-05-09 12:51:37.436931] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-09 12:51:37.436937] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-09 12:51:37.436945] device ..................... 1
[2022-05-09 12:51:37.436954] device_num ................. 0
[2022-05-09 12:51:37.436963] disable_tqdm ............... True
[2022-05-09 12:51:37.436969] do_test .................... False
[2022-05-09 12:51:37.436975] do_valid ................... True
[2022-05-09 12:51:37.436983] dont_print_args ............ True
[2022-05-09 12:51:37.436992] dont_shuffle ............... None
[2022-05-09 12:51:37.437006] dropout .................... 0.3
[2022-05-09 12:51:37.437017] estimate_type .............. <function beam_search_lower_bound at 0x7fb0e8cc5d30>
[2022-05-09 12:51:37.437029] excluded_terms ............. [1]
[2022-05-09 12:51:37.437039] finetune ................... False
[2022-05-09 12:51:37.437047] grad_clip .................. 1.0
[2022-05-09 12:51:37.437053] hidden_size ................ 128
[2022-05-09 12:51:37.437060] hist_len ................... 18
[2022-05-09 12:51:37.437069] interp_func ................ <function lin_interp at 0x7fb0e8cc5c10>
[2022-05-09 12:51:37.437074] log_interval ............... 100
[2022-05-09 12:51:37.437081] lr ......................... 0.001
[2022-05-09 12:51:37.437087] lr_decay_style ............. constant
[2022-05-09 12:51:37.437094] masked_lm .................. False
[2022-05-09 12:51:37.437103] min_phase_shift ............ 0
[2022-05-09 12:51:37.437111] min_var_reduction .......... 0.9
[2022-05-09 12:51:37.437117] min_variance ............... False
[2022-05-09 12:51:37.437124] model_budget_filepath ...... None
[2022-05-09 12:51:37.437131] num_beams .................. 0.0
[2022-05-09 12:51:37.437139] num_layers ................. 2
[2022-05-09 12:51:37.437145] num_mc_samples ............. 1000
[2022-05-09 12:51:37.437151] num_workers ................ 0
[2022-05-09 12:51:37.437157] optimizer .................. adam
[2022-05-09 12:51:37.437164] proposal_func .............. <function lm_proposal at 0x7fb0e8cc2e50>
[2022-05-09 12:51:37.437170] rnn_type ................... LSTM
[2022-05-09 12:51:37.437177] save_epochs ................ 1
[2022-05-09 12:51:37.437183] seed ....................... 1234321
[2022-05-09 12:51:37.437189] seq_len .................... 100
[2022-05-09 12:51:37.437196] shuffle .................... True
[2022-05-09 12:51:37.437202] store_intermediate_lbs ..... True
[2022-05-09 12:51:37.437210] sub_estimates .............. []
[2022-05-09 12:51:37.437217] text_dict .................. None
[2022-05-09 12:51:37.437225] top_k ...................... 0
[2022-05-09 12:51:37.437229] top_p ...................... 0
[2022-05-09 12:51:37.437235] total_seq_len .............. 20
[2022-05-09 12:51:37.437242] train_data_pct ............. 0.9
[2022-05-09 12:51:37.437248] train_epochs ............... 40
[2022-05-09 12:51:37.437255] val_data_pct ............... 0.05
[2022-05-09 12:51:37.437270] val_metrics ................ ['accuracy']
[2022-05-09 12:51:37.437277] valid_epochs ............... 1
[2022-05-09 12:51:37.437282] vocab_size ................. 68
[2022-05-09 12:51:37.437288] warmup_pct ................. 0.01
[2022-05-09 12:51:37.437297] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.95 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl does not exist
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl does not exist
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-09 12:57:11.900544] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-09 12:57:11.912879] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-09 12:57:11.913216] batch_size ................. 4096
[2022-05-09 12:57:11.913228] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-09 12:57:11.913241] cuda ....................... True
[2022-05-09 12:57:11.913249] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-09 12:57:11.913260] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-09 12:57:11.913271] device ..................... 1
[2022-05-09 12:57:11.913280] device_num ................. 0
[2022-05-09 12:57:11.913286] disable_tqdm ............... True
[2022-05-09 12:57:11.913292] do_test .................... False
[2022-05-09 12:57:11.913300] do_valid ................... True
[2022-05-09 12:57:11.913306] dont_print_args ............ True
[2022-05-09 12:57:11.913312] dont_shuffle ............... None
[2022-05-09 12:57:11.913326] dropout .................... 0.3
[2022-05-09 12:57:11.913334] estimate_type .............. <function beam_search_lower_bound at 0x7fb0e8cc5d30>
[2022-05-09 12:57:11.913342] excluded_terms ............. [1]
[2022-05-09 12:57:11.913348] finetune ................... False
[2022-05-09 12:57:11.913357] grad_clip .................. 1.0
[2022-05-09 12:57:11.913369] hidden_size ................ 512
[2022-05-09 12:57:11.913381] hist_len ................... 18
[2022-05-09 12:57:11.913389] interp_func ................ <function lin_interp at 0x7fb0e8cc5c10>
[2022-05-09 12:57:11.913413] log_interval ............... 100
[2022-05-09 12:57:11.913430] lr ......................... 0.001
[2022-05-09 12:57:11.913437] lr_decay_style ............. constant
[2022-05-09 12:57:11.913444] masked_lm .................. False
[2022-05-09 12:57:11.913451] min_phase_shift ............ 0
[2022-05-09 12:57:11.913460] min_var_reduction .......... 0.9
[2022-05-09 12:57:11.913467] min_variance ............... False
[2022-05-09 12:57:11.913475] model_budget_filepath ...... None
[2022-05-09 12:57:11.913483] num_beams .................. 0.0
[2022-05-09 12:57:11.913490] num_layers ................. 2
[2022-05-09 12:57:11.913497] num_mc_samples ............. 1000
[2022-05-09 12:57:11.913512] num_workers ................ 0
[2022-05-09 12:57:11.913524] optimizer .................. adam
[2022-05-09 12:57:11.913538] proposal_func .............. <function lm_proposal at 0x7fb0e8cc2e50>
[2022-05-09 12:57:11.913546] rnn_type ................... LSTM
[2022-05-09 12:57:11.913553] save_epochs ................ 1
[2022-05-09 12:57:11.913560] seed ....................... 1234321
[2022-05-09 12:57:11.913567] seq_len .................... 15
[2022-05-09 12:57:11.913576] shuffle .................... True
[2022-05-09 12:57:11.913583] store_intermediate_lbs ..... True
[2022-05-09 12:57:11.913590] sub_estimates .............. []
[2022-05-09 12:57:11.913597] text_dict .................. None
[2022-05-09 12:57:11.913603] top_k ...................... 0
[2022-05-09 12:57:11.913610] top_p ...................... 0
[2022-05-09 12:57:11.913617] total_seq_len .............. 20
[2022-05-09 12:57:11.913625] train_data_pct ............. 0.9
[2022-05-09 12:57:11.913632] train_epochs ............... 40
[2022-05-09 12:57:11.913640] val_data_pct ............... 0.0001
[2022-05-09 12:57:11.913649] val_metrics ................ ['accuracy']
[2022-05-09 12:57:11.913655] valid_epochs ............... 1
[2022-05-09 12:57:11.913662] vocab_size ................. 30
[2022-05-09 12:57:11.913669] warmup_pct ................. 0.01
[2022-05-09 12:57:11.913676] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.95 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.85 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-09 13:43:35.368046] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-09 13:43:35.395465] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-09 13:43:35.395864] batch_size ................. 4096
[2022-05-09 13:43:35.395885] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-09 13:43:35.395898] cuda ....................... True
[2022-05-09 13:43:35.395907] data_path .................. data/apps/lsapp.tsv
[2022-05-09 13:43:35.395914] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-09 13:43:35.395923] device ..................... 1
[2022-05-09 13:43:35.395931] device_num ................. 0
[2022-05-09 13:43:35.395939] disable_tqdm ............... True
[2022-05-09 13:43:35.395947] do_test .................... False
[2022-05-09 13:43:35.395955] do_valid ................... True
[2022-05-09 13:43:35.395962] dont_print_args ............ True
[2022-05-09 13:43:35.395976] dont_shuffle ............... None
[2022-05-09 13:43:35.395993] dropout .................... 0.3
[2022-05-09 13:43:35.396003] estimate_type .............. <function beam_search_lower_bound at 0x7fb0e8cc5d30>
[2022-05-09 13:43:35.396014] excluded_terms ............. [1]
[2022-05-09 13:43:35.396064] finetune ................... False
[2022-05-09 13:43:35.396073] grad_clip .................. 1.0
[2022-05-09 13:43:35.396081] hidden_size ................ 512
[2022-05-09 13:43:35.396088] hist_len ................... 18
[2022-05-09 13:43:35.396099] interp_func ................ <function lin_interp at 0x7fb0e8cc5c10>
[2022-05-09 13:43:35.396106] log_interval ............... 100
[2022-05-09 13:43:35.396116] lr ......................... 0.001
[2022-05-09 13:43:35.396124] lr_decay_style ............. constant
[2022-05-09 13:43:35.396152] masked_lm .................. False
[2022-05-09 13:43:35.396160] min_phase_shift ............ 0
[2022-05-09 13:43:35.396169] min_var_reduction .......... 0.9
[2022-05-09 13:43:35.396177] min_variance ............... False
[2022-05-09 13:43:35.396185] model_budget_filepath ...... None
[2022-05-09 13:43:35.396197] num_beams .................. 0.0
[2022-05-09 13:43:35.396204] num_layers ................. 2
[2022-05-09 13:43:35.396212] num_mc_samples ............. 1000
[2022-05-09 13:43:35.396220] num_workers ................ 0
[2022-05-09 13:43:35.396228] optimizer .................. adam
[2022-05-09 13:43:35.396237] proposal_func .............. <function lm_proposal at 0x7fb0e8cc2e50>
[2022-05-09 13:43:35.396247] rnn_type ................... LSTM
[2022-05-09 13:43:35.396254] save_epochs ................ 1
[2022-05-09 13:43:35.396262] seed ....................... 1234321
[2022-05-09 13:43:35.396269] seq_len .................... 15
[2022-05-09 13:43:35.396277] shuffle .................... True
[2022-05-09 13:43:35.396284] store_intermediate_lbs ..... True
[2022-05-09 13:43:35.396293] sub_estimates .............. []
[2022-05-09 13:43:35.396307] text_dict .................. None
[2022-05-09 13:43:35.396314] top_k ...................... 0
[2022-05-09 13:43:35.396322] top_p ...................... 0
[2022-05-09 13:43:35.396329] total_seq_len .............. 20
[2022-05-09 13:43:35.396337] train_data_pct ............. 0.9
[2022-05-09 13:43:35.396345] train_epochs ............... 40
[2022-05-09 13:43:35.396353] val_data_pct ............... 0.001
[2022-05-09 13:43:35.396367] val_metrics ................ ['accuracy']
[2022-05-09 13:43:35.396375] valid_epochs ............... 1
[2022-05-09 13:43:35.396382] vocab_size ................. 88
[2022-05-09 13:43:35.396390] warmup_pct ................. 0.01
[2022-05-09 13:43:35.396399] weight_decay ............... 0.0
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.92 | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.87 | Hist length 11 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.75 | Hist length 10 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
