==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 14:04:40.058976] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 14:04:40.062336] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 14:04:40.063689] batch_size ................. 4096
[2022-05-12 14:04:40.063702] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 14:04:40.063710] cuda ....................... True
[2022-05-12 14:04:40.063715] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 14:04:40.063718] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:04:40.063722] device ..................... 4
[2022-05-12 14:04:40.063725] device_num ................. 0
[2022-05-12 14:04:40.063729] disable_tqdm ............... True
[2022-05-12 14:04:40.063733] do_test .................... False
[2022-05-12 14:04:40.063737] do_valid ................... True
[2022-05-12 14:04:40.063740] dont_print_args ............ True
[2022-05-12 14:04:40.063745] dont_shuffle ............... None
[2022-05-12 14:04:40.063752] dropout .................... 0.3
[2022-05-12 14:04:40.063758] estimate_type .............. <function beam_search_lower_bound at 0x7f69cfc4d790>
[2022-05-12 14:04:40.063763] excluded_terms ............. [1]
[2022-05-12 14:04:40.063768] finetune ................... False
[2022-05-12 14:04:40.063773] grad_clip .................. 1.0
[2022-05-12 14:04:40.063777] hidden_size ................ 128
[2022-05-12 14:04:40.063780] hist_len ................... 18
[2022-05-12 14:04:40.063785] interp_func ................ <function lin_interp at 0x7f69cfc4d670>
[2022-05-12 14:04:40.063788] log_interval ............... 100
[2022-05-12 14:04:40.063793] lr ......................... 0.001
[2022-05-12 14:04:40.063796] lr_decay_style ............. constant
[2022-05-12 14:04:40.063800] masked_lm .................. False
[2022-05-12 14:04:40.063804] max_num_mc_samples ......... 100000
[2022-05-12 14:04:40.063808] max_num_queries ............ 100
[2022-05-12 14:04:40.063811] min_num_mc_samples ......... 10000
[2022-05-12 14:04:40.063815] min_phase_shift ............ 0
[2022-05-12 14:04:40.063819] min_var_reduction .......... 0.1
[2022-05-12 14:04:40.063823] min_variance ............... True
[2022-05-12 14:04:40.063826] model_budget_filepath ...... None
[2022-05-12 14:04:40.063830] num_beams .................. 0.0
[2022-05-12 14:04:40.063834] num_layers ................. 2
[2022-05-12 14:04:40.063837] num_mc_samples ............. 100
[2022-05-12 14:04:40.063841] num_workers ................ 0
[2022-05-12 14:04:40.063845] optimizer .................. adam
[2022-05-12 14:04:40.063849] proposal_func .............. <function lm_proposal at 0x7f69cfc3b790>
[2022-05-12 14:04:40.063852] rnn_type ................... LSTM
[2022-05-12 14:04:40.063856] save_epochs ................ 1
[2022-05-12 14:04:40.063859] seed ....................... 42
[2022-05-12 14:04:40.063862] seq_len .................... 100
[2022-05-12 14:04:40.063866] shuffle .................... True
[2022-05-12 14:04:40.063870] store_intermediate_lbs ..... True
[2022-05-12 14:04:40.063874] sub_estimates .............. []
[2022-05-12 14:04:40.063877] text_dict .................. None
[2022-05-12 14:04:40.063881] top_k ...................... 0
[2022-05-12 14:04:40.063884] top_p ...................... 0
[2022-05-12 14:04:40.063887] total_seq_len .............. 20
[2022-05-12 14:04:40.063892] train_data_pct ............. 0.9
[2022-05-12 14:04:40.063895] train_epochs ............... 40
[2022-05-12 14:04:40.063899] use_gpt2 ................... False
[2022-05-12 14:04:40.063903] val_data_pct ............... 0.05
[2022-05-12 14:04:40.063907] val_metrics ................ ['accuracy']
[2022-05-12 14:04:40.063911] valid_epochs ............... 1
[2022-05-12 14:04:40.063916] variance_epsilon ........... 5e-06
[2022-05-12 14:04:40.063920] vocab_size ................. 68
[2022-05-12 14:04:40.063923] warmup_pct ................. 0.01
[2022-05-12 14:04:40.063927] weight_decay ............... 0.0
==================================================
[2022-05-12 14:04:40.064235] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 1000 | Hist length 16 | Total Seq Length 20

..........
==================================================
[2022-05-12 14:04:40.766463] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 1000 | Hist length 12 | Total Seq Length 20

..........
==================================================
[2022-05-12 14:04:41.833944] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 20

..........
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 14:05:49.852549] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 14:05:49.881171] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 14:05:50.259450] batch_size ................. 4096
[2022-05-12 14:05:50.259476] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 14:05:50.259485] cuda ....................... True
[2022-05-12 14:05:50.259491] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 14:05:50.259497] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:05:50.259503] device ..................... 4
[2022-05-12 14:05:50.259509] device_num ................. 0
[2022-05-12 14:05:50.259515] disable_tqdm ............... True
[2022-05-12 14:05:50.259522] do_test .................... False
[2022-05-12 14:05:50.259528] do_valid ................... True
[2022-05-12 14:05:50.259533] dont_print_args ............ True
[2022-05-12 14:05:50.259540] dont_shuffle ............... None
[2022-05-12 14:05:50.259551] dropout .................... 0.3
[2022-05-12 14:05:50.259559] estimate_type .............. <function beam_search_lower_bound at 0x7f69cfc4d790>
[2022-05-12 14:05:50.265305] excluded_terms ............. [1]
[2022-05-12 14:05:50.265325] finetune ................... False
[2022-05-12 14:05:50.265332] grad_clip .................. 1.0
[2022-05-12 14:05:50.265338] hidden_size ................ 512
[2022-05-12 14:05:50.265344] hist_len ................... 18
[2022-05-12 14:05:50.265353] interp_func ................ <function lin_interp at 0x7f69cfc4d670>
[2022-05-12 14:05:50.265358] log_interval ............... 100
[2022-05-12 14:05:50.265366] lr ......................... 0.001
[2022-05-12 14:05:50.265371] lr_decay_style ............. constant
[2022-05-12 14:05:50.265383] masked_lm .................. False
[2022-05-12 14:05:50.265388] max_num_mc_samples ......... 100000
[2022-05-12 14:05:50.265394] max_num_queries ............ 100
[2022-05-12 14:05:50.265400] min_num_mc_samples ......... 10000
[2022-05-12 14:05:50.265405] min_phase_shift ............ 0
[2022-05-12 14:05:50.265413] min_var_reduction .......... 0.1
[2022-05-12 14:05:50.265419] min_variance ............... True
[2022-05-12 14:05:50.265425] model_budget_filepath ...... None
[2022-05-12 14:05:50.265432] num_beams .................. 0.0
[2022-05-12 14:05:50.265437] num_layers ................. 2
[2022-05-12 14:05:50.265443] num_mc_samples ............. 100
[2022-05-12 14:05:50.265450] num_workers ................ 0
[2022-05-12 14:05:50.265456] optimizer .................. adam
[2022-05-12 14:05:50.265463] proposal_func .............. <function lm_proposal at 0x7f69cfc3b790>
[2022-05-12 14:05:50.265469] rnn_type ................... LSTM
[2022-05-12 14:05:50.265474] save_epochs ................ 1
[2022-05-12 14:05:50.265480] seed ....................... 42
[2022-05-12 14:05:50.265485] seq_len .................... 15
[2022-05-12 14:05:50.265495] shuffle .................... True
[2022-05-12 14:05:50.265500] store_intermediate_lbs ..... True
[2022-05-12 14:05:50.265507] sub_estimates .............. []
[2022-05-12 14:05:50.265512] text_dict .................. None
[2022-05-12 14:05:50.265518] top_k ...................... 0
[2022-05-12 14:05:50.265524] top_p ...................... 0
[2022-05-12 14:05:50.265529] total_seq_len .............. 20
[2022-05-12 14:05:50.265537] train_data_pct ............. 0.9
[2022-05-12 14:05:50.265543] train_epochs ............... 40
[2022-05-12 14:05:50.265548] use_gpt2 ................... False
[2022-05-12 14:05:50.265556] val_data_pct ............... 0.0001
[2022-05-12 14:05:50.265563] val_metrics ................ ['accuracy']
[2022-05-12 14:05:50.265569] valid_epochs ............... 1
[2022-05-12 14:05:50.265577] variance_epsilon ........... 5e-06
[2022-05-12 14:05:50.265583] vocab_size ................. 30
[2022-05-12 14:05:50.265590] warmup_pct ................. 0.01
[2022-05-12 14:05:50.265596] weight_decay ............... 0.0
==================================================
[2022-05-12 14:05:50.265984] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..........
==================================================
[2022-05-12 14:05:52.824623] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15

..........
==================================================
[2022-05-12 14:05:55.669890] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15

..........
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 14:06:40.255469] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 14:06:40.267583] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 14:06:40.864530] batch_size ................. 4096
[2022-05-12 14:06:40.864556] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 14:06:40.864562] cuda ....................... True
[2022-05-12 14:06:40.864566] data_path .................. data/apps/lsapp.tsv
[2022-05-12 14:06:40.864570] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:06:40.864575] device ..................... 4
[2022-05-12 14:06:40.864578] device_num ................. 0
[2022-05-12 14:06:40.864582] disable_tqdm ............... True
[2022-05-12 14:06:40.864587] do_test .................... False
[2022-05-12 14:06:40.864591] do_valid ................... True
[2022-05-12 14:06:40.864594] dont_print_args ............ True
[2022-05-12 14:06:40.864600] dont_shuffle ............... None
[2022-05-12 14:06:40.864609] dropout .................... 0.3
[2022-05-12 14:06:40.864614] estimate_type .............. <function beam_search_lower_bound at 0x7f69cfc4d790>
[2022-05-12 14:06:40.864622] excluded_terms ............. [1]
[2022-05-12 14:06:40.864626] finetune ................... False
[2022-05-12 14:06:40.864630] grad_clip .................. 1.0
[2022-05-12 14:06:40.864633] hidden_size ................ 512
[2022-05-12 14:06:40.864637] hist_len ................... 18
[2022-05-12 14:06:40.864641] interp_func ................ <function lin_interp at 0x7f69cfc4d670>
[2022-05-12 14:06:40.864644] log_interval ............... 100
[2022-05-12 14:06:40.864648] lr ......................... 0.001
[2022-05-12 14:06:40.864652] lr_decay_style ............. constant
[2022-05-12 14:06:40.864656] masked_lm .................. False
[2022-05-12 14:06:40.864659] max_num_mc_samples ......... 100000
[2022-05-12 14:06:40.864662] max_num_queries ............ 100
[2022-05-12 14:06:40.864666] min_num_mc_samples ......... 10000
[2022-05-12 14:06:40.864669] min_phase_shift ............ 0
[2022-05-12 14:06:40.864673] min_var_reduction .......... 0.1
[2022-05-12 14:06:40.864677] min_variance ............... True
[2022-05-12 14:06:40.864680] model_budget_filepath ...... None
[2022-05-12 14:06:40.864685] needs_encoding ............. True
[2022-05-12 14:06:40.864689] num_beams .................. 0.0
[2022-05-12 14:06:40.864692] num_layers ................. 2
[2022-05-12 14:06:40.864697] num_mc_samples ............. 100
[2022-05-12 14:06:40.864700] num_workers ................ 0
[2022-05-12 14:06:40.864704] optimizer .................. adam
[2022-05-12 14:06:40.864707] proposal_func .............. <function lm_proposal at 0x7f69cfc3b790>
[2022-05-12 14:06:40.864711] rnn_type ................... LSTM
[2022-05-12 14:06:40.864714] save_epochs ................ 1
[2022-05-12 14:06:40.864717] seed ....................... 42
[2022-05-12 14:06:40.864720] seq_len .................... 15
[2022-05-12 14:06:40.864724] shuffle .................... True
[2022-05-12 14:06:40.864727] store_intermediate_lbs ..... True
[2022-05-12 14:06:40.864731] sub_estimates .............. []
[2022-05-12 14:06:40.864734] text_dict .................. None
[2022-05-12 14:06:40.864737] top_k ...................... 0
[2022-05-12 14:06:40.864740] top_p ...................... 0
[2022-05-12 14:06:40.864744] total_seq_len .............. 20
[2022-05-12 14:06:40.864748] train_data_pct ............. 0.9
[2022-05-12 14:06:40.864751] train_epochs ............... 40
[2022-05-12 14:06:40.864755] use_gpt2 ................... False
[2022-05-12 14:06:40.864758] val_data_pct ............... 0.001
[2022-05-12 14:06:40.864762] val_metrics ................ ['accuracy']
[2022-05-12 14:06:40.864765] valid_epochs ............... 1
[2022-05-12 14:06:40.864771] variance_epsilon ........... 5e-06
[2022-05-12 14:06:40.864776] vocab_size ................. 88
[2022-05-12 14:06:40.864780] warmup_pct ................. 0.01
[2022-05-12 14:06:40.864783] weight_decay ............... 0.0
==================================================
[2022-05-12 14:06:40.865204] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..........
==================================================
[2022-05-12 14:06:42.842842] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15

..........
==================================================
[2022-05-12 14:06:44.581908] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15

..........
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-12 14:06:49.637082] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-12 14:06:49.640531] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-12 14:06:49.716259] batch_size ................. 4096
[2022-05-12 14:06:49.716290] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-12 14:06:49.716299] cuda ....................... True
[2022-05-12 14:06:49.716306] data_path .................. data/moocs/mooc.csv
[2022-05-12 14:06:49.716311] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:06:49.716320] device ..................... 4
[2022-05-12 14:06:49.716326] device_num ................. 0
[2022-05-12 14:06:49.716332] disable_tqdm ............... True
[2022-05-12 14:06:49.716341] do_test .................... False
[2022-05-12 14:06:49.716347] do_valid ................... True
[2022-05-12 14:06:49.716353] dont_print_args ............ True
[2022-05-12 14:06:49.716360] dont_shuffle ............... None
[2022-05-12 14:06:49.716374] dropout .................... 0.3
[2022-05-12 14:06:49.716382] estimate_type .............. <function beam_search_lower_bound at 0x7f69cfc4d790>
[2022-05-12 14:06:49.716394] excluded_terms ............. [1]
[2022-05-12 14:06:49.716401] finetune ................... False
[2022-05-12 14:06:49.716408] grad_clip .................. 1.0
[2022-05-12 14:06:49.716414] hidden_size ................ 128
[2022-05-12 14:06:49.716420] hist_len ................... 18
[2022-05-12 14:06:49.716426] interp_func ................ <function lin_interp at 0x7f69cfc4d670>
[2022-05-12 14:06:49.716432] log_interval ............... 100
[2022-05-12 14:06:49.716440] lr ......................... 0.001
[2022-05-12 14:06:49.716445] lr_decay_style ............. constant
[2022-05-12 14:06:49.716451] masked_lm .................. False
[2022-05-12 14:06:49.716456] max_num_mc_samples ......... 100000
[2022-05-12 14:06:49.716462] max_num_queries ............ 100
[2022-05-12 14:06:49.716468] min_num_mc_samples ......... 10000
[2022-05-12 14:06:49.716473] min_phase_shift ............ 0
[2022-05-12 14:06:49.716480] min_var_reduction .......... 0.1
[2022-05-12 14:06:49.716486] min_variance ............... True
[2022-05-12 14:06:49.716492] model_budget_filepath ...... None
[2022-05-12 14:06:49.716498] needs_encoding ............. False
[2022-05-12 14:06:49.716505] num_beams .................. 0.0
[2022-05-12 14:06:49.716510] num_layers ................. 2
[2022-05-12 14:06:49.716516] num_mc_samples ............. 100
[2022-05-12 14:06:49.716524] num_workers ................ 0
[2022-05-12 14:06:49.716538] optimizer .................. adam
[2022-05-12 14:06:49.716559] proposal_func .............. <function lm_proposal at 0x7f69cfc3b790>
[2022-05-12 14:06:49.716575] rnn_type ................... LSTM
[2022-05-12 14:06:49.716593] save_epochs ................ 1
[2022-05-12 14:06:49.716615] seed ....................... 42
[2022-05-12 14:06:49.716627] seq_len .................... 15
[2022-05-12 14:06:49.716642] shuffle .................... True
[2022-05-12 14:06:49.716651] store_intermediate_lbs ..... True
[2022-05-12 14:06:49.716658] sub_estimates .............. []
[2022-05-12 14:06:49.716664] text_dict .................. None
[2022-05-12 14:06:49.716669] top_k ...................... 0
[2022-05-12 14:06:49.716675] top_p ...................... 0
[2022-05-12 14:06:49.716681] total_seq_len .............. 20
[2022-05-12 14:06:49.716687] train_data_pct ............. 0.9
[2022-05-12 14:06:49.716693] train_epochs ............... 40
[2022-05-12 14:06:49.716698] use_gpt2 ................... False
[2022-05-12 14:06:49.716705] val_data_pct ............... 0.01
[2022-05-12 14:06:49.716712] val_metrics ................ ['accuracy']
[2022-05-12 14:06:49.716718] valid_epochs ............... 1
[2022-05-12 14:06:49.716728] variance_epsilon ........... 5e-06
[2022-05-12 14:06:49.716733] vocab_size ................. 98
[2022-05-12 14:06:49.716739] warmup_pct ................. 0.01
[2022-05-12 14:06:49.716745] weight_decay ............... 0.0
==================================================
[2022-05-12 14:06:49.717600] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..........
==================================================
[2022-05-12 14:06:50.908457] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15

..........
==================================================
[2022-05-12 14:06:52.349396] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15

..........
==================================================
