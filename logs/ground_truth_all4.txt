==================================================
* Running for dataset shakespeare
==================================================
[2022-05-10 15:18:48.166059] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-10 15:18:48.169540] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-10 15:18:48.172030] batch_size ................. 4096
[2022-05-10 15:18:48.172042] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-10 15:18:48.172052] cuda ....................... True
[2022-05-10 15:18:48.172056] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-10 15:18:48.172059] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 15:18:48.172063] device ..................... 0
[2022-05-10 15:18:48.172066] device_num ................. 0
[2022-05-10 15:18:48.172070] disable_tqdm ............... True
[2022-05-10 15:18:48.172073] do_test .................... False
[2022-05-10 15:18:48.172077] do_valid ................... True
[2022-05-10 15:18:48.172081] dont_print_args ............ True
[2022-05-10 15:18:48.172085] dont_shuffle ............... None
[2022-05-10 15:18:48.172094] dropout .................... 0.3
[2022-05-10 15:18:48.172100] estimate_type .............. <function beam_search_lower_bound at 0x7ff02e7c7a60>
[2022-05-10 15:18:48.172105] excluded_terms ............. [1]
[2022-05-10 15:18:48.172109] finetune ................... False
[2022-05-10 15:18:48.172113] grad_clip .................. 1.0
[2022-05-10 15:18:48.172116] hidden_size ................ 128
[2022-05-10 15:18:48.172120] hist_len ................... 18
[2022-05-10 15:18:48.172124] interp_func ................ <function lin_interp at 0x7ff02e7c7940>
[2022-05-10 15:18:48.172128] log_interval ............... 100
[2022-05-10 15:18:48.172132] lr ......................... 0.001
[2022-05-10 15:18:48.172136] lr_decay_style ............. constant
[2022-05-10 15:18:48.172139] masked_lm .................. False
[2022-05-10 15:18:48.172143] min_phase_shift ............ 0
[2022-05-10 15:18:48.172147] min_var_reduction .......... 0.1
[2022-05-10 15:18:48.172150] min_variance ............... True
[2022-05-10 15:18:48.172154] model_budget_filepath ...... None
[2022-05-10 15:18:48.172158] num_beams .................. 0.0
[2022-05-10 15:18:48.172161] num_layers ................. 2
[2022-05-10 15:18:48.172165] num_mc_samples ............. 100
[2022-05-10 15:18:48.172168] num_workers ................ 0
[2022-05-10 15:18:48.172171] optimizer .................. adam
[2022-05-10 15:18:48.172175] proposal_func .............. <function lm_proposal at 0x7ff02e7c3940>
[2022-05-10 15:18:48.172179] rnn_type ................... LSTM
[2022-05-10 15:18:48.172182] save_epochs ................ 1
[2022-05-10 15:18:48.172185] seed ....................... 42
[2022-05-10 15:18:48.172188] seq_len .................... 100
[2022-05-10 15:18:48.172192] shuffle .................... True
[2022-05-10 15:18:48.172195] store_intermediate_lbs ..... True
[2022-05-10 15:18:48.172199] sub_estimates .............. []
[2022-05-10 15:18:48.172203] text_dict .................. None
[2022-05-10 15:18:48.172206] top_k ...................... 0
[2022-05-10 15:18:48.172209] top_p ...................... 0
[2022-05-10 15:18:48.172212] total_seq_len .............. 20
[2022-05-10 15:18:48.172216] train_data_pct ............. 0.9
[2022-05-10 15:18:48.172220] train_epochs ............... 40
[2022-05-10 15:18:48.172223] val_data_pct ............... 0.05
[2022-05-10 15:18:48.172229] val_metrics ................ ['accuracy']
[2022-05-10 15:18:48.172233] valid_epochs ............... 1
[2022-05-10 15:18:48.172236] vocab_size ................. 68
[2022-05-10 15:18:48.172240] warmup_pct ................. 0.01
[2022-05-10 15:18:48.172243] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: ground_truth | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: ground_truth | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-10 15:44:42.098610] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-10 15:44:42.109887] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-10 15:44:42.433538] batch_size ................. 4096
[2022-05-10 15:44:42.433579] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-10 15:44:42.433587] cuda ....................... True
[2022-05-10 15:44:42.433591] data_path .................. data/apps/lsapp.tsv
[2022-05-10 15:44:42.433595] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 15:44:42.433599] device ..................... 0
[2022-05-10 15:44:42.433602] device_num ................. 0
[2022-05-10 15:44:42.433606] disable_tqdm ............... True
[2022-05-10 15:44:42.433613] do_test .................... False
[2022-05-10 15:44:42.433617] do_valid ................... True
[2022-05-10 15:44:42.433620] dont_print_args ............ True
[2022-05-10 15:44:42.433625] dont_shuffle ............... None
[2022-05-10 15:44:42.433634] dropout .................... 0.3
[2022-05-10 15:44:42.433640] estimate_type .............. <function beam_search_lower_bound at 0x7ff02e7c7a60>
[2022-05-10 15:44:42.433653] excluded_terms ............. [1]
[2022-05-10 15:44:42.433661] finetune ................... False
[2022-05-10 15:44:42.433668] grad_clip .................. 1.0
[2022-05-10 15:44:42.433671] hidden_size ................ 512
[2022-05-10 15:44:42.433675] hist_len ................... 18
[2022-05-10 15:44:42.433680] interp_func ................ <function lin_interp at 0x7ff02e7c7940>
[2022-05-10 15:44:42.433683] log_interval ............... 100
[2022-05-10 15:44:42.433688] lr ......................... 0.001
[2022-05-10 15:44:42.433692] lr_decay_style ............. constant
[2022-05-10 15:44:42.433696] masked_lm .................. False
[2022-05-10 15:44:42.433699] min_phase_shift ............ 0
[2022-05-10 15:44:42.433703] min_var_reduction .......... 0.1
[2022-05-10 15:44:42.433707] min_variance ............... True
[2022-05-10 15:44:42.433711] model_budget_filepath ...... None
[2022-05-10 15:44:42.433714] needs_encoding ............. True
[2022-05-10 15:44:42.433718] num_beams .................. 0.0
[2022-05-10 15:44:42.433721] num_layers ................. 2
[2022-05-10 15:44:42.433725] num_mc_samples ............. 100
[2022-05-10 15:44:42.433739] num_workers ................ 0
[2022-05-10 15:44:42.433746] optimizer .................. adam
[2022-05-10 15:44:42.433757] proposal_func .............. <function lm_proposal at 0x7ff02e7c3940>
[2022-05-10 15:44:42.433760] rnn_type ................... LSTM
[2022-05-10 15:44:42.433764] save_epochs ................ 1
[2022-05-10 15:44:42.433767] seed ....................... 42
[2022-05-10 15:44:42.433771] seq_len .................... 15
[2022-05-10 15:44:42.433774] shuffle .................... True
[2022-05-10 15:44:42.433778] store_intermediate_lbs ..... True
[2022-05-10 15:44:42.433782] sub_estimates .............. []
[2022-05-10 15:44:42.433785] text_dict .................. None
[2022-05-10 15:44:42.433789] top_k ...................... 0
[2022-05-10 15:44:42.433792] top_p ...................... 0
[2022-05-10 15:44:42.433795] total_seq_len .............. 20
[2022-05-10 15:44:42.433799] train_data_pct ............. 0.9
[2022-05-10 15:44:42.433803] train_epochs ............... 40
[2022-05-10 15:44:42.433809] val_data_pct ............... 0.001
[2022-05-10 15:44:42.433828] val_metrics ................ ['accuracy']
[2022-05-10 15:44:42.433834] valid_epochs ............... 1
[2022-05-10 15:44:42.433837] vocab_size ................. 88
[2022-05-10 15:44:42.433841] warmup_pct ................. 0.01
[2022-05-10 15:44:42.433845] weight_decay ............... 0.0
==================================================
Dataset: apps | Sample type: ground_truth | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: ground_truth | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-10 20:20:16.357030] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-10 20:20:16.427854] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-10 20:20:16.589516] batch_size ................. 4096
[2022-05-10 20:20:16.589543] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-10 20:20:16.589549] cuda ....................... True
[2022-05-10 20:20:16.589552] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-10 20:20:16.589555] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 20:20:16.589558] device ..................... 0
[2022-05-10 20:20:16.589561] device_num ................. 0
[2022-05-10 20:20:16.589563] disable_tqdm ............... True
[2022-05-10 20:20:16.589567] do_test .................... False
[2022-05-10 20:20:16.589570] do_valid ................... True
[2022-05-10 20:20:16.589572] dont_print_args ............ True
[2022-05-10 20:20:16.589577] dont_shuffle ............... None
[2022-05-10 20:20:16.589585] dropout .................... 0.3
[2022-05-10 20:20:16.589589] estimate_type .............. <function beam_search_lower_bound at 0x7ff02e7c7a60>
[2022-05-10 20:20:16.589594] excluded_terms ............. [1]
[2022-05-10 20:20:16.589601] finetune ................... False
[2022-05-10 20:20:16.589605] grad_clip .................. 1.0
[2022-05-10 20:20:16.589607] hidden_size ................ 512
[2022-05-10 20:20:16.589610] hist_len ................... 18
[2022-05-10 20:20:16.589613] interp_func ................ <function lin_interp at 0x7ff02e7c7940>
[2022-05-10 20:20:16.589616] log_interval ............... 100
[2022-05-10 20:20:16.589619] lr ......................... 0.001
[2022-05-10 20:20:16.589621] lr_decay_style ............. constant
[2022-05-10 20:20:16.589624] masked_lm .................. False
[2022-05-10 20:20:16.589627] min_phase_shift ............ 0
[2022-05-10 20:20:16.589630] min_var_reduction .......... 0.1
[2022-05-10 20:20:16.589632] min_variance ............... True
[2022-05-10 20:20:16.589635] model_budget_filepath ...... None
[2022-05-10 20:20:16.589638] num_beams .................. 0.0
[2022-05-10 20:20:16.589640] num_layers ................. 2
[2022-05-10 20:20:16.589643] num_mc_samples ............. 100
[2022-05-10 20:20:16.589646] num_workers ................ 0
[2022-05-10 20:20:16.589648] optimizer .................. adam
[2022-05-10 20:20:16.589651] proposal_func .............. <function lm_proposal at 0x7ff02e7c3940>
[2022-05-10 20:20:16.589654] rnn_type ................... LSTM
[2022-05-10 20:20:16.589656] save_epochs ................ 1
[2022-05-10 20:20:16.589659] seed ....................... 42
[2022-05-10 20:20:16.589661] seq_len .................... 15
[2022-05-10 20:20:16.589664] shuffle .................... True
[2022-05-10 20:20:16.589666] store_intermediate_lbs ..... True
[2022-05-10 20:20:16.589669] sub_estimates .............. []
[2022-05-10 20:20:16.589672] text_dict .................. None
[2022-05-10 20:20:16.589675] top_k ...................... 0
[2022-05-10 20:20:16.589677] top_p ...................... 0
[2022-05-10 20:20:16.589679] total_seq_len .............. 20
[2022-05-10 20:20:16.589682] train_data_pct ............. 0.9
[2022-05-10 20:20:16.589685] train_epochs ............... 40
[2022-05-10 20:20:16.589687] val_data_pct ............... 0.0001
[2022-05-10 20:20:16.589691] val_metrics ................ ['accuracy']
[2022-05-10 20:20:16.589693] valid_epochs ............... 1
[2022-05-10 20:20:16.589696] vocab_size ................. 30
[2022-05-10 20:20:16.589698] warmup_pct ................. 0.01
[2022-05-10 20:20:16.589701] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: ground_truth | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: ground_truth | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-10 20:33:41.423356] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-10 20:33:41.431295] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-10 20:33:41.479663] batch_size ................. 4096
[2022-05-10 20:33:41.479681] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-10 20:33:41.479689] cuda ....................... True
[2022-05-10 20:33:41.479693] data_path .................. data/moocs/mooc.csv
[2022-05-10 20:33:41.479697] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 20:33:41.479701] device ..................... 0
[2022-05-10 20:33:41.479704] device_num ................. 0
[2022-05-10 20:33:41.479708] disable_tqdm ............... True
[2022-05-10 20:33:41.479712] do_test .................... False
[2022-05-10 20:33:41.479717] do_valid ................... True
[2022-05-10 20:33:41.479722] dont_print_args ............ True
[2022-05-10 20:33:41.479727] dont_shuffle ............... None
[2022-05-10 20:33:41.479735] dropout .................... 0.3
[2022-05-10 20:33:41.479741] estimate_type .............. <function beam_search_lower_bound at 0x7ff02e7c7a60>
[2022-05-10 20:33:41.479747] excluded_terms ............. [1]
[2022-05-10 20:33:41.479766] finetune ................... False
[2022-05-10 20:33:41.479771] grad_clip .................. 1.0
[2022-05-10 20:33:41.479775] hidden_size ................ 128
[2022-05-10 20:33:41.479778] hist_len ................... 18
[2022-05-10 20:33:41.479783] interp_func ................ <function lin_interp at 0x7ff02e7c7940>
[2022-05-10 20:33:41.479786] log_interval ............... 100
[2022-05-10 20:33:41.479791] lr ......................... 0.001
[2022-05-10 20:33:41.479794] lr_decay_style ............. constant
[2022-05-10 20:33:41.479798] masked_lm .................. False
[2022-05-10 20:33:41.479802] min_phase_shift ............ 0
[2022-05-10 20:33:41.479806] min_var_reduction .......... 0.1
[2022-05-10 20:33:41.479809] min_variance ............... True
[2022-05-10 20:33:41.479813] model_budget_filepath ...... None
[2022-05-10 20:33:41.479817] needs_encoding ............. False
[2022-05-10 20:33:41.479821] num_beams .................. 0.0
[2022-05-10 20:33:41.479824] num_layers ................. 2
[2022-05-10 20:33:41.479827] num_mc_samples ............. 100
[2022-05-10 20:33:41.479831] num_workers ................ 0
[2022-05-10 20:33:41.479834] optimizer .................. adam
[2022-05-10 20:33:41.479839] proposal_func .............. <function lm_proposal at 0x7ff02e7c3940>
[2022-05-10 20:33:41.479842] rnn_type ................... LSTM
[2022-05-10 20:33:41.479845] save_epochs ................ 1
[2022-05-10 20:33:41.479848] seed ....................... 42
[2022-05-10 20:33:41.479852] seq_len .................... 15
[2022-05-10 20:33:41.479855] shuffle .................... True
[2022-05-10 20:33:41.479858] store_intermediate_lbs ..... True
[2022-05-10 20:33:41.479863] sub_estimates .............. []
[2022-05-10 20:33:41.479867] text_dict .................. None
[2022-05-10 20:33:41.479870] top_k ...................... 0
[2022-05-10 20:33:41.479873] top_p ...................... 0
[2022-05-10 20:33:41.479876] total_seq_len .............. 20
[2022-05-10 20:33:41.479880] train_data_pct ............. 0.9
[2022-05-10 20:33:41.479884] train_epochs ............... 40
[2022-05-10 20:33:41.479889] val_data_pct ............... 0.01
[2022-05-10 20:33:41.479893] val_metrics ................ ['accuracy']
[2022-05-10 20:33:41.479897] valid_epochs ............... 1
[2022-05-10 20:33:41.479900] vocab_size ................. 98
[2022-05-10 20:33:41.479904] warmup_pct ................. 0.01
[2022-05-10 20:33:41.479908] weight_decay ............... 0.0
==================================================
Dataset: moocs | Sample type: ground_truth | Hist length 13 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: moocs | Sample type: ground_truth | Hist length 12 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................................................................
==================================================
