==================================================
* Running for dataset shakespeare
==================================================
[2022-05-23 16:03:01.043232] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-23 16:03:01.046185] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-23 16:03:01.047835] batch_size ................. 8192
[2022-05-23 16:03:01.047852] bs_ablation ................ False
[2022-05-23 16:03:01.047856] bs_ablation_max_beams ...... 10000
[2022-05-23 16:03:01.047859] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-23 16:03:01.047862] cuda ....................... True
[2022-05-23 16:03:01.047865] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-23 16:03:01.047868] dataset .................... shakespeare
[2022-05-23 16:03:01.047870] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 16:03:01.047873] device ..................... 7
[2022-05-23 16:03:01.047876] device_num ................. 0
[2022-05-23 16:03:01.047879] disable_tqdm ............... True
[2022-05-23 16:03:01.047882] do_test .................... False
[2022-05-23 16:03:01.047885] do_valid ................... True
[2022-05-23 16:03:01.047888] dont_print_args ............ True
[2022-05-23 16:03:01.047895] dont_shuffle ............... None
[2022-05-23 16:03:01.047901] dropout .................... 0.3
[2022-05-23 16:03:01.047907] estimate_type .............. <function beam_search_lower_bound at 0x7f29c4bf4d30>
[2022-05-23 16:03:01.047912] excluded_terms ............. [1]
[2022-05-23 16:03:01.047915] excluded_terms_list ........ [[]]
[2022-05-23 16:03:01.047917] finetune ................... False
[2022-05-23 16:03:01.047920] frequentist_test ........... False
[2022-05-23 16:03:01.047923] grad_clip .................. 1.0
[2022-05-23 16:03:01.047926] hidden_size ................ 128
[2022-05-23 16:03:01.047928] hist_len ................... 18
[2022-05-23 16:03:01.047931] hybrid_max_num_beams ....... 1500
[2022-05-23 16:03:01.047934] interp_func ................ <function lin_interp at 0x7f29c4bf4c10>
[2022-05-23 16:03:01.047937] log_interval ............... 100
[2022-05-23 16:03:01.047940] lr ......................... 0.001
[2022-05-23 16:03:01.047943] lr_decay_style ............. constant
[2022-05-23 16:03:01.047946] masked_lm .................. False
[2022-05-23 16:03:01.047949] max_k ...................... None
[2022-05-23 16:03:01.047951] max_num_mc_samples ......... 100000
[2022-05-23 16:03:01.047954] max_num_queries ............ 1000
[2022-05-23 16:03:01.047956] min_num_mc_samples ......... 10000
[2022-05-23 16:03:01.047959] min_phase_shift ............ 0
[2022-05-23 16:03:01.047962] min_var_reduction .......... 0.1
[2022-05-23 16:03:01.047965] min_variance ............... True
[2022-05-23 16:03:01.047967] model_budget_filepath ...... None
[2022-05-23 16:03:01.047970] needs_dl ................... True
[2022-05-23 16:03:01.047973] num_beams .................. 0.0
[2022-05-23 16:03:01.047976] num_layers ................. 2
[2022-05-23 16:03:01.047979] num_mc_samples ............. 100
[2022-05-23 16:03:01.047981] num_workers ................ 0
[2022-05-23 16:03:01.047984] optimizer .................. adam
[2022-05-23 16:03:01.047987] proposal_func .............. <function lm_proposal at 0x7f29c4be0c10>
[2022-05-23 16:03:01.047989] rnn_type ................... LSTM
[2022-05-23 16:03:01.047992] save_epochs ................ 1
[2022-05-23 16:03:01.047994] seed ....................... 42
[2022-05-23 16:03:01.047997] seq_len .................... 100
[2022-05-23 16:03:01.047999] shuffle .................... True
[2022-05-23 16:03:01.048002] store_intermediate_lbs ..... True
[2022-05-23 16:03:01.048005] sub_estimates .............. []
[2022-05-23 16:03:01.048008] tau_a_excl_terms ........... [18, 46]
[2022-05-23 16:03:01.048011] tau_b_excl_terms ........... [43, 48, 49, 52, 63, 15, 20, 21, 24, 35]
[2022-05-23 16:03:01.048014] terms_of_interest .......... []
[2022-05-23 16:03:01.048016] text_dict .................. None
[2022-05-23 16:03:01.048019] top_k ...................... 0
[2022-05-23 16:03:01.048021] top_p ...................... 0
[2022-05-23 16:03:01.048024] total_seq_len .............. 20
[2022-05-23 16:03:01.048027] train_data_pct ............. 0.9
[2022-05-23 16:03:01.048029] train_epochs ............... 40
[2022-05-23 16:03:01.048032] use_gpt2 ................... False
[2022-05-23 16:03:01.048034] val_data_pct ............... 0.05
[2022-05-23 16:03:01.048038] val_metrics ................ ['accuracy']
[2022-05-23 16:03:01.048040] valid_epochs ............... 1
[2022-05-23 16:03:01.048044] variance_epsilon ........... 5e-06
[2022-05-23 16:03:01.048047] vocab_size ................. 68
[2022-05-23 16:03:01.048050] warmup_pct ................. 0.01
[2022-05-23 16:03:01.048052] weight_decay ............... 0.0
==================================================
[2022-05-23 16:03:01.048441] | Dataset: shakespeare | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-23 16:12:31.312061] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-23 16:12:31.329446] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-23 16:12:31.592044] batch_size ................. 8192
[2022-05-23 16:12:31.592069] bs_ablation ................ False
[2022-05-23 16:12:31.592072] bs_ablation_max_beams ...... 10000
[2022-05-23 16:12:31.592075] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-23 16:12:31.592079] cuda ....................... True
[2022-05-23 16:12:31.592082] data_path .................. data/apps/lsapp.tsv
[2022-05-23 16:12:31.592084] dataset .................... apps
[2022-05-23 16:12:31.592087] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 16:12:31.592090] device ..................... 7
[2022-05-23 16:12:31.592093] device_num ................. 0
[2022-05-23 16:12:31.592096] disable_tqdm ............... True
[2022-05-23 16:12:31.592115] do_test .................... False
[2022-05-23 16:12:31.592118] do_valid ................... True
[2022-05-23 16:12:31.592120] dont_print_args ............ True
[2022-05-23 16:12:31.592124] dont_shuffle ............... None
[2022-05-23 16:12:31.592134] dropout .................... 0.3
[2022-05-23 16:12:31.592139] estimate_type .............. <function beam_search_lower_bound at 0x7f29c4bf4d30>
[2022-05-23 16:12:31.592144] excluded_terms ............. [1]
[2022-05-23 16:12:31.592147] excluded_terms_list ........ [[]]
[2022-05-23 16:12:31.592150] finetune ................... False
[2022-05-23 16:12:31.592153] frequentist_test ........... False
[2022-05-23 16:12:31.592156] grad_clip .................. 1.0
[2022-05-23 16:12:31.592159] hidden_size ................ 512
[2022-05-23 16:12:31.592162] hist_len ................... 18
[2022-05-23 16:12:31.592165] hybrid_max_num_beams ....... 1500
[2022-05-23 16:12:31.592168] interp_func ................ <function lin_interp at 0x7f29c4bf4c10>
[2022-05-23 16:12:31.592170] log_interval ............... 100
[2022-05-23 16:12:31.592174] lr ......................... 0.001
[2022-05-23 16:12:31.592180] lr_decay_style ............. constant
[2022-05-23 16:12:31.592183] masked_lm .................. False
[2022-05-23 16:12:31.592185] max_k ...................... None
[2022-05-23 16:12:31.592188] max_num_mc_samples ......... 100000
[2022-05-23 16:12:31.592191] max_num_queries ............ 1000
[2022-05-23 16:12:31.592193] min_num_mc_samples ......... 10000
[2022-05-23 16:12:31.592196] min_phase_shift ............ 0
[2022-05-23 16:12:31.592199] min_var_reduction .......... 0.1
[2022-05-23 16:12:31.592204] min_variance ............... True
[2022-05-23 16:12:31.592207] model_budget_filepath ...... None
[2022-05-23 16:12:31.592209] needs_dl ................... True
[2022-05-23 16:12:31.592212] needs_encoding ............. True
[2022-05-23 16:12:31.592215] num_beams .................. 0.0
[2022-05-23 16:12:31.592219] num_layers ................. 2
[2022-05-23 16:12:31.592221] num_mc_samples ............. 100
[2022-05-23 16:12:31.592224] num_workers ................ 0
[2022-05-23 16:12:31.592227] optimizer .................. adam
[2022-05-23 16:12:31.592230] proposal_func .............. <function lm_proposal at 0x7f29c4be0c10>
[2022-05-23 16:12:31.592232] rnn_type ................... LSTM
[2022-05-23 16:12:31.592235] save_epochs ................ 1
[2022-05-23 16:12:31.592238] seed ....................... 42
[2022-05-23 16:12:31.592240] seq_len .................... 15
[2022-05-23 16:12:31.592243] shuffle .................... True
[2022-05-23 16:12:31.592245] store_intermediate_lbs ..... True
[2022-05-23 16:12:31.592248] sub_estimates .............. []
[2022-05-23 16:12:31.592253] tau_a_excl_terms ........... [3, 14, 16, 23, 30, 39, 44, 40, 41, 51, 60, 73, 74, 79, 81, 82, 84]
[2022-05-23 16:12:31.592257] tau_b_excl_terms ........... [18, 19, 33, 34, 47, 78, 52, 55, 57, 67]
[2022-05-23 16:12:31.592260] terms_of_interest .......... []
[2022-05-23 16:12:31.592263] text_dict .................. None
[2022-05-23 16:12:31.592265] top_k ...................... 0
[2022-05-23 16:12:31.592268] top_p ...................... 0
[2022-05-23 16:12:31.592270] total_seq_len .............. 20
[2022-05-23 16:12:31.592273] train_data_pct ............. 0.9
[2022-05-23 16:12:31.592276] train_epochs ............... 40
[2022-05-23 16:12:31.592279] use_gpt2 ................... False
[2022-05-23 16:12:31.592281] val_data_pct ............... 0.001
[2022-05-23 16:12:31.592285] val_metrics ................ ['accuracy']
[2022-05-23 16:12:31.592288] valid_epochs ............... 1
[2022-05-23 16:12:31.592292] variance_epsilon ........... 5e-06
[2022-05-23 16:12:31.592295] vocab_size ................. 88
[2022-05-23 16:12:31.592298] warmup_pct ................. 0.01
[2022-05-23 16:12:31.592301] weight_decay ............... 0.0
==================================================
[2022-05-23 16:12:31.592603] | Dataset: apps | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-23 16:36:22.859113] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-23 16:36:22.862406] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-23 16:36:22.911188] batch_size ................. 8192
[2022-05-23 16:36:22.911205] bs_ablation ................ False
[2022-05-23 16:36:22.911210] bs_ablation_max_beams ...... 10000
[2022-05-23 16:36:22.911213] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-23 16:36:22.911218] cuda ....................... True
[2022-05-23 16:36:22.911221] data_path .................. data/moocs/mooc.csv
[2022-05-23 16:36:22.911225] dataset .................... moocs
[2022-05-23 16:36:22.911228] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 16:36:22.911233] device ..................... 7
[2022-05-23 16:36:22.911236] device_num ................. 0
[2022-05-23 16:36:22.911240] disable_tqdm ............... True
[2022-05-23 16:36:22.911244] do_test .................... False
[2022-05-23 16:36:22.911247] do_valid ................... True
[2022-05-23 16:36:22.911251] dont_print_args ............ True
[2022-05-23 16:36:22.911255] dont_shuffle ............... None
[2022-05-23 16:36:22.911274] dropout .................... 0.3
[2022-05-23 16:36:22.911280] estimate_type .............. <function beam_search_lower_bound at 0x7f29c4bf4d30>
[2022-05-23 16:36:22.911287] excluded_terms ............. [1]
[2022-05-23 16:36:22.911291] excluded_terms_list ........ [[]]
[2022-05-23 16:36:22.911295] finetune ................... False
[2022-05-23 16:36:22.911299] frequentist_test ........... False
[2022-05-23 16:36:22.911303] grad_clip .................. 1.0
[2022-05-23 16:36:22.911307] hidden_size ................ 128
[2022-05-23 16:36:22.911313] hist_len ................... 18
[2022-05-23 16:36:22.911317] hybrid_max_num_beams ....... 1500
[2022-05-23 16:36:22.911321] interp_func ................ <function lin_interp at 0x7f29c4bf4c10>
[2022-05-23 16:36:22.911324] log_interval ............... 100
[2022-05-23 16:36:22.911329] lr ......................... 0.001
[2022-05-23 16:36:22.911333] lr_decay_style ............. constant
[2022-05-23 16:36:22.911337] masked_lm .................. False
[2022-05-23 16:36:22.911340] max_k ...................... None
[2022-05-23 16:36:22.911344] max_num_mc_samples ......... 100000
[2022-05-23 16:36:22.911347] max_num_queries ............ 1000
[2022-05-23 16:36:22.911351] min_num_mc_samples ......... 10000
[2022-05-23 16:36:22.911354] min_phase_shift ............ 0
[2022-05-23 16:36:22.911358] min_var_reduction .......... 0.1
[2022-05-23 16:36:22.911377] min_variance ............... True
[2022-05-23 16:36:22.911381] model_budget_filepath ...... None
[2022-05-23 16:36:22.911385] needs_dl ................... True
[2022-05-23 16:36:22.911388] needs_encoding ............. False
[2022-05-23 16:36:22.911392] num_beams .................. 0.0
[2022-05-23 16:36:22.911397] num_layers ................. 2
[2022-05-23 16:36:22.911400] num_mc_samples ............. 100
[2022-05-23 16:36:22.911403] num_workers ................ 0
[2022-05-23 16:36:22.911407] optimizer .................. adam
[2022-05-23 16:36:22.911411] proposal_func .............. <function lm_proposal at 0x7f29c4be0c10>
[2022-05-23 16:36:22.911414] rnn_type ................... LSTM
[2022-05-23 16:36:22.911417] save_epochs ................ 1
[2022-05-23 16:36:22.911421] seed ....................... 42
[2022-05-23 16:36:22.911424] seq_len .................... 15
[2022-05-23 16:36:22.911428] shuffle .................... True
[2022-05-23 16:36:22.911431] store_intermediate_lbs ..... True
[2022-05-23 16:36:22.911435] sub_estimates .............. []
[2022-05-23 16:36:22.911439] tau_a_excl_terms ........... [13, 8, 21, 7]
[2022-05-23 16:36:22.911444] tau_b_excl_terms ........... [51, 33, 16, 27, 15, 24, 53]
[2022-05-23 16:36:22.911447] terms_of_interest .......... []
[2022-05-23 16:36:22.911451] text_dict .................. None
[2022-05-23 16:36:22.911455] top_k ...................... 0
[2022-05-23 16:36:22.911458] top_p ...................... 0
[2022-05-23 16:36:22.911461] total_seq_len .............. 20
[2022-05-23 16:36:22.911465] train_data_pct ............. 0.9
[2022-05-23 16:36:22.911469] train_epochs ............... 40
[2022-05-23 16:36:22.911472] use_gpt2 ................... False
[2022-05-23 16:36:22.911476] val_data_pct ............... 0.01
[2022-05-23 16:36:22.911480] val_metrics ................ ['accuracy']
[2022-05-23 16:36:22.911484] valid_epochs ............... 1
[2022-05-23 16:36:22.911489] variance_epsilon ........... 5e-06
[2022-05-23 16:36:22.911493] vocab_size ................. 98
[2022-05-23 16:36:22.911497] warmup_pct ................. 0.01
[2022-05-23 16:36:22.911500] weight_decay ............... 0.0
==================================================
[2022-05-23 16:36:22.912157] | Dataset: moocs | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-23 16:46:52.390939] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-23 16:46:52.402081] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-23 16:46:52.563780] batch_size ................. 8192
[2022-05-23 16:46:52.563812] bs_ablation ................ False
[2022-05-23 16:46:52.563815] bs_ablation_max_beams ...... 10000
[2022-05-23 16:46:52.563818] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-23 16:46:52.563822] cuda ....................... True
[2022-05-23 16:46:52.563825] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-23 16:46:52.563828] dataset .................... amazon
[2022-05-23 16:46:52.563830] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 16:46:52.563836] device ..................... 7
[2022-05-23 16:46:52.563838] device_num ................. 0
[2022-05-23 16:46:52.563841] disable_tqdm ............... True
[2022-05-23 16:46:52.563844] do_test .................... False
[2022-05-23 16:46:52.563847] do_valid ................... True
[2022-05-23 16:46:52.563849] dont_print_args ............ True
[2022-05-23 16:46:52.563853] dont_shuffle ............... None
[2022-05-23 16:46:52.563882] dropout .................... 0.3
[2022-05-23 16:46:52.563887] estimate_type .............. <function beam_search_lower_bound at 0x7f29c4bf4d30>
[2022-05-23 16:46:52.563891] excluded_terms ............. [1]
[2022-05-23 16:46:52.563895] excluded_terms_list ........ [[]]
[2022-05-23 16:46:52.563898] finetune ................... False
[2022-05-23 16:46:52.563901] frequentist_test ........... False
[2022-05-23 16:46:52.563904] grad_clip .................. 1.0
[2022-05-23 16:46:52.563907] hidden_size ................ 512
[2022-05-23 16:46:52.563916] hist_len ................... 18
[2022-05-23 16:46:52.563919] hybrid_max_num_beams ....... 1500
[2022-05-23 16:46:52.563922] interp_func ................ <function lin_interp at 0x7f29c4bf4c10>
[2022-05-23 16:46:52.563925] log_interval ............... 100
[2022-05-23 16:46:52.563928] lr ......................... 0.001
[2022-05-23 16:46:52.563931] lr_decay_style ............. constant
[2022-05-23 16:46:52.563935] masked_lm .................. False
[2022-05-23 16:46:52.563937] max_k ...................... None
[2022-05-23 16:46:52.563940] max_num_mc_samples ......... 100000
[2022-05-23 16:46:52.563942] max_num_queries ............ 1000
[2022-05-23 16:46:52.563945] min_num_mc_samples ......... 10000
[2022-05-23 16:46:52.563948] min_phase_shift ............ 0
[2022-05-23 16:46:52.563951] min_var_reduction .......... 0.1
[2022-05-23 16:46:52.563954] min_variance ............... True
[2022-05-23 16:46:52.563956] model_budget_filepath ...... None
[2022-05-23 16:46:52.563959] needs_dl ................... True
[2022-05-23 16:46:52.563963] num_beams .................. 0.0
[2022-05-23 16:46:52.563965] num_layers ................. 2
[2022-05-23 16:46:52.563968] num_mc_samples ............. 100
[2022-05-23 16:46:52.563971] num_workers ................ 0
[2022-05-23 16:46:52.563973] optimizer .................. adam
[2022-05-23 16:46:52.563976] proposal_func .............. <function lm_proposal at 0x7f29c4be0c10>
[2022-05-23 16:46:52.563979] rnn_type ................... LSTM
[2022-05-23 16:46:52.563981] save_epochs ................ 1
[2022-05-23 16:46:52.563984] seed ....................... 42
[2022-05-23 16:46:52.563987] seq_len .................... 15
[2022-05-23 16:46:52.563990] shuffle .................... True
[2022-05-23 16:46:52.563992] store_intermediate_lbs ..... True
[2022-05-23 16:46:52.563995] sub_estimates .............. []
[2022-05-23 16:46:52.563998] tau_a_excl_terms ........... [2, 3, 9, 10]
[2022-05-23 16:46:52.564001] tau_b_excl_terms ........... [17, 19, 25, 28]
[2022-05-23 16:46:52.564004] terms_of_interest .......... []
[2022-05-23 16:46:52.564007] text_dict .................. None
[2022-05-23 16:46:52.564009] top_k ...................... 0
[2022-05-23 16:46:52.564012] top_p ...................... 0
[2022-05-23 16:46:52.564014] total_seq_len .............. 20
[2022-05-23 16:46:52.564017] train_data_pct ............. 0.9
[2022-05-23 16:46:52.564020] train_epochs ............... 40
[2022-05-23 16:46:52.564022] use_gpt2 ................... False
[2022-05-23 16:46:52.564025] val_data_pct ............... 0.0001
[2022-05-23 16:46:52.564029] val_metrics ................ ['accuracy']
[2022-05-23 16:46:52.564031] valid_epochs ............... 1
[2022-05-23 16:46:52.564036] variance_epsilon ........... 5e-06
[2022-05-23 16:46:52.564039] vocab_size ................. 30
[2022-05-23 16:46:52.564042] warmup_pct ................. 0.01
[2022-05-23 16:46:52.564045] weight_decay ............... 0.0
==================================================
[2022-05-23 16:46:52.564232] | Dataset: amazon | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
