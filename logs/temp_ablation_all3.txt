==================================================
* Running for dataset shakespeare
==================================================
[2022-05-15 13:30:38.107079] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-15 13:30:38.119506] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-15 13:30:38.122801] batch_size ................. 4096
[2022-05-15 13:30:38.122822] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-15 13:30:38.122831] cuda ....................... True
[2022-05-15 13:30:38.122837] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-15 13:30:38.122843] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 13:30:38.122849] device ..................... 6
[2022-05-15 13:30:38.122855] device_num ................. 0
[2022-05-15 13:30:38.122861] disable_tqdm ............... True
[2022-05-15 13:30:38.122867] do_test .................... False
[2022-05-15 13:30:38.122873] do_valid ................... True
[2022-05-15 13:30:38.122878] dont_print_args ............ True
[2022-05-15 13:30:38.122885] dont_shuffle ............... None
[2022-05-15 13:30:38.122898] dropout .................... 0.3
[2022-05-15 13:30:38.122907] estimate_type .............. <function beam_search_lower_bound at 0x7f89896cd0d0>
[2022-05-15 13:30:38.122916] excluded_terms ............. [1]
[2022-05-15 13:30:38.122923] finetune ................... False
[2022-05-15 13:30:38.122930] grad_clip .................. 1.0
[2022-05-15 13:30:38.122935] hidden_size ................ 128
[2022-05-15 13:30:38.122940] hist_len ................... 18
[2022-05-15 13:30:38.122946] hybrid_max_num_beams ....... 1500
[2022-05-15 13:30:38.122952] interp_func ................ <function lin_interp at 0x7f89896c9f70>
[2022-05-15 13:30:38.122958] log_interval ............... 100
[2022-05-15 13:30:38.122965] lr ......................... 0.001
[2022-05-15 13:30:38.122970] lr_decay_style ............. constant
[2022-05-15 13:30:38.122976] masked_lm .................. False
[2022-05-15 13:30:38.122982] max_num_mc_samples ......... 100000
[2022-05-15 13:30:38.122987] max_num_queries ............ 1000
[2022-05-15 13:30:38.122993] min_num_mc_samples ......... 10000
[2022-05-15 13:30:38.122998] min_phase_shift ............ 0
[2022-05-15 13:30:38.123004] min_var_reduction .......... 0.1
[2022-05-15 13:30:38.123010] min_variance ............... True
[2022-05-15 13:30:38.123015] model_budget_filepath ...... None
[2022-05-15 13:30:38.123021] num_beams .................. 0.0
[2022-05-15 13:30:38.123027] num_layers ................. 2
[2022-05-15 13:30:38.123032] num_mc_samples ............. 100
[2022-05-15 13:30:38.123037] num_workers ................ 0
[2022-05-15 13:30:38.123043] optimizer .................. adam
[2022-05-15 13:30:38.123049] proposal_func .............. <function lm_proposal at 0x7f89896b8f70>
[2022-05-15 13:30:38.123055] rnn_type ................... LSTM
[2022-05-15 13:30:38.123060] save_epochs ................ 1
[2022-05-15 13:30:38.123065] seed ....................... 42
[2022-05-15 13:30:38.123071] seq_len .................... 100
[2022-05-15 13:30:38.123077] shuffle .................... True
[2022-05-15 13:30:38.123083] store_intermediate_lbs ..... True
[2022-05-15 13:30:38.123088] sub_estimates .............. []
[2022-05-15 13:30:38.123094] terms_of_interest .......... []
[2022-05-15 13:30:38.123100] text_dict .................. None
[2022-05-15 13:30:38.123105] top_k ...................... 0
[2022-05-15 13:30:38.123111] top_p ...................... 0
[2022-05-15 13:30:38.123116] total_seq_len .............. 20
[2022-05-15 13:30:38.123122] train_data_pct ............. 0.9
[2022-05-15 13:30:38.123127] train_epochs ............... 40
[2022-05-15 13:30:38.123133] use_gpt2 ................... False
[2022-05-15 13:30:38.123139] val_data_pct ............... 0.05
[2022-05-15 13:30:38.123145] val_metrics ................ ['accuracy']
[2022-05-15 13:30:38.123151] valid_epochs ............... 1
[2022-05-15 13:30:38.123159] variance_epsilon ........... 5e-06
[2022-05-15 13:30:38.123165] vocab_size ................. 68
[2022-05-15 13:30:38.123171] warmup_pct ................. 0.01
[2022-05-15 13:30:38.123176] weight_decay ............... 0.0
==================================================
[2022-05-15 13:30:38.126064] | Dataset: shakespeare | Temperature: 0.01 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 13:31:49.527001] | Dataset: shakespeare | Temperature: 0.01 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-15 13:37:13.925894] | Dataset: shakespeare | Temperature 0.01 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-15 13:38:13.666948] | Dataset: shakespeare | Temperature: 0.1 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 13:39:21.901053] | Dataset: shakespeare | Temperature: 0.1 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-15 13:47:09.598916] | Dataset: shakespeare | Temperature 0.1 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-15 13:48:58.435991] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-15 13:48:58.532414] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-15 13:48:59.319824] batch_size ................. 4096
[2022-05-15 13:48:59.319856] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-15 13:48:59.319868] cuda ....................... True
[2022-05-15 13:48:59.319876] data_path .................. data/apps/lsapp.tsv
[2022-05-15 13:48:59.319883] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 13:48:59.319892] device ..................... 6
[2022-05-15 13:48:59.319900] device_num ................. 0
[2022-05-15 13:48:59.319907] disable_tqdm ............... True
[2022-05-15 13:48:59.319916] do_test .................... False
[2022-05-15 13:48:59.319923] do_valid ................... True
[2022-05-15 13:48:59.319931] dont_print_args ............ True
[2022-05-15 13:48:59.319940] dont_shuffle ............... None
[2022-05-15 13:48:59.319953] dropout .................... 0.3
[2022-05-15 13:48:59.319964] estimate_type .............. <function beam_search_lower_bound at 0x7f89896cd0d0>
[2022-05-15 13:48:59.319975] excluded_terms ............. [1]
[2022-05-15 13:48:59.319997] finetune ................... False
[2022-05-15 13:48:59.320005] grad_clip .................. 1.0
[2022-05-15 13:48:59.320013] hidden_size ................ 512
[2022-05-15 13:48:59.320020] hist_len ................... 18
[2022-05-15 13:48:59.320029] hybrid_max_num_beams ....... 1500
[2022-05-15 13:48:59.320038] interp_func ................ <function lin_interp at 0x7f89896c9f70>
[2022-05-15 13:48:59.320045] log_interval ............... 100
[2022-05-15 13:48:59.320054] lr ......................... 0.001
[2022-05-15 13:48:59.320065] lr_decay_style ............. constant
[2022-05-15 13:48:59.320073] masked_lm .................. False
[2022-05-15 13:48:59.320080] max_num_mc_samples ......... 100000
[2022-05-15 13:48:59.320087] max_num_queries ............ 1000
[2022-05-15 13:48:59.320095] min_num_mc_samples ......... 10000
[2022-05-15 13:48:59.320102] min_phase_shift ............ 0
[2022-05-15 13:48:59.320111] min_var_reduction .......... 0.1
[2022-05-15 13:48:59.320119] min_variance ............... True
[2022-05-15 13:48:59.320126] model_budget_filepath ...... None
[2022-05-15 13:48:59.320134] needs_encoding ............. True
[2022-05-15 13:48:59.320142] num_beams .................. 0.0
[2022-05-15 13:48:59.320151] num_layers ................. 2
[2022-05-15 13:48:59.320159] num_mc_samples ............. 100
[2022-05-15 13:48:59.320166] num_workers ................ 0
[2022-05-15 13:48:59.320173] optimizer .................. adam
[2022-05-15 13:48:59.320182] proposal_func .............. <function lm_proposal at 0x7f89896b8f70>
[2022-05-15 13:48:59.320189] rnn_type ................... LSTM
[2022-05-15 13:48:59.320196] save_epochs ................ 1
[2022-05-15 13:48:59.320205] seed ....................... 42
[2022-05-15 13:48:59.320212] seq_len .................... 15
[2022-05-15 13:48:59.320229] shuffle .................... True
[2022-05-15 13:48:59.320235] store_intermediate_lbs ..... True
[2022-05-15 13:48:59.320241] sub_estimates .............. []
[2022-05-15 13:48:59.320246] terms_of_interest .......... []
[2022-05-15 13:48:59.320252] text_dict .................. None
[2022-05-15 13:48:59.320258] top_k ...................... 0
[2022-05-15 13:48:59.320264] top_p ...................... 0
[2022-05-15 13:48:59.320270] total_seq_len .............. 20
[2022-05-15 13:48:59.320276] train_data_pct ............. 0.9
[2022-05-15 13:48:59.320281] train_epochs ............... 40
[2022-05-15 13:48:59.320287] use_gpt2 ................... False
[2022-05-15 13:48:59.320293] val_data_pct ............... 0.001
[2022-05-15 13:48:59.320301] val_metrics ................ ['accuracy']
[2022-05-15 13:48:59.320307] valid_epochs ............... 1
[2022-05-15 13:48:59.320315] variance_epsilon ........... 5e-06
[2022-05-15 13:48:59.320321] vocab_size ................. 88
[2022-05-15 13:48:59.320327] warmup_pct ................. 0.01
[2022-05-15 13:48:59.320333] weight_decay ............... 0.0
==================================================
[2022-05-15 13:48:59.321717] | Dataset: apps | Temperature: 0.01 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 13:50:45.212617] | Dataset: apps | Temperature: 0.01 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:02:29.736375] | Dataset: apps | Temperature 0.01 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 14:04:14.546395] | Dataset: apps | Temperature: 0.1 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:06:31.911109] | Dataset: apps | Temperature: 0.1 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:19:39.755253] | Dataset: apps | Temperature 0.1 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

...........