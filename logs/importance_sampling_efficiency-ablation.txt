==================================================
* Running for dataset shakespeare
==================================================
[2022-09-29 14:50:48.333302] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-09-29 14:50:48.337425] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-09-29 14:50:48.339759] batch_size ................. 8192
[2022-09-29 14:50:48.339787] bs_ablation ................ False
[2022-09-29 14:50:48.339792] bs_ablation_max_beams ...... 10000
[2022-09-29 14:50:48.339797] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-09-29 14:50:48.339801] cuda ....................... True
[2022-09-29 14:50:48.339805] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-09-29 14:50:48.339809] dataset .................... shakespeare
[2022-09-29 14:50:48.339812] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-09-29 14:50:48.339816] device ..................... 4
[2022-09-29 14:50:48.339820] device_num ................. 0
[2022-09-29 14:50:48.339823] disable_tqdm ............... True
[2022-09-29 14:50:48.339827] do_test .................... False
[2022-09-29 14:50:48.339831] do_valid ................... True
[2022-09-29 14:50:48.339835] dont_print_args ............ True
[2022-09-29 14:50:48.339843] dont_shuffle ............... None
[2022-09-29 14:50:48.339854] dropout .................... 0.3
[2022-09-29 14:50:48.339860] estimate_type .............. <function mc_estimate at 0x7f73cb4318b0>
[2022-09-29 14:50:48.339867] excluded_terms ............. [1]
[2022-09-29 14:50:48.339872] excluded_terms_list ........ [[]]
[2022-09-29 14:50:48.339876] finetune ................... False
[2022-09-29 14:50:48.339879] frequentist_test ........... False
[2022-09-29 14:50:48.339884] grad_clip .................. 1.0
[2022-09-29 14:50:48.339887] hidden_size ................ 128
[2022-09-29 14:50:48.339891] hist_len ................... 18
[2022-09-29 14:50:48.339894] hybrid_max_num_beams ....... 1500
[2022-09-29 14:50:48.339900] intermediate_seqs .......... [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
[2022-09-29 14:50:48.339906] interp_func ................ <function lin_interp at 0x7f73cb431d30>
[2022-09-29 14:50:48.339909] log_interval ............... 100
[2022-09-29 14:50:48.339914] lr ......................... 0.001
[2022-09-29 14:50:48.339918] lr_decay_style ............. constant
[2022-09-29 14:50:48.339922] masked_lm .................. False
[2022-09-29 14:50:48.339925] max_k ...................... None
[2022-09-29 14:50:48.339929] max_num_mc_samples ......... 100000
[2022-09-29 14:50:48.339933] max_num_queries ............ 1000
[2022-09-29 14:50:48.339936] min_num_mc_samples ......... 10000
[2022-09-29 14:50:48.339939] min_phase_shift ............ 0
[2022-09-29 14:50:48.339944] min_var_reduction .......... 0.1
[2022-09-29 14:50:48.339947] min_variance ............... False
[2022-09-29 14:50:48.339951] model_budget_filepath ...... None
[2022-09-29 14:50:48.339954] needs_dl ................... True
[2022-09-29 14:50:48.339958] num_beams .................. 0.0
[2022-09-29 14:50:48.339962] num_layers ................. 2
[2022-09-29 14:50:48.339965] num_mc_samples ............. 100
[2022-09-29 14:50:48.339969] num_workers ................ 0
[2022-09-29 14:50:48.339972] optimizer .................. adam
[2022-09-29 14:50:48.339976] proposal_func .............. <function lm_proposal at 0x7f73cb41ed30>
[2022-09-29 14:50:48.339980] query_2 .................... False
[2022-09-29 14:50:48.339983] rnn_type ................... LSTM
[2022-09-29 14:50:48.339986] save_epochs ................ 1
[2022-09-29 14:50:48.339990] seed ....................... 42
[2022-09-29 14:50:48.339993] seq_len .................... 100
[2022-09-29 14:50:48.339996] shuffle .................... True
[2022-09-29 14:50:48.340000] store_intermediate_lbs ..... True
[2022-09-29 14:50:48.340010] sub_estimates .............. [10, 30, 50]
[2022-09-29 14:50:48.340014] tau_a_excl_terms ........... [18, 46]
[2022-09-29 14:50:48.340019] tau_b_excl_terms ........... [43, 48, 49, 52, 63, 15, 20, 21, 24, 35]
[2022-09-29 14:50:48.340023] terms_of_interest .......... []
[2022-09-29 14:50:48.340027] text_dict .................. None
[2022-09-29 14:50:48.340030] top_k ...................... 0
[2022-09-29 14:50:48.340034] top_p ...................... 0
[2022-09-29 14:50:48.340037] total_seq_len .............. 20
[2022-09-29 14:50:48.340041] train_data_pct ............. 0.9
[2022-09-29 14:50:48.340045] train_epochs ............... 40
[2022-09-29 14:50:48.340048] use_gpt2 ................... False
[2022-09-29 14:50:48.340052] val_data_pct ............... 0.05
[2022-09-29 14:50:48.340061] val_metrics ................ ['accuracy']
[2022-09-29 14:50:48.340065] valid_epochs ............... 1
[2022-09-29 14:50:48.340071] variance_epsilon ........... 5e-06
[2022-09-29 14:50:48.340075] vocab_size ................. 68
[2022-09-29 14:50:48.340078] warmup_pct ................. 0.01
[2022-09-29 14:50:48.340082] weight_decay ............... 0.0
==================================================
[2022-09-29 14:50:48.340651] | Dataset: shakespeare | Sample type: efficiency_ablation | Num samples: None | Hist length 5 | Total Seq Length 21 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-09-29 14:58:48.119851] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-09-29 14:58:48.178614] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-09-29 14:58:48.494243] batch_size ................. 8192
[2022-09-29 14:58:48.494276] bs_ablation ................ False
[2022-09-29 14:58:48.494281] bs_ablation_max_beams ...... 10000
[2022-09-29 14:58:48.494285] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-09-29 14:58:48.494289] cuda ....................... True
[2022-09-29 14:58:48.494293] data_path .................. data/apps/lsapp.tsv
[2022-09-29 14:58:48.494297] dataset .................... apps
[2022-09-29 14:58:48.494301] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-09-29 14:58:48.494305] device ..................... 4
[2022-09-29 14:58:48.494309] device_num ................. 0
[2022-09-29 14:58:48.494313] disable_tqdm ............... True
[2022-09-29 14:58:48.494317] do_test .................... False
[2022-09-29 14:58:48.494321] do_valid ................... True
[2022-09-29 14:58:48.494324] dont_print_args ............ True
[2022-09-29 14:58:48.494329] dont_shuffle ............... None
[2022-09-29 14:58:48.494351] dropout .................... 0.3
[2022-09-29 14:58:48.494358] estimate_type .............. <function mc_estimate at 0x7f73cb4318b0>
[2022-09-29 14:58:48.494363] excluded_terms ............. [1]
[2022-09-29 14:58:48.494368] excluded_terms_list ........ [[]]
[2022-09-29 14:58:48.494373] finetune ................... False
[2022-09-29 14:58:48.494377] frequentist_test ........... False
[2022-09-29 14:58:48.494381] grad_clip .................. 1.0
[2022-09-29 14:58:48.494385] hidden_size ................ 512
[2022-09-29 14:58:48.494388] hist_len ................... 18
[2022-09-29 14:58:48.494392] hybrid_max_num_beams ....... 1500
[2022-09-29 14:58:48.494398] intermediate_seqs .......... [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
[2022-09-29 14:58:48.494402] interp_func ................ <function lin_interp at 0x7f73cb431d30>
[2022-09-29 14:58:48.494406] log_interval ............... 100
[2022-09-29 14:58:48.494412] lr ......................... 0.001
[2022-09-29 14:58:48.494416] lr_decay_style ............. constant
[2022-09-29 14:58:48.494420] masked_lm .................. False
[2022-09-29 14:58:48.494423] max_k ...................... None
[2022-09-29 14:58:48.494427] max_num_mc_samples ......... 100000
[2022-09-29 14:58:48.494430] max_num_queries ............ 1000
[2022-09-29 14:58:48.494434] min_num_mc_samples ......... 10000
[2022-09-29 14:58:48.494437] min_phase_shift ............ 0
[2022-09-29 14:58:48.494441] min_var_reduction .......... 0.1
[2022-09-29 14:58:48.494445] min_variance ............... False
[2022-09-29 14:58:48.494451] model_budget_filepath ...... None
[2022-09-29 14:58:48.494455] needs_dl ................... True
[2022-09-29 14:58:48.494459] needs_encoding ............. True
[2022-09-29 14:58:48.494463] num_beams .................. 0.0
[2022-09-29 14:58:48.494466] num_layers ................. 2
[2022-09-29 14:58:48.494469] num_mc_samples ............. 100
[2022-09-29 14:58:48.494473] num_workers ................ 0
[2022-09-29 14:58:48.494476] optimizer .................. adam
[2022-09-29 14:58:48.494480] proposal_func .............. <function lm_proposal at 0x7f73cb41ed30>
[2022-09-29 14:58:48.494484] query_2 .................... False
[2022-09-29 14:58:48.494488] rnn_type ................... LSTM
[2022-09-29 14:58:48.494491] save_epochs ................ 1
[2022-09-29 14:58:48.494494] seed ....................... 42
[2022-09-29 14:58:48.494498] seq_len .................... 15
[2022-09-29 14:58:48.494501] shuffle .................... True
[2022-09-29 14:58:48.494505] store_intermediate_lbs ..... True
[2022-09-29 14:58:48.494509] sub_estimates .............. [10, 30, 50]
[2022-09-29 14:58:48.494514] tau_a_excl_terms ........... [3, 14, 16, 23, 30, 39, 44, 40, 41, 51, 60, 73, 74, 79, 81, 82, 84]
[2022-09-29 14:58:48.494520] tau_b_excl_terms ........... [18, 19, 33, 34, 47, 78, 52, 55, 57, 67]
[2022-09-29 14:58:48.494524] terms_of_interest .......... []
[2022-09-29 14:58:48.494528] text_dict .................. None
[2022-09-29 14:58:48.494531] top_k ...................... 0
[2022-09-29 14:58:48.494534] top_p ...................... 0
[2022-09-29 14:58:48.494538] total_seq_len .............. 20
[2022-09-29 14:58:48.494542] train_data_pct ............. 0.9
[2022-09-29 14:58:48.494545] train_epochs ............... 40
[2022-09-29 14:58:48.494549] use_gpt2 ................... False
[2022-09-29 14:58:48.494554] val_data_pct ............... 0.001
[2022-09-29 14:58:48.494558] val_metrics ................ ['accuracy']
[2022-09-29 14:58:48.494562] valid_epochs ............... 1
[2022-09-29 14:58:48.494568] variance_epsilon ........... 5e-06
[2022-09-29 14:58:48.494571] vocab_size ................. 88
[2022-09-29 14:58:48.494576] warmup_pct ................. 0.01
[2022-09-29 14:58:48.494579] weight_decay ............... 0.0
==================================================
[2022-09-29 14:58:48.494987] | Dataset: apps | Sample type: efficiency_ablation | Num samples: None | Hist length 5 | Total Seq Length 21 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-09-29 15:23:21.349934] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-09-29 15:23:21.359786] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-09-29 15:23:21.431048] batch_size ................. 8192
[2022-09-29 15:23:21.431090] bs_ablation ................ False
[2022-09-29 15:23:21.431097] bs_ablation_max_beams ...... 10000
[2022-09-29 15:23:21.431103] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-09-29 15:23:21.431110] cuda ....................... True
[2022-09-29 15:23:21.431116] data_path .................. data/moocs/mooc.csv
[2022-09-29 15:23:21.431122] dataset .................... moocs
[2022-09-29 15:23:21.431127] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-09-29 15:23:21.431134] device ..................... 4
[2022-09-29 15:23:21.431139] device_num ................. 0
[2022-09-29 15:23:21.431145] disable_tqdm ............... True
[2022-09-29 15:23:21.431151] do_test .................... False
[2022-09-29 15:23:21.431157] do_valid ................... True
[2022-09-29 15:23:21.431162] dont_print_args ............ True
[2022-09-29 15:23:21.431169] dont_shuffle ............... None
[2022-09-29 15:23:21.431196] dropout .................... 0.3
[2022-09-29 15:23:21.431205] estimate_type .............. <function mc_estimate at 0x7f73cb4318b0>
[2022-09-29 15:23:21.431213] excluded_terms ............. [1]
[2022-09-29 15:23:21.431220] excluded_terms_list ........ [[]]
[2022-09-29 15:23:21.431226] finetune ................... False
[2022-09-29 15:23:21.431232] frequentist_test ........... False
[2022-09-29 15:23:21.431239] grad_clip .................. 1.0
[2022-09-29 15:23:21.431244] hidden_size ................ 128
[2022-09-29 15:23:21.431250] hist_len ................... 18
[2022-09-29 15:23:21.431256] hybrid_max_num_beams ....... 1500
[2022-09-29 15:23:21.431264] intermediate_seqs .......... [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
[2022-09-29 15:23:21.431274] interp_func ................ <function lin_interp at 0x7f73cb431d30>
[2022-09-29 15:23:21.431279] log_interval ............... 100
[2022-09-29 15:23:21.431288] lr ......................... 0.001
[2022-09-29 15:23:21.431293] lr_decay_style ............. constant
[2022-09-29 15:23:21.431299] masked_lm .................. False
[2022-09-29 15:23:21.431305] max_k ...................... None
[2022-09-29 15:23:21.431311] max_num_mc_samples ......... 100000
[2022-09-29 15:23:21.431316] max_num_queries ............ 1000
[2022-09-29 15:23:21.431322] min_num_mc_samples ......... 10000
[2022-09-29 15:23:21.431328] min_phase_shift ............ 0
[2022-09-29 15:23:21.431334] min_var_reduction .......... 0.1
[2022-09-29 15:23:21.431340] min_variance ............... False
[2022-09-29 15:23:21.431347] model_budget_filepath ...... None
[2022-09-29 15:23:21.431353] needs_dl ................... True
[2022-09-29 15:23:21.431358] needs_encoding ............. False
[2022-09-29 15:23:21.431366] num_beams .................. 0.0
[2022-09-29 15:23:21.431371] num_layers ................. 2
[2022-09-29 15:23:21.431376] num_mc_samples ............. 100
[2022-09-29 15:23:21.431382] num_workers ................ 0
[2022-09-29 15:23:21.431388] optimizer .................. adam
[2022-09-29 15:23:21.431394] proposal_func .............. <function lm_proposal at 0x7f73cb41ed30>
[2022-09-29 15:23:21.431399] query_2 .................... False
[2022-09-29 15:23:21.431406] rnn_type ................... LSTM
[2022-09-29 15:23:21.431411] save_epochs ................ 1
[2022-09-29 15:23:21.431417] seed ....................... 42
[2022-09-29 15:23:21.431422] seq_len .................... 15
[2022-09-29 15:23:21.431427] shuffle .................... True
[2022-09-29 15:23:21.431433] store_intermediate_lbs ..... True
[2022-09-29 15:23:21.431440] sub_estimates .............. [10, 30, 50]
[2022-09-29 15:23:21.431447] tau_a_excl_terms ........... [13, 8, 21, 7]
[2022-09-29 15:23:21.431455] tau_b_excl_terms ........... [51, 33, 16, 27, 15, 24, 53]
[2022-09-29 15:23:21.431461] terms_of_interest .......... []
[2022-09-29 15:23:21.431466] text_dict .................. None
[2022-09-29 15:23:21.431472] top_k ...................... 0
[2022-09-29 15:23:21.431477] top_p ...................... 0
[2022-09-29 15:23:21.431483] total_seq_len .............. 20
[2022-09-29 15:23:21.431489] train_data_pct ............. 0.9
[2022-09-29 15:23:21.431494] train_epochs ............... 40
[2022-09-29 15:23:21.431500] use_gpt2 ................... False
[2022-09-29 15:23:21.431507] val_data_pct ............... 0.01
[2022-09-29 15:23:21.431513] val_metrics ................ ['accuracy']
[2022-09-29 15:23:21.431519] valid_epochs ............... 1
[2022-09-29 15:23:21.431527] variance_epsilon ........... 5e-06
[2022-09-29 15:23:21.431533] vocab_size ................. 98
[2022-09-29 15:23:21.431539] warmup_pct ................. 0.01
[2022-09-29 15:23:21.431545] weight_decay ............... 0.0
==================================================
[2022-09-29 15:23:21.432452] | Dataset: moocs | Sample type: efficiency_ablation | Num samples: None | Hist length 5 | Total Seq Length 21 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-09-29 15:32:36.392756] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-09-29 15:32:36.506935] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-09-29 15:32:36.621276] batch_size ................. 8192
[2022-09-29 15:32:36.621306] bs_ablation ................ False
[2022-09-29 15:32:36.621310] bs_ablation_max_beams ...... 10000
[2022-09-29 15:32:36.621314] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-09-29 15:32:36.621319] cuda ....................... True
[2022-09-29 15:32:36.621322] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-09-29 15:32:36.621326] dataset .................... amazon
[2022-09-29 15:32:36.621329] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-09-29 15:32:36.621334] device ..................... 4
[2022-09-29 15:32:36.621337] device_num ................. 0
[2022-09-29 15:32:36.621340] disable_tqdm ............... True
[2022-09-29 15:32:36.621344] do_test .................... False
[2022-09-29 15:32:36.621347] do_valid ................... True
[2022-09-29 15:32:36.621351] dont_print_args ............ True
[2022-09-29 15:32:36.621355] dont_shuffle ............... None
[2022-09-29 15:32:36.621378] dropout .................... 0.3
[2022-09-29 15:32:36.621383] estimate_type .............. <function mc_estimate at 0x7f73cb4318b0>
[2022-09-29 15:32:36.621389] excluded_terms ............. [1]
[2022-09-29 15:32:36.621393] excluded_terms_list ........ [[]]
[2022-09-29 15:32:36.621398] finetune ................... False
[2022-09-29 15:32:36.621401] frequentist_test ........... False
[2022-09-29 15:32:36.621405] grad_clip .................. 1.0
[2022-09-29 15:32:36.621408] hidden_size ................ 512
[2022-09-29 15:32:36.621412] hist_len ................... 18
[2022-09-29 15:32:36.621415] hybrid_max_num_beams ....... 1500
[2022-09-29 15:32:36.621420] intermediate_seqs .......... [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
[2022-09-29 15:32:36.621424] interp_func ................ <function lin_interp at 0x7f73cb431d30>
[2022-09-29 15:32:36.621427] log_interval ............... 100
[2022-09-29 15:32:36.621438] lr ......................... 0.001
[2022-09-29 15:32:36.621442] lr_decay_style ............. constant
[2022-09-29 15:32:36.621445] masked_lm .................. False
[2022-09-29 15:32:36.621449] max_k ...................... None
[2022-09-29 15:32:36.621452] max_num_mc_samples ......... 100000
[2022-09-29 15:32:36.621455] max_num_queries ............ 1000
[2022-09-29 15:32:36.621459] min_num_mc_samples ......... 10000
[2022-09-29 15:32:36.621462] min_phase_shift ............ 0
[2022-09-29 15:32:36.621465] min_var_reduction .......... 0.1
[2022-09-29 15:32:36.621468] min_variance ............... False
[2022-09-29 15:32:36.621473] model_budget_filepath ...... None
[2022-09-29 15:32:36.621476] needs_dl ................... True
[2022-09-29 15:32:36.621480] num_beams .................. 0.0
[2022-09-29 15:32:36.621483] num_layers ................. 2
[2022-09-29 15:32:36.621487] num_mc_samples ............. 100
[2022-09-29 15:32:36.621490] num_workers ................ 0
[2022-09-29 15:32:36.621493] optimizer .................. adam
[2022-09-29 15:32:36.621497] proposal_func .............. <function lm_proposal at 0x7f73cb41ed30>
[2022-09-29 15:32:36.621500] query_2 .................... False
[2022-09-29 15:32:36.621503] rnn_type ................... LSTM
[2022-09-29 15:32:36.621506] save_epochs ................ 1
[2022-09-29 15:32:36.621510] seed ....................... 42
[2022-09-29 15:32:36.621512] seq_len .................... 15
[2022-09-29 15:32:36.621516] shuffle .................... True
[2022-09-29 15:32:36.621519] store_intermediate_lbs ..... True
[2022-09-29 15:32:36.621523] sub_estimates .............. [10, 30, 50]
[2022-09-29 15:32:36.621526] tau_a_excl_terms ........... [2, 3, 9, 10]
[2022-09-29 15:32:36.621530] tau_b_excl_terms ........... [17, 19, 25, 28]
[2022-09-29 15:32:36.621533] terms_of_interest .......... []
[2022-09-29 15:32:36.621537] text_dict .................. None
[2022-09-29 15:32:36.621540] top_k ...................... 0
[2022-09-29 15:32:36.621543] top_p ...................... 0
[2022-09-29 15:32:36.621546] total_seq_len .............. 20
[2022-09-29 15:32:36.621549] train_data_pct ............. 0.9
[2022-09-29 15:32:36.621553] train_epochs ............... 40
[2022-09-29 15:32:36.621556] use_gpt2 ................... False
[2022-09-29 15:32:36.621559] val_data_pct ............... 0.0001
[2022-09-29 15:32:36.621564] val_metrics ................ ['accuracy']
[2022-09-29 15:32:36.621567] valid_epochs ............... 1
[2022-09-29 15:32:36.621573] variance_epsilon ........... 5e-06
[2022-09-29 15:32:36.621576] vocab_size ................. 30
[2022-09-29 15:32:36.621580] warmup_pct ................. 0.01
[2022-09-29 15:32:36.621583] weight_decay ............... 0.0
==================================================
[2022-09-29 15:32:36.621823] | Dataset: amazon | Sample type: efficiency_ablation | Num samples: None | Hist length 5 | Total Seq Length 21 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
