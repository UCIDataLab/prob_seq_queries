==================================================
* Running for dataset moocs
==================================================
[2022-07-29 08:24:43.465199] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-07-29 08:24:43.470263] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-07-29 08:24:43.591392] batch_size ................. 8192
[2022-07-29 08:24:43.591434] bs_ablation ................ False
[2022-07-29 08:24:43.591440] bs_ablation_max_beams ...... 10000
[2022-07-29 08:24:43.591447] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-07-29 08:24:43.591453] cuda ....................... True
[2022-07-29 08:24:43.591459] data_path .................. data/moocs/mooc.csv
[2022-07-29 08:24:43.591464] dataset .................... moocs
[2022-07-29 08:24:43.591470] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-07-29 08:24:43.591476] device ..................... 3
[2022-07-29 08:24:43.591482] device_num ................. 0
[2022-07-29 08:24:43.591487] disable_tqdm ............... True
[2022-07-29 08:24:43.591493] do_test .................... False
[2022-07-29 08:24:43.591499] do_valid ................... True
[2022-07-29 08:24:43.591505] dont_print_args ............ True
[2022-07-29 08:24:43.591512] dont_shuffle ............... None
[2022-07-29 08:24:43.591528] dropout .................... 0.3
[2022-07-29 08:24:43.591540] estimate_type .............. <function mc_estimate at 0x7f5bce4ad940>
[2022-07-29 08:24:43.591550] excluded_terms ............. [1]
[2022-07-29 08:24:43.591557] excluded_terms_list ........ [[]]
[2022-07-29 08:24:43.591573] finetune ................... False
[2022-07-29 08:24:43.591579] frequentist_test ........... False
[2022-07-29 08:24:43.591586] grad_clip .................. 1.0
[2022-07-29 08:24:43.591591] hidden_size ................ 128
[2022-07-29 08:24:43.591596] hist_len ................... 18
[2022-07-29 08:24:43.591602] hybrid_max_num_beams ....... 1500
[2022-07-29 08:24:43.591611] intermediate_seqs .......... [2, 3, 4, 5, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]
[2022-07-29 08:24:43.591621] interp_func ................ <function lin_interp at 0x7f5bce4addc0>
[2022-07-29 08:24:43.591627] log_interval ............... 100
[2022-07-29 08:24:43.591634] lr ......................... 0.001
[2022-07-29 08:24:43.591639] lr_decay_style ............. constant
[2022-07-29 08:24:43.591645] masked_lm .................. False
[2022-07-29 08:24:43.591651] max_k ...................... None
[2022-07-29 08:24:43.591656] max_num_mc_samples ......... 100000
[2022-07-29 08:24:43.591662] max_num_queries ............ 100
[2022-07-29 08:24:43.591667] min_num_mc_samples ......... 10000
[2022-07-29 08:24:43.591673] min_phase_shift ............ 0
[2022-07-29 08:24:43.591680] min_var_reduction .......... 0.1
[2022-07-29 08:24:43.591685] min_variance ............... False
[2022-07-29 08:24:43.591690] model_budget_filepath ...... None
[2022-07-29 08:24:43.591696] needs_dl ................... True
[2022-07-29 08:24:43.591701] needs_encoding ............. False
[2022-07-29 08:24:43.591708] num_beams .................. 0.0
[2022-07-29 08:24:43.591713] num_layers ................. 2
[2022-07-29 08:24:43.591719] num_mc_samples ............. 100
[2022-07-29 08:24:43.591724] num_workers ................ 0
[2022-07-29 08:24:43.591730] optimizer .................. adam
[2022-07-29 08:24:43.591736] proposal_func .............. <function lm_proposal at 0x7f5bce49adc0>
[2022-07-29 08:24:43.591741] query_2 .................... False
[2022-07-29 08:24:43.591749] rnn_type ................... LSTM
[2022-07-29 08:24:43.591755] save_epochs ................ 1
[2022-07-29 08:24:43.591760] seed ....................... 42
[2022-07-29 08:24:43.591766] seq_len .................... 15
[2022-07-29 08:24:43.591771] shuffle .................... True
[2022-07-29 08:24:43.591776] store_intermediate_lbs ..... True
[2022-07-29 08:24:43.591786] sub_estimates .............. [10, 30, 50, 100, 300, 500, 1000, 3000, 5000, 10000]
[2022-07-29 08:24:43.591792] tau_a_excl_terms ........... [13, 8, 21, 7]
[2022-07-29 08:24:43.591799] tau_b_excl_terms ........... [51, 33, 16, 27, 15, 24, 53]
[2022-07-29 08:24:43.591805] terms_of_interest .......... []
[2022-07-29 08:24:43.591811] text_dict .................. None
[2022-07-29 08:24:43.591816] top_k ...................... 0
[2022-07-29 08:24:43.591821] top_p ...................... 0
[2022-07-29 08:24:43.591827] total_seq_len .............. 20
[2022-07-29 08:24:43.591833] train_data_pct ............. 0.9
[2022-07-29 08:24:43.591838] train_epochs ............... 40
[2022-07-29 08:24:43.591844] use_gpt2 ................... False
[2022-07-29 08:24:43.591849] val_data_pct ............... 0.01
[2022-07-29 08:24:43.591858] val_metrics ................ ['accuracy']
[2022-07-29 08:24:43.591863] valid_epochs ............... 1
[2022-07-29 08:24:43.591872] variance_epsilon ........... 5e-06
[2022-07-29 08:24:43.591878] vocab_size ................. 98
[2022-07-29 08:24:43.591884] warmup_pct ................. 0.01
[2022-07-29 08:24:43.591890] weight_decay ............... 0.0
==================================================
[2022-07-29 08:24:43.592782] | Dataset: moocs | Sample type: query2_importance_sampling_ablation | Num samples: None | Hist length 5 | Total Seq Length 105 | Pseudo GT: True | Model Budget: False

..........
==================================================
