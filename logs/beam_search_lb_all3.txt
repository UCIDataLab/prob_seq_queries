==================================================
* Running for dataset shakespeare
==================================================
[2022-05-03 13:58:35.843542] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-03 13:58:35.846831] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-03 13:58:35.848778] batch_size .......... 4096
[2022-05-03 13:58:35.848790] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-03 13:58:35.848796] cuda ................ True
[2022-05-03 13:58:35.848800] data_path ........... data/shakespeare/shakespeare_input.txt
[2022-05-03 13:58:35.848803] device .............. 4
[2022-05-03 13:58:35.848806] device_num .......... 0
[2022-05-03 13:58:35.848810] disable_tqdm ........ True
[2022-05-03 13:58:35.848813] do_test ............. False
[2022-05-03 13:58:35.848816] do_valid ............ True
[2022-05-03 13:58:35.848819] dont_print_args ..... True
[2022-05-03 13:58:35.848823] dont_shuffle ........ None
[2022-05-03 13:58:35.848830] dropout ............. 0.3
[2022-05-03 13:58:35.848835] estimate_type ....... <function beam_search_lower_bound at 0x7f1af65369d0>
[2022-05-03 13:58:35.848840] excluded_terms ...... [1]
[2022-05-03 13:58:35.848843] finetune ............ False
[2022-05-03 13:58:35.848847] grad_clip ........... 1.0
[2022-05-03 13:58:35.848850] hidden_size ......... 128
[2022-05-03 13:58:35.848853] hist_len ............ 18
[2022-05-03 13:58:35.848857] interp_func ......... <function lin_interp at 0x7f1af65368b0>
[2022-05-03 13:58:35.848861] log_interval ........ 100
[2022-05-03 13:58:35.848865] lr .................. 0.001
[2022-05-03 13:58:35.848868] lr_decay_style ...... constant
[2022-05-03 13:58:35.848871] masked_lm ........... False
[2022-05-03 13:58:35.848875] min_var_reduction ... 0.9
[2022-05-03 13:58:35.848878] min_variance ........ False
[2022-05-03 13:58:35.848882] num_beams ........... 0.0
[2022-05-03 13:58:35.848885] num_layers .......... 2
[2022-05-03 13:58:35.848888] num_mc_samples ...... 100
[2022-05-03 13:58:35.848891] num_workers ......... 0
[2022-05-03 13:58:35.848894] optimizer ........... adam
[2022-05-03 13:58:35.848898] proposal_func ....... <function lm_proposal at 0x7f1af652eaf0>
[2022-05-03 13:58:35.848900] rnn_type ............ LSTM
[2022-05-03 13:58:35.848903] save_epochs ......... 1
[2022-05-03 13:58:35.848907] seed ................ 1234321
[2022-05-03 13:58:35.848910] seq_len ............. 100
[2022-05-03 13:58:35.848913] shuffle ............. True
[2022-05-03 13:58:35.848916] sub_estimates ....... []
[2022-05-03 13:58:35.848919] text_dict ........... None
[2022-05-03 13:58:35.848922] top_k ............... 0
[2022-05-03 13:58:35.848925] top_p ............... 0
[2022-05-03 13:58:35.848928] total_seq_len ....... 20
[2022-05-03 13:58:35.848931] train_data_pct ...... 0.9
[2022-05-03 13:58:35.848934] train_epochs ........ 40
[2022-05-03 13:58:35.848938] val_data_pct ........ 0.05
[2022-05-03 13:58:35.848942] val_metrics ......... ['accuracy']
[2022-05-03 13:58:35.848945] valid_epochs ........ 1
[2022-05-03 13:58:35.848948] vocab_size .......... 68
[2022-05-03 13:58:35.848951] warmup_pct .......... 0.01
[2022-05-03 13:58:35.848954] weight_decay ........ 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.95 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.85 | Hist length 15 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 14 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-03 14:04:45.083437] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-03 14:04:45.153103] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-03 14:04:45.594053] batch_size .......... 4096
[2022-05-03 14:04:45.594075] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-03 14:04:45.594081] cuda ................ True
[2022-05-03 14:04:45.594085] data_path ........... /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-03 14:04:45.594089] device .............. 4
[2022-05-03 14:04:45.594093] device_num .......... 0
[2022-05-03 14:04:45.594097] disable_tqdm ........ True
[2022-05-03 14:04:45.594101] do_test ............. False
[2022-05-03 14:04:45.594104] do_valid ............ True
[2022-05-03 14:04:45.594108] dont_print_args ..... True
[2022-05-03 14:04:45.594116] dont_shuffle ........ None
[2022-05-03 14:04:45.594124] dropout ............. 0.3
[2022-05-03 14:04:45.594130] estimate_type ....... <function beam_search_lower_bound at 0x7f1af65369d0>
[2022-05-03 14:04:45.594135] excluded_terms ...... [1]
[2022-05-03 14:04:45.594139] finetune ............ False
[2022-05-03 14:04:45.594145] grad_clip ........... 1.0
[2022-05-03 14:04:45.594149] hidden_size ......... 512
[2022-05-03 14:04:45.594152] hist_len ............ 18
[2022-05-03 14:04:45.594156] interp_func ......... <function lin_interp at 0x7f1af65368b0>
[2022-05-03 14:04:45.594161] log_interval ........ 100
[2022-05-03 14:04:45.594165] lr .................. 0.001
[2022-05-03 14:04:45.594169] lr_decay_style ...... constant
[2022-05-03 14:04:45.594172] masked_lm ........... False
[2022-05-03 14:04:45.594225] min_var_reduction ... 0.9
[2022-05-03 14:04:45.594229] min_variance ........ False
[2022-05-03 14:04:45.594233] num_beams ........... 0.0
[2022-05-03 14:04:45.594236] num_layers .......... 2
[2022-05-03 14:04:45.594239] num_mc_samples ...... 100
[2022-05-03 14:04:45.594245] num_workers ......... 0
[2022-05-03 14:04:45.594249] optimizer ........... adam
[2022-05-03 14:04:45.594253] proposal_func ....... <function lm_proposal at 0x7f1af652eaf0>
[2022-05-03 14:04:45.594257] rnn_type ............ LSTM
[2022-05-03 14:04:45.594261] save_epochs ......... 1
[2022-05-03 14:04:45.594265] seed ................ 1234321
[2022-05-03 14:04:45.594270] seq_len ............. 15
[2022-05-03 14:04:45.594274] shuffle ............. True
[2022-05-03 14:04:45.594277] sub_estimates ....... []
[2022-05-03 14:04:45.594281] text_dict ........... None
[2022-05-03 14:04:45.594284] top_k ............... 0
[2022-05-03 14:04:45.594287] top_p ............... 0
[2022-05-03 14:04:45.594291] total_seq_len ....... 20
[2022-05-03 14:04:45.594296] train_data_pct ...... 0.9
[2022-05-03 14:04:45.594300] train_epochs ........ 40
[2022-05-03 14:04:45.594303] val_data_pct ........ 0.0001
[2022-05-03 14:04:45.594308] val_metrics ......... ['accuracy']
[2022-05-03 14:04:45.594312] valid_epochs ........ 1
[2022-05-03 14:04:45.594315] vocab_size .......... 30
[2022-05-03 14:04:45.594319] warmup_pct .......... 0.01
[2022-05-03 14:04:45.594324] weight_decay ........ 0.0
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.95 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.85 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

...............................................