==================================================
* Running for dataset apps
==================================================
[2022-05-04 09:54:39.717717] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-04 09:54:39.753876] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-04 09:54:39.820945] batch_size .......... 4096
[2022-05-04 09:54:39.820978] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-04 09:54:39.820989] cuda ................ True
[2022-05-04 09:54:39.820996] data_path ........... data/apps/lsapp.tsv
[2022-05-04 09:54:39.821002] device .............. 4
[2022-05-04 09:54:39.821008] device_num .......... 0
[2022-05-04 09:54:39.821015] disable_tqdm ........ True
[2022-05-04 09:54:39.821021] do_test ............. False
[2022-05-04 09:54:39.821027] do_valid ............ True
[2022-05-04 09:54:39.821033] dont_print_args ..... True
[2022-05-04 09:54:39.821041] dont_shuffle ........ None
[2022-05-04 09:54:39.821053] dropout ............. 0.3
[2022-05-04 09:54:39.821065] estimate_type ....... <function beam_search_lower_bound at 0x7f40d12439d0>
[2022-05-04 09:54:39.821074] excluded_terms ...... [1]
[2022-05-04 09:54:39.821080] finetune ............ False
[2022-05-04 09:54:39.821089] grad_clip ........... 1.0
[2022-05-04 09:54:39.821095] hidden_size ......... 512
[2022-05-04 09:54:39.821100] hist_len ............ 18
[2022-05-04 09:54:39.821107] interp_func ......... <function lin_interp at 0x7f40d12438b0>
[2022-05-04 09:54:39.821113] log_interval ........ 100
[2022-05-04 09:54:39.821120] lr .................. 0.001
[2022-05-04 09:54:39.821125] lr_decay_style ...... constant
[2022-05-04 09:54:39.821131] masked_lm ........... False
[2022-05-04 09:54:39.821137] min_var_reduction ... 0.9
[2022-05-04 09:54:39.821143] min_variance ........ False
[2022-05-04 09:54:39.821149] num_beams ........... 0.0
[2022-05-04 09:54:39.821154] num_layers .......... 2
[2022-05-04 09:54:39.821163] num_mc_samples ...... 100
[2022-05-04 09:54:39.821169] num_workers ......... 0
[2022-05-04 09:54:39.821175] optimizer ........... adam
[2022-05-04 09:54:39.821181] proposal_func ....... <function lm_proposal at 0x7f40d123baf0>
[2022-05-04 09:54:39.821187] rnn_type ............ LSTM
[2022-05-04 09:54:39.821192] save_epochs ......... 1
[2022-05-04 09:54:39.821198] seed ................ 1234321
[2022-05-04 09:54:39.821203] seq_len ............. 15
[2022-05-04 09:54:39.821209] shuffle ............. True
[2022-05-04 09:54:39.821215] sub_estimates ....... []
[2022-05-04 09:54:39.821220] text_dict ........... None
[2022-05-04 09:54:39.821226] top_k ............... 0
[2022-05-04 09:54:39.821231] top_p ............... 0
[2022-05-04 09:54:39.821237] total_seq_len ....... 20
[2022-05-04 09:54:39.821243] train_data_pct ...... 0.9
[2022-05-04 09:54:39.821248] train_epochs ........ 40
[2022-05-04 09:54:39.821254] val_data_pct ........ 0.001
[2022-05-04 09:54:39.821263] val_metrics ......... ['accuracy']
[2022-05-04 09:54:39.821268] valid_epochs ........ 1
[2022-05-04 09:54:39.821274] vocab_size .......... 88
[2022-05-04 09:54:39.821280] warmup_pct .......... 0.01
[2022-05-04 09:54:39.821286] weight_decay ........ 0.0
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.92 | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.87 | Hist length 11 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search | Num Beams: 0.75 | Hist length 10 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-04 10:02:15.087114] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-04 10:02:15.159803] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-04 10:02:15.826377] batch_size .......... 4096
[2022-05-04 10:02:15.826410] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-04 10:02:15.826422] cuda ................ True
[2022-05-04 10:02:15.826428] data_path ........... /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-04 10:02:15.826434] device .............. 4
[2022-05-04 10:02:15.826440] device_num .......... 0
[2022-05-04 10:02:15.826446] disable_tqdm ........ True
[2022-05-04 10:02:15.826452] do_test ............. False
[2022-05-04 10:02:15.826458] do_valid ............ True
[2022-05-04 10:02:15.826464] dont_print_args ..... True
[2022-05-04 10:02:15.826470] dont_shuffle ........ None
[2022-05-04 10:02:15.826487] dropout ............. 0.3
[2022-05-04 10:02:15.826495] estimate_type ....... <function beam_search_lower_bound at 0x7f40d12439d0>
[2022-05-04 10:02:15.826503] excluded_terms ...... [1]
[2022-05-04 10:02:15.826509] finetune ............ False
[2022-05-04 10:02:15.826519] grad_clip ........... 1.0
[2022-05-04 10:02:15.826525] hidden_size ......... 512
[2022-05-04 10:02:15.826531] hist_len ............ 18
[2022-05-04 10:02:15.826538] interp_func ......... <function lin_interp at 0x7f40d12438b0>
[2022-05-04 10:02:15.826547] log_interval ........ 100
[2022-05-04 10:02:15.826554] lr .................. 0.001
[2022-05-04 10:02:15.826560] lr_decay_style ...... constant
[2022-05-04 10:02:15.826566] masked_lm ........... False
[2022-05-04 10:02:15.826640] min_var_reduction ... 0.9
[2022-05-04 10:02:15.826646] min_variance ........ False
[2022-05-04 10:02:15.826655] num_beams ........... 0.0
[2022-05-04 10:02:15.826661] num_layers .......... 2
[2022-05-04 10:02:15.826667] num_mc_samples ...... 100
[2022-05-04 10:02:15.826678] num_workers ......... 0
[2022-05-04 10:02:15.826684] optimizer ........... adam
[2022-05-04 10:02:15.826690] proposal_func ....... <function lm_proposal at 0x7f40d123baf0>
[2022-05-04 10:02:15.826696] rnn_type ............ LSTM
[2022-05-04 10:02:15.826702] save_epochs ......... 1
[2022-05-04 10:02:15.826708] seed ................ 1234321
[2022-05-04 10:02:15.826721] seq_len ............. 15
[2022-05-04 10:02:15.826727] shuffle ............. True
[2022-05-04 10:02:15.826733] sub_estimates ....... []
[2022-05-04 10:02:15.826739] text_dict ........... None
[2022-05-04 10:02:15.826745] top_k ............... 0
[2022-05-04 10:02:15.826750] top_p ............... 0
[2022-05-04 10:02:15.826756] total_seq_len ....... 20
[2022-05-04 10:02:15.826769] train_data_pct ...... 0.9
[2022-05-04 10:02:15.826774] train_epochs ........ 40
[2022-05-04 10:02:15.826781] val_data_pct ........ 0.0001
[2022-05-04 10:02:15.826791] val_metrics ......... ['accuracy']
[2022-05-04 10:02:15.826797] valid_epochs ........ 1
[2022-05-04 10:02:15.826804] vocab_size .......... 30
[2022-05-04 10:02:15.826811] warmup_pct .......... 0.01
[2022-05-04 10:02:15.826824] weight_decay ........ 0.0
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.95 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.85 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset shakespeare
==================================================
[2022-05-04 17:23:51.294768] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-04 17:23:51.304341] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-04 17:23:51.304548] batch_size .......... 4096
[2022-05-04 17:23:51.304558] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-04 17:23:51.304566] cuda ................ True
[2022-05-04 17:23:51.304571] data_path ........... data/shakespeare/shakespeare_input.txt
[2022-05-04 17:23:51.304577] device .............. 4
[2022-05-04 17:23:51.304583] device_num .......... 0
[2022-05-04 17:23:51.304589] disable_tqdm ........ True
[2022-05-04 17:23:51.304595] do_test ............. False
[2022-05-04 17:23:51.304601] do_valid ............ True
[2022-05-04 17:23:51.304606] dont_print_args ..... True
[2022-05-04 17:23:51.304613] dont_shuffle ........ None
[2022-05-04 17:23:51.304623] dropout ............. 0.3
[2022-05-04 17:23:51.304631] estimate_type ....... <function beam_search_lower_bound at 0x7f40d12439d0>
[2022-05-04 17:23:51.304639] excluded_terms ...... [1]
[2022-05-04 17:23:51.304645] finetune ............ False
[2022-05-04 17:23:51.304653] grad_clip ........... 1.0
[2022-05-04 17:23:51.304659] hidden_size ......... 128
[2022-05-04 17:23:51.304665] hist_len ............ 18
[2022-05-04 17:23:51.304671] interp_func ......... <function lin_interp at 0x7f40d12438b0>
[2022-05-04 17:23:51.304678] log_interval ........ 100
[2022-05-04 17:23:51.304685] lr .................. 0.001
[2022-05-04 17:23:51.304691] lr_decay_style ...... constant
[2022-05-04 17:23:51.304696] masked_lm ........... False
[2022-05-04 17:23:51.304905] min_var_reduction ... 0.9
[2022-05-04 17:23:51.304911] min_variance ........ False
[2022-05-04 17:23:51.304918] num_beams ........... 0.0
[2022-05-04 17:23:51.304923] num_layers .......... 2
[2022-05-04 17:23:51.304929] num_mc_samples ...... 100
[2022-05-04 17:23:51.304977] num_workers ......... 0
[2022-05-04 17:23:51.304983] optimizer ........... adam
[2022-05-04 17:23:51.304990] proposal_func ....... <function lm_proposal at 0x7f40d123baf0>
[2022-05-04 17:23:51.304995] rnn_type ............ LSTM
[2022-05-04 17:23:51.305001] save_epochs ......... 1
[2022-05-04 17:23:51.305007] seed ................ 1234321
[2022-05-04 17:23:51.305014] seq_len ............. 100
[2022-05-04 17:23:51.305020] shuffle ............. True
[2022-05-04 17:23:51.305026] sub_estimates ....... []
[2022-05-04 17:23:51.305032] text_dict ........... None
[2022-05-04 17:23:51.305037] top_k ............... 0
[2022-05-04 17:23:51.305042] top_p ............... 0
[2022-05-04 17:23:51.305048] total_seq_len ....... 20
[2022-05-04 17:23:51.305055] train_data_pct ...... 0.9
[2022-05-04 17:23:51.305061] train_epochs ........ 40
[2022-05-04 17:23:51.305067] val_data_pct ........ 0.05
[2022-05-04 17:23:51.305074] val_metrics ......... ['accuracy']
[2022-05-04 17:23:51.305080] valid_epochs ........ 1
[2022-05-04 17:23:51.305086] vocab_size .......... 68
[2022-05-04 17:23:51.305092] warmup_pct .......... 0.01
[2022-05-04 17:23:51.305099] weight_decay ........ 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.95 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.85 | Hist length 15 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 14 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
