==================================================
* Running for dataset apps
==================================================
[2022-05-17 15:23:42.073157] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-17 15:23:42.104365] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-17 15:23:43.297934] batch_size ................. 8000
[2022-05-17 15:23:43.297963] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-17 15:23:43.297973] cuda ....................... True
[2022-05-17 15:23:43.297979] data_path .................. data/apps/lsapp.tsv
[2022-05-17 15:23:43.297984] dataset .................... apps
[2022-05-17 15:23:43.297990] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-17 15:23:43.297996] device ..................... 7
[2022-05-17 15:23:43.298002] device_num ................. 0
[2022-05-17 15:23:43.298007] disable_tqdm ............... True
[2022-05-17 15:23:43.298013] do_test .................... False
[2022-05-17 15:23:43.298019] do_valid ................... True
[2022-05-17 15:23:43.298024] dont_print_args ............ True
[2022-05-17 15:23:43.298032] dont_shuffle ............... None
[2022-05-17 15:23:43.298043] dropout .................... 0.3
[2022-05-17 15:23:43.298052] estimate_type .............. <function beam_search_lower_bound at 0x7f35b9397ee0>
[2022-05-17 15:23:43.298064] excluded_terms ............. [1]
[2022-05-17 15:23:43.298070] excluded_terms_list ........ [[]]
[2022-05-17 15:23:43.298077] finetune ................... False
[2022-05-17 15:23:43.298083] grad_clip .................. 1.0
[2022-05-17 15:23:43.298090] hidden_size ................ 512
[2022-05-17 15:23:43.298096] hist_len ................... 18
[2022-05-17 15:23:43.298101] hybrid_max_num_beams ....... 1500
[2022-05-17 15:23:43.298108] interp_func ................ <function lin_interp at 0x7f35b9397dc0>
[2022-05-17 15:23:43.298113] log_interval ............... 100
[2022-05-17 15:23:43.298120] lr ......................... 0.001
[2022-05-17 15:23:43.298126] lr_decay_style ............. constant
[2022-05-17 15:23:43.298132] masked_lm .................. False
[2022-05-17 15:23:43.298137] max_k ...................... None
[2022-05-17 15:23:43.298143] max_num_mc_samples ......... 100000
[2022-05-17 15:23:43.298149] max_num_queries ............ 1000
[2022-05-17 15:23:43.298154] min_num_mc_samples ......... 10000
[2022-05-17 15:23:43.298160] min_phase_shift ............ 0
[2022-05-17 15:23:43.298166] min_var_reduction .......... 0.1
[2022-05-17 15:23:43.298171] min_variance ............... True
[2022-05-17 15:23:43.298177] model_budget_filepath ...... None
[2022-05-17 15:23:43.298183] needs_dl ................... True
[2022-05-17 15:23:43.298188] needs_encoding ............. True
[2022-05-17 15:23:43.298194] num_beams .................. 0.0
[2022-05-17 15:23:43.298200] num_layers ................. 2
[2022-05-17 15:23:43.298205] num_mc_samples ............. 100
[2022-05-17 15:23:43.298211] num_workers ................ 0
[2022-05-17 15:23:43.298216] optimizer .................. adam
[2022-05-17 15:23:43.298222] proposal_func .............. <function lm_proposal at 0x7f35b9385dc0>
[2022-05-17 15:23:43.298228] rnn_type ................... LSTM
[2022-05-17 15:23:43.298233] save_epochs ................ 1
[2022-05-17 15:23:43.298238] seed ....................... 42
[2022-05-17 15:23:43.298244] seq_len .................... 15
[2022-05-17 15:23:43.298249] shuffle .................... True
[2022-05-17 15:23:43.298255] store_intermediate_lbs ..... True
[2022-05-17 15:23:43.298261] sub_estimates .............. []
[2022-05-17 15:23:43.298266] tau_a_excl_terms ........... []
[2022-05-17 15:23:43.298272] tau_b_excl_terms ........... []
[2022-05-17 15:23:43.298277] terms_of_interest .......... []
[2022-05-17 15:23:43.298283] text_dict .................. None
[2022-05-17 15:23:43.298288] top_k ...................... 0
[2022-05-17 15:23:43.298293] top_p ...................... 0
[2022-05-17 15:23:43.298299] total_seq_len .............. 20
[2022-05-17 15:23:43.298305] train_data_pct ............. 0.9
[2022-05-17 15:23:43.298310] train_epochs ............... 40
[2022-05-17 15:23:43.298316] use_gpt2 ................... False
[2022-05-17 15:23:43.298321] val_data_pct ............... 0.001
[2022-05-17 15:23:43.298328] val_metrics ................ ['accuracy']
[2022-05-17 15:23:43.298333] valid_epochs ............... 1
[2022-05-17 15:23:43.298342] variance_epsilon ........... 5e-06
[2022-05-17 15:23:43.298348] vocab_size ................. 88
[2022-05-17 15:23:43.298353] warmup_pct ................. 0.01
[2022-05-17 15:23:43.298359] weight_decay ............... 0.0
==================================================
[2022-05-17 15:23:43.298967] | Dataset: apps | Sample type: pseudo_gt | Num samples: None | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset shakespeare
==================================================
[2022-05-17 17:09:13.074038] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-17 17:09:13.077553] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-17 17:09:13.077779] batch_size ................. 8000
[2022-05-17 17:09:13.077790] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-17 17:09:13.077798] cuda ....................... True
[2022-05-17 17:09:13.077803] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-17 17:09:13.077809] dataset .................... shakespeare
[2022-05-17 17:09:13.077815] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-17 17:09:13.077821] device ..................... 7
[2022-05-17 17:09:13.077826] device_num ................. 0
[2022-05-17 17:09:13.077832] disable_tqdm ............... True
[2022-05-17 17:09:13.077838] do_test .................... False
[2022-05-17 17:09:13.077844] do_valid ................... True
[2022-05-17 17:09:13.077850] dont_print_args ............ True
[2022-05-17 17:09:13.077856] dont_shuffle ............... None
[2022-05-17 17:09:13.077867] dropout .................... 0.3
[2022-05-17 17:09:13.077877] estimate_type .............. <function beam_search_lower_bound at 0x7f35b9397ee0>
[2022-05-17 17:09:13.077886] excluded_terms ............. [1]
[2022-05-17 17:09:13.077893] excluded_terms_list ........ [[]]
[2022-05-17 17:09:13.077898] finetune ................... False
[2022-05-17 17:09:13.077905] grad_clip .................. 1.0
[2022-05-17 17:09:13.077911] hidden_size ................ 128
[2022-05-17 17:09:13.077916] hist_len ................... 18
[2022-05-17 17:09:13.077922] hybrid_max_num_beams ....... 1500
[2022-05-17 17:09:13.077928] interp_func ................ <function lin_interp at 0x7f35b9397dc0>
[2022-05-17 17:09:13.077934] log_interval ............... 100
[2022-05-17 17:09:13.077940] lr ......................... 0.001
[2022-05-17 17:09:13.077946] lr_decay_style ............. constant
[2022-05-17 17:09:13.077951] masked_lm .................. False
[2022-05-17 17:09:13.077957] max_k ...................... None
[2022-05-17 17:09:13.077963] max_num_mc_samples ......... 100000
[2022-05-17 17:09:13.077968] max_num_queries ............ 1000
[2022-05-17 17:09:13.077974] min_num_mc_samples ......... 10000
[2022-05-17 17:09:13.077979] min_phase_shift ............ 0
[2022-05-17 17:09:13.077985] min_var_reduction .......... 0.1
[2022-05-17 17:09:13.077991] min_variance ............... True
[2022-05-17 17:09:13.077997] model_budget_filepath ...... None
[2022-05-17 17:09:13.078002] needs_dl ................... True
[2022-05-17 17:09:13.078008] num_beams .................. 0.0
[2022-05-17 17:09:13.078014] num_layers ................. 2
[2022-05-17 17:09:13.078019] num_mc_samples ............. 100
[2022-05-17 17:09:13.078025] num_workers ................ 0
[2022-05-17 17:09:13.078030] optimizer .................. adam
[2022-05-17 17:09:13.078036] proposal_func .............. <function lm_proposal at 0x7f35b9385dc0>
[2022-05-17 17:09:13.078042] rnn_type ................... LSTM
[2022-05-17 17:09:13.078047] save_epochs ................ 1
[2022-05-17 17:09:13.078052] seed ....................... 42
[2022-05-17 17:09:13.078058] seq_len .................... 100
[2022-05-17 17:09:13.078063] shuffle .................... True
[2022-05-17 17:09:13.078069] store_intermediate_lbs ..... True
[2022-05-17 17:09:13.078075] sub_estimates .............. []
[2022-05-17 17:09:13.078081] tau_a_excl_terms ........... []
[2022-05-17 17:09:13.078086] tau_b_excl_terms ........... []
[2022-05-17 17:09:13.078091] terms_of_interest .......... []
[2022-05-17 17:09:13.078097] text_dict .................. None
[2022-05-17 17:09:13.078103] top_k ...................... 0
[2022-05-17 17:09:13.078108] top_p ...................... 0
[2022-05-17 17:09:13.078113] total_seq_len .............. 20
[2022-05-17 17:09:13.078119] train_data_pct ............. 0.9
[2022-05-17 17:09:13.078125] train_epochs ............... 40
[2022-05-17 17:09:13.078131] use_gpt2 ................... False
[2022-05-17 17:09:13.078137] val_data_pct ............... 0.05
[2022-05-17 17:09:13.078143] val_metrics ................ ['accuracy']
[2022-05-17 17:09:13.078149] valid_epochs ............... 1
[2022-05-17 17:09:13.078157] variance_epsilon ........... 5e-06
[2022-05-17 17:09:13.078162] vocab_size ................. 68
[2022-05-17 17:09:13.078168] warmup_pct ................. 0.01
[2022-05-17 17:09:13.078174] weight_decay ............... 0.0
==================================================
[2022-05-17 17:09:13.078688] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 10 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.............................................................................