==================================================
* Running for dataset shakespeare
==================================================
[2022-07-29 08:23:29.075159] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-07-29 08:23:29.078202] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-07-29 08:23:29.079865] batch_size ................. 8192
[2022-07-29 08:23:29.079879] bs_ablation ................ False
[2022-07-29 08:23:29.079883] bs_ablation_max_beams ...... 10000
[2022-07-29 08:23:29.079887] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-07-29 08:23:29.079891] cuda ....................... True
[2022-07-29 08:23:29.079894] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-07-29 08:23:29.079898] dataset .................... shakespeare
[2022-07-29 08:23:29.079901] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-07-29 08:23:29.079904] device ..................... 1
[2022-07-29 08:23:29.079908] device_num ................. 0
[2022-07-29 08:23:29.079911] disable_tqdm ............... True
[2022-07-29 08:23:29.079914] do_test .................... False
[2022-07-29 08:23:29.079918] do_valid ................... True
[2022-07-29 08:23:29.079921] dont_print_args ............ True
[2022-07-29 08:23:29.079926] dont_shuffle ............... None
[2022-07-29 08:23:29.079935] dropout .................... 0.3
[2022-07-29 08:23:29.079940] estimate_type .............. <function mc_estimate at 0x7ff1aac4e940>
[2022-07-29 08:23:29.079946] excluded_terms ............. [1]
[2022-07-29 08:23:29.079950] excluded_terms_list ........ [[]]
[2022-07-29 08:23:29.079953] finetune ................... False
[2022-07-29 08:23:29.079956] frequentist_test ........... False
[2022-07-29 08:23:29.079961] grad_clip .................. 1.0
[2022-07-29 08:23:29.079964] hidden_size ................ 128
[2022-07-29 08:23:29.079967] hist_len ................... 18
[2022-07-29 08:23:29.079971] hybrid_max_num_beams ....... 1500
[2022-07-29 08:23:29.079976] intermediate_seqs .......... [2, 3, 4, 5, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]
[2022-07-29 08:23:29.079980] interp_func ................ <function lin_interp at 0x7ff1aac4edc0>
[2022-07-29 08:23:29.079983] log_interval ............... 100
[2022-07-29 08:23:29.079987] lr ......................... 0.001
[2022-07-29 08:23:29.079991] lr_decay_style ............. constant
[2022-07-29 08:23:29.079994] masked_lm .................. False
[2022-07-29 08:23:29.079997] max_k ...................... None
[2022-07-29 08:23:29.080001] max_num_mc_samples ......... 100000
[2022-07-29 08:23:29.080004] max_num_queries ............ 100
[2022-07-29 08:23:29.080007] min_num_mc_samples ......... 10000
[2022-07-29 08:23:29.080010] min_phase_shift ............ 0
[2022-07-29 08:23:29.080014] min_var_reduction .......... 0.1
[2022-07-29 08:23:29.080017] min_variance ............... False
[2022-07-29 08:23:29.080020] model_budget_filepath ...... None
[2022-07-29 08:23:29.080023] needs_dl ................... True
[2022-07-29 08:23:29.080027] num_beams .................. 0.0
[2022-07-29 08:23:29.080031] num_layers ................. 2
[2022-07-29 08:23:29.080034] num_mc_samples ............. 100
[2022-07-29 08:23:29.080037] num_workers ................ 0
[2022-07-29 08:23:29.080040] optimizer .................. adam
[2022-07-29 08:23:29.080043] proposal_func .............. <function lm_proposal at 0x7ff1aac3bdc0>
[2022-07-29 08:23:29.080047] query_2 .................... False
[2022-07-29 08:23:29.080050] rnn_type ................... LSTM
[2022-07-29 08:23:29.080053] save_epochs ................ 1
[2022-07-29 08:23:29.080056] seed ....................... 42
[2022-07-29 08:23:29.080059] seq_len .................... 100
[2022-07-29 08:23:29.080062] shuffle .................... True
[2022-07-29 08:23:29.080065] store_intermediate_lbs ..... True
[2022-07-29 08:23:29.080071] sub_estimates .............. [10, 30, 50, 100, 300, 500, 1000, 3000, 5000, 10000]
[2022-07-29 08:23:29.080075] tau_a_excl_terms ........... [18, 46]
[2022-07-29 08:23:29.080079] tau_b_excl_terms ........... [43, 48, 49, 52, 63, 15, 20, 21, 24, 35]
[2022-07-29 08:23:29.080083] terms_of_interest .......... []
[2022-07-29 08:23:29.080086] text_dict .................. None
[2022-07-29 08:23:29.080089] top_k ...................... 0
[2022-07-29 08:23:29.080092] top_p ...................... 0
[2022-07-29 08:23:29.080096] total_seq_len .............. 20
[2022-07-29 08:23:29.080099] train_data_pct ............. 0.9
[2022-07-29 08:23:29.080102] train_epochs ............... 40
[2022-07-29 08:23:29.080106] use_gpt2 ................... False
[2022-07-29 08:23:29.080109] val_data_pct ............... 0.05
[2022-07-29 08:23:29.080114] val_metrics ................ ['accuracy']
[2022-07-29 08:23:29.080117] valid_epochs ............... 1
[2022-07-29 08:23:29.080123] variance_epsilon ........... 5e-06
[2022-07-29 08:23:29.080126] vocab_size ................. 68
[2022-07-29 08:23:29.080129] warmup_pct ................. 0.01
[2022-07-29 08:23:29.080133] weight_decay ............... 0.0
==================================================
[2022-07-29 08:23:29.080437] | Dataset: shakespeare | Sample type: query2_importance_sampling_ablation | Num samples: None | Hist length 5 | Total Seq Length 105 | Pseudo GT: True | Model Budget: False

..........
==================================================
