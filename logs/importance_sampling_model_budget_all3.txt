==================================================
* Running for dataset shakespeare
==================================================
[2022-05-09 10:59:03.953443] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-09 10:59:03.958849] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-09 10:59:03.961019] batch_size ................. 4096
[2022-05-09 10:59:03.961035] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-09 10:59:03.961041] cuda ....................... True
[2022-05-09 10:59:03.961045] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-09 10:59:03.961049] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-09 10:59:03.961053] device ..................... 6
[2022-05-09 10:59:03.961056] device_num ................. 0
[2022-05-09 10:59:03.961060] disable_tqdm ............... True
[2022-05-09 10:59:03.961064] do_test .................... False
[2022-05-09 10:59:03.961068] do_valid ................... True
[2022-05-09 10:59:03.961071] dont_print_args ............ True
[2022-05-09 10:59:03.961076] dont_shuffle ............... None
[2022-05-09 10:59:03.961085] dropout .................... 0.3
[2022-05-09 10:59:03.961091] estimate_type .............. <function mc_estimate at 0x7f9e66479700>
[2022-05-09 10:59:03.961097] excluded_terms ............. [1]
[2022-05-09 10:59:03.961103] finetune ................... False
[2022-05-09 10:59:03.961107] grad_clip .................. 1.0
[2022-05-09 10:59:03.961111] hidden_size ................ 128
[2022-05-09 10:59:03.961114] hist_len ................... 18
[2022-05-09 10:59:03.961118] interp_func ................ <function lin_interp at 0x7f9e66479a60>
[2022-05-09 10:59:03.961122] log_interval ............... 100
[2022-05-09 10:59:03.961126] lr ......................... 0.001
[2022-05-09 10:59:03.961130] lr_decay_style ............. constant
[2022-05-09 10:59:03.961134] masked_lm .................. False
[2022-05-09 10:59:03.961140] min_phase_shift ............ 0
[2022-05-09 10:59:03.961144] min_var_reduction .......... 0.9
[2022-05-09 10:59:03.961147] min_variance ............... False
[2022-05-09 10:59:03.961151] model_budget_filepath ...... None
[2022-05-09 10:59:03.961155] num_beams .................. 0.0
[2022-05-09 10:59:03.961159] num_layers ................. 2
[2022-05-09 10:59:03.961162] num_mc_samples ............. 1000
[2022-05-09 10:59:03.961166] num_workers ................ 0
[2022-05-09 10:59:03.961169] optimizer .................. adam
[2022-05-09 10:59:03.961173] proposal_func .............. <function lm_proposal at 0x7f9e66476ca0>
[2022-05-09 10:59:03.961176] rnn_type ................... LSTM
[2022-05-09 10:59:03.961179] save_epochs ................ 1
[2022-05-09 10:59:03.961183] seed ....................... 1234321
[2022-05-09 10:59:03.961186] seq_len .................... 100
[2022-05-09 10:59:03.961190] shuffle .................... True
[2022-05-09 10:59:03.961193] store_intermediate_lbs ..... False
[2022-05-09 10:59:03.961198] sub_estimates .............. [10, 100, 1000]
[2022-05-09 10:59:03.961202] text_dict .................. None
[2022-05-09 10:59:03.961205] top_k ...................... 0
[2022-05-09 10:59:03.961209] top_p ...................... 0
[2022-05-09 10:59:03.961212] total_seq_len .............. 20
[2022-05-09 10:59:03.961216] train_data_pct ............. 0.9
[2022-05-09 10:59:03.961219] train_epochs ............... 40
[2022-05-09 10:59:03.961223] val_data_pct ............... 0.05
[2022-05-09 10:59:03.961227] val_metrics ................ ['accuracy']
[2022-05-09 10:59:03.961231] valid_epochs ............... 1
[2022-05-09 10:59:03.961235] vocab_size ................. 68
[2022-05-09 10:59:03.961238] warmup_pct ................. 0.01
[2022-05-09 10:59:03.961242] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: importance_sampling | Num samples: 1000 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
sample_estimates torch.Size([2287, 3, 68])
sample_estimate_var torch.Size([2287, 3, 68])
sample_estimate_mean torch.Size([2287, 0])
model_iters torch.Size([2287, 3])
excluded_terms torch.Size([2287])
