==================================================
* Running for dataset amazon
==================================================
[2022-05-06 17:02:27.411200] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-06 17:02:27.428110] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-06 17:02:27.428290] batch_size ................. 4096
[2022-05-06 17:02:27.428299] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-06 17:02:27.428307] cuda ....................... True
[2022-05-06 17:02:27.428313] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-06 17:02:27.428319] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-06 17:02:27.428325] device ..................... 6
[2022-05-06 17:02:27.428332] device_num ................. 0
[2022-05-06 17:02:27.428338] disable_tqdm ............... True
[2022-05-06 17:02:27.428344] do_test .................... False
[2022-05-06 17:02:27.428350] do_valid ................... True
[2022-05-06 17:02:27.428356] dont_print_args ............ True
[2022-05-06 17:02:27.428363] dont_shuffle ............... None
[2022-05-06 17:02:27.428381] dropout .................... 0.3
[2022-05-06 17:02:27.428393] estimate_type .............. <function mc_estimate at 0x7f1025c42670>
[2022-05-06 17:02:27.428402] excluded_terms ............. [1]
[2022-05-06 17:02:27.428411] finetune ................... False
[2022-05-06 17:02:27.428418] grad_clip .................. 1.0
[2022-05-06 17:02:27.428423] hidden_size ................ 512
[2022-05-06 17:02:27.428429] hist_len ................... 18
[2022-05-06 17:02:27.428437] interp_func ................ <function lin_interp at 0x7f1025c429d0>
[2022-05-06 17:02:27.428442] log_interval ............... 100
[2022-05-06 17:02:27.428450] lr ......................... 0.001
[2022-05-06 17:02:27.428456] lr_decay_style ............. constant
[2022-05-06 17:02:27.428461] masked_lm .................. False
[2022-05-06 17:02:27.428469] min_phase_shift ............ 5
[2022-05-06 17:02:27.428476] min_var_reduction .......... 0.9
[2022-05-06 17:02:27.428482] min_variance ............... False
[2022-05-06 17:02:27.428488] model_budget_filepath ...... None
[2022-05-06 17:02:27.428494] num_beams .................. 0.0
[2022-05-06 17:02:27.428500] num_layers ................. 2
[2022-05-06 17:02:27.428506] num_mc_samples ............. 1000
[2022-05-06 17:02:27.428512] num_workers ................ 0
[2022-05-06 17:02:27.428517] optimizer .................. adam
[2022-05-06 17:02:27.428524] proposal_func .............. <function lm_proposal at 0x7f1025c3cc10>
[2022-05-06 17:02:27.428530] rnn_type ................... LSTM
[2022-05-06 17:02:27.428536] save_epochs ................ 1
[2022-05-06 17:02:27.428541] seed ....................... 1234321
[2022-05-06 17:02:27.428547] seq_len .................... 15
[2022-05-06 17:02:27.428553] shuffle .................... True
[2022-05-06 17:02:27.428561] sub_estimates .............. [10, 100, 1000]
[2022-05-06 17:02:27.428567] text_dict .................. None
[2022-05-06 17:02:27.428572] top_k ...................... 0
[2022-05-06 17:02:27.428578] top_p ...................... 0
[2022-05-06 17:02:27.428584] total_seq_len .............. 20
[2022-05-06 17:02:27.428590] train_data_pct ............. 0.9
[2022-05-06 17:02:27.428596] train_epochs ............... 40
[2022-05-06 17:02:27.428603] val_data_pct ............... 0.0001
[2022-05-06 17:02:27.428611] val_metrics ................ ['accuracy']
[2022-05-06 17:02:27.428617] valid_epochs ............... 1
[2022-05-06 17:02:27.428622] vocab_size ................. 30
[2022-05-06 17:02:27.428628] warmup_pct ................. 0.01
[2022-05-06 17:02:27.428634] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
...............................................................................................................
==================================================
Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
...............................................................................................................
==================================================
Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
...............................................................................................................
==================================================
Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
...............................................................................................................
==================================================
Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 9 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
...............................................................................................................
==================================================
Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
...............................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_7h_15s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_7h_15s_1000mc.pkl does not exist
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_6h_15s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_6h_15s_1000mc.pkl does not exist
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_5h_15s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_5h_15s_1000mc.pkl does not exist
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-06 17:36:55.188581] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-06 17:36:55.201934] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-06 17:36:55.228894] batch_size ................. 128
[2022-05-06 17:36:55.228935] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-06 17:36:55.228947] cuda ....................... True
[2022-05-06 17:36:55.228953] data_path .................. data/apps/lsapp.tsv
[2022-05-06 17:36:55.228964] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-06 17:36:55.228970] device ..................... 6
[2022-05-06 17:36:55.228976] device_num ................. 0
[2022-05-06 17:36:55.228993] disable_tqdm ............... True
[2022-05-06 17:36:55.228999] do_test .................... False
[2022-05-06 17:36:55.229006] do_valid ................... True
[2022-05-06 17:36:55.229014] dont_print_args ............ True
[2022-05-06 17:36:55.229022] dont_shuffle ............... None
[2022-05-06 17:36:55.229041] dropout .................... 0.3
[2022-05-06 17:36:55.229050] estimate_type .............. <function mc_estimate at 0x7f1025c42670>
[2022-05-06 17:36:55.229062] excluded_terms ............. [1]
[2022-05-06 17:36:55.229067] finetune ................... False
[2022-05-06 17:36:55.229075] grad_clip .................. 1.0
[2022-05-06 17:36:55.229081] hidden_size ................ 512
[2022-05-06 17:36:55.229086] hist_len ................... 18
[2022-05-06 17:36:55.229115] interp_func ................ <function lin_interp at 0x7f1025c429d0>
[2022-05-06 17:36:55.229121] log_interval ............... 100
[2022-05-06 17:36:55.229130] lr ......................... 0.001
[2022-05-06 17:36:55.229136] lr_decay_style ............. constant
[2022-05-06 17:36:55.229142] masked_lm .................. False
[2022-05-06 17:36:55.229150] min_phase_shift ............ 5
[2022-05-06 17:36:55.229157] min_var_reduction .......... 0.9
[2022-05-06 17:36:55.229163] min_variance ............... False
[2022-05-06 17:36:55.229169] model_budget_filepath ...... None
[2022-05-06 17:36:55.229176] num_beams .................. 0.0
[2022-05-06 17:36:55.229181] num_layers ................. 2
[2022-05-06 17:36:55.229191] num_mc_samples ............. 1000
[2022-05-06 17:36:55.229197] num_workers ................ 0
[2022-05-06 17:36:55.229204] optimizer .................. adam
[2022-05-06 17:36:55.229210] proposal_func .............. <function lm_proposal at 0x7f1025c3cc10>
[2022-05-06 17:36:55.229217] rnn_type ................... LSTM
[2022-05-06 17:36:55.229223] save_epochs ................ 1
[2022-05-06 17:36:55.229230] seed ....................... 1234321
[2022-05-06 17:36:55.229236] seq_len .................... 15
[2022-05-06 17:36:55.229242] shuffle .................... True
[2022-05-06 17:36:55.229250] sub_estimates .............. [10, 100, 1000]
[2022-05-06 17:36:55.229257] text_dict .................. None
[2022-05-06 17:36:55.229262] top_k ...................... 0
[2022-05-06 17:36:55.229268] top_p ...................... 0
[2022-05-06 17:36:55.229278] total_seq_len .............. 20
[2022-05-06 17:36:55.229285] train_data_pct ............. 0.9
[2022-05-06 17:36:55.229290] train_epochs ............... 40
[2022-05-06 17:36:55.229297] val_data_pct ............... 0.001
[2022-05-06 17:36:55.229305] val_metrics ................ ['accuracy']
[2022-05-06 17:36:55.229310] valid_epochs ............... 1
[2022-05-06 17:36:55.229316] vocab_size ................. 88
[2022-05-06 17:36:55.229323] warmup_pct ................. 0.01
[2022-05-06 17:36:55.229329] weight_decay ............... 0.0
==================================================
Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 13 | Total Seq Length 15

.............
.............
.............
.............
.............
.............
.............
.............
.............
.........