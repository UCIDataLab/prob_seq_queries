==================================================
* Running for dataset shakespeare
==================================================
[2022-05-24 10:35:27.316879] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-24 10:35:27.320195] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-24 10:35:27.322322] batch_size ................. 8192
[2022-05-24 10:35:27.322339] bs_ablation ................ False
[2022-05-24 10:35:27.322343] bs_ablation_max_beams ...... 10000
[2022-05-24 10:35:27.322346] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-24 10:35:27.322349] cuda ....................... True
[2022-05-24 10:35:27.322352] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-24 10:35:27.322354] dataset .................... shakespeare
[2022-05-24 10:35:27.322357] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-24 10:35:27.322360] device ..................... 1
[2022-05-24 10:35:27.322362] device_num ................. 0
[2022-05-24 10:35:27.322365] disable_tqdm ............... True
[2022-05-24 10:35:27.322368] do_test .................... False
[2022-05-24 10:35:27.322371] do_valid ................... True
[2022-05-24 10:35:27.322373] dont_print_args ............ True
[2022-05-24 10:35:27.322381] dont_shuffle ............... None
[2022-05-24 10:35:27.322390] dropout .................... 0.3
[2022-05-24 10:35:27.322394] estimate_type .............. <function beam_search_lower_bound at 0x7fe63ffa5dc0>
[2022-05-24 10:35:27.322398] excluded_terms ............. [1]
[2022-05-24 10:35:27.322401] excluded_terms_list ........ [[]]
[2022-05-24 10:35:27.322404] finetune ................... False
[2022-05-24 10:35:27.322407] frequentist_test ........... False
[2022-05-24 10:35:27.322411] grad_clip .................. 1.0
[2022-05-24 10:35:27.322413] hidden_size ................ 128
[2022-05-24 10:35:27.322415] hist_len ................... 18
[2022-05-24 10:35:27.322418] hybrid_max_num_beams ....... 1500
[2022-05-24 10:35:27.322421] interp_func ................ <function lin_interp at 0x7fe63ffa5ca0>
[2022-05-24 10:35:27.322423] log_interval ............... 100
[2022-05-24 10:35:27.322427] lr ......................... 0.001
[2022-05-24 10:35:27.322429] lr_decay_style ............. constant
[2022-05-24 10:35:27.322432] masked_lm .................. False
[2022-05-24 10:35:27.322435] max_k ...................... None
[2022-05-24 10:35:27.322437] max_num_mc_samples ......... 100000
[2022-05-24 10:35:27.322439] max_num_queries ............ 1000
[2022-05-24 10:35:27.322442] min_num_mc_samples ......... 10000
[2022-05-24 10:35:27.322444] min_phase_shift ............ 0
[2022-05-24 10:35:27.322447] min_var_reduction .......... 0.1
[2022-05-24 10:35:27.322449] min_variance ............... False
[2022-05-24 10:35:27.322452] model_budget_filepath ...... None
[2022-05-24 10:35:27.322454] needs_dl ................... True
[2022-05-24 10:35:27.322457] num_beams .................. 0.0
[2022-05-24 10:35:27.322459] num_layers ................. 2
[2022-05-24 10:35:27.322462] num_mc_samples ............. 100
[2022-05-24 10:35:27.322465] num_workers ................ 0
[2022-05-24 10:35:27.322467] optimizer .................. adam
[2022-05-24 10:35:27.322470] proposal_func .............. <function lm_proposal at 0x7fe63ff91ca0>
[2022-05-24 10:35:27.322473] rnn_type ................... LSTM
[2022-05-24 10:35:27.322475] save_epochs ................ 1
[2022-05-24 10:35:27.322477] seed ....................... 42
[2022-05-24 10:35:27.322480] seq_len .................... 100
[2022-05-24 10:35:27.322482] shuffle .................... True
[2022-05-24 10:35:27.322484] store_intermediate_lbs ..... True
[2022-05-24 10:35:27.322487] sub_estimates .............. []
[2022-05-24 10:35:27.322490] tau_a_excl_terms ........... [18, 46]
[2022-05-24 10:35:27.322493] tau_b_excl_terms ........... [43, 48, 49, 52, 63, 15, 20, 21, 24, 35]
[2022-05-24 10:35:27.322496] terms_of_interest .......... []
[2022-05-24 10:35:27.322498] text_dict .................. None
[2022-05-24 10:35:27.322500] top_k ...................... 0
[2022-05-24 10:35:27.322503] top_p ...................... 0
[2022-05-24 10:35:27.322505] total_seq_len .............. 20
[2022-05-24 10:35:27.322508] train_data_pct ............. 0.9
[2022-05-24 10:35:27.322510] train_epochs ............... 40
[2022-05-24 10:35:27.322512] use_gpt2 ................... False
[2022-05-24 10:35:27.322515] val_data_pct ............... 0.05
[2022-05-24 10:35:27.322518] val_metrics ................ ['accuracy']
[2022-05-24 10:35:27.322521] valid_epochs ............... 1
[2022-05-24 10:35:27.322525] variance_epsilon ........... 5e-06
[2022-05-24 10:35:27.322528] vocab_size ................. 68
[2022-05-24 10:35:27.322530] warmup_pct ................. 0.01
[2022-05-24 10:35:27.322533] weight_decay ............... 0.0
==================================================
[2022-05-24 10:35:27.322920] | Dataset: shakespeare | Sample type: frequentist_estimates | Num samples: 10000 | Hist length 10 | Total Seq Length 20 | Frequentist Test | Model Budget: True

....................................................................................................
==================================================
[2022-05-24 10:38:13.185149] | Dataset: shakespeare | Sample type: frequentist_estimates | Num samples: 10000 | Hist length 14 | Total Seq Length 20 | Frequentist Test | Model Budget: True

....................................................................................................
==================================================
[2022-05-24 10:39:52.311609] | Dataset: shakespeare | Sample type: frequentist_estimates | Num samples: 10000 | Hist length 18 | Total Seq Length 20 | Frequentist Test | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-24 10:41:00.335608] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-24 10:41:00.344807] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-24 10:41:00.616314] batch_size ................. 8192
[2022-05-24 10:41:00.616339] bs_ablation ................ False
[2022-05-24 10:41:00.616342] bs_ablation_max_beams ...... 10000
[2022-05-24 10:41:00.616346] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-24 10:41:00.616349] cuda ....................... True
[2022-05-24 10:41:00.616352] data_path .................. data/apps/lsapp.tsv
[2022-05-24 10:41:00.616354] dataset .................... apps
[2022-05-24 10:41:00.616357] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-24 10:41:00.616360] device ..................... 1
[2022-05-24 10:41:00.616362] device_num ................. 0
[2022-05-24 10:41:00.616365] disable_tqdm ............... True
[2022-05-24 10:41:00.616367] do_test .................... False
[2022-05-24 10:41:00.616371] do_valid ................... True
[2022-05-24 10:41:00.616373] dont_print_args ............ True
[2022-05-24 10:41:00.616376] dont_shuffle ............... None
[2022-05-24 10:41:00.616404] dropout .................... 0.3
[2022-05-24 10:41:00.616409] estimate_type .............. <function beam_search_lower_bound at 0x7fe63ffa5dc0>
[2022-05-24 10:41:00.616414] excluded_terms ............. [1]
[2022-05-24 10:41:00.616417] excluded_terms_list ........ [[]]
[2022-05-24 10:41:00.616420] finetune ................... False
[2022-05-24 10:41:00.616422] frequentist_test ........... False
[2022-05-24 10:41:00.616426] grad_clip .................. 1.0
[2022-05-24 10:41:00.616429] hidden_size ................ 512
[2022-05-24 10:41:00.616438] hist_len ................... 18
[2022-05-24 10:41:00.616441] hybrid_max_num_beams ....... 1500
[2022-05-24 10:41:00.616444] interp_func ................ <function lin_interp at 0x7fe63ffa5ca0>
[2022-05-24 10:41:00.616446] log_interval ............... 100
[2022-05-24 10:41:00.616449] lr ......................... 0.001
[2022-05-24 10:41:00.616453] lr_decay_style ............. constant
[2022-05-24 10:41:00.616455] masked_lm .................. False
[2022-05-24 10:41:00.616458] max_k ...................... None
[2022-05-24 10:41:00.616460] max_num_mc_samples ......... 100000
[2022-05-24 10:41:00.616463] max_num_queries ............ 1000
[2022-05-24 10:41:00.616465] min_num_mc_samples ......... 10000
[2022-05-24 10:41:00.616468] min_phase_shift ............ 0
[2022-05-24 10:41:00.616471] min_var_reduction .......... 0.1
[2022-05-24 10:41:00.616474] min_variance ............... False
[2022-05-24 10:41:00.616477] model_budget_filepath ...... None
[2022-05-24 10:41:00.616479] needs_dl ................... True
[2022-05-24 10:41:00.616482] needs_encoding ............. True
[2022-05-24 10:41:00.616485] num_beams .................. 0.0
[2022-05-24 10:41:00.616488] num_layers ................. 2
[2022-05-24 10:41:00.616490] num_mc_samples ............. 100
[2022-05-24 10:41:00.616493] num_workers ................ 0
[2022-05-24 10:41:00.616495] optimizer .................. adam
[2022-05-24 10:41:00.616498] proposal_func .............. <function lm_proposal at 0x7fe63ff91ca0>
[2022-05-24 10:41:00.616501] rnn_type ................... LSTM
[2022-05-24 10:41:00.616503] save_epochs ................ 1
[2022-05-24 10:41:00.616506] seed ....................... 42
[2022-05-24 10:41:00.616508] seq_len .................... 15
[2022-05-24 10:41:00.616511] shuffle .................... True
[2022-05-24 10:41:00.616513] store_intermediate_lbs ..... True
[2022-05-24 10:41:00.616516] sub_estimates .............. []
[2022-05-24 10:41:00.616521] tau_a_excl_terms ........... [3, 14, 16, 23, 30, 39, 44, 40, 41, 51, 60, 73, 74, 79, 81, 82, 84]
[2022-05-24 10:41:00.616524] tau_b_excl_terms ........... [18, 19, 33, 34, 47, 78, 52, 55, 57, 67]
[2022-05-24 10:41:00.616527] terms_of_interest .......... []
[2022-05-24 10:41:00.616530] text_dict .................. None
[2022-05-24 10:41:00.616532] top_k ...................... 0
[2022-05-24 10:41:00.616535] top_p ...................... 0
[2022-05-24 10:41:00.616537] total_seq_len .............. 20
[2022-05-24 10:41:00.616540] train_data_pct ............. 0.9
[2022-05-24 10:41:00.616542] train_epochs ............... 40
[2022-05-24 10:41:00.616545] use_gpt2 ................... False
[2022-05-24 10:41:00.616547] val_data_pct ............... 0.001
[2022-05-24 10:41:00.616550] val_metrics ................ ['accuracy']
[2022-05-24 10:41:00.616554] valid_epochs ............... 1
[2022-05-24 10:41:00.616558] variance_epsilon ........... 5e-06
[2022-05-24 10:41:00.616561] vocab_size ................. 88
[2022-05-24 10:41:00.616564] warmup_pct ................. 0.01
[2022-05-24 10:41:00.616566] weight_decay ............... 0.0
==================================================
[2022-05-24 10:41:00.618327] | Dataset: apps | Sample type: frequentist_estimates | Num samples: 10000 | Hist length 5 | Total Seq Length 15 | Frequentist Test | Model Budget: True

.............................................................................................