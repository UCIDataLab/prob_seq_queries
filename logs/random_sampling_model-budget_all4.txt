==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 07:51:14.693932] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 07:51:14.697847] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 07:51:14.700743] batch_size ................. 4096
[2022-05-16 07:51:14.700757] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 07:51:14.700770] cuda ....................... True
[2022-05-16 07:51:14.700775] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 07:51:14.700781] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:51:14.700787] device ..................... 5
[2022-05-16 07:51:14.700792] device_num ................. 0
[2022-05-16 07:51:14.700798] disable_tqdm ............... True
[2022-05-16 07:51:14.700804] do_test .................... False
[2022-05-16 07:51:14.700810] do_valid ................... True
[2022-05-16 07:51:14.700815] dont_print_args ............ True
[2022-05-16 07:51:14.700823] dont_shuffle ............... None
[2022-05-16 07:51:14.700836] dropout .................... 0.3
[2022-05-16 07:51:14.700843] estimate_type .............. <function beam_search_lower_bound at 0x7ff78d2bcca0>
[2022-05-16 07:51:14.700853] excluded_terms ............. [1]
[2022-05-16 07:51:14.700860] excluded_terms_list ........ [[]]
[2022-05-16 07:51:14.700866] finetune ................... False
[2022-05-16 07:51:14.700872] grad_clip .................. 1.0
[2022-05-16 07:51:14.700878] hidden_size ................ 128
[2022-05-16 07:51:14.700883] hist_len ................... 18
[2022-05-16 07:51:14.700889] hybrid_max_num_beams ....... 1500
[2022-05-16 07:51:14.700895] interp_func ................ <function lin_interp at 0x7ff78d2bcb80>
[2022-05-16 07:51:14.700901] k_range .................... []
[2022-05-16 07:51:14.700906] log_interval ............... 100
[2022-05-16 07:51:14.700914] lr ......................... 0.001
[2022-05-16 07:51:14.700919] lr_decay_style ............. constant
[2022-05-16 07:51:14.700925] masked_lm .................. False
[2022-05-16 07:51:14.700930] max_num_mc_samples ......... 100000
[2022-05-16 07:51:14.700936] max_num_queries ............ 1000
[2022-05-16 07:51:14.700942] min_num_mc_samples ......... 10000
[2022-05-16 07:51:14.700947] min_phase_shift ............ 0
[2022-05-16 07:51:14.700953] min_var_reduction .......... 0.1
[2022-05-16 07:51:14.700959] min_variance ............... True
[2022-05-16 07:51:14.700965] model_budget_filepath ...... None
[2022-05-16 07:51:14.700971] num_beams .................. 0.0
[2022-05-16 07:51:14.700976] num_layers ................. 2
[2022-05-16 07:51:14.700982] num_mc_samples ............. 100
[2022-05-16 07:51:14.700987] num_workers ................ 0
[2022-05-16 07:51:14.700992] optimizer .................. adam
[2022-05-16 07:51:14.700999] proposal_func .............. <function lm_proposal at 0x7ff78d2a9af0>
[2022-05-16 07:51:14.701004] rnn_type ................... LSTM
[2022-05-16 07:51:14.701010] save_epochs ................ 1
[2022-05-16 07:51:14.701016] seed ....................... 42
[2022-05-16 07:51:14.701021] seq_len .................... 100
[2022-05-16 07:51:14.701026] shuffle .................... True
[2022-05-16 07:51:14.701032] store_intermediate_lbs ..... True
[2022-05-16 07:51:14.701039] sub_estimates .............. []
[2022-05-16 07:51:14.701044] terms_of_interest .......... []
[2022-05-16 07:51:14.701049] text_dict .................. None
[2022-05-16 07:51:14.701055] top_k ...................... 0
[2022-05-16 07:51:14.701060] top_p ...................... 0
[2022-05-16 07:51:14.701065] total_seq_len .............. 20
[2022-05-16 07:51:14.701071] train_data_pct ............. 0.9
[2022-05-16 07:51:14.701077] train_epochs ............... 40
[2022-05-16 07:51:14.701082] use_gpt2 ................... False
[2022-05-16 07:51:14.701088] val_data_pct ............... 0.05
[2022-05-16 07:51:14.701096] val_metrics ................ ['accuracy']
[2022-05-16 07:51:14.701102] valid_epochs ............... 1
[2022-05-16 07:51:14.701111] variance_epsilon ........... 5e-06
[2022-05-16 07:51:14.701116] vocab_size ................. 68
[2022-05-16 07:51:14.701122] warmup_pct ................. 0.01
[2022-05-16 07:51:14.701128] weight_decay ............... 0.0
==================================================
[2022-05-16 07:51:14.701789] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 1000 | Hist length 15 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-16 07:51:24.487522] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 1000 | Hist length 13 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-16 07:51:38.420722] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 20

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-16 07:53:48.320190] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-16 07:53:48.346359] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-16 07:53:48.633652] batch_size ................. 4096
[2022-05-16 07:53:48.633680] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-16 07:53:48.633689] cuda ....................... True
[2022-05-16 07:53:48.633695] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-16 07:53:48.633701] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:53:48.633708] device ..................... 5
[2022-05-16 07:53:48.633713] device_num ................. 0
[2022-05-16 07:53:48.633720] disable_tqdm ............... True
[2022-05-16 07:53:48.633726] do_test .................... False
[2022-05-16 07:53:48.633732] do_valid ................... True
[2022-05-16 07:53:48.633738] dont_print_args ............ True
[2022-05-16 07:53:48.633745] dont_shuffle ............... None
[2022-05-16 07:53:48.633758] dropout .................... 0.3
[2022-05-16 07:53:48.633766] estimate_type .............. <function beam_search_lower_bound at 0x7ff78d2bcca0>
[2022-05-16 07:53:48.633774] excluded_terms ............. [1]
[2022-05-16 07:53:48.633794] excluded_terms_list ........ [[]]
[2022-05-16 07:53:48.633800] finetune ................... False
[2022-05-16 07:53:48.633807] grad_clip .................. 1.0
[2022-05-16 07:53:48.633813] hidden_size ................ 512
[2022-05-16 07:53:48.633819] hist_len ................... 18
[2022-05-16 07:53:48.633825] hybrid_max_num_beams ....... 1500
[2022-05-16 07:53:48.633831] interp_func ................ <function lin_interp at 0x7ff78d2bcb80>
[2022-05-16 07:53:48.633841] k_range .................... []
[2022-05-16 07:53:48.633847] log_interval ............... 100
[2022-05-16 07:53:48.633854] lr ......................... 0.001
[2022-05-16 07:53:48.633860] lr_decay_style ............. constant
[2022-05-16 07:53:48.633866] masked_lm .................. False
[2022-05-16 07:53:48.633871] max_num_mc_samples ......... 100000
[2022-05-16 07:53:48.633878] max_num_queries ............ 1000
[2022-05-16 07:53:48.633883] min_num_mc_samples ......... 10000
[2022-05-16 07:53:48.633889] min_phase_shift ............ 0
[2022-05-16 07:53:48.633895] min_var_reduction .......... 0.1
[2022-05-16 07:53:48.633901] min_variance ............... True
[2022-05-16 07:53:48.633907] model_budget_filepath ...... None
[2022-05-16 07:53:48.633915] num_beams .................. 0.0
[2022-05-16 07:53:48.633921] num_layers ................. 2
[2022-05-16 07:53:48.633927] num_mc_samples ............. 100
[2022-05-16 07:53:48.633932] num_workers ................ 0
[2022-05-16 07:53:48.633938] optimizer .................. adam
[2022-05-16 07:53:48.633944] proposal_func .............. <function lm_proposal at 0x7ff78d2a9af0>
[2022-05-16 07:53:48.633950] rnn_type ................... LSTM
[2022-05-16 07:53:48.633958] save_epochs ................ 1
[2022-05-16 07:53:48.633964] seed ....................... 42
[2022-05-16 07:53:48.633969] seq_len .................... 15
[2022-05-16 07:53:48.633975] shuffle .................... True
[2022-05-16 07:53:48.633981] store_intermediate_lbs ..... True
[2022-05-16 07:53:48.633986] sub_estimates .............. []
[2022-05-16 07:53:48.633992] terms_of_interest .......... []
[2022-05-16 07:53:48.633999] text_dict .................. None
[2022-05-16 07:53:48.634004] top_k ...................... 0
[2022-05-16 07:53:48.634009] top_p ...................... 0
[2022-05-16 07:53:48.634015] total_seq_len .............. 20
[2022-05-16 07:53:48.634021] train_data_pct ............. 0.9
[2022-05-16 07:53:48.634026] train_epochs ............... 40
[2022-05-16 07:53:48.634032] use_gpt2 ................... False
[2022-05-16 07:53:48.634038] val_data_pct ............... 0.0001
[2022-05-16 07:53:48.634046] val_metrics ................ ['accuracy']
[2022-05-16 07:53:48.634052] valid_epochs ............... 1
[2022-05-16 07:53:48.634060] variance_epsilon ........... 5e-06
[2022-05-16 07:53:48.634065] vocab_size ................. 30
[2022-05-16 07:53:48.634071] warmup_pct ................. 0.01
[2022-05-16 07:53:48.634077] weight_decay ............... 0.0
==================================================
[2022-05-16 07:53:48.635172] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-16 07:54:09.127471] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 7 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-16 07:54:31.066005] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 6 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-16 07:55:31.179744] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-16 07:55:31.189991] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-16 07:55:31.578498] batch_size ................. 4096
[2022-05-16 07:55:31.578526] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-16 07:55:31.578537] cuda ....................... True
[2022-05-16 07:55:31.578543] data_path .................. data/apps/lsapp.tsv
[2022-05-16 07:55:31.578549] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:55:31.578555] device ..................... 5
[2022-05-16 07:55:31.578561] device_num ................. 0
[2022-05-16 07:55:31.578567] disable_tqdm ............... True
[2022-05-16 07:55:31.578574] do_test .................... False
[2022-05-16 07:55:31.578580] do_valid ................... True
[2022-05-16 07:55:31.578585] dont_print_args ............ True
[2022-05-16 07:55:31.578596] dont_shuffle ............... None
[2022-05-16 07:55:31.578610] dropout .................... 0.3
[2022-05-16 07:55:31.578618] estimate_type .............. <function beam_search_lower_bound at 0x7ff78d2bcca0>
[2022-05-16 07:55:31.578628] excluded_terms ............. [1]
[2022-05-16 07:55:31.578654] excluded_terms_list ........ [[]]
[2022-05-16 07:55:31.578660] finetune ................... False
[2022-05-16 07:55:31.578667] grad_clip .................. 1.0
[2022-05-16 07:55:31.578672] hidden_size ................ 512
[2022-05-16 07:55:31.578678] hist_len ................... 18
[2022-05-16 07:55:31.578684] hybrid_max_num_beams ....... 1500
[2022-05-16 07:55:31.578690] interp_func ................ <function lin_interp at 0x7ff78d2bcb80>
[2022-05-16 07:55:31.578696] k_range .................... []
[2022-05-16 07:55:31.578702] log_interval ............... 100
[2022-05-16 07:55:31.578709] lr ......................... 0.001
[2022-05-16 07:55:31.578714] lr_decay_style ............. constant
[2022-05-16 07:55:31.578720] masked_lm .................. False
[2022-05-16 07:55:31.578726] max_num_mc_samples ......... 100000
[2022-05-16 07:55:31.578744] max_num_queries ............ 1000
[2022-05-16 07:55:31.578749] min_num_mc_samples ......... 10000
[2022-05-16 07:55:31.578755] min_phase_shift ............ 0
[2022-05-16 07:55:31.578761] min_var_reduction .......... 0.1
[2022-05-16 07:55:31.578767] min_variance ............... True
[2022-05-16 07:55:31.578773] model_budget_filepath ...... None
[2022-05-16 07:55:31.578779] needs_encoding ............. True
[2022-05-16 07:55:31.578785] num_beams .................. 0.0
[2022-05-16 07:55:31.578790] num_layers ................. 2
[2022-05-16 07:55:31.578796] num_mc_samples ............. 100
[2022-05-16 07:55:31.578801] num_workers ................ 0
[2022-05-16 07:55:31.578807] optimizer .................. adam
[2022-05-16 07:55:31.578813] proposal_func .............. <function lm_proposal at 0x7ff78d2a9af0>
[2022-05-16 07:55:31.578819] rnn_type ................... LSTM
[2022-05-16 07:55:31.578825] save_epochs ................ 1
[2022-05-16 07:55:31.578830] seed ....................... 42
[2022-05-16 07:55:31.578836] seq_len .................... 15
[2022-05-16 07:55:31.578841] shuffle .................... True
[2022-05-16 07:55:31.578847] store_intermediate_lbs ..... True
[2022-05-16 07:55:31.578852] sub_estimates .............. []
[2022-05-16 07:55:31.578859] terms_of_interest .......... []
[2022-05-16 07:55:31.578865] text_dict .................. None
[2022-05-16 07:55:31.578870] top_k ...................... 0
[2022-05-16 07:55:31.578875] top_p ...................... 0
[2022-05-16 07:55:31.578881] total_seq_len .............. 20
[2022-05-16 07:55:31.578887] train_data_pct ............. 0.9
[2022-05-16 07:55:31.578892] train_epochs ............... 40
[2022-05-16 07:55:31.578898] use_gpt2 ................... False
[2022-05-16 07:55:31.578904] val_data_pct ............... 0.001
[2022-05-16 07:55:31.578911] val_metrics ................ ['accuracy']
[2022-05-16 07:55:31.578917] valid_epochs ............... 1
[2022-05-16 07:55:31.578925] variance_epsilon ........... 5e-06
[2022-05-16 07:55:31.578930] vocab_size ................. 88
[2022-05-16 07:55:31.578936] warmup_pct ................. 0.01
[2022-05-16 07:55:31.578942] weight_decay ............... 0.0
==================================================
[2022-05-16 07:55:31.580311] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-16 07:55:52.282600] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 7 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-16 07:56:21.745793] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 6 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-16 07:56:58.138526] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-16 07:56:58.141904] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-16 07:56:58.279448] batch_size ................. 4096
[2022-05-16 07:56:58.279476] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-16 07:56:58.279486] cuda ....................... True
[2022-05-16 07:56:58.279492] data_path .................. data/moocs/mooc.csv
[2022-05-16 07:56:58.279498] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:56:58.279505] device ..................... 5
[2022-05-16 07:56:58.279511] device_num ................. 0
[2022-05-16 07:56:58.279517] disable_tqdm ............... True
[2022-05-16 07:56:58.279523] do_test .................... False
[2022-05-16 07:56:58.279529] do_valid ................... True
[2022-05-16 07:56:58.279535] dont_print_args ............ True
[2022-05-16 07:56:58.279542] dont_shuffle ............... None
[2022-05-16 07:56:58.279556] dropout .................... 0.3
[2022-05-16 07:56:58.284770] estimate_type .............. <function beam_search_lower_bound at 0x7ff78d2bcca0>
[2022-05-16 07:56:58.284782] excluded_terms ............. [1]
[2022-05-16 07:56:58.284809] excluded_terms_list ........ [[]]
[2022-05-16 07:56:58.284815] finetune ................... False
[2022-05-16 07:56:58.284822] grad_clip .................. 1.0
[2022-05-16 07:56:58.284828] hidden_size ................ 128
[2022-05-16 07:56:58.284835] hist_len ................... 18
[2022-05-16 07:56:58.284841] hybrid_max_num_beams ....... 1500
[2022-05-16 07:56:58.284848] interp_func ................ <function lin_interp at 0x7ff78d2bcb80>
[2022-05-16 07:56:58.284854] k_range .................... []
[2022-05-16 07:56:58.284860] log_interval ............... 100
[2022-05-16 07:56:58.284868] lr ......................... 0.001
[2022-05-16 07:56:58.284873] lr_decay_style ............. constant
[2022-05-16 07:56:58.284879] masked_lm .................. False
[2022-05-16 07:56:58.284885] max_num_mc_samples ......... 100000
[2022-05-16 07:56:58.284892] max_num_queries ............ 1000
[2022-05-16 07:56:58.284897] min_num_mc_samples ......... 10000
[2022-05-16 07:56:58.284903] min_phase_shift ............ 0
[2022-05-16 07:56:58.284910] min_var_reduction .......... 0.1
[2022-05-16 07:56:58.284916] min_variance ............... True
[2022-05-16 07:56:58.284922] model_budget_filepath ...... None
[2022-05-16 07:56:58.284929] needs_encoding ............. False
[2022-05-16 07:56:58.284935] num_beams .................. 0.0
[2022-05-16 07:56:58.284941] num_layers ................. 2
[2022-05-16 07:56:58.284946] num_mc_samples ............. 100
[2022-05-16 07:56:58.284952] num_workers ................ 0
[2022-05-16 07:56:58.284958] optimizer .................. adam
[2022-05-16 07:56:58.284964] proposal_func .............. <function lm_proposal at 0x7ff78d2a9af0>
[2022-05-16 07:56:58.284971] rnn_type ................... LSTM
[2022-05-16 07:56:58.284976] save_epochs ................ 1
[2022-05-16 07:56:58.284982] seed ....................... 42
[2022-05-16 07:56:58.284988] seq_len .................... 15
[2022-05-16 07:56:58.284993] shuffle .................... True
[2022-05-16 07:56:58.284999] store_intermediate_lbs ..... True
[2022-05-16 07:56:58.285005] sub_estimates .............. []
[2022-05-16 07:56:58.285012] terms_of_interest .......... []
[2022-05-16 07:56:58.285018] text_dict .................. None
[2022-05-16 07:56:58.285023] top_k ...................... 0
[2022-05-16 07:56:58.285029] top_p ...................... 0
[2022-05-16 07:56:58.285035] total_seq_len .............. 20
[2022-05-16 07:56:58.285041] train_data_pct ............. 0.9
[2022-05-16 07:56:58.285047] train_epochs ............... 40
[2022-05-16 07:56:58.285052] use_gpt2 ................... False
[2022-05-16 07:56:58.285059] val_data_pct ............... 0.01
[2022-05-16 07:56:58.285066] val_metrics ................ ['accuracy']
[2022-05-16 07:56:58.285072] valid_epochs ............... 1
[2022-05-16 07:56:58.285080] variance_epsilon ........... 5e-06
[2022-05-16 07:56:58.285086] vocab_size ................. 98
[2022-05-16 07:56:58.285092] warmup_pct ................. 0.01
[2022-05-16 07:56:58.285098] weight_decay ............... 0.0
==================================================
[2022-05-16 07:56:58.287594] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-16 07:57:10.605194] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 7 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-16 07:57:26.862549] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 6 | Total Seq Length 15

....................................................................................................
==================================================
