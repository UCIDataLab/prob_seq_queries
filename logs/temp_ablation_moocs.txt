==================================================
* Running for dataset moocs
==================================================
[2022-05-15 13:28:26.605466] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-15 13:28:26.608751] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-15 13:28:26.679876] batch_size ................. 4096
[2022-05-15 13:28:26.679898] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-15 13:28:26.679907] cuda ....................... True
[2022-05-15 13:28:26.679913] data_path .................. data/moocs/mooc.csv
[2022-05-15 13:28:26.679918] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 13:28:26.679925] device ..................... 7
[2022-05-15 13:28:26.679931] device_num ................. 0
[2022-05-15 13:28:26.679936] disable_tqdm ............... True
[2022-05-15 13:28:26.679942] do_test .................... False
[2022-05-15 13:28:26.679948] do_valid ................... True
[2022-05-15 13:28:26.679953] dont_print_args ............ True
[2022-05-15 13:28:26.679962] dont_shuffle ............... None
[2022-05-15 13:28:26.679976] dropout .................... 0.3
[2022-05-15 13:28:26.679984] estimate_type .............. <function beam_search_lower_bound at 0x7f6d0cfc90d0>
[2022-05-15 13:28:26.680004] excluded_terms ............. [1]
[2022-05-15 13:28:26.680011] finetune ................... False
[2022-05-15 13:28:26.680018] grad_clip .................. 1.0
[2022-05-15 13:28:26.680023] hidden_size ................ 128
[2022-05-15 13:28:26.680029] hist_len ................... 18
[2022-05-15 13:28:26.680035] hybrid_max_num_beams ....... 1500
[2022-05-15 13:28:26.680042] interp_func ................ <function lin_interp at 0x7f6d0cfc5f70>
[2022-05-15 13:28:26.680048] log_interval ............... 100
[2022-05-15 13:28:26.680055] lr ......................... 0.001
[2022-05-15 13:28:26.680061] lr_decay_style ............. constant
[2022-05-15 13:28:26.680067] masked_lm .................. False
[2022-05-15 13:28:26.680072] max_num_mc_samples ......... 100000
[2022-05-15 13:28:26.680078] max_num_queries ............ 1000
[2022-05-15 13:28:26.680083] min_num_mc_samples ......... 10000
[2022-05-15 13:28:26.680089] min_phase_shift ............ 0
[2022-05-15 13:28:26.680095] min_var_reduction .......... 0.1
[2022-05-15 13:28:26.680101] min_variance ............... True
[2022-05-15 13:28:26.680106] model_budget_filepath ...... None
[2022-05-15 13:28:26.680112] needs_encoding ............. False
[2022-05-15 13:28:26.680118] num_beams .................. 0.0
[2022-05-15 13:28:26.680123] num_layers ................. 2
[2022-05-15 13:28:26.680129] num_mc_samples ............. 100
[2022-05-15 13:28:26.680134] num_workers ................ 0
[2022-05-15 13:28:26.680140] optimizer .................. adam
[2022-05-15 13:28:26.680146] proposal_func .............. <function lm_proposal at 0x7f6d0cfb4f70>
[2022-05-15 13:28:26.680151] rnn_type ................... LSTM
[2022-05-15 13:28:26.680157] save_epochs ................ 1
[2022-05-15 13:28:26.680162] seed ....................... 42
[2022-05-15 13:28:26.680167] seq_len .................... 15
[2022-05-15 13:28:26.680173] shuffle .................... True
[2022-05-15 13:28:26.680179] store_intermediate_lbs ..... True
[2022-05-15 13:28:26.680185] sub_estimates .............. []
[2022-05-15 13:28:26.680190] terms_of_interest .......... []
[2022-05-15 13:28:26.680196] text_dict .................. None
[2022-05-15 13:28:26.680201] top_k ...................... 0
[2022-05-15 13:28:26.680206] top_p ...................... 0
[2022-05-15 13:28:26.680212] total_seq_len .............. 20
[2022-05-15 13:28:26.680218] train_data_pct ............. 0.9
[2022-05-15 13:28:26.680223] train_epochs ............... 40
[2022-05-15 13:28:26.680228] use_gpt2 ................... False
[2022-05-15 13:28:26.680234] val_data_pct ............... 0.01
[2022-05-15 13:28:26.680241] val_metrics ................ ['accuracy']
[2022-05-15 13:28:26.680247] valid_epochs ............... 1
[2022-05-15 13:28:26.680255] variance_epsilon ........... 5e-06
[2022-05-15 13:28:26.680261] vocab_size ................. 98
[2022-05-15 13:28:26.680266] warmup_pct ................. 0.01
[2022-05-15 13:28:26.680272] weight_decay ............... 0.0
==================================================
[2022-05-15 13:28:26.681482] | Dataset: moocs | Temperature: 0.01 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 13:29:11.854789] | Dataset: moocs | Temperature: 0.01 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 13:34:19.073387] | Dataset: moocs | Temperature 0.01 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 13:35:11.890681] | Dataset: moocs | Temperature: 0.1 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 13:36:14.164851] | Dataset: moocs | Temperature: 0.1 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 13:43:17.674799] | Dataset: moocs | Temperature 0.1 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 13:44:17.915531] | Dataset: moocs | Temperature: 0.5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 13:45:05.812696] | Dataset: moocs | Temperature: 0.5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 13:51:55.489339] | Dataset: moocs | Temperature 0.5 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 13:52:34.057192] | Dataset: moocs | Temperature: 0.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 13:53:06.515916] | Dataset: moocs | Temperature: 0.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 13:59:03.565925] | Dataset: moocs | Temperature 0.75 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 13:59:32.618995] | Dataset: moocs | Temperature: 1.0 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:00:09.418274] | Dataset: moocs | Temperature: 1.0 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:04:38.864099] | Dataset: moocs | Temperature 1.0 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 14:05:05.906489] | Dataset: moocs | Temperature: 1.25 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:05:37.720887] | Dataset: moocs | Temperature: 1.25 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:09:35.799534] | Dataset: moocs | Temperature 1.25 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 14:10:05.396076] | Dataset: moocs | Temperature: 1.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:10:44.184995] | Dataset: moocs | Temperature: 1.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:15:08.168028] | Dataset: moocs | Temperature 1.75 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 14:15:52.127973] | Dataset: moocs | Temperature: 2 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:16:49.276072] | Dataset: moocs | Temperature: 2 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:20:42.898113] | Dataset: moocs | Temperature 2 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 14:21:10.538522] | Dataset: moocs | Temperature: 3 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:21:39.455658] | Dataset: moocs | Temperature: 3 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:24:12.813500] | Dataset: moocs | Temperature 3 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 14:24:46.757591] | Dataset: moocs | Temperature: 4 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:25:17.600504] | Dataset: moocs | Temperature: 4 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:28:23.282814] | Dataset: moocs | Temperature 4 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 14:28:48.175539] | Dataset: moocs | Temperature: 5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:29:16.075428] | Dataset: moocs | Temperature: 5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:32:43.003171] | Dataset: moocs | Temperature 5 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-15 14:33:32.690285] | Dataset: moocs | Temperature: 10 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-15 14:34:07.728855] | Dataset: moocs | Temperature: 10 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-15 14:38:04.467185] | Dataset: moocs | Temperature 10 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
