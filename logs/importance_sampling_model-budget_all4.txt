==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 07:50:52.686996] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 07:50:52.690991] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 07:50:52.694068] batch_size ................. 4096
[2022-05-16 07:50:52.694085] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 07:50:52.694102] cuda ....................... True
[2022-05-16 07:50:52.694110] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 07:50:52.694118] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:50:52.694126] device ..................... 1
[2022-05-16 07:50:52.694134] device_num ................. 0
[2022-05-16 07:50:52.694143] disable_tqdm ............... True
[2022-05-16 07:50:52.694151] do_test .................... False
[2022-05-16 07:50:52.694160] do_valid ................... True
[2022-05-16 07:50:52.694168] dont_print_args ............ True
[2022-05-16 07:50:52.694176] dont_shuffle ............... None
[2022-05-16 07:50:52.694190] dropout .................... 0.3
[2022-05-16 07:50:52.694201] estimate_type .............. <function beam_search_lower_bound at 0x7f0d5b26ddc0>
[2022-05-16 07:50:52.694212] excluded_terms ............. [1]
[2022-05-16 07:50:52.694222] excluded_terms_list ........ [[]]
[2022-05-16 07:50:52.694230] finetune ................... False
[2022-05-16 07:50:52.694239] grad_clip .................. 1.0
[2022-05-16 07:50:52.694247] hidden_size ................ 128
[2022-05-16 07:50:52.694256] hist_len ................... 18
[2022-05-16 07:50:52.694264] hybrid_max_num_beams ....... 1500
[2022-05-16 07:50:52.694273] interp_func ................ <function lin_interp at 0x7f0d5b26dca0>
[2022-05-16 07:50:52.694281] k_range .................... []
[2022-05-16 07:50:52.694289] log_interval ............... 100
[2022-05-16 07:50:52.694299] lr ......................... 0.001
[2022-05-16 07:50:52.694307] lr_decay_style ............. constant
[2022-05-16 07:50:52.694315] masked_lm .................. False
[2022-05-16 07:50:52.694323] max_num_mc_samples ......... 100000
[2022-05-16 07:50:52.694331] max_num_queries ............ 1000
[2022-05-16 07:50:52.694340] min_num_mc_samples ......... 10000
[2022-05-16 07:50:52.694347] min_phase_shift ............ 0
[2022-05-16 07:50:52.694356] min_var_reduction .......... 0.1
[2022-05-16 07:50:52.694365] min_variance ............... True
[2022-05-16 07:50:52.694373] model_budget_filepath ...... None
[2022-05-16 07:50:52.694381] num_beams .................. 0.0
[2022-05-16 07:50:52.694389] num_layers ................. 2
[2022-05-16 07:50:52.694397] num_mc_samples ............. 100
[2022-05-16 07:50:52.694405] num_workers ................ 0
[2022-05-16 07:50:52.694413] optimizer .................. adam
[2022-05-16 07:50:52.694422] proposal_func .............. <function lm_proposal at 0x7f0d5b25bc10>
[2022-05-16 07:50:52.694429] rnn_type ................... LSTM
[2022-05-16 07:50:52.694438] save_epochs ................ 1
[2022-05-16 07:50:52.694446] seed ....................... 42
[2022-05-16 07:50:52.694453] seq_len .................... 100
[2022-05-16 07:50:52.694461] shuffle .................... True
[2022-05-16 07:50:52.694469] store_intermediate_lbs ..... True
[2022-05-16 07:50:52.694477] sub_estimates .............. []
[2022-05-16 07:50:52.694486] terms_of_interest .......... []
[2022-05-16 07:50:52.694494] text_dict .................. None
[2022-05-16 07:50:52.694502] top_k ...................... 0
[2022-05-16 07:50:52.694509] top_p ...................... 0
[2022-05-16 07:50:52.694517] total_seq_len .............. 20
[2022-05-16 07:50:52.694526] train_data_pct ............. 0.9
[2022-05-16 07:50:52.694534] train_epochs ............... 40
[2022-05-16 07:50:52.694542] use_gpt2 ................... False
[2022-05-16 07:50:52.694550] val_data_pct ............... 0.05
[2022-05-16 07:50:52.694559] val_metrics ................ ['accuracy']
[2022-05-16 07:50:52.694568] valid_epochs ............... 1
[2022-05-16 07:50:52.694579] variance_epsilon ........... 5e-06
[2022-05-16 07:50:52.694587] vocab_size ................. 68
[2022-05-16 07:50:52.694595] warmup_pct ................. 0.01
[2022-05-16 07:50:52.694604] weight_decay ............... 0.0
==================================================
[2022-05-16 07:50:52.695461] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 1000 | Hist length 15 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-16 07:51:13.787061] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 1000 | Hist length 13 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-16 07:52:00.503797] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-16 07:52:41.711126] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-16 07:52:41.714167] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-16 07:52:41.789366] batch_size ................. 4096
[2022-05-16 07:52:41.789397] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-16 07:52:41.789410] cuda ....................... True
[2022-05-16 07:52:41.789416] data_path .................. data/moocs/mooc.csv
[2022-05-16 07:52:41.789421] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:52:41.789428] device ..................... 1
[2022-05-16 07:52:41.789433] device_num ................. 0
[2022-05-16 07:52:41.789439] disable_tqdm ............... True
[2022-05-16 07:52:41.789446] do_test .................... False
[2022-05-16 07:52:41.789451] do_valid ................... True
[2022-05-16 07:52:41.789457] dont_print_args ............ True
[2022-05-16 07:52:41.789466] dont_shuffle ............... None
[2022-05-16 07:52:41.789481] dropout .................... 0.3
[2022-05-16 07:52:41.789490] estimate_type .............. <function beam_search_lower_bound at 0x7f0d5b26ddc0>
[2022-05-16 07:52:41.789499] excluded_terms ............. [1]
[2022-05-16 07:52:41.789508] excluded_terms_list ........ [[]]
[2022-05-16 07:52:41.789514] finetune ................... False
[2022-05-16 07:52:41.789521] grad_clip .................. 1.0
[2022-05-16 07:52:41.789526] hidden_size ................ 128
[2022-05-16 07:52:41.789535] hist_len ................... 18
[2022-05-16 07:52:41.789540] hybrid_max_num_beams ....... 1500
[2022-05-16 07:52:41.789547] interp_func ................ <function lin_interp at 0x7f0d5b26dca0>
[2022-05-16 07:52:41.789552] k_range .................... []
[2022-05-16 07:52:41.789605] log_interval ............... 100
[2022-05-16 07:52:41.789612] lr ......................... 0.001
[2022-05-16 07:52:41.789618] lr_decay_style ............. constant
[2022-05-16 07:52:41.789624] masked_lm .................. False
[2022-05-16 07:52:41.789629] max_num_mc_samples ......... 100000
[2022-05-16 07:52:41.789637] max_num_queries ............ 1000
[2022-05-16 07:52:41.789642] min_num_mc_samples ......... 10000
[2022-05-16 07:52:41.789648] min_phase_shift ............ 0
[2022-05-16 07:52:41.789654] min_var_reduction .......... 0.1
[2022-05-16 07:52:41.789659] min_variance ............... True
[2022-05-16 07:52:41.789665] model_budget_filepath ...... None
[2022-05-16 07:52:41.789671] needs_encoding ............. False
[2022-05-16 07:52:41.789678] num_beams .................. 0.0
[2022-05-16 07:52:41.789683] num_layers ................. 2
[2022-05-16 07:52:41.789688] num_mc_samples ............. 100
[2022-05-16 07:52:41.789694] num_workers ................ 0
[2022-05-16 07:52:41.789699] optimizer .................. adam
[2022-05-16 07:52:41.789706] proposal_func .............. <function lm_proposal at 0x7f0d5b25bc10>
[2022-05-16 07:52:41.789715] rnn_type ................... LSTM
[2022-05-16 07:52:41.789721] save_epochs ................ 1
[2022-05-16 07:52:41.789726] seed ....................... 42
[2022-05-16 07:52:41.789732] seq_len .................... 15
[2022-05-16 07:52:41.789737] shuffle .................... True
[2022-05-16 07:52:41.789742] store_intermediate_lbs ..... True
[2022-05-16 07:52:41.789748] sub_estimates .............. []
[2022-05-16 07:52:41.789756] terms_of_interest .......... []
[2022-05-16 07:52:41.789761] text_dict .................. None
[2022-05-16 07:52:41.789767] top_k ...................... 0
[2022-05-16 07:52:41.789772] top_p ...................... 0
[2022-05-16 07:52:41.789778] total_seq_len .............. 20
[2022-05-16 07:52:41.789784] train_data_pct ............. 0.9
[2022-05-16 07:52:41.789789] train_epochs ............... 40
[2022-05-16 07:52:41.789794] use_gpt2 ................... False
[2022-05-16 07:52:41.789801] val_data_pct ............... 0.01
[2022-05-16 07:52:41.789808] val_metrics ................ ['accuracy']
[2022-05-16 07:52:41.789813] valid_epochs ............... 1
[2022-05-16 07:52:41.789821] variance_epsilon ........... 5e-06
[2022-05-16 07:52:41.789827] vocab_size ................. 98
[2022-05-16 07:52:41.789833] warmup_pct ................. 0.01
[2022-05-16 07:52:41.789839] weight_decay ............... 0.0
==================================================
[2022-05-16 07:52:41.791366] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-16 07:53:10.977265] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 7 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-16 07:54:05.402132] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 6 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-16 07:56:07.814361] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-16 07:56:07.823251] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-16 07:56:08.430074] batch_size ................. 4096
[2022-05-16 07:56:08.430102] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-16 07:56:08.430111] cuda ....................... True
[2022-05-16 07:56:08.430117] data_path .................. data/apps/lsapp.tsv
[2022-05-16 07:56:08.430123] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:56:08.430129] device ..................... 1
[2022-05-16 07:56:08.430135] device_num ................. 0
[2022-05-16 07:56:08.430140] disable_tqdm ............... True
[2022-05-16 07:56:08.430146] do_test .................... False
[2022-05-16 07:56:08.430152] do_valid ................... True
[2022-05-16 07:56:08.430158] dont_print_args ............ True
[2022-05-16 07:56:08.430165] dont_shuffle ............... None
[2022-05-16 07:56:08.430178] dropout .................... 0.3
[2022-05-16 07:56:08.430186] estimate_type .............. <function beam_search_lower_bound at 0x7f0d5b26ddc0>
[2022-05-16 07:56:08.430195] excluded_terms ............. [1]
[2022-05-16 07:56:08.430205] excluded_terms_list ........ [[]]
[2022-05-16 07:56:08.430211] finetune ................... False
[2022-05-16 07:56:08.430217] grad_clip .................. 1.0
[2022-05-16 07:56:08.430223] hidden_size ................ 512
[2022-05-16 07:56:08.430229] hist_len ................... 18
[2022-05-16 07:56:08.430235] hybrid_max_num_beams ....... 1500
[2022-05-16 07:56:08.430241] interp_func ................ <function lin_interp at 0x7f0d5b26dca0>
[2022-05-16 07:56:08.430247] k_range .................... []
[2022-05-16 07:56:08.430269] log_interval ............... 100
[2022-05-16 07:56:08.430276] lr ......................... 0.001
[2022-05-16 07:56:08.430282] lr_decay_style ............. constant
[2022-05-16 07:56:08.430288] masked_lm .................. False
[2022-05-16 07:56:08.430293] max_num_mc_samples ......... 100000
[2022-05-16 07:56:08.430299] max_num_queries ............ 1000
[2022-05-16 07:56:08.430305] min_num_mc_samples ......... 10000
[2022-05-16 07:56:08.430311] min_phase_shift ............ 0
[2022-05-16 07:56:08.430317] min_var_reduction .......... 0.1
[2022-05-16 07:56:08.430322] min_variance ............... True
[2022-05-16 07:56:08.430328] model_budget_filepath ...... None
[2022-05-16 07:56:08.430334] needs_encoding ............. True
[2022-05-16 07:56:08.430341] num_beams .................. 0.0
[2022-05-16 07:56:08.430346] num_layers ................. 2
[2022-05-16 07:56:08.430351] num_mc_samples ............. 100
[2022-05-16 07:56:08.430357] num_workers ................ 0
[2022-05-16 07:56:08.430362] optimizer .................. adam
[2022-05-16 07:56:08.430369] proposal_func .............. <function lm_proposal at 0x7f0d5b25bc10>
[2022-05-16 07:56:08.430375] rnn_type ................... LSTM
[2022-05-16 07:56:08.430380] save_epochs ................ 1
[2022-05-16 07:56:08.430386] seed ....................... 42
[2022-05-16 07:56:08.430391] seq_len .................... 15
[2022-05-16 07:56:08.430397] shuffle .................... True
[2022-05-16 07:56:08.430402] store_intermediate_lbs ..... True
[2022-05-16 07:56:08.430408] sub_estimates .............. []
[2022-05-16 07:56:08.430414] terms_of_interest .......... []
[2022-05-16 07:56:08.430420] text_dict .................. None
[2022-05-16 07:56:08.430426] top_k ...................... 0
[2022-05-16 07:56:08.430431] top_p ...................... 0
[2022-05-16 07:56:08.430437] total_seq_len .............. 20
[2022-05-16 07:56:08.430443] train_data_pct ............. 0.9
[2022-05-16 07:56:08.430448] train_epochs ............... 40
[2022-05-16 07:56:08.430454] use_gpt2 ................... False
[2022-05-16 07:56:08.430460] val_data_pct ............... 0.001
[2022-05-16 07:56:08.430467] val_metrics ................ ['accuracy']
[2022-05-16 07:56:08.430472] valid_epochs ............... 1
[2022-05-16 07:56:08.430481] variance_epsilon ........... 5e-06
[2022-05-16 07:56:08.430486] vocab_size ................. 88
[2022-05-16 07:56:08.430492] warmup_pct ................. 0.01
[2022-05-16 07:56:08.430498] weight_decay ............... 0.0
==================================================
[2022-05-16 07:56:08.435165] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-16 07:57:27.554360] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 7 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-16 07:58:19.990712] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 6 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-16 08:00:38.635976] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-16 08:00:38.645458] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-16 08:00:38.917780] batch_size ................. 4096
[2022-05-16 08:00:38.917809] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-16 08:00:38.917821] cuda ....................... True
[2022-05-16 08:00:38.917827] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-16 08:00:38.917833] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 08:00:38.917842] device ..................... 1
[2022-05-16 08:00:38.917848] device_num ................. 0
[2022-05-16 08:00:38.917854] disable_tqdm ............... True
[2022-05-16 08:00:38.917861] do_test .................... False
[2022-05-16 08:00:38.917866] do_valid ................... True
[2022-05-16 08:00:38.917872] dont_print_args ............ True
[2022-05-16 08:00:38.917881] dont_shuffle ............... None
[2022-05-16 08:00:38.917896] dropout .................... 0.3
[2022-05-16 08:00:38.917904] estimate_type .............. <function beam_search_lower_bound at 0x7f0d5b26ddc0>
[2022-05-16 08:00:38.917914] excluded_terms ............. [1]
[2022-05-16 08:00:38.917922] excluded_terms_list ........ [[]]
[2022-05-16 08:00:38.917928] finetune ................... False
[2022-05-16 08:00:38.917934] grad_clip .................. 1.0
[2022-05-16 08:00:38.917940] hidden_size ................ 512
[2022-05-16 08:00:38.917946] hist_len ................... 18
[2022-05-16 08:00:38.917952] hybrid_max_num_beams ....... 1500
[2022-05-16 08:00:38.917958] interp_func ................ <function lin_interp at 0x7f0d5b26dca0>
[2022-05-16 08:00:38.917964] k_range .................... []
[2022-05-16 08:00:38.917970] log_interval ............... 100
[2022-05-16 08:00:38.917977] lr ......................... 0.001
[2022-05-16 08:00:38.917982] lr_decay_style ............. constant
[2022-05-16 08:00:38.917988] masked_lm .................. False
[2022-05-16 08:00:38.917994] max_num_mc_samples ......... 100000
[2022-05-16 08:00:38.917999] max_num_queries ............ 1000
[2022-05-16 08:00:38.918005] min_num_mc_samples ......... 10000
[2022-05-16 08:00:38.918010] min_phase_shift ............ 0
[2022-05-16 08:00:38.918016] min_var_reduction .......... 0.1
[2022-05-16 08:00:38.918022] min_variance ............... True
[2022-05-16 08:00:38.918027] model_budget_filepath ...... None
[2022-05-16 08:00:38.918034] num_beams .................. 0.0
[2022-05-16 08:00:38.918039] num_layers ................. 2
[2022-05-16 08:00:38.918045] num_mc_samples ............. 100
[2022-05-16 08:00:38.918050] num_workers ................ 0
[2022-05-16 08:00:38.918055] optimizer .................. adam
[2022-05-16 08:00:38.918061] proposal_func .............. <function lm_proposal at 0x7f0d5b25bc10>
[2022-05-16 08:00:38.918067] rnn_type ................... LSTM
[2022-05-16 08:00:38.918072] save_epochs ................ 1
[2022-05-16 08:00:38.918078] seed ....................... 42
[2022-05-16 08:00:38.918083] seq_len .................... 15
[2022-05-16 08:00:38.918088] shuffle .................... True
[2022-05-16 08:00:38.918094] store_intermediate_lbs ..... True
[2022-05-16 08:00:38.918100] sub_estimates .............. []
[2022-05-16 08:00:38.918105] terms_of_interest .......... []
[2022-05-16 08:00:38.918111] text_dict .................. None
[2022-05-16 08:00:38.918117] top_k ...................... 0
[2022-05-16 08:00:38.918129] top_p ...................... 0
[2022-05-16 08:00:38.918140] total_seq_len .............. 20
[2022-05-16 08:00:38.918152] train_data_pct ............. 0.9
[2022-05-16 08:00:38.918169] train_epochs ............... 40
[2022-05-16 08:00:38.918185] use_gpt2 ................... False
[2022-05-16 08:00:38.918201] val_data_pct ............... 0.0001
[2022-05-16 08:00:38.918227] val_metrics ................ ['accuracy']
[2022-05-16 08:00:38.918245] valid_epochs ............... 1
[2022-05-16 08:00:38.918264] variance_epsilon ........... 5e-06
[2022-05-16 08:00:38.918273] vocab_size ................. 30
[2022-05-16 08:00:38.918280] warmup_pct ................. 0.01
[2022-05-16 08:00:38.918285] weight_decay ............... 0.0
==================================================
[2022-05-16 08:00:38.919504] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-16 08:01:23.087143] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 7 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-16 08:02:14.756773] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 6 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
