==================================================
* Running for dataset moocs
==================================================
[2022-05-13 08:37:36.993042] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-13 08:37:37.000868] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-13 08:37:37.179602] batch_size ................. 4096
[2022-05-13 08:37:37.179631] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-13 08:37:37.179645] cuda ....................... True
[2022-05-13 08:37:37.179652] data_path .................. data/moocs/mooc.csv
[2022-05-13 08:37:37.179657] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:37:37.179665] device ..................... 5
[2022-05-13 08:37:37.179671] device_num ................. 0
[2022-05-13 08:37:37.179677] disable_tqdm ............... True
[2022-05-13 08:37:37.179682] do_test .................... False
[2022-05-13 08:37:37.179688] do_valid ................... True
[2022-05-13 08:37:37.179694] dont_print_args ............ True
[2022-05-13 08:37:37.179702] dont_shuffle ............... None
[2022-05-13 08:37:37.179716] dropout .................... 0.3
[2022-05-13 08:37:37.179725] estimate_type .............. <function beam_search_lower_bound at 0x7f876e9e9c10>
[2022-05-13 08:37:37.179736] excluded_terms ............. [1]
[2022-05-13 08:37:37.179743] finetune ................... False
[2022-05-13 08:37:37.179749] grad_clip .................. 1.0
[2022-05-13 08:37:37.179755] hidden_size ................ 128
[2022-05-13 08:37:37.179760] hist_len ................... 18
[2022-05-13 08:37:37.179768] interp_func ................ <function lin_interp at 0x7f876e9e9af0>
[2022-05-13 08:37:37.179774] log_interval ............... 100
[2022-05-13 08:37:37.179781] lr ......................... 0.001
[2022-05-13 08:37:37.179787] lr_decay_style ............. constant
[2022-05-13 08:37:37.179792] masked_lm .................. False
[2022-05-13 08:37:37.179798] max_num_mc_samples ......... 100000
[2022-05-13 08:37:37.179804] max_num_queries ............ 1000
[2022-05-13 08:37:37.179809] min_num_mc_samples ......... 10000
[2022-05-13 08:37:37.179815] min_phase_shift ............ 0
[2022-05-13 08:37:37.179821] min_var_reduction .......... 0.1
[2022-05-13 08:37:37.179827] min_variance ............... True
[2022-05-13 08:37:37.179832] model_budget_filepath ...... None
[2022-05-13 08:37:37.179838] needs_encoding ............. False
[2022-05-13 08:37:37.179844] num_beams .................. 0.0
[2022-05-13 08:37:37.179850] num_layers ................. 2
[2022-05-13 08:37:37.179855] num_mc_samples ............. 100
[2022-05-13 08:37:37.179861] num_workers ................ 0
[2022-05-13 08:37:37.179866] optimizer .................. adam
[2022-05-13 08:37:37.179872] proposal_func .............. <function lm_proposal at 0x7f876e9d7af0>
[2022-05-13 08:37:37.179878] rnn_type ................... LSTM
[2022-05-13 08:37:37.179883] save_epochs ................ 1
[2022-05-13 08:37:37.179888] seed ....................... 42
[2022-05-13 08:37:37.179894] seq_len .................... 15
[2022-05-13 08:37:37.179899] shuffle .................... True
[2022-05-13 08:37:37.179905] store_intermediate_lbs ..... True
[2022-05-13 08:37:37.179911] sub_estimates .............. []
[2022-05-13 08:37:37.179916] text_dict .................. None
[2022-05-13 08:37:37.179921] top_k ...................... 0
[2022-05-13 08:37:37.179927] top_p ...................... 0
[2022-05-13 08:37:37.179932] total_seq_len .............. 20
[2022-05-13 08:37:37.179938] train_data_pct ............. 0.9
[2022-05-13 08:37:37.179943] train_epochs ............... 40
[2022-05-13 08:37:37.179949] use_gpt2 ................... False
[2022-05-13 08:37:37.179954] val_data_pct ............... 0.01
[2022-05-13 08:37:37.179964] val_metrics ................ ['accuracy']
[2022-05-13 08:37:37.179969] valid_epochs ............... 1
[2022-05-13 08:37:37.179977] variance_epsilon ........... 5e-06
[2022-05-13 08:37:37.179983] vocab_size ................. 98
[2022-05-13 08:37:37.179989] warmup_pct ................. 0.01
[2022-05-13 08:37:37.179995] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_5h_15s_1000mc_1000q.pkl
[2022-05-13 08:37:37.180878] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_8h_15s_1000mc_1000q.pkl
[2022-05-13 08:41:53.642374] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-13 08:44:10.081208] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-13 08:45:57.656226] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-13 08:45:57.679353] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-13 08:45:58.452758] batch_size ................. 4096
[2022-05-13 08:45:58.452804] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-13 08:45:58.452814] cuda ....................... True
[2022-05-13 08:45:58.452820] data_path .................. data/apps/lsapp.tsv
[2022-05-13 08:45:58.452826] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:45:58.452834] device ..................... 5
[2022-05-13 08:45:58.452840] device_num ................. 0
[2022-05-13 08:45:58.452846] disable_tqdm ............... True
[2022-05-13 08:45:58.452862] do_test .................... False
[2022-05-13 08:45:58.452869] do_valid ................... True
[2022-05-13 08:45:58.452874] dont_print_args ............ True
[2022-05-13 08:45:58.452907] dont_shuffle ............... None
[2022-05-13 08:45:58.452924] dropout .................... 0.3
[2022-05-13 08:45:58.452935] estimate_type .............. <function beam_search_lower_bound at 0x7f876e9e9c10>
[2022-05-13 08:45:58.452946] excluded_terms ............. [1]
[2022-05-13 08:45:58.452956] finetune ................... False
[2022-05-13 08:45:58.452965] grad_clip .................. 1.0
[2022-05-13 08:45:58.452972] hidden_size ................ 512
[2022-05-13 08:45:58.452980] hist_len ................... 18
[2022-05-13 08:45:58.452989] interp_func ................ <function lin_interp at 0x7f876e9e9af0>
[2022-05-13 08:45:58.452996] log_interval ............... 100
[2022-05-13 08:45:58.453006] lr ......................... 0.001
[2022-05-13 08:45:58.453013] lr_decay_style ............. constant
[2022-05-13 08:45:58.453043] masked_lm .................. False
[2022-05-13 08:45:58.453050] max_num_mc_samples ......... 100000
[2022-05-13 08:45:58.453058] max_num_queries ............ 1000
[2022-05-13 08:45:58.453065] min_num_mc_samples ......... 10000
[2022-05-13 08:45:58.453072] min_phase_shift ............ 0
[2022-05-13 08:45:58.453082] min_var_reduction .......... 0.1
[2022-05-13 08:45:58.453090] min_variance ............... True
[2022-05-13 08:45:58.453097] model_budget_filepath ...... None
[2022-05-13 08:45:58.453105] needs_encoding ............. True
[2022-05-13 08:45:58.453113] num_beams .................. 0.0
[2022-05-13 08:45:58.453120] num_layers ................. 2
[2022-05-13 08:45:58.453133] num_mc_samples ............. 100
[2022-05-13 08:45:58.453140] num_workers ................ 0
[2022-05-13 08:45:58.453147] optimizer .................. adam
[2022-05-13 08:45:58.453155] proposal_func .............. <function lm_proposal at 0x7f876e9d7af0>
[2022-05-13 08:45:58.453162] rnn_type ................... LSTM
[2022-05-13 08:45:58.453169] save_epochs ................ 1
[2022-05-13 08:45:58.453177] seed ....................... 42
[2022-05-13 08:45:58.453194] seq_len .................... 15
[2022-05-13 08:45:58.453202] shuffle .................... True
[2022-05-13 08:45:58.453209] store_intermediate_lbs ..... True
[2022-05-13 08:45:58.453217] sub_estimates .............. []
[2022-05-13 08:45:58.453224] text_dict .................. None
[2022-05-13 08:45:58.453232] top_k ...................... 0
[2022-05-13 08:45:58.453239] top_p ...................... 0
[2022-05-13 08:45:58.453247] total_seq_len .............. 20
[2022-05-13 08:45:58.453255] train_data_pct ............. 0.9
[2022-05-13 08:45:58.453262] train_epochs ............... 40
[2022-05-13 08:45:58.453270] use_gpt2 ................... False
[2022-05-13 08:45:58.453278] val_data_pct ............... 0.001
[2022-05-13 08:45:58.453287] val_metrics ................ ['accuracy']
[2022-05-13 08:45:58.453294] valid_epochs ............... 1
[2022-05-13 08:45:58.453305] variance_epsilon ........... 5e-06
[2022-05-13 08:45:58.453314] vocab_size ................. 88
[2022-05-13 08:45:58.453323] warmup_pct ................. 0.01
[2022-05-13 08:45:58.453330] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_5h_15s_1000mc_1000q.pkl
[2022-05-13 08:45:58.459067] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_8h_15s_1000mc_1000q.pkl
[2022-05-13 08:50:58.162665] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-13 08:53:15.828762] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-13 08:55:27.599876] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-13 08:55:27.611407] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-13 08:55:27.850367] batch_size ................. 4096
[2022-05-13 08:55:27.850392] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-13 08:55:27.850398] cuda ....................... True
[2022-05-13 08:55:27.850402] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-13 08:55:27.850406] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:55:27.850411] device ..................... 5
[2022-05-13 08:55:27.850414] device_num ................. 0
[2022-05-13 08:55:27.850418] disable_tqdm ............... True
[2022-05-13 08:55:27.850422] do_test .................... False
[2022-05-13 08:55:27.850426] do_valid ................... True
[2022-05-13 08:55:27.850429] dont_print_args ............ True
[2022-05-13 08:55:27.850434] dont_shuffle ............... None
[2022-05-13 08:55:27.850441] dropout .................... 0.3
[2022-05-13 08:55:27.850447] estimate_type .............. <function beam_search_lower_bound at 0x7f876e9e9c10>
[2022-05-13 08:55:27.850462] excluded_terms ............. [1]
[2022-05-13 08:55:27.850468] finetune ................... False
[2022-05-13 08:55:27.850472] grad_clip .................. 1.0
[2022-05-13 08:55:27.850475] hidden_size ................ 512
[2022-05-13 08:55:27.850479] hist_len ................... 18
[2022-05-13 08:55:27.850509] interp_func ................ <function lin_interp at 0x7f876e9e9af0>
[2022-05-13 08:55:27.850513] log_interval ............... 100
[2022-05-13 08:55:27.850517] lr ......................... 0.001
[2022-05-13 08:55:27.850520] lr_decay_style ............. constant
[2022-05-13 08:55:27.850525] masked_lm .................. False
[2022-05-13 08:55:27.850529] max_num_mc_samples ......... 100000
[2022-05-13 08:55:27.850533] max_num_queries ............ 1000
[2022-05-13 08:55:27.850536] min_num_mc_samples ......... 10000
[2022-05-13 08:55:27.850540] min_phase_shift ............ 0
[2022-05-13 08:55:27.850545] min_var_reduction .......... 0.1
[2022-05-13 08:55:27.850549] min_variance ............... True
[2022-05-13 08:55:27.850553] model_budget_filepath ...... None
[2022-05-13 08:55:27.850556] num_beams .................. 0.0
[2022-05-13 08:55:27.850560] num_layers ................. 2
[2022-05-13 08:55:27.850563] num_mc_samples ............. 100
[2022-05-13 08:55:27.850568] num_workers ................ 0
[2022-05-13 08:55:27.850571] optimizer .................. adam
[2022-05-13 08:55:27.850575] proposal_func .............. <function lm_proposal at 0x7f876e9d7af0>
[2022-05-13 08:55:27.850578] rnn_type ................... LSTM
[2022-05-13 08:55:27.850582] save_epochs ................ 1
[2022-05-13 08:55:27.850585] seed ....................... 42
[2022-05-13 08:55:27.850588] seq_len .................... 15
[2022-05-13 08:55:27.850593] shuffle .................... True
[2022-05-13 08:55:27.850596] store_intermediate_lbs ..... True
[2022-05-13 08:55:27.850600] sub_estimates .............. []
[2022-05-13 08:55:27.850604] text_dict .................. None
[2022-05-13 08:55:27.850608] top_k ...................... 0
[2022-05-13 08:55:27.850611] top_p ...................... 0
[2022-05-13 08:55:27.850614] total_seq_len .............. 20
[2022-05-13 08:55:27.850619] train_data_pct ............. 0.9
[2022-05-13 08:55:27.850623] train_epochs ............... 40
[2022-05-13 08:55:27.850626] use_gpt2 ................... False
[2022-05-13 08:55:27.850630] val_data_pct ............... 0.0001
[2022-05-13 08:55:27.850634] val_metrics ................ ['accuracy']
[2022-05-13 08:55:27.850638] valid_epochs ............... 1
[2022-05-13 08:55:27.850643] variance_epsilon ........... 5e-06
[2022-05-13 08:55:27.850646] vocab_size ................. 30
[2022-05-13 08:55:27.850651] warmup_pct ................. 0.01
[2022-05-13 08:55:27.850655] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_5h_15s_1000mc_1000q.pkl
[2022-05-13 08:55:27.850903] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_8h_15s_1000mc_1000q.pkl
[2022-05-13 08:56:31.125733] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-13 08:57:15.796907] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
