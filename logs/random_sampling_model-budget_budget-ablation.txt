==================================================
* Running for dataset shakespeare
==================================================
[2022-05-20 19:54:06.868761] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-20 19:54:06.872369] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-20 19:54:06.875037] batch_size ................. 8000
[2022-05-20 19:54:06.875056] bs_ablation ................ False
[2022-05-20 19:54:06.875063] bs_ablation_max_beams ...... 10000
[2022-05-20 19:54:06.875069] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-20 19:54:06.875076] cuda ....................... True
[2022-05-20 19:54:06.875081] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-20 19:54:06.875087] dataset .................... shakespeare
[2022-05-20 19:54:06.875093] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 19:54:06.875099] device ..................... 2
[2022-05-20 19:54:06.875105] device_num ................. 0
[2022-05-20 19:54:06.875110] disable_tqdm ............... True
[2022-05-20 19:54:06.875116] do_test .................... False
[2022-05-20 19:54:06.875122] do_valid ................... True
[2022-05-20 19:54:06.875128] dont_print_args ............ True
[2022-05-20 19:54:06.875135] dont_shuffle ............... None
[2022-05-20 19:54:06.875147] dropout .................... 0.3
[2022-05-20 19:54:06.875155] estimate_type .............. <function beam_search_lower_bound at 0x7fe730279dc0>
[2022-05-20 19:54:06.875164] excluded_terms ............. [1]
[2022-05-20 19:54:06.875170] excluded_terms_list ........ [[]]
[2022-05-20 19:54:06.875176] finetune ................... False
[2022-05-20 19:54:06.875182] frequentist_test ........... False
[2022-05-20 19:54:06.875188] grad_clip .................. 1.0
[2022-05-20 19:54:06.875194] hidden_size ................ 128
[2022-05-20 19:54:06.875200] hist_len ................... 18
[2022-05-20 19:54:06.875206] hybrid_max_num_beams ....... 1500
[2022-05-20 19:54:06.875212] interp_func ................ <function lin_interp at 0x7fe730279ca0>
[2022-05-20 19:54:06.875218] log_interval ............... 100
[2022-05-20 19:54:06.875225] lr ......................... 0.001
[2022-05-20 19:54:06.875230] lr_decay_style ............. constant
[2022-05-20 19:54:06.875236] masked_lm .................. False
[2022-05-20 19:54:06.875242] max_k ...................... None
[2022-05-20 19:54:06.875247] max_num_mc_samples ......... 100000
[2022-05-20 19:54:06.875253] max_num_queries ............ 1000
[2022-05-20 19:54:06.875258] min_num_mc_samples ......... 10000
[2022-05-20 19:54:06.875264] min_phase_shift ............ 0
[2022-05-20 19:54:06.875270] min_var_reduction .......... 0.1
[2022-05-20 19:54:06.875276] min_variance ............... True
[2022-05-20 19:54:06.875282] model_budget_filepath ...... None
[2022-05-20 19:54:06.875288] needs_dl ................... True
[2022-05-20 19:54:06.875294] num_beams .................. 0.0
[2022-05-20 19:54:06.875299] num_layers ................. 2
[2022-05-20 19:54:06.875305] num_mc_samples ............. 100
[2022-05-20 19:54:06.875310] num_workers ................ 0
[2022-05-20 19:54:06.875316] optimizer .................. adam
[2022-05-20 19:54:06.875322] proposal_func .............. <function lm_proposal at 0x7fe730266ca0>
[2022-05-20 19:54:06.875327] rnn_type ................... LSTM
[2022-05-20 19:54:06.875333] save_epochs ................ 1
[2022-05-20 19:54:06.875339] seed ....................... 42
[2022-05-20 19:54:06.875345] seq_len .................... 100
[2022-05-20 19:54:06.875351] shuffle .................... True
[2022-05-20 19:54:06.875356] store_intermediate_lbs ..... True
[2022-05-20 19:54:06.875362] sub_estimates .............. []
[2022-05-20 19:54:06.875368] tau_a_excl_terms ........... []
[2022-05-20 19:54:06.875373] tau_b_excl_terms ........... []
[2022-05-20 19:54:06.875379] terms_of_interest .......... []
[2022-05-20 19:54:06.875384] text_dict .................. None
[2022-05-20 19:54:06.875390] top_k ...................... 0
[2022-05-20 19:54:06.875395] top_p ...................... 0
[2022-05-20 19:54:06.875401] total_seq_len .............. 20
[2022-05-20 19:54:06.875407] train_data_pct ............. 0.9
[2022-05-20 19:54:06.875412] train_epochs ............... 40
[2022-05-20 19:54:06.875418] use_gpt2 ................... False
[2022-05-20 19:54:06.875424] val_data_pct ............... 0.05
[2022-05-20 19:54:06.875431] val_metrics ................ ['accuracy']
[2022-05-20 19:54:06.875436] valid_epochs ............... 1
[2022-05-20 19:54:06.875444] variance_epsilon ........... 5e-06
[2022-05-20 19:54:06.875450] vocab_size ................. 68
[2022-05-20 19:54:06.875456] warmup_pct ................. 0.01
[2022-05-20 19:54:06.875461] weight_decay ............... 0.0
==================================================
[2022-05-20 19:54:06.876013] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 10000 | Hist length 10 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-20 19:55:22.603640] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 10000 | Hist length 14 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-20 19:56:03.673499] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 10000 | Hist length 18 | Total Seq Length 20

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-20 19:57:41.393794] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-20 19:57:41.404318] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-20 19:57:41.553026] batch_size ................. 8000
[2022-05-20 19:57:41.553050] bs_ablation ................ False
[2022-05-20 19:57:41.553054] bs_ablation_max_beams ...... 10000
[2022-05-20 19:57:41.553057] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-20 19:57:41.553060] cuda ....................... True
[2022-05-20 19:57:41.553063] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-20 19:57:41.553066] dataset .................... amazon
[2022-05-20 19:57:41.553069] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 19:57:41.553073] device ..................... 2
[2022-05-20 19:57:41.553076] device_num ................. 0
[2022-05-20 19:57:41.553078] disable_tqdm ............... True
[2022-05-20 19:57:41.553082] do_test .................... False
[2022-05-20 19:57:41.553084] do_valid ................... True
[2022-05-20 19:57:41.553087] dont_print_args ............ True
[2022-05-20 19:57:41.553090] dont_shuffle ............... None
[2022-05-20 19:57:41.553099] dropout .................... 0.3
[2022-05-20 19:57:41.553104] estimate_type .............. <function beam_search_lower_bound at 0x7fe730279dc0>
[2022-05-20 19:57:41.553111] excluded_terms ............. [1]
[2022-05-20 19:57:41.553115] excluded_terms_list ........ [[]]
[2022-05-20 19:57:41.553118] finetune ................... False
[2022-05-20 19:57:41.553120] frequentist_test ........... False
[2022-05-20 19:57:41.553124] grad_clip .................. 1.0
[2022-05-20 19:57:41.553126] hidden_size ................ 512
[2022-05-20 19:57:41.553129] hist_len ................... 18
[2022-05-20 19:57:41.553132] hybrid_max_num_beams ....... 1500
[2022-05-20 19:57:41.553135] interp_func ................ <function lin_interp at 0x7fe730279ca0>
[2022-05-20 19:57:41.553138] log_interval ............... 100
[2022-05-20 19:57:41.553141] lr ......................... 0.001
[2022-05-20 19:57:41.553145] lr_decay_style ............. constant
[2022-05-20 19:57:41.553148] masked_lm .................. False
[2022-05-20 19:57:41.553151] max_k ...................... None
[2022-05-20 19:57:41.553153] max_num_mc_samples ......... 100000
[2022-05-20 19:57:41.553156] max_num_queries ............ 1000
[2022-05-20 19:57:41.553159] min_num_mc_samples ......... 10000
[2022-05-20 19:57:41.553161] min_phase_shift ............ 0
[2022-05-20 19:57:41.553164] min_var_reduction .......... 0.1
[2022-05-20 19:57:41.553167] min_variance ............... True
[2022-05-20 19:57:41.553170] model_budget_filepath ...... None
[2022-05-20 19:57:41.553172] needs_dl ................... True
[2022-05-20 19:57:41.553175] num_beams .................. 0.0
[2022-05-20 19:57:41.553178] num_layers ................. 2
[2022-05-20 19:57:41.553181] num_mc_samples ............. 100
[2022-05-20 19:57:41.553183] num_workers ................ 0
[2022-05-20 19:57:41.553186] optimizer .................. adam
[2022-05-20 19:57:41.553189] proposal_func .............. <function lm_proposal at 0x7fe730266ca0>
[2022-05-20 19:57:41.553192] rnn_type ................... LSTM
[2022-05-20 19:57:41.553194] save_epochs ................ 1
[2022-05-20 19:57:41.553197] seed ....................... 42
[2022-05-20 19:57:41.553200] seq_len .................... 15
[2022-05-20 19:57:41.553202] shuffle .................... True
[2022-05-20 19:57:41.553205] store_intermediate_lbs ..... True
[2022-05-20 19:57:41.553207] sub_estimates .............. []
[2022-05-20 19:57:41.553210] tau_a_excl_terms ........... []
[2022-05-20 19:57:41.553212] tau_b_excl_terms ........... []
[2022-05-20 19:57:41.553215] terms_of_interest .......... []
[2022-05-20 19:57:41.553218] text_dict .................. None
[2022-05-20 19:57:41.553220] top_k ...................... 0
[2022-05-20 19:57:41.553223] top_p ...................... 0
[2022-05-20 19:57:41.553225] total_seq_len .............. 20
[2022-05-20 19:57:41.553228] train_data_pct ............. 0.9
[2022-05-20 19:57:41.553231] train_epochs ............... 40
[2022-05-20 19:57:41.553233] use_gpt2 ................... False
[2022-05-20 19:57:41.553236] val_data_pct ............... 0.0001
[2022-05-20 19:57:41.553240] val_metrics ................ ['accuracy']
[2022-05-20 19:57:41.553242] valid_epochs ............... 1
[2022-05-20 19:57:41.553247] variance_epsilon ........... 5e-06
[2022-05-20 19:57:41.553250] vocab_size ................. 30
[2022-05-20 19:57:41.553253] warmup_pct ................. 0.01
[2022-05-20 19:57:41.553255] weight_decay ............... 0.0
==================================================
[2022-05-20 19:57:41.555020] | Dataset: amazon | Sample type: random_sampling | Num samples: 10000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-20 19:59:38.147723] | Dataset: amazon | Sample type: random_sampling | Num samples: 10000 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-20 20:01:28.626380] | Dataset: amazon | Sample type: random_sampling | Num samples: 10000 | Hist length 13 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-20 20:03:42.252217] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-20 20:03:42.261134] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-20 20:03:42.561777] batch_size ................. 8000
[2022-05-20 20:03:42.561804] bs_ablation ................ False
[2022-05-20 20:03:42.561809] bs_ablation_max_beams ...... 10000
[2022-05-20 20:03:42.561813] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-20 20:03:42.561817] cuda ....................... True
[2022-05-20 20:03:42.561821] data_path .................. data/apps/lsapp.tsv
[2022-05-20 20:03:42.561824] dataset .................... apps
[2022-05-20 20:03:42.561828] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 20:03:42.561832] device ..................... 2
[2022-05-20 20:03:42.561836] device_num ................. 0
[2022-05-20 20:03:42.561839] disable_tqdm ............... True
[2022-05-20 20:03:42.561845] do_test .................... False
[2022-05-20 20:03:42.561849] do_valid ................... True
[2022-05-20 20:03:42.561852] dont_print_args ............ True
[2022-05-20 20:03:42.561856] dont_shuffle ............... None
[2022-05-20 20:03:42.561889] dropout .................... 0.3
[2022-05-20 20:03:42.561895] estimate_type .............. <function beam_search_lower_bound at 0x7fe730279dc0>
[2022-05-20 20:03:42.561901] excluded_terms ............. [1]
[2022-05-20 20:03:42.561906] excluded_terms_list ........ [[]]
[2022-05-20 20:03:42.561910] finetune ................... False
[2022-05-20 20:03:42.561913] frequentist_test ........... False
[2022-05-20 20:03:42.561917] grad_clip .................. 1.0
[2022-05-20 20:03:42.561921] hidden_size ................ 512
[2022-05-20 20:03:42.561931] hist_len ................... 18
[2022-05-20 20:03:42.561934] hybrid_max_num_beams ....... 1500
[2022-05-20 20:03:42.561938] interp_func ................ <function lin_interp at 0x7fe730279ca0>
[2022-05-20 20:03:42.561941] log_interval ............... 100
[2022-05-20 20:03:42.561946] lr ......................... 0.001
[2022-05-20 20:03:42.561949] lr_decay_style ............. constant
[2022-05-20 20:03:42.561953] masked_lm .................. False
[2022-05-20 20:03:42.561956] max_k ...................... None
[2022-05-20 20:03:42.561960] max_num_mc_samples ......... 100000
[2022-05-20 20:03:42.561963] max_num_queries ............ 1000
[2022-05-20 20:03:42.561967] min_num_mc_samples ......... 10000
[2022-05-20 20:03:42.561971] min_phase_shift ............ 0
[2022-05-20 20:03:42.561975] min_var_reduction .......... 0.1
[2022-05-20 20:03:42.561978] min_variance ............... True
[2022-05-20 20:03:42.561981] model_budget_filepath ...... None
[2022-05-20 20:03:42.561985] needs_dl ................... True
[2022-05-20 20:03:42.561988] needs_encoding ............. True
[2022-05-20 20:03:42.561992] num_beams .................. 0.0
[2022-05-20 20:03:42.561996] num_layers ................. 2
[2022-05-20 20:03:42.562000] num_mc_samples ............. 100
[2022-05-20 20:03:42.562003] num_workers ................ 0
[2022-05-20 20:03:42.562006] optimizer .................. adam
[2022-05-20 20:03:42.562010] proposal_func .............. <function lm_proposal at 0x7fe730266ca0>
[2022-05-20 20:03:42.562013] rnn_type ................... LSTM
[2022-05-20 20:03:42.562017] save_epochs ................ 1
[2022-05-20 20:03:42.562021] seed ....................... 42
[2022-05-20 20:03:42.562024] seq_len .................... 15
[2022-05-20 20:03:42.562028] shuffle .................... True
[2022-05-20 20:03:42.562031] store_intermediate_lbs ..... True
[2022-05-20 20:03:42.562034] sub_estimates .............. []
[2022-05-20 20:03:42.562038] tau_a_excl_terms ........... []
[2022-05-20 20:03:42.562041] tau_b_excl_terms ........... []
[2022-05-20 20:03:42.562044] terms_of_interest .......... []
[2022-05-20 20:03:42.562049] text_dict .................. None
[2022-05-20 20:03:42.562052] top_k ...................... 0
[2022-05-20 20:03:42.562055] top_p ...................... 0
[2022-05-20 20:03:42.562059] total_seq_len .............. 20
[2022-05-20 20:03:42.562063] train_data_pct ............. 0.9
[2022-05-20 20:03:42.562066] train_epochs ............... 40
[2022-05-20 20:03:42.562069] use_gpt2 ................... False
[2022-05-20 20:03:42.562073] val_data_pct ............... 0.001
[2022-05-20 20:03:42.562077] val_metrics ................ ['accuracy']
[2022-05-20 20:03:42.562082] valid_epochs ............... 1
[2022-05-20 20:03:42.562087] variance_epsilon ........... 5e-06
[2022-05-20 20:03:42.562091] vocab_size ................. 88
[2022-05-20 20:03:42.562095] warmup_pct ................. 0.01
[2022-05-20 20:03:42.562098] weight_decay ............... 0.0
==================================================
[2022-05-20 20:03:42.563466] | Dataset: apps | Sample type: random_sampling | Num samples: 10000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-20 20:05:59.533835] | Dataset: apps | Sample type: random_sampling | Num samples: 10000 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-20 20:08:15.268221] | Dataset: apps | Sample type: random_sampling | Num samples: 10000 | Hist length 13 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-20 20:10:26.415908] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-20 20:10:26.419227] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-20 20:10:26.488141] batch_size ................. 8000
[2022-05-20 20:10:26.488161] bs_ablation ................ False
[2022-05-20 20:10:26.488167] bs_ablation_max_beams ...... 10000
[2022-05-20 20:10:26.488173] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-20 20:10:26.488179] cuda ....................... True
[2022-05-20 20:10:26.488185] data_path .................. data/moocs/mooc.csv
[2022-05-20 20:10:26.488190] dataset .................... moocs
[2022-05-20 20:10:26.488196] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 20:10:26.488202] device ..................... 2
[2022-05-20 20:10:26.488207] device_num ................. 0
[2022-05-20 20:10:26.488213] disable_tqdm ............... True
[2022-05-20 20:10:26.488219] do_test .................... False
[2022-05-20 20:10:26.488225] do_valid ................... True
[2022-05-20 20:10:26.488230] dont_print_args ............ True
[2022-05-20 20:10:26.488236] dont_shuffle ............... None
[2022-05-20 20:10:26.488266] dropout .................... 0.3
[2022-05-20 20:10:26.488274] estimate_type .............. <function beam_search_lower_bound at 0x7fe730279dc0>
[2022-05-20 20:10:26.488282] excluded_terms ............. [1]
[2022-05-20 20:10:26.488289] excluded_terms_list ........ [[]]
[2022-05-20 20:10:26.488295] finetune ................... False
[2022-05-20 20:10:26.488301] frequentist_test ........... False
[2022-05-20 20:10:26.488308] grad_clip .................. 1.0
[2022-05-20 20:10:26.488313] hidden_size ................ 128
[2022-05-20 20:10:26.488319] hist_len ................... 18
[2022-05-20 20:10:26.488325] hybrid_max_num_beams ....... 1500
[2022-05-20 20:10:26.488332] interp_func ................ <function lin_interp at 0x7fe730279ca0>
[2022-05-20 20:10:26.488337] log_interval ............... 100
[2022-05-20 20:10:26.488344] lr ......................... 0.001
[2022-05-20 20:10:26.488350] lr_decay_style ............. constant
[2022-05-20 20:10:26.488356] masked_lm .................. False
[2022-05-20 20:10:26.488362] max_k ...................... None
[2022-05-20 20:10:26.488367] max_num_mc_samples ......... 100000
[2022-05-20 20:10:26.488373] max_num_queries ............ 1000
[2022-05-20 20:10:26.488378] min_num_mc_samples ......... 10000
[2022-05-20 20:10:26.488384] min_phase_shift ............ 0
[2022-05-20 20:10:26.488390] min_var_reduction .......... 0.1
[2022-05-20 20:10:26.488395] min_variance ............... True
[2022-05-20 20:10:26.488401] model_budget_filepath ...... None
[2022-05-20 20:10:26.488407] needs_dl ................... True
[2022-05-20 20:10:26.488412] needs_encoding ............. False
[2022-05-20 20:10:26.488418] num_beams .................. 0.0
[2022-05-20 20:10:26.488425] num_layers ................. 2
[2022-05-20 20:10:26.488430] num_mc_samples ............. 100
[2022-05-20 20:10:26.488435] num_workers ................ 0
[2022-05-20 20:10:26.488441] optimizer .................. adam
[2022-05-20 20:10:26.488447] proposal_func .............. <function lm_proposal at 0x7fe730266ca0>
[2022-05-20 20:10:26.488452] rnn_type ................... LSTM
[2022-05-20 20:10:26.488458] save_epochs ................ 1
[2022-05-20 20:10:26.488464] seed ....................... 42
[2022-05-20 20:10:26.488469] seq_len .................... 15
[2022-05-20 20:10:26.488475] shuffle .................... True
[2022-05-20 20:10:26.488480] store_intermediate_lbs ..... True
[2022-05-20 20:10:26.488486] sub_estimates .............. []
[2022-05-20 20:10:26.488492] tau_a_excl_terms ........... []
[2022-05-20 20:10:26.488497] tau_b_excl_terms ........... []
[2022-05-20 20:10:26.488503] terms_of_interest .......... []
[2022-05-20 20:10:26.488509] text_dict .................. None
[2022-05-20 20:10:26.488514] top_k ...................... 0
[2022-05-20 20:10:26.488519] top_p ...................... 0
[2022-05-20 20:10:26.488525] total_seq_len .............. 20
[2022-05-20 20:10:26.488531] train_data_pct ............. 0.9
[2022-05-20 20:10:26.488536] train_epochs ............... 40
[2022-05-20 20:10:26.488542] use_gpt2 ................... False
[2022-05-20 20:10:26.488548] val_data_pct ............... 0.01
[2022-05-20 20:10:26.488555] val_metrics ................ ['accuracy']
[2022-05-20 20:10:26.488561] valid_epochs ............... 1
[2022-05-20 20:10:26.488570] variance_epsilon ........... 5e-06
[2022-05-20 20:10:26.488575] vocab_size ................. 98
[2022-05-20 20:10:26.488581] warmup_pct ................. 0.01
[2022-05-20 20:10:26.488587] weight_decay ............... 0.0
==================================================
[2022-05-20 20:10:26.490158] | Dataset: moocs | Sample type: random_sampling | Num samples: 10000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-20 20:11:34.661883] | Dataset: moocs | Sample type: random_sampling | Num samples: 10000 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-20 20:12:16.550780] | Dataset: moocs | Sample type: random_sampling | Num samples: 10000 | Hist length 13 | Total Seq Length 15

....................................................................................................
==================================================
