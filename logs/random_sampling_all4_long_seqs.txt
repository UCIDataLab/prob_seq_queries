==================================================
* Running for dataset amazon
==================================================
[2022-05-13 08:36:02.334143] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-13 08:36:02.379346] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-13 08:36:02.670821] batch_size ................. 4096
[2022-05-13 08:36:02.670852] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-13 08:36:02.670870] cuda ....................... True
[2022-05-13 08:36:02.670877] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-13 08:36:02.670882] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:36:02.670889] device ..................... 4
[2022-05-13 08:36:02.670895] device_num ................. 0
[2022-05-13 08:36:02.670900] disable_tqdm ............... True
[2022-05-13 08:36:02.670906] do_test .................... False
[2022-05-13 08:36:02.670912] do_valid ................... True
[2022-05-13 08:36:02.670919] dont_print_args ............ True
[2022-05-13 08:36:02.670933] dont_shuffle ............... None
[2022-05-13 08:36:02.670945] dropout .................... 0.3
[2022-05-13 08:36:02.670957] estimate_type .............. <function beam_search_lower_bound at 0x7f59d1f91a60>
[2022-05-13 08:36:02.670966] excluded_terms ............. [1]
[2022-05-13 08:36:02.670974] finetune ................... False
[2022-05-13 08:36:02.670981] grad_clip .................. 1.0
[2022-05-13 08:36:02.670986] hidden_size ................ 512
[2022-05-13 08:36:02.670992] hist_len ................... 18
[2022-05-13 08:36:02.670999] interp_func ................ <function lin_interp at 0x7f59d1f91940>
[2022-05-13 08:36:02.671004] log_interval ............... 100
[2022-05-13 08:36:02.671011] lr ......................... 0.001
[2022-05-13 08:36:02.671016] lr_decay_style ............. constant
[2022-05-13 08:36:02.671022] masked_lm .................. False
[2022-05-13 08:36:02.671028] max_num_mc_samples ......... 100000
[2022-05-13 08:36:02.671033] max_num_queries ............ 1000
[2022-05-13 08:36:02.671039] min_num_mc_samples ......... 10000
[2022-05-13 08:36:02.671044] min_phase_shift ............ 0
[2022-05-13 08:36:02.671050] min_var_reduction .......... 0.1
[2022-05-13 08:36:02.671056] min_variance ............... True
[2022-05-13 08:36:02.671062] model_budget_filepath ...... None
[2022-05-13 08:36:02.671068] num_beams .................. 0.0
[2022-05-13 08:36:02.671076] num_layers ................. 2
[2022-05-13 08:36:02.671081] num_mc_samples ............. 100
[2022-05-13 08:36:02.671087] num_workers ................ 0
[2022-05-13 08:36:02.671093] optimizer .................. adam
[2022-05-13 08:36:02.671099] proposal_func .............. <function lm_proposal at 0x7f59d1f7c940>
[2022-05-13 08:36:02.671104] rnn_type ................... LSTM
[2022-05-13 08:36:02.671110] save_epochs ................ 1
[2022-05-13 08:36:02.671115] seed ....................... 42
[2022-05-13 08:36:02.671120] seq_len .................... 15
[2022-05-13 08:36:02.671126] shuffle .................... True
[2022-05-13 08:36:02.671132] store_intermediate_lbs ..... True
[2022-05-13 08:36:02.671138] sub_estimates .............. []
[2022-05-13 08:36:02.671143] text_dict .................. None
[2022-05-13 08:36:02.671149] top_k ...................... 0
[2022-05-13 08:36:02.671154] top_p ...................... 0
[2022-05-13 08:36:02.671159] total_seq_len .............. 20
[2022-05-13 08:36:02.671166] train_data_pct ............. 0.9
[2022-05-13 08:36:02.671171] train_epochs ............... 40
[2022-05-13 08:36:02.671177] use_gpt2 ................... False
[2022-05-13 08:36:02.671184] val_data_pct ............... 0.0001
[2022-05-13 08:36:02.671191] val_metrics ................ ['accuracy']
[2022-05-13 08:36:02.671197] valid_epochs ............... 1
[2022-05-13 08:36:02.671205] variance_epsilon ........... 5e-06
[2022-05-13 08:36:02.671210] vocab_size ................. 30
[2022-05-13 08:36:02.671216] warmup_pct ................. 0.01
[2022-05-13 08:36:02.671222] weight_decay ............... 0.0
==================================================
[2022-05-13 08:36:02.680511] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-13 08:36:23.757027] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-13 08:36:51.785263] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-13 08:38:19.766397] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-13 08:38:19.792872] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-13 08:38:20.589935] batch_size ................. 4096
[2022-05-13 08:38:20.589963] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-13 08:38:20.589971] cuda ....................... True
[2022-05-13 08:38:20.589977] data_path .................. data/apps/lsapp.tsv
[2022-05-13 08:38:20.589983] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:38:20.589989] device ..................... 4
[2022-05-13 08:38:20.589995] device_num ................. 0
[2022-05-13 08:38:20.590001] disable_tqdm ............... True
[2022-05-13 08:38:20.590009] do_test .................... False
[2022-05-13 08:38:20.590015] do_valid ................... True
[2022-05-13 08:38:20.590021] dont_print_args ............ True
[2022-05-13 08:38:20.590028] dont_shuffle ............... None
[2022-05-13 08:38:20.590039] dropout .................... 0.3
[2022-05-13 08:38:20.590047] estimate_type .............. <function beam_search_lower_bound at 0x7f59d1f91a60>
[2022-05-13 08:38:20.590056] excluded_terms ............. [1]
[2022-05-13 08:38:20.590063] finetune ................... False
[2022-05-13 08:38:20.590070] grad_clip .................. 1.0
[2022-05-13 08:38:20.590075] hidden_size ................ 512
[2022-05-13 08:38:20.590081] hist_len ................... 18
[2022-05-13 08:38:20.590088] interp_func ................ <function lin_interp at 0x7f59d1f91940>
[2022-05-13 08:38:20.590093] log_interval ............... 100
[2022-05-13 08:38:20.590100] lr ......................... 0.001
[2022-05-13 08:38:20.590106] lr_decay_style ............. constant
[2022-05-13 08:38:20.590113] masked_lm .................. False
[2022-05-13 08:38:20.590118] max_num_mc_samples ......... 100000
[2022-05-13 08:38:20.590124] max_num_queries ............ 1000
[2022-05-13 08:38:20.590130] min_num_mc_samples ......... 10000
[2022-05-13 08:38:20.590135] min_phase_shift ............ 0
[2022-05-13 08:38:20.590146] min_var_reduction .......... 0.1
[2022-05-13 08:38:20.590152] min_variance ............... True
[2022-05-13 08:38:20.590158] model_budget_filepath ...... None
[2022-05-13 08:38:20.590164] needs_encoding ............. True
[2022-05-13 08:38:20.590171] num_beams .................. 0.0
[2022-05-13 08:38:20.590176] num_layers ................. 2
[2022-05-13 08:38:20.590182] num_mc_samples ............. 100
[2022-05-13 08:38:20.590188] num_workers ................ 0
[2022-05-13 08:38:20.590193] optimizer .................. adam
[2022-05-13 08:38:20.590200] proposal_func .............. <function lm_proposal at 0x7f59d1f7c940>
[2022-05-13 08:38:20.590205] rnn_type ................... LSTM
[2022-05-13 08:38:20.590210] save_epochs ................ 1
[2022-05-13 08:38:20.590216] seed ....................... 42
[2022-05-13 08:38:20.590222] seq_len .................... 15
[2022-05-13 08:38:20.590228] shuffle .................... True
[2022-05-13 08:38:20.590233] store_intermediate_lbs ..... True
[2022-05-13 08:38:20.590239] sub_estimates .............. []
[2022-05-13 08:38:20.590245] text_dict .................. None
[2022-05-13 08:38:20.590251] top_k ...................... 0
[2022-05-13 08:38:20.590256] top_p ...................... 0
[2022-05-13 08:38:20.590262] total_seq_len .............. 20
[2022-05-13 08:38:20.590268] train_data_pct ............. 0.9
[2022-05-13 08:38:20.590274] train_epochs ............... 40
[2022-05-13 08:38:20.590280] use_gpt2 ................... False
[2022-05-13 08:38:20.590286] val_data_pct ............... 0.001
[2022-05-13 08:38:20.590292] val_metrics ................ ['accuracy']
[2022-05-13 08:38:20.590298] valid_epochs ............... 1
[2022-05-13 08:38:20.590306] variance_epsilon ........... 5e-06
[2022-05-13 08:38:20.590312] vocab_size ................. 88
[2022-05-13 08:38:20.590318] warmup_pct ................. 0.01
[2022-05-13 08:38:20.590324] weight_decay ............... 0.0
==================================================
[2022-05-13 08:38:20.590949] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-13 08:39:02.226837] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-13 08:39:55.211770] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-13 08:40:56.833735] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-13 08:40:56.837611] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-13 08:40:56.995293] batch_size ................. 4096
[2022-05-13 08:40:56.995326] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-13 08:40:56.995335] cuda ....................... True
[2022-05-13 08:40:56.995341] data_path .................. data/moocs/mooc.csv
[2022-05-13 08:40:56.995347] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:40:56.995354] device ..................... 4
[2022-05-13 08:40:56.995359] device_num ................. 0
[2022-05-13 08:40:56.995365] disable_tqdm ............... True
[2022-05-13 08:40:56.995371] do_test .................... False
[2022-05-13 08:40:56.995377] do_valid ................... True
[2022-05-13 08:40:56.995383] dont_print_args ............ True
[2022-05-13 08:40:56.995390] dont_shuffle ............... None
[2022-05-13 08:40:56.995402] dropout .................... 0.3
[2022-05-13 08:40:56.995411] estimate_type .............. <function beam_search_lower_bound at 0x7f59d1f91a60>
[2022-05-13 08:40:56.995421] excluded_terms ............. [1]
[2022-05-13 08:40:56.995448] finetune ................... False
[2022-05-13 08:40:56.995455] grad_clip .................. 1.0
[2022-05-13 08:40:56.995460] hidden_size ................ 128
[2022-05-13 08:40:56.995466] hist_len ................... 18
[2022-05-13 08:40:56.995473] interp_func ................ <function lin_interp at 0x7f59d1f91940>
[2022-05-13 08:40:56.995479] log_interval ............... 100
[2022-05-13 08:40:56.995486] lr ......................... 0.001
[2022-05-13 08:40:56.995491] lr_decay_style ............. constant
[2022-05-13 08:40:56.995507] masked_lm .................. False
[2022-05-13 08:40:56.995512] max_num_mc_samples ......... 100000
[2022-05-13 08:40:56.995517] max_num_queries ............ 1000
[2022-05-13 08:40:56.995523] min_num_mc_samples ......... 10000
[2022-05-13 08:40:56.995528] min_phase_shift ............ 0
[2022-05-13 08:40:56.995535] min_var_reduction .......... 0.1
[2022-05-13 08:40:56.995541] min_variance ............... True
[2022-05-13 08:40:56.995548] model_budget_filepath ...... None
[2022-05-13 08:40:56.995554] needs_encoding ............. False
[2022-05-13 08:40:56.995560] num_beams .................. 0.0
[2022-05-13 08:40:56.995575] num_layers ................. 2
[2022-05-13 08:40:56.995582] num_mc_samples ............. 100
[2022-05-13 08:40:56.995587] num_workers ................ 0
[2022-05-13 08:40:56.995593] optimizer .................. adam
[2022-05-13 08:40:56.995599] proposal_func .............. <function lm_proposal at 0x7f59d1f7c940>
[2022-05-13 08:40:56.995604] rnn_type ................... LSTM
[2022-05-13 08:40:56.995610] save_epochs ................ 1
[2022-05-13 08:40:56.995615] seed ....................... 42
[2022-05-13 08:40:56.995621] seq_len .................... 15
[2022-05-13 08:40:56.995627] shuffle .................... True
[2022-05-13 08:40:56.995632] store_intermediate_lbs ..... True
[2022-05-13 08:40:56.995638] sub_estimates .............. []
[2022-05-13 08:40:56.995644] text_dict .................. None
[2022-05-13 08:40:56.995650] top_k ...................... 0
[2022-05-13 08:40:56.995655] top_p ...................... 0
[2022-05-13 08:40:56.995662] total_seq_len .............. 20
[2022-05-13 08:40:56.995668] train_data_pct ............. 0.9
[2022-05-13 08:40:56.995673] train_epochs ............... 40
[2022-05-13 08:40:56.995679] use_gpt2 ................... False
[2022-05-13 08:40:56.995685] val_data_pct ............... 0.01
[2022-05-13 08:40:56.995692] val_metrics ................ ['accuracy']
[2022-05-13 08:40:56.995697] valid_epochs ............... 1
[2022-05-13 08:40:56.995705] variance_epsilon ........... 5e-06
[2022-05-13 08:40:56.995712] vocab_size ................. 98
[2022-05-13 08:40:56.995718] warmup_pct ................. 0.01
[2022-05-13 08:40:56.995723] weight_decay ............... 0.0
==================================================
[2022-05-13 08:40:56.997695] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-13 08:41:26.127898] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-13 08:42:02.695604] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
