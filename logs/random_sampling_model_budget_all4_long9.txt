==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 17:14:07.492114] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 17:14:07.496551] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 17:14:07.500804] batch_size ................. 4096
[2022-05-16 17:14:07.500826] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 17:14:07.500841] cuda ....................... True
[2022-05-16 17:14:07.500849] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 17:14:07.500857] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 17:14:07.500865] device ..................... 1
[2022-05-16 17:14:07.500873] device_num ................. 0
[2022-05-16 17:14:07.500881] disable_tqdm ............... True
[2022-05-16 17:14:07.500889] do_test .................... False
[2022-05-16 17:14:07.500897] do_valid ................... True
[2022-05-16 17:14:07.500905] dont_print_args ............ True
[2022-05-16 17:14:07.500913] dont_shuffle ............... None
[2022-05-16 17:14:07.500927] dropout .................... 0.3
[2022-05-16 17:14:07.500939] estimate_type .............. <function beam_search_lower_bound at 0x7faf5d6d3d30>
[2022-05-16 17:14:07.500949] excluded_terms ............. [1]
[2022-05-16 17:14:07.500959] excluded_terms_list ........ [[]]
[2022-05-16 17:14:07.500967] finetune ................... False
[2022-05-16 17:14:07.500975] grad_clip .................. 1.0
[2022-05-16 17:14:07.501032] hidden_size ................ 128
[2022-05-16 17:14:07.501039] hist_len ................... 18
[2022-05-16 17:14:07.501044] hybrid_max_num_beams ....... 1500
[2022-05-16 17:14:07.501051] interp_func ................ <function lin_interp at 0x7faf5d6d3c10>
[2022-05-16 17:14:07.501057] log_interval ............... 100
[2022-05-16 17:14:07.501064] lr ......................... 0.001
[2022-05-16 17:14:07.501070] lr_decay_style ............. constant
[2022-05-16 17:14:07.501076] masked_lm .................. False
[2022-05-16 17:14:07.501081] max_k ...................... None
[2022-05-16 17:14:07.501087] max_num_mc_samples ......... 100000
[2022-05-16 17:14:07.501093] max_num_queries ............ 1000
[2022-05-16 17:14:07.501098] min_num_mc_samples ......... 10000
[2022-05-16 17:14:07.501104] min_phase_shift ............ 0
[2022-05-16 17:14:07.501118] min_var_reduction .......... 0.1
[2022-05-16 17:14:07.501129] min_variance ............... True
[2022-05-16 17:14:07.501144] model_budget_filepath ...... None
[2022-05-16 17:14:07.501162] num_beams .................. 0.0
[2022-05-16 17:14:07.501181] num_layers ................. 2
[2022-05-16 17:14:07.501192] num_mc_samples ............. 100
[2022-05-16 17:14:07.501203] num_workers ................ 0
[2022-05-16 17:14:07.501217] optimizer .................. adam
[2022-05-16 17:14:07.501232] proposal_func .............. <function lm_proposal at 0x7faf5d6c0c10>
[2022-05-16 17:14:07.501247] rnn_type ................... LSTM
[2022-05-16 17:14:07.501262] save_epochs ................ 1
[2022-05-16 17:14:07.501278] seed ....................... 42
[2022-05-16 17:14:07.501291] seq_len .................... 100
[2022-05-16 17:14:07.501303] shuffle .................... True
[2022-05-16 17:14:07.501313] store_intermediate_lbs ..... True
[2022-05-16 17:14:07.501327] sub_estimates .............. []
[2022-05-16 17:14:07.501340] tau_a_excl_terms ........... []
[2022-05-16 17:14:07.501355] tau_b_excl_terms ........... []
[2022-05-16 17:14:07.501372] terms_of_interest .......... []
[2022-05-16 17:14:07.501388] text_dict .................. None
[2022-05-16 17:14:07.501400] top_k ...................... 0
[2022-05-16 17:14:07.501413] top_p ...................... 0
[2022-05-16 17:14:07.501424] total_seq_len .............. 20
[2022-05-16 17:14:07.501441] train_data_pct ............. 0.9
[2022-05-16 17:14:07.501454] train_epochs ............... 40
[2022-05-16 17:14:07.501472] use_gpt2 ................... False
[2022-05-16 17:14:07.501481] val_data_pct ............... 0.05
[2022-05-16 17:14:07.501493] val_metrics ................ ['accuracy']
[2022-05-16 17:14:07.501498] valid_epochs ............... 1
[2022-05-16 17:14:07.501512] variance_epsilon ........... 5e-06
[2022-05-16 17:14:07.501520] vocab_size ................. 68
[2022-05-16 17:14:07.501528] warmup_pct ................. 0.01
[2022-05-16 17:14:07.501535] weight_decay ............... 0.0
==================================================
[2022-05-16 17:14:07.502661] | Dataset: shakespeare | Sample type: random_sampling | Num samples: 1000 | Hist length 14 | Total Seq Length 20

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-16 17:15:49.948299] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-16 17:15:49.959358] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-16 17:15:50.103332] batch_size ................. 4096
[2022-05-16 17:15:50.103354] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-16 17:15:50.103359] cuda ....................... True
[2022-05-16 17:15:50.103362] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-16 17:15:50.103364] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 17:15:50.103367] device ..................... 1
[2022-05-16 17:15:50.103370] device_num ................. 0
[2022-05-16 17:15:50.103373] disable_tqdm ............... True
[2022-05-16 17:15:50.103376] do_test .................... False
[2022-05-16 17:15:50.103379] do_valid ................... True
[2022-05-16 17:15:50.103381] dont_print_args ............ True
[2022-05-16 17:15:50.103385] dont_shuffle ............... None
[2022-05-16 17:15:50.103392] dropout .................... 0.3
[2022-05-16 17:15:50.103396] estimate_type .............. <function beam_search_lower_bound at 0x7faf5d6d3d30>
[2022-05-16 17:15:50.103400] excluded_terms ............. [1]
[2022-05-16 17:15:50.103409] excluded_terms_list ........ [[]]
[2022-05-16 17:15:50.103412] finetune ................... False
[2022-05-16 17:15:50.103415] grad_clip .................. 1.0
[2022-05-16 17:15:50.103417] hidden_size ................ 512
[2022-05-16 17:15:50.103421] hist_len ................... 18
[2022-05-16 17:15:50.103423] hybrid_max_num_beams ....... 1500
[2022-05-16 17:15:50.103427] interp_func ................ <function lin_interp at 0x7faf5d6d3c10>
[2022-05-16 17:15:50.103429] log_interval ............... 100
[2022-05-16 17:15:50.103438] lr ......................... 0.001
[2022-05-16 17:15:50.103441] lr_decay_style ............. constant
[2022-05-16 17:15:50.103443] masked_lm .................. False
[2022-05-16 17:15:50.103446] max_k ...................... None
[2022-05-16 17:15:50.103448] max_num_mc_samples ......... 100000
[2022-05-16 17:15:50.103452] max_num_queries ............ 1000
[2022-05-16 17:15:50.103455] min_num_mc_samples ......... 10000
[2022-05-16 17:15:50.103457] min_phase_shift ............ 0
[2022-05-16 17:15:50.103460] min_var_reduction .......... 0.1
[2022-05-16 17:15:50.103462] min_variance ............... True
[2022-05-16 17:15:50.103465] model_budget_filepath ...... None
[2022-05-16 17:15:50.103468] num_beams .................. 0.0
[2022-05-16 17:15:50.103471] num_layers ................. 2
[2022-05-16 17:15:50.103473] num_mc_samples ............. 100
[2022-05-16 17:15:50.103476] num_workers ................ 0
[2022-05-16 17:15:50.103478] optimizer .................. adam
[2022-05-16 17:15:50.103481] proposal_func .............. <function lm_proposal at 0x7faf5d6c0c10>
[2022-05-16 17:15:50.103485] rnn_type ................... LSTM
[2022-05-16 17:15:50.103490] save_epochs ................ 1
[2022-05-16 17:15:50.103492] seed ....................... 42
[2022-05-16 17:15:50.103495] seq_len .................... 15
[2022-05-16 17:15:50.103498] shuffle .................... True
[2022-05-16 17:15:50.103500] store_intermediate_lbs ..... True
[2022-05-16 17:15:50.103503] sub_estimates .............. []
[2022-05-16 17:15:50.103505] tau_a_excl_terms ........... []
[2022-05-16 17:15:50.103509] tau_b_excl_terms ........... []
[2022-05-16 17:15:50.103511] terms_of_interest .......... []
[2022-05-16 17:15:50.103514] text_dict .................. None
[2022-05-16 17:15:50.103516] top_k ...................... 0
[2022-05-16 17:15:50.103519] top_p ...................... 0
[2022-05-16 17:15:50.103521] total_seq_len .............. 20
[2022-05-16 17:15:50.103524] train_data_pct ............. 0.9
[2022-05-16 17:15:50.103526] train_epochs ............... 40
[2022-05-16 17:15:50.103532] use_gpt2 ................... False
[2022-05-16 17:15:50.103535] val_data_pct ............... 0.0001
[2022-05-16 17:15:50.103538] val_metrics ................ ['accuracy']
[2022-05-16 17:15:50.103540] valid_epochs ............... 1
[2022-05-16 17:15:50.103544] variance_epsilon ........... 5e-06
[2022-05-16 17:15:50.103547] vocab_size ................. 30
[2022-05-16 17:15:50.103549] warmup_pct ................. 0.01
[2022-05-16 17:15:50.103552] weight_decay ............... 0.0
==================================================
[2022-05-16 17:15:50.103790] | Dataset: amazon | Sample type: random_sampling | Num samples: 1000 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-16 17:16:22.489248] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-16 17:16:22.498311] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-16 17:16:22.764779] batch_size ................. 4096
[2022-05-16 17:16:22.764801] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-16 17:16:22.764806] cuda ....................... True
[2022-05-16 17:16:22.764809] data_path .................. data/apps/lsapp.tsv
[2022-05-16 17:16:22.764812] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 17:16:22.764815] device ..................... 1
[2022-05-16 17:16:22.764818] device_num ................. 0
[2022-05-16 17:16:22.764821] disable_tqdm ............... True
[2022-05-16 17:16:22.764827] do_test .................... False
[2022-05-16 17:16:22.764830] do_valid ................... True
[2022-05-16 17:16:22.764833] dont_print_args ............ True
[2022-05-16 17:16:22.764850] dont_shuffle ............... None
[2022-05-16 17:16:22.764857] dropout .................... 0.3
[2022-05-16 17:16:22.764862] estimate_type .............. <function beam_search_lower_bound at 0x7faf5d6d3d30>
[2022-05-16 17:16:22.764866] excluded_terms ............. [1]
[2022-05-16 17:16:22.764870] excluded_terms_list ........ [[]]
[2022-05-16 17:16:22.764873] finetune ................... False
[2022-05-16 17:16:22.764877] grad_clip .................. 1.0
[2022-05-16 17:16:22.764880] hidden_size ................ 512
[2022-05-16 17:16:22.764883] hist_len ................... 18
[2022-05-16 17:16:22.764885] hybrid_max_num_beams ....... 1500
[2022-05-16 17:16:22.764889] interp_func ................ <function lin_interp at 0x7faf5d6d3c10>
[2022-05-16 17:16:22.764891] log_interval ............... 100
[2022-05-16 17:16:22.764895] lr ......................... 0.001
[2022-05-16 17:16:22.764898] lr_decay_style ............. constant
[2022-05-16 17:16:22.764901] masked_lm .................. False
[2022-05-16 17:16:22.764904] max_k ...................... None
[2022-05-16 17:16:22.764906] max_num_mc_samples ......... 100000
[2022-05-16 17:16:22.764928] max_num_queries ............ 1000
[2022-05-16 17:16:22.764930] min_num_mc_samples ......... 10000
[2022-05-16 17:16:22.764933] min_phase_shift ............ 0
[2022-05-16 17:16:22.764936] min_var_reduction .......... 0.1
[2022-05-16 17:16:22.764939] min_variance ............... True
[2022-05-16 17:16:22.764942] model_budget_filepath ...... None
[2022-05-16 17:16:22.764945] needs_encoding ............. True
[2022-05-16 17:16:22.764949] num_beams .................. 0.0
[2022-05-16 17:16:22.764951] num_layers ................. 2
[2022-05-16 17:16:22.764954] num_mc_samples ............. 100
[2022-05-16 17:16:22.764957] num_workers ................ 0
[2022-05-16 17:16:22.764959] optimizer .................. adam
[2022-05-16 17:16:22.764962] proposal_func .............. <function lm_proposal at 0x7faf5d6c0c10>
[2022-05-16 17:16:22.764966] rnn_type ................... LSTM
[2022-05-16 17:16:22.764968] save_epochs ................ 1
[2022-05-16 17:16:22.764971] seed ....................... 42
[2022-05-16 17:16:22.764973] seq_len .................... 15
[2022-05-16 17:16:22.764976] shuffle .................... True
[2022-05-16 17:16:22.764979] store_intermediate_lbs ..... True
[2022-05-16 17:16:22.764982] sub_estimates .............. []
[2022-05-16 17:16:22.764985] tau_a_excl_terms ........... []
[2022-05-16 17:16:22.764987] tau_b_excl_terms ........... []
[2022-05-16 17:16:22.764990] terms_of_interest .......... []
[2022-05-16 17:16:22.764993] text_dict .................. None
[2022-05-16 17:16:22.764995] top_k ...................... 0
[2022-05-16 17:16:22.764998] top_p ...................... 0
[2022-05-16 17:16:22.765001] total_seq_len .............. 20
[2022-05-16 17:16:22.765003] train_data_pct ............. 0.9
[2022-05-16 17:16:22.765006] train_epochs ............... 40
[2022-05-16 17:16:22.765009] use_gpt2 ................... False
[2022-05-16 17:16:22.765012] val_data_pct ............... 0.001
[2022-05-16 17:16:22.765015] val_metrics ................ ['accuracy']
[2022-05-16 17:16:22.765018] valid_epochs ............... 1
[2022-05-16 17:16:22.765022] variance_epsilon ........... 5e-06
[2022-05-16 17:16:22.765025] vocab_size ................. 88
[2022-05-16 17:16:22.765028] warmup_pct ................. 0.01
[2022-05-16 17:16:22.765030] weight_decay ............... 0.0
==================================================
[2022-05-16 17:16:22.766147] | Dataset: apps | Sample type: random_sampling | Num samples: 1000 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-16 17:16:39.354102] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-16 17:16:39.357897] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-16 17:16:39.428983] batch_size ................. 4096
[2022-05-16 17:16:39.429005] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-16 17:16:39.429013] cuda ....................... True
[2022-05-16 17:16:39.429019] data_path .................. data/moocs/mooc.csv
[2022-05-16 17:16:39.429024] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 17:16:39.429031] device ..................... 1
[2022-05-16 17:16:39.429036] device_num ................. 0
[2022-05-16 17:16:39.429042] disable_tqdm ............... True
[2022-05-16 17:16:39.429048] do_test .................... False
[2022-05-16 17:16:39.429053] do_valid ................... True
[2022-05-16 17:16:39.429059] dont_print_args ............ True
[2022-05-16 17:16:39.429065] dont_shuffle ............... None
[2022-05-16 17:16:39.429076] dropout .................... 0.3
[2022-05-16 17:16:39.429083] estimate_type .............. <function beam_search_lower_bound at 0x7faf5d6d3d30>
[2022-05-16 17:16:39.429091] excluded_terms ............. [1]
[2022-05-16 17:16:39.429108] excluded_terms_list ........ [[]]
[2022-05-16 17:16:39.429114] finetune ................... False
[2022-05-16 17:16:39.429120] grad_clip .................. 1.0
[2022-05-16 17:16:39.429126] hidden_size ................ 128
[2022-05-16 17:16:39.429132] hist_len ................... 18
[2022-05-16 17:16:39.429138] hybrid_max_num_beams ....... 1500
[2022-05-16 17:16:39.429144] interp_func ................ <function lin_interp at 0x7faf5d6d3c10>
[2022-05-16 17:16:39.429149] log_interval ............... 100
[2022-05-16 17:16:39.429164] lr ......................... 0.001
[2022-05-16 17:16:39.429169] lr_decay_style ............. constant
[2022-05-16 17:16:39.429175] masked_lm .................. False
[2022-05-16 17:16:39.429181] max_k ...................... None
[2022-05-16 17:16:39.429186] max_num_mc_samples ......... 100000
[2022-05-16 17:16:39.429193] max_num_queries ............ 1000
[2022-05-16 17:16:39.429198] min_num_mc_samples ......... 10000
[2022-05-16 17:16:39.429203] min_phase_shift ............ 0
[2022-05-16 17:16:39.429210] min_var_reduction .......... 0.1
[2022-05-16 17:16:39.429215] min_variance ............... True
[2022-05-16 17:16:39.429221] model_budget_filepath ...... None
[2022-05-16 17:16:39.429227] needs_encoding ............. False
[2022-05-16 17:16:39.429233] num_beams .................. 0.0
[2022-05-16 17:16:39.429238] num_layers ................. 2
[2022-05-16 17:16:39.429243] num_mc_samples ............. 100
[2022-05-16 17:16:39.429249] num_workers ................ 0
[2022-05-16 17:16:39.429254] optimizer .................. adam
[2022-05-16 17:16:39.429260] proposal_func .............. <function lm_proposal at 0x7faf5d6c0c10>
[2022-05-16 17:16:39.429267] rnn_type ................... LSTM
[2022-05-16 17:16:39.429272] save_epochs ................ 1
[2022-05-16 17:16:39.429278] seed ....................... 42
[2022-05-16 17:16:39.429283] seq_len .................... 15
[2022-05-16 17:16:39.429288] shuffle .................... True
[2022-05-16 17:16:39.429294] store_intermediate_lbs ..... True
[2022-05-16 17:16:39.429299] sub_estimates .............. []
[2022-05-16 17:16:39.429306] tau_a_excl_terms ........... []
[2022-05-16 17:16:39.429311] tau_b_excl_terms ........... []
[2022-05-16 17:16:39.429317] terms_of_interest .......... []
[2022-05-16 17:16:39.429322] text_dict .................. None
[2022-05-16 17:16:39.429328] top_k ...................... 0
[2022-05-16 17:16:39.429333] top_p ...................... 0
[2022-05-16 17:16:39.429338] total_seq_len .............. 20
[2022-05-16 17:16:39.429344] train_data_pct ............. 0.9
[2022-05-16 17:16:39.429350] train_epochs ............... 40
[2022-05-16 17:16:39.429355] use_gpt2 ................... False
[2022-05-16 17:16:39.429361] val_data_pct ............... 0.01
[2022-05-16 17:16:39.429368] val_metrics ................ ['accuracy']
[2022-05-16 17:16:39.429373] valid_epochs ............... 1
[2022-05-16 17:16:39.429382] variance_epsilon ........... 5e-06
[2022-05-16 17:16:39.429387] vocab_size ................. 98
[2022-05-16 17:16:39.429393] warmup_pct ................. 0.01
[2022-05-16 17:16:39.429398] weight_decay ............... 0.0
==================================================
[2022-05-16 17:16:39.430907] | Dataset: moocs | Sample type: random_sampling | Num samples: 1000 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
