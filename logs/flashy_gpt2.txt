==================================================
* Running for dataset flashy_gpt2
==================================================
354823168
==================================================
[2022-05-17 21:03:09.601813] batch_size ................. 128
[2022-05-17 21:03:09.601859] bs_ablation ................ False
[2022-05-17 21:03:09.601866] bs_ablation_max_beams ...... 10000
[2022-05-17 21:03:09.601875] checkpoint_path ............ None
[2022-05-17 21:03:09.601882] cuda ....................... True
[2022-05-17 21:03:09.601887] data_path .................. data/wikitext/wikitext_val-dl.csv
[2022-05-17 21:03:09.601893] dataset .................... flashy_gpt2
[2022-05-17 21:03:09.601900] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-17 21:03:09.601908] device ..................... 1
[2022-05-17 21:03:09.601915] device_num ................. 0
[2022-05-17 21:03:09.601921] disable_tqdm ............... True
[2022-05-17 21:03:09.601927] do_test .................... False
[2022-05-17 21:03:09.601933] do_valid ................... True
[2022-05-17 21:03:09.601939] dont_print_args ............ True
[2022-05-17 21:03:09.601945] dont_shuffle ............... None
[2022-05-17 21:03:09.601959] dropout .................... 0.3
[2022-05-17 21:03:09.601969] estimate_type .............. <function beam_search_lower_bound at 0x7f9b62554b80>
[2022-05-17 21:03:09.601983] excluded_terms ............. [30, 13, 0, 26]
[2022-05-17 21:03:09.601990] excluded_terms_list ........ [[]]
[2022-05-17 21:03:09.601996] finetune ................... False
[2022-05-17 21:03:09.602001] fixed_seq_len .............. 30
[2022-05-17 21:03:09.602008] flashy ..................... True
[2022-05-17 21:03:09.602014] grad_clip .................. 1.0
[2022-05-17 21:03:09.602020] hidden_size ................ 128
[2022-05-17 21:03:09.602026] hist_len ................... 18
[2022-05-17 21:03:09.602032] hybrid_max_num_beams ....... 1500
[2022-05-17 21:03:09.602040] interp_func ................ <function lin_interp at 0x7f9b62554a60>
[2022-05-17 21:03:09.602046] log_interval ............... 100
[2022-05-17 21:03:09.602053] lr ......................... 0.001
[2022-05-17 21:03:09.602059] lr_decay_style ............. constant
[2022-05-17 21:03:09.602065] masked_lm .................. False
[2022-05-17 21:03:09.602070] max_k ...................... None
[2022-05-17 21:03:09.602076] max_num_mc_samples ......... 100000
[2022-05-17 21:03:09.602082] max_num_queries ............ None
[2022-05-17 21:03:09.602087] min_num_mc_samples ......... 10000
[2022-05-17 21:03:09.602093] min_phase_shift ............ 0
[2022-05-17 21:03:09.602099] min_var_reduction .......... 0.1
[2022-05-17 21:03:09.602105] min_variance ............... True
[2022-05-17 21:03:09.602111] model_budget_filepath ...... None
[2022-05-17 21:03:09.602116] needs_dl ................... False
[2022-05-17 21:03:09.602122] num_beams .................. 0.0
[2022-05-17 21:03:09.602128] num_layers ................. 2
[2022-05-17 21:03:09.602134] num_mc_samples ............. 100
[2022-05-17 21:03:09.602139] num_workers ................ 0
[2022-05-17 21:03:09.602145] optimizer .................. adam
[2022-05-17 21:03:09.602152] proposal_func .............. <function lm_proposal at 0x7f9b62540a60>
[2022-05-17 21:03:09.602157] rnn_type ................... LSTM
[2022-05-17 21:03:09.602163] save_epochs ................ 1
[2022-05-17 21:03:09.602168] seed ....................... 42
[2022-05-17 21:03:09.602174] seq_len .................... 20
[2022-05-17 21:03:09.602180] shuffle .................... True
[2022-05-17 21:03:09.602185] store_intermediate_lbs ..... True
[2022-05-17 21:03:09.602192] sub_estimates .............. []
[2022-05-17 21:03:09.602197] tau_a_excl_terms ........... []
[2022-05-17 21:03:09.602203] tau_b_excl_terms ........... []
[2022-05-17 21:03:09.602209] terms_of_interest .......... []
[2022-05-17 21:03:09.602214] text_dict .................. None
[2022-05-17 21:03:09.602220] top_k ...................... 0
[2022-05-17 21:03:09.602226] top_p ...................... 0
[2022-05-17 21:03:09.602231] total_seq_len .............. 20
[2022-05-17 21:03:09.602237] train_data_pct ............. 0.9
[2022-05-17 21:03:09.602243] train_epochs ............... 40
[2022-05-17 21:03:09.602248] use_gpt2 ................... True
[2022-05-17 21:03:09.602254] val_data_pct ............... 0.05
[2022-05-17 21:03:09.602263] val_metrics ................ ['accuracy']
[2022-05-17 21:03:09.602269] valid_epochs ............... 1
[2022-05-17 21:03:09.602278] variance_epsilon ........... 5e-06
[2022-05-17 21:03:09.602283] vocab_size ................. 50257
[2022-05-17 21:03:09.602289] warmup_pct ................. 0.01
[2022-05-17 21:03:09.602295] weight_decay ............... 0.0
==================================================
[2022-05-17 21:03:09.602651] | Dataset: flashy_gpt2 | Sample type: flashy | Num samples: 1000 | Hist length 18 | Total Seq Length 20 

tensor([ 259,  616, 4459,   11,  220]) 50257
[2022-05-17 21:03:09.613539] - 0
