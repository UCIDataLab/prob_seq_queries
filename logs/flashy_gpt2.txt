==================================================
* Running for dataset flashy_gpt2
==================================================
354823168
==================================================
[2022-05-19 10:46:21.871738] batch_size ................. 512
[2022-05-19 10:46:21.871766] bs_ablation ................ False
[2022-05-19 10:46:21.871769] bs_ablation_max_beams ...... 10000
[2022-05-19 10:46:21.871773] checkpoint_path ............ None
[2022-05-19 10:46:21.871776] cuda ....................... True
[2022-05-19 10:46:21.871778] data_path .................. data/wikitext/wikitext_val-dl.csv
[2022-05-19 10:46:21.871780] dataset .................... flashy_gpt2
[2022-05-19 10:46:21.871783] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-19 10:46:21.871786] device ..................... 6
[2022-05-19 10:46:21.871788] device_num ................. 0
[2022-05-19 10:46:21.871791] disable_tqdm ............... True
[2022-05-19 10:46:21.871794] do_test .................... False
[2022-05-19 10:46:21.871796] do_valid ................... True
[2022-05-19 10:46:21.871799] dont_print_args ............ True
[2022-05-19 10:46:21.871802] dont_shuffle ............... None
[2022-05-19 10:46:21.871809] dropout .................... 0.3
[2022-05-19 10:46:21.871814] estimate_type .............. <function beam_search_lower_bound at 0x7feb5eb9cb80>
[2022-05-19 10:46:21.871822] excluded_terms ............. [30, 13, 0, 26]
[2022-05-19 10:46:21.871825] excluded_terms_list ........ [[]]
[2022-05-19 10:46:21.871828] finetune ................... False
[2022-05-19 10:46:21.871830] fixed_seq_len .............. 30
[2022-05-19 10:46:21.871833] flashy ..................... True
[2022-05-19 10:46:21.871835] frequentist_test ........... False
[2022-05-19 10:46:21.871839] grad_clip .................. 1.0
[2022-05-19 10:46:21.871841] hidden_size ................ 128
[2022-05-19 10:46:21.871844] hist_len ................... 18
[2022-05-19 10:46:21.871847] hybrid_max_num_beams ....... 1500
[2022-05-19 10:46:21.871850] interp_func ................ <function lin_interp at 0x7feb5eb9ca60>
[2022-05-19 10:46:21.871852] log_interval ............... 100
[2022-05-19 10:46:21.871855] lr ......................... 0.001
[2022-05-19 10:46:21.871858] lr_decay_style ............. constant
[2022-05-19 10:46:21.871861] masked_lm .................. False
[2022-05-19 10:46:21.871863] max_k ...................... None
[2022-05-19 10:46:21.871866] max_num_mc_samples ......... 100000
[2022-05-19 10:46:21.871868] max_num_queries ............ None
[2022-05-19 10:46:21.871870] min_num_mc_samples ......... 10000
[2022-05-19 10:46:21.871873] min_phase_shift ............ 0
[2022-05-19 10:46:21.871876] min_var_reduction .......... 0.1
[2022-05-19 10:46:21.871879] min_variance ............... True
[2022-05-19 10:46:21.871881] model_budget_filepath ...... None
[2022-05-19 10:46:21.871883] needs_dl ................... False
[2022-05-19 10:46:21.871886] num_beams .................. 0.0
[2022-05-19 10:46:21.871889] num_layers ................. 2
[2022-05-19 10:46:21.871891] num_mc_samples ............. 100
[2022-05-19 10:46:21.871894] num_workers ................ 0
[2022-05-19 10:46:21.871896] optimizer .................. adam
[2022-05-19 10:46:21.871899] proposal_func .............. <function lm_proposal at 0x7feb5eb87a60>
[2022-05-19 10:46:21.871901] rnn_type ................... LSTM
[2022-05-19 10:46:21.871904] save_epochs ................ 1
[2022-05-19 10:46:21.871906] seed ....................... 42
[2022-05-19 10:46:21.871909] seq_len .................... 20
[2022-05-19 10:46:21.871912] shuffle .................... True
[2022-05-19 10:46:21.871914] store_intermediate_lbs ..... True
[2022-05-19 10:46:21.871917] sub_estimates .............. []
[2022-05-19 10:46:21.871919] tau_a_excl_terms ........... []
[2022-05-19 10:46:21.871921] tau_b_excl_terms ........... []
[2022-05-19 10:46:21.871924] terms_of_interest .......... []
[2022-05-19 10:46:21.871926] text_dict .................. None
[2022-05-19 10:46:21.871929] top_k ...................... 0
[2022-05-19 10:46:21.871931] top_p ...................... 0
[2022-05-19 10:46:21.871934] total_seq_len .............. 20
[2022-05-19 10:46:21.871937] train_data_pct ............. 0.9
[2022-05-19 10:46:21.871939] train_epochs ............... 40
[2022-05-19 10:46:21.871942] use_gpt2 ................... True
[2022-05-19 10:46:21.871944] val_data_pct ............... 0.05
[2022-05-19 10:46:21.871948] val_metrics ................ ['accuracy']
[2022-05-19 10:46:21.871951] valid_epochs ............... 1
[2022-05-19 10:46:21.871955] variance_epsilon ........... 5e-06
[2022-05-19 10:46:21.871958] vocab_size ................. 50257
[2022-05-19 10:46:21.871960] warmup_pct ................. 0.01
[2022-05-19 10:46:21.871963] weight_decay ............... 0.0
==================================================
[2022-05-19 10:46:21.872138] | Dataset: flashy_gpt2 | Sample type: flashy | Num samples: 1000 | Hist length 18 | Total Seq Length 20 

tensor([ 259,  616, 4459,   11,  220])
[30, 13, 0, 26]
[2022-05-19 10:46:21.874801] - 0
False
[30, 13, 0, 26]
torch.Size([1000, 30])

tensor([4480,  326,  531,   11,  220])
[30, 13, 0, 26]
[2022-05-19 10:47:55.641560] - 1
False
[30, 13, 0, 26]
torch.Size([1000, 30])

tensor([ 259,  584, 2456,   11,  220])
[30, 13, 0, 26]
[2022-05-19 10:49:27.524752] - 2
False
[30, 13, 0, 26]
torch.Size([1000, 30])

tensor([2188])
[30, 13, 0, 26]
[2022-05-19 10:50:58.995433] - 3
False
[30, 13, 0, 26]
torch.Size([1000, 30])

tensor([5303,   11,  616, 1438,  318,  220])
[30, 13, 0, 26]
[2022-05-19 10:51:59.362859] - 4
False
[30, 13, 0, 26]
torch.Size([1000, 30])

tensor([3003,  318,  220])
[30, 13, 0, 26]
[2022-05-19 10:53:29.259794] - 5
False
[30, 13, 0, 26]
torch.Size([1000, 30])

tensor([27078,  2402,   257,   220])
[30, 13, 0, 26]
[2022-05-19 10:54:38.041315] - 6
False
[30, 13, 0, 26]
torch.Size([1000, 30])

tensor([  40, 4601,  220])
[30, 13, 0, 26]
[2022-05-19 10:55:55.815097] - 7
False
[30, 13, 0, 26]
torch.Size([1000, 30])

==================================================
