==================================================
* Running for dataset shakespeare
==================================================
[2022-05-14 13:10:20.650642] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-14 13:10:20.653421] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-14 13:10:20.655042] batch_size ................. 4096
[2022-05-14 13:10:20.655052] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-14 13:10:20.655059] cuda ....................... True
[2022-05-14 13:10:20.655062] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-14 13:10:20.655065] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-14 13:10:20.655068] device ..................... 1
[2022-05-14 13:10:20.655070] device_num ................. 0
[2022-05-14 13:10:20.655073] disable_tqdm ............... True
[2022-05-14 13:10:20.655076] do_test .................... False
[2022-05-14 13:10:20.655078] do_valid ................... True
[2022-05-14 13:10:20.655081] dont_print_args ............ True
[2022-05-14 13:10:20.655084] dont_shuffle ............... None
[2022-05-14 13:10:20.655091] dropout .................... 0.3
[2022-05-14 13:10:20.655096] estimate_type .............. <function beam_search_lower_bound at 0x7fa4697d2f70>
[2022-05-14 13:10:20.655100] excluded_terms ............. [1]
[2022-05-14 13:10:20.655103] finetune ................... False
[2022-05-14 13:10:20.655106] grad_clip .................. 1.0
[2022-05-14 13:10:20.655109] hidden_size ................ 128
[2022-05-14 13:10:20.655111] hist_len ................... 18
[2022-05-14 13:10:20.655114] hybrid_max_num_beams ....... 1500
[2022-05-14 13:10:20.655117] interp_func ................ <function lin_interp at 0x7fa4697d2e50>
[2022-05-14 13:10:20.655119] log_interval ............... 100
[2022-05-14 13:10:20.655123] lr ......................... 0.001
[2022-05-14 13:10:20.655125] lr_decay_style ............. constant
[2022-05-14 13:10:20.655128] masked_lm .................. False
[2022-05-14 13:10:20.655130] max_num_mc_samples ......... 100000
[2022-05-14 13:10:20.655133] max_num_queries ............ 1000
[2022-05-14 13:10:20.655135] min_num_mc_samples ......... 10000
[2022-05-14 13:10:20.655138] min_phase_shift ............ 0
[2022-05-14 13:10:20.655140] min_var_reduction .......... 0.1
[2022-05-14 13:10:20.655143] min_variance ............... True
[2022-05-14 13:10:20.655145] model_budget_filepath ...... None
[2022-05-14 13:10:20.655148] num_beams .................. 0.0
[2022-05-14 13:10:20.655151] num_layers ................. 2
[2022-05-14 13:10:20.655153] num_mc_samples ............. 100
[2022-05-14 13:10:20.655156] num_workers ................ 0
[2022-05-14 13:10:20.655158] optimizer .................. adam
[2022-05-14 13:10:20.655161] proposal_func .............. <function lm_proposal at 0x7fa4697bce50>
[2022-05-14 13:10:20.655163] rnn_type ................... LSTM
[2022-05-14 13:10:20.655166] save_epochs ................ 1
[2022-05-14 13:10:20.655168] seed ....................... 42
[2022-05-14 13:10:20.655171] seq_len .................... 100
[2022-05-14 13:10:20.655173] shuffle .................... True
[2022-05-14 13:10:20.655175] store_intermediate_lbs ..... True
[2022-05-14 13:10:20.655178] sub_estimates .............. []
[2022-05-14 13:10:20.655180] terms_of_interest .......... []
[2022-05-14 13:10:20.655183] text_dict .................. None
[2022-05-14 13:10:20.655185] top_k ...................... 0
[2022-05-14 13:10:20.655188] top_p ...................... 0
[2022-05-14 13:10:20.655190] total_seq_len .............. 20
[2022-05-14 13:10:20.655193] train_data_pct ............. 0.9
[2022-05-14 13:10:20.655195] train_epochs ............... 40
[2022-05-14 13:10:20.655198] use_gpt2 ................... False
[2022-05-14 13:10:20.655201] val_data_pct ............... 0.05
[2022-05-14 13:10:20.655205] val_metrics ................ ['accuracy']
[2022-05-14 13:10:20.655207] valid_epochs ............... 1
[2022-05-14 13:10:20.655211] variance_epsilon ........... 5e-06
[2022-05-14 13:10:20.655214] vocab_size ................. 68
[2022-05-14 13:10:20.655216] warmup_pct ................. 0.01
[2022-05-14 13:10:20.655219] weight_decay ............... 0.0
==================================================
[2022-05-14 13:10:20.655511] | Dataset: shakespeare | Temperature: 0.5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:10:33.859144] | Dataset: shakespeare | Temperature: 0.5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:12:44.640669] | Dataset: shakespeare | Temperature 0.5 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:12:58.703730] | Dataset: shakespeare | Temperature: 0.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:13:12.888783] | Dataset: shakespeare | Temperature: 0.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:15:19.081402] | Dataset: shakespeare | Temperature 0.75 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:15:31.835938] | Dataset: shakespeare | Temperature: 1.0 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:15:44.303108] | Dataset: shakespeare | Temperature: 1.0 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:17:37.065151] | Dataset: shakespeare | Temperature 1.0 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:17:49.783560] | Dataset: shakespeare | Temperature: 1.25 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:18:02.275012] | Dataset: shakespeare | Temperature: 1.25 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:19:43.046869] | Dataset: shakespeare | Temperature 1.25 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:19:56.633941] | Dataset: shakespeare | Temperature: 1.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:20:11.074365] | Dataset: shakespeare | Temperature: 1.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:22:05.416470] | Dataset: shakespeare | Temperature 1.75 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:22:21.329188] | Dataset: shakespeare | Temperature: 2 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:22:36.806601] | Dataset: shakespeare | Temperature: 2 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:24:16.500093] | Dataset: shakespeare | Temperature 2 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:24:29.638912] | Dataset: shakespeare | Temperature: 3 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:24:43.746689] | Dataset: shakespeare | Temperature: 3 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:26:36.759347] | Dataset: shakespeare | Temperature 3 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:26:53.667429] | Dataset: shakespeare | Temperature: 4 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:27:12.052575] | Dataset: shakespeare | Temperature: 4 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:29:03.397836] | Dataset: shakespeare | Temperature 4 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:29:18.750957] | Dataset: shakespeare | Temperature: 5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:29:34.326261] | Dataset: shakespeare | Temperature: 5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:31:11.190323] | Dataset: shakespeare | Temperature 5 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-14 13:31:24.087482] | Dataset: shakespeare | Temperature: 10 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:31:36.939629] | Dataset: shakespeare | Temperature: 10 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-14 13:33:17.277728] | Dataset: shakespeare | Temperature 10 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-14 13:33:50.845953] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-14 13:33:50.855894] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-14 13:33:51.228739] batch_size ................. 4096
[2022-05-14 13:33:51.228769] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-14 13:33:51.228775] cuda ....................... True
[2022-05-14 13:33:51.228778] data_path .................. data/apps/lsapp.tsv
[2022-05-14 13:33:51.228781] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-14 13:33:51.228785] device ..................... 1
[2022-05-14 13:33:51.228787] device_num ................. 0
[2022-05-14 13:33:51.228790] disable_tqdm ............... True
[2022-05-14 13:33:51.228793] do_test .................... False
[2022-05-14 13:33:51.228796] do_valid ................... True
[2022-05-14 13:33:51.228798] dont_print_args ............ True
[2022-05-14 13:33:51.228802] dont_shuffle ............... None
[2022-05-14 13:33:51.228811] dropout .................... 0.3
[2022-05-14 13:33:51.228817] estimate_type .............. <function beam_search_lower_bound at 0x7fa4697d2f70>
[2022-05-14 13:33:51.228822] excluded_terms ............. [1]
[2022-05-14 13:33:51.228826] finetune ................... False
[2022-05-14 13:33:51.228830] grad_clip .................. 1.0
[2022-05-14 13:33:51.228833] hidden_size ................ 512
[2022-05-14 13:33:51.228835] hist_len ................... 18
[2022-05-14 13:33:51.228839] hybrid_max_num_beams ....... 1500
[2022-05-14 13:33:51.228843] interp_func ................ <function lin_interp at 0x7fa4697d2e50>
[2022-05-14 13:33:51.228845] log_interval ............... 100
[2022-05-14 13:33:51.228849] lr ......................... 0.001
[2022-05-14 13:33:51.228855] lr_decay_style ............. constant
[2022-05-14 13:33:51.228858] masked_lm .................. False
[2022-05-14 13:33:51.228860] max_num_mc_samples ......... 100000
[2022-05-14 13:33:51.228863] max_num_queries ............ 1000
[2022-05-14 13:33:51.228865] min_num_mc_samples ......... 10000
[2022-05-14 13:33:51.228869] min_phase_shift ............ 0
[2022-05-14 13:33:51.228872] min_var_reduction .......... 0.1
[2022-05-14 13:33:51.228875] min_variance ............... True
[2022-05-14 13:33:51.228878] model_budget_filepath ...... None
[2022-05-14 13:33:51.228880] needs_encoding ............. True
[2022-05-14 13:33:51.228883] num_beams .................. 0.0
[2022-05-14 13:33:51.228887] num_layers ................. 2
[2022-05-14 13:33:51.228890] num_mc_samples ............. 100
[2022-05-14 13:33:51.228893] num_workers ................ 0
[2022-05-14 13:33:51.228896] optimizer .................. adam
[2022-05-14 13:33:51.228899] proposal_func .............. <function lm_proposal at 0x7fa4697bce50>
[2022-05-14 13:33:51.228901] rnn_type ................... LSTM
[2022-05-14 13:33:51.228904] save_epochs ................ 1
[2022-05-14 13:33:51.228909] seed ....................... 42
[2022-05-14 13:33:51.228911] seq_len .................... 15
[2022-05-14 13:33:51.228914] shuffle .................... True
[2022-05-14 13:33:51.228917] store_intermediate_lbs ..... True
[2022-05-14 13:33:51.228919] sub_estimates .............. []
[2022-05-14 13:33:51.228922] terms_of_interest .......... []
[2022-05-14 13:33:51.228925] text_dict .................. None
[2022-05-14 13:33:51.228929] top_k ...................... 0
[2022-05-14 13:33:51.228931] top_p ...................... 0
[2022-05-14 13:33:51.228934] total_seq_len .............. 20
[2022-05-14 13:33:51.228936] train_data_pct ............. 0.9
[2022-05-14 13:33:51.228939] train_epochs ............... 40
[2022-05-14 13:33:51.228941] use_gpt2 ................... False
[2022-05-14 13:33:51.228944] val_data_pct ............... 0.001
[2022-05-14 13:33:51.228948] val_metrics ................ ['accuracy']
[2022-05-14 13:33:51.228952] valid_epochs ............... 1
[2022-05-14 13:33:51.228957] variance_epsilon ........... 5e-06
[2022-05-14 13:33:51.228960] vocab_size ................. 88
[2022-05-14 13:33:51.228963] warmup_pct ................. 0.01
[2022-05-14 13:33:51.228965] weight_decay ............... 0.0
==================================================
[2022-05-14 13:33:51.230034] | Dataset: apps | Temperature: 0.5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:34:28.711737] | Dataset: apps | Temperature: 0.5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 13:41:34.470131] | Dataset: apps | Temperature 0.5 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 13:42:21.804443] | Dataset: apps | Temperature: 0.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:43:06.484194] | Dataset: apps | Temperature: 0.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 13:48:24.662557] | Dataset: apps | Temperature 0.75 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 13:48:54.110429] | Dataset: apps | Temperature: 1.0 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:49:25.789004] | Dataset: apps | Temperature: 1.0 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 13:54:51.712799] | Dataset: apps | Temperature 1.0 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 13:55:20.785598] | Dataset: apps | Temperature: 1.25 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 13:55:52.104969] | Dataset: apps | Temperature: 1.25 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 14:01:21.043022] | Dataset: apps | Temperature 1.25 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 14:01:50.207306] | Dataset: apps | Temperature: 1.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 14:02:21.686695] | Dataset: apps | Temperature: 1.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 14:07:46.073780] | Dataset: apps | Temperature 1.75 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 14:08:15.709751] | Dataset: apps | Temperature: 2 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 14:08:47.467242] | Dataset: apps | Temperature: 2 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 14:14:12.207758] | Dataset: apps | Temperature 2 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 14:14:41.768796] | Dataset: apps | Temperature: 3 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 14:15:15.530293] | Dataset: apps | Temperature: 3 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 14:20:40.366329] | Dataset: apps | Temperature 3 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 14:21:09.493661] | Dataset: apps | Temperature: 4 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 14:21:40.930586] | Dataset: apps | Temperature: 4 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 14:28:36.696525] | Dataset: apps | Temperature 4 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 14:29:50.794426] | Dataset: apps | Temperature: 5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 14:31:10.454256] | Dataset: apps | Temperature: 5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 14:41:20.109721] | Dataset: apps | Temperature 5 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 14:42:15.959779] | Dataset: apps | Temperature: 10 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 14:43:09.619558] | Dataset: apps | Temperature: 10 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 14:52:20.805323] | Dataset: apps | Temperature 10 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-14 14:54:21.277145] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-14 14:54:21.289674] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-14 14:54:21.467763] batch_size ................. 4096
[2022-05-14 14:54:21.467788] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-14 14:54:21.467794] cuda ....................... True
[2022-05-14 14:54:21.467798] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-14 14:54:21.467803] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-14 14:54:21.467809] device ..................... 1
[2022-05-14 14:54:21.467812] device_num ................. 0
[2022-05-14 14:54:21.467816] disable_tqdm ............... True
[2022-05-14 14:54:21.467820] do_test .................... False
[2022-05-14 14:54:21.467824] do_valid ................... True
[2022-05-14 14:54:21.467827] dont_print_args ............ True
[2022-05-14 14:54:21.467831] dont_shuffle ............... None
[2022-05-14 14:54:21.467841] dropout .................... 0.3
[2022-05-14 14:54:21.467846] estimate_type .............. <function beam_search_lower_bound at 0x7fa4697d2f70>
[2022-05-14 14:54:21.467853] excluded_terms ............. [1]
[2022-05-14 14:54:21.467858] finetune ................... False
[2022-05-14 14:54:21.467863] grad_clip .................. 1.0
[2022-05-14 14:54:21.467866] hidden_size ................ 512
[2022-05-14 14:54:21.467870] hist_len ................... 18
[2022-05-14 14:54:21.467874] hybrid_max_num_beams ....... 1500
[2022-05-14 14:54:21.467878] interp_func ................ <function lin_interp at 0x7fa4697d2e50>
[2022-05-14 14:54:21.467882] log_interval ............... 100
[2022-05-14 14:54:21.467886] lr ......................... 0.001
[2022-05-14 14:54:21.467910] lr_decay_style ............. constant
[2022-05-14 14:54:21.467914] masked_lm .................. False
[2022-05-14 14:54:21.467917] max_num_mc_samples ......... 100000
[2022-05-14 14:54:21.467921] max_num_queries ............ 1000
[2022-05-14 14:54:21.467925] min_num_mc_samples ......... 10000
[2022-05-14 14:54:21.467930] min_phase_shift ............ 0
[2022-05-14 14:54:21.467934] min_var_reduction .......... 0.1
[2022-05-14 14:54:21.467938] min_variance ............... True
[2022-05-14 14:54:21.467941] model_budget_filepath ...... None
[2022-05-14 14:54:21.467945] num_beams .................. 0.0
[2022-05-14 14:54:21.467948] num_layers ................. 2
[2022-05-14 14:54:21.467953] num_mc_samples ............. 100
[2022-05-14 14:54:21.467956] num_workers ................ 0
[2022-05-14 14:54:21.467959] optimizer .................. adam
[2022-05-14 14:54:21.467963] proposal_func .............. <function lm_proposal at 0x7fa4697bce50>
[2022-05-14 14:54:21.467967] rnn_type ................... LSTM
[2022-05-14 14:54:21.467970] save_epochs ................ 1
[2022-05-14 14:54:21.467973] seed ....................... 42
[2022-05-14 14:54:21.467978] seq_len .................... 15
[2022-05-14 14:54:21.467981] shuffle .................... True
[2022-05-14 14:54:21.467985] store_intermediate_lbs ..... True
[2022-05-14 14:54:21.467989] sub_estimates .............. []
[2022-05-14 14:54:21.467992] terms_of_interest .......... []
[2022-05-14 14:54:21.467996] text_dict .................. None
[2022-05-14 14:54:21.467999] top_k ...................... 0
[2022-05-14 14:54:21.468003] top_p ...................... 0
[2022-05-14 14:54:21.468007] total_seq_len .............. 20
[2022-05-14 14:54:21.468010] train_data_pct ............. 0.9
[2022-05-14 14:54:21.468013] train_epochs ............... 40
[2022-05-14 14:54:21.468017] use_gpt2 ................... False
[2022-05-14 14:54:21.468020] val_data_pct ............... 0.0001
[2022-05-14 14:54:21.468025] val_metrics ................ ['accuracy']
[2022-05-14 14:54:21.468028] valid_epochs ............... 1
[2022-05-14 14:54:21.468035] variance_epsilon ........... 5e-06
[2022-05-14 14:54:21.468038] vocab_size ................. 30
[2022-05-14 14:54:21.468042] warmup_pct ................. 0.01
[2022-05-14 14:54:21.468046] weight_decay ............... 0.0
==================================================
[2022-05-14 14:54:21.469510] | Dataset: amazon | Temperature: 0.5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 14:55:34.084016] | Dataset: amazon | Temperature: 0.5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 15:03:56.207867] | Dataset: amazon | Temperature 0.5 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 15:04:59.378786] | Dataset: amazon | Temperature: 0.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 15:06:04.493216] | Dataset: amazon | Temperature: 0.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 15:14:37.441289] | Dataset: amazon | Temperature 0.75 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 15:15:40.279602] | Dataset: amazon | Temperature: 1.0 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 15:16:40.807620] | Dataset: amazon | Temperature: 1.0 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 15:25:42.947968] | Dataset: amazon | Temperature 1.0 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 15:26:44.938078] | Dataset: amazon | Temperature: 1.25 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 15:27:44.919054] | Dataset: amazon | Temperature: 1.25 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 15:34:34.241812] | Dataset: amazon | Temperature 1.25 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 15:34:57.752058] | Dataset: amazon | Temperature: 1.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 15:35:25.747787] | Dataset: amazon | Temperature: 1.75 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 15:40:16.100893] | Dataset: amazon | Temperature 1.75 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 15:40:41.644103] | Dataset: amazon | Temperature: 2 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 15:41:11.170744] | Dataset: amazon | Temperature: 2 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 15:46:21.173151] | Dataset: amazon | Temperature 2 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 15:46:49.290208] | Dataset: amazon | Temperature: 3 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 15:47:19.733240] | Dataset: amazon | Temperature: 3 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 15:53:35.321951] | Dataset: amazon | Temperature 3 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 15:54:31.501666] | Dataset: amazon | Temperature: 4 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 15:55:31.373827] | Dataset: amazon | Temperature: 4 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 16:04:47.959197] | Dataset: amazon | Temperature 4 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 16:05:29.786517] | Dataset: amazon | Temperature: 5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 16:06:15.898715] | Dataset: amazon | Temperature: 5 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 16:13:15.458512] | Dataset: amazon | Temperature 5 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-14 16:13:44.584001] | Dataset: amazon | Temperature: 10 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Pseudo GT
==================================================
[2022-05-14 16:14:24.504077] | Dataset: amazon | Temperature: 10 |Sample type: temperature_ablation | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
 * Beam search
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_1000q.pkl
[2022-05-14 16:19:56.761625] | Dataset: amazon | Temperature 10 | Sample type: temperature_ablation | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
Traceback (most recent call last):
  File "scripts/temperature_ablation.py", line 75, in <module>
    beam_info =beams[dataset_name]
KeyError: 'moocs'
