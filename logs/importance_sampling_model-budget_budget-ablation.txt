==================================================
* Running for dataset shakespeare
==================================================
[2022-05-20 19:51:40.671270] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-20 19:51:40.674774] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-20 19:51:40.676451] batch_size ................. 8000
[2022-05-20 19:51:40.676467] bs_ablation ................ False
[2022-05-20 19:51:40.676470] bs_ablation_max_beams ...... 10000
[2022-05-20 19:51:40.676473] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-20 19:51:40.676476] cuda ....................... True
[2022-05-20 19:51:40.676478] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-20 19:51:40.676481] dataset .................... shakespeare
[2022-05-20 19:51:40.676483] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 19:51:40.676486] device ..................... 0
[2022-05-20 19:51:40.676488] device_num ................. 0
[2022-05-20 19:51:40.676491] disable_tqdm ............... True
[2022-05-20 19:51:40.676493] do_test .................... False
[2022-05-20 19:51:40.676496] do_valid ................... True
[2022-05-20 19:51:40.676498] dont_print_args ............ True
[2022-05-20 19:51:40.676505] dont_shuffle ............... None
[2022-05-20 19:51:40.676511] dropout .................... 0.3
[2022-05-20 19:51:40.676514] estimate_type .............. <function beam_search_lower_bound at 0x7f4ef1493ee0>
[2022-05-20 19:51:40.676520] excluded_terms ............. [1]
[2022-05-20 19:51:40.676523] excluded_terms_list ........ [[]]
[2022-05-20 19:51:40.676525] finetune ................... False
[2022-05-20 19:51:40.676527] frequentist_test ........... False
[2022-05-20 19:51:40.676530] grad_clip .................. 1.0
[2022-05-20 19:51:40.676533] hidden_size ................ 128
[2022-05-20 19:51:40.676535] hist_len ................... 18
[2022-05-20 19:51:40.676538] hybrid_max_num_beams ....... 1500
[2022-05-20 19:51:40.676541] interp_func ................ <function lin_interp at 0x7f4ef1493dc0>
[2022-05-20 19:51:40.676543] log_interval ............... 100
[2022-05-20 19:51:40.676547] lr ......................... 0.001
[2022-05-20 19:51:40.676549] lr_decay_style ............. constant
[2022-05-20 19:51:40.676552] masked_lm .................. False
[2022-05-20 19:51:40.676554] max_k ...................... None
[2022-05-20 19:51:40.676556] max_num_mc_samples ......... 100000
[2022-05-20 19:51:40.676559] max_num_queries ............ 1000
[2022-05-20 19:51:40.676561] min_num_mc_samples ......... 10000
[2022-05-20 19:51:40.676563] min_phase_shift ............ 0
[2022-05-20 19:51:40.676566] min_var_reduction .......... 0.1
[2022-05-20 19:51:40.676569] min_variance ............... True
[2022-05-20 19:51:40.676571] model_budget_filepath ...... None
[2022-05-20 19:51:40.676574] needs_dl ................... True
[2022-05-20 19:51:40.676576] num_beams .................. 0.0
[2022-05-20 19:51:40.676579] num_layers ................. 2
[2022-05-20 19:51:40.676581] num_mc_samples ............. 100
[2022-05-20 19:51:40.676584] num_workers ................ 0
[2022-05-20 19:51:40.676586] optimizer .................. adam
[2022-05-20 19:51:40.676589] proposal_func .............. <function lm_proposal at 0x7f4ef1481dc0>
[2022-05-20 19:51:40.676591] rnn_type ................... LSTM
[2022-05-20 19:51:40.676594] save_epochs ................ 1
[2022-05-20 19:51:40.676596] seed ....................... 42
[2022-05-20 19:51:40.676599] seq_len .................... 100
[2022-05-20 19:51:40.676601] shuffle .................... True
[2022-05-20 19:51:40.676603] store_intermediate_lbs ..... True
[2022-05-20 19:51:40.676606] sub_estimates .............. []
[2022-05-20 19:51:40.676609] tau_a_excl_terms ........... []
[2022-05-20 19:51:40.676611] tau_b_excl_terms ........... []
[2022-05-20 19:51:40.676614] terms_of_interest .......... []
[2022-05-20 19:51:40.676616] text_dict .................. None
[2022-05-20 19:51:40.676619] top_k ...................... 0
[2022-05-20 19:51:40.676621] top_p ...................... 0
[2022-05-20 19:51:40.676623] total_seq_len .............. 20
[2022-05-20 19:51:40.676626] train_data_pct ............. 0.9
[2022-05-20 19:51:40.676628] train_epochs ............... 40
[2022-05-20 19:51:40.676631] use_gpt2 ................... False
[2022-05-20 19:51:40.676633] val_data_pct ............... 0.05
[2022-05-20 19:51:40.676640] val_metrics ................ ['accuracy']
[2022-05-20 19:51:40.676643] valid_epochs ............... 1
[2022-05-20 19:51:40.676647] variance_epsilon ........... 5e-06
[2022-05-20 19:51:40.676650] vocab_size ................. 68
[2022-05-20 19:51:40.676652] warmup_pct ................. 0.01
[2022-05-20 19:51:40.676655] weight_decay ............... 0.0
==================================================
[2022-05-20 19:51:40.677111] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 10000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-20 19:54:46.308485] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 10000 | Hist length 14 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-20 19:56:39.044363] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 10000 | Hist length 18 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-20 19:57:49.992982] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-20 19:57:50.001171] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-20 19:57:50.358221] batch_size ................. 8000
[2022-05-20 19:57:50.358246] bs_ablation ................ False
[2022-05-20 19:57:50.358250] bs_ablation_max_beams ...... 10000
[2022-05-20 19:57:50.358253] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-20 19:57:50.358256] cuda ....................... True
[2022-05-20 19:57:50.358260] data_path .................. data/apps/lsapp.tsv
[2022-05-20 19:57:50.358262] dataset .................... apps
[2022-05-20 19:57:50.358265] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 19:57:50.358268] device ..................... 0
[2022-05-20 19:57:50.358271] device_num ................. 0
[2022-05-20 19:57:50.358274] disable_tqdm ............... True
[2022-05-20 19:57:50.358296] do_test .................... False
[2022-05-20 19:57:50.358299] do_valid ................... True
[2022-05-20 19:57:50.358302] dont_print_args ............ True
[2022-05-20 19:57:50.358306] dont_shuffle ............... None
[2022-05-20 19:57:50.358316] dropout .................... 0.3
[2022-05-20 19:57:50.358321] estimate_type .............. <function beam_search_lower_bound at 0x7f4ef1493ee0>
[2022-05-20 19:57:50.358328] excluded_terms ............. [1]
[2022-05-20 19:57:50.358331] excluded_terms_list ........ [[]]
[2022-05-20 19:57:50.358334] finetune ................... False
[2022-05-20 19:57:50.358337] frequentist_test ........... False
[2022-05-20 19:57:50.358341] grad_clip .................. 1.0
[2022-05-20 19:57:50.358344] hidden_size ................ 512
[2022-05-20 19:57:50.358349] hist_len ................... 18
[2022-05-20 19:57:50.358352] hybrid_max_num_beams ....... 1500
[2022-05-20 19:57:50.358356] interp_func ................ <function lin_interp at 0x7f4ef1493dc0>
[2022-05-20 19:57:50.358358] log_interval ............... 100
[2022-05-20 19:57:50.358362] lr ......................... 0.001
[2022-05-20 19:57:50.358366] lr_decay_style ............. constant
[2022-05-20 19:57:50.358369] masked_lm .................. False
[2022-05-20 19:57:50.358372] max_k ...................... None
[2022-05-20 19:57:50.358374] max_num_mc_samples ......... 100000
[2022-05-20 19:57:50.358377] max_num_queries ............ 1000
[2022-05-20 19:57:50.358380] min_num_mc_samples ......... 10000
[2022-05-20 19:57:50.358383] min_phase_shift ............ 0
[2022-05-20 19:57:50.358386] min_var_reduction .......... 0.1
[2022-05-20 19:57:50.358389] min_variance ............... True
[2022-05-20 19:57:50.358392] model_budget_filepath ...... None
[2022-05-20 19:57:50.358394] needs_dl ................... True
[2022-05-20 19:57:50.358397] needs_encoding ............. True
[2022-05-20 19:57:50.358400] num_beams .................. 0.0
[2022-05-20 19:57:50.358404] num_layers ................. 2
[2022-05-20 19:57:50.358407] num_mc_samples ............. 100
[2022-05-20 19:57:50.358409] num_workers ................ 0
[2022-05-20 19:57:50.358412] optimizer .................. adam
[2022-05-20 19:57:50.358415] proposal_func .............. <function lm_proposal at 0x7f4ef1481dc0>
[2022-05-20 19:57:50.358418] rnn_type ................... LSTM
[2022-05-20 19:57:50.358421] save_epochs ................ 1
[2022-05-20 19:57:50.358424] seed ....................... 42
[2022-05-20 19:57:50.358427] seq_len .................... 15
[2022-05-20 19:57:50.358430] shuffle .................... True
[2022-05-20 19:57:50.358432] store_intermediate_lbs ..... True
[2022-05-20 19:57:50.358435] sub_estimates .............. []
[2022-05-20 19:57:50.358438] tau_a_excl_terms ........... []
[2022-05-20 19:57:50.358440] tau_b_excl_terms ........... []
[2022-05-20 19:57:50.358443] terms_of_interest .......... []
[2022-05-20 19:57:50.358446] text_dict .................. None
[2022-05-20 19:57:50.358449] top_k ...................... 0
[2022-05-20 19:57:50.358451] top_p ...................... 0
[2022-05-20 19:57:50.358454] total_seq_len .............. 20
[2022-05-20 19:57:50.358457] train_data_pct ............. 0.9
[2022-05-20 19:57:50.358459] train_epochs ............... 40
[2022-05-20 19:57:50.358462] use_gpt2 ................... False
[2022-05-20 19:57:50.358465] val_data_pct ............... 0.001
[2022-05-20 19:57:50.358468] val_metrics ................ ['accuracy']
[2022-05-20 19:57:50.358472] valid_epochs ............... 1
[2022-05-20 19:57:50.358476] variance_epsilon ........... 5e-06
[2022-05-20 19:57:50.358479] vocab_size ................. 88
[2022-05-20 19:57:50.358482] warmup_pct ................. 0.01
[2022-05-20 19:57:50.358485] weight_decay ............... 0.0
==================================================
[2022-05-20 19:57:50.359666] | Dataset: apps | Sample type: importance_sampling | Num samples: 10000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-20 20:05:06.527955] | Dataset: apps | Sample type: importance_sampling | Num samples: 10000 | Hist length 9 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-20 20:10:11.280021] | Dataset: apps | Sample type: importance_sampling | Num samples: 10000 | Hist length 13 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-20 20:13:17.429222] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-20 20:13:17.431888] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-20 20:13:17.480865] batch_size ................. 8000
[2022-05-20 20:13:17.480881] bs_ablation ................ False
[2022-05-20 20:13:17.480885] bs_ablation_max_beams ...... 10000
[2022-05-20 20:13:17.480889] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-20 20:13:17.480893] cuda ....................... True
[2022-05-20 20:13:17.480897] data_path .................. data/moocs/mooc.csv
[2022-05-20 20:13:17.480901] dataset .................... moocs
[2022-05-20 20:13:17.480904] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 20:13:17.480908] device ..................... 0
[2022-05-20 20:13:17.480911] device_num ................. 0
[2022-05-20 20:13:17.480915] disable_tqdm ............... True
[2022-05-20 20:13:17.480919] do_test .................... False
[2022-05-20 20:13:17.480922] do_valid ................... True
[2022-05-20 20:13:17.480925] dont_print_args ............ True
[2022-05-20 20:13:17.480929] dont_shuffle ............... None
[2022-05-20 20:13:17.480942] dropout .................... 0.3
[2022-05-20 20:13:17.480948] estimate_type .............. <function beam_search_lower_bound at 0x7f4ef1493ee0>
[2022-05-20 20:13:17.480954] excluded_terms ............. [1]
[2022-05-20 20:13:17.480958] excluded_terms_list ........ [[]]
[2022-05-20 20:13:17.480961] finetune ................... False
[2022-05-20 20:13:17.480965] frequentist_test ........... False
[2022-05-20 20:13:17.480969] grad_clip .................. 1.0
[2022-05-20 20:13:17.480972] hidden_size ................ 128
[2022-05-20 20:13:17.480976] hist_len ................... 18
[2022-05-20 20:13:17.480979] hybrid_max_num_beams ....... 1500
[2022-05-20 20:13:17.480983] interp_func ................ <function lin_interp at 0x7f4ef1493dc0>
[2022-05-20 20:13:17.480986] log_interval ............... 100
[2022-05-20 20:13:17.480991] lr ......................... 0.001
[2022-05-20 20:13:17.480995] lr_decay_style ............. constant
[2022-05-20 20:13:17.480998] masked_lm .................. False
[2022-05-20 20:13:17.481002] max_k ...................... None
[2022-05-20 20:13:17.481005] max_num_mc_samples ......... 100000
[2022-05-20 20:13:17.481008] max_num_queries ............ 1000
[2022-05-20 20:13:17.481012] min_num_mc_samples ......... 10000
[2022-05-20 20:13:17.481015] min_phase_shift ............ 0
[2022-05-20 20:13:17.481019] min_var_reduction .......... 0.1
[2022-05-20 20:13:17.481023] min_variance ............... True
[2022-05-20 20:13:17.481026] model_budget_filepath ...... None
[2022-05-20 20:13:17.481029] needs_dl ................... True
[2022-05-20 20:13:17.481032] needs_encoding ............. False
[2022-05-20 20:13:17.481036] num_beams .................. 0.0
[2022-05-20 20:13:17.481040] num_layers ................. 2
[2022-05-20 20:13:17.481043] num_mc_samples ............. 100
[2022-05-20 20:13:17.481046] num_workers ................ 0
[2022-05-20 20:13:17.481049] optimizer .................. adam
[2022-05-20 20:13:17.481053] proposal_func .............. <function lm_proposal at 0x7f4ef1481dc0>
[2022-05-20 20:13:17.481056] rnn_type ................... LSTM
[2022-05-20 20:13:17.481060] save_epochs ................ 1
[2022-05-20 20:13:17.481063] seed ....................... 42
[2022-05-20 20:13:17.481066] seq_len .................... 15
[2022-05-20 20:13:17.481069] shuffle .................... True
[2022-05-20 20:13:17.481073] store_intermediate_lbs ..... True
[2022-05-20 20:13:17.481076] sub_estimates .............. []
[2022-05-20 20:13:17.481080] tau_a_excl_terms ........... []
[2022-05-20 20:13:17.481083] tau_b_excl_terms ........... []
[2022-05-20 20:13:17.481086] terms_of_interest .......... []
[2022-05-20 20:13:17.481090] text_dict .................. None
[2022-05-20 20:13:17.481093] top_k ...................... 0
[2022-05-20 20:13:17.481097] top_p ...................... 0
[2022-05-20 20:13:17.481100] total_seq_len .............. 20
[2022-05-20 20:13:17.481104] train_data_pct ............. 0.9
[2022-05-20 20:13:17.481107] train_epochs ............... 40
[2022-05-20 20:13:17.481111] use_gpt2 ................... False
[2022-05-20 20:13:17.481114] val_data_pct ............... 0.01
[2022-05-20 20:13:17.481119] val_metrics ................ ['accuracy']
[2022-05-20 20:13:17.481122] valid_epochs ............... 1
[2022-05-20 20:13:17.481127] variance_epsilon ........... 5e-06
[2022-05-20 20:13:17.481131] vocab_size ................. 98
[2022-05-20 20:13:17.481135] warmup_pct ................. 0.01
[2022-05-20 20:13:17.481138] weight_decay ............... 0.0
==================================================
[2022-05-20 20:13:17.482495] | Dataset: moocs | Sample type: importance_sampling | Num samples: 10000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-20 20:16:22.395571] | Dataset: moocs | Sample type: importance_sampling | Num samples: 10000 | Hist length 9 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-20 20:18:07.999222] | Dataset: moocs | Sample type: importance_sampling | Num samples: 10000 | Hist length 13 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-20 20:19:50.206030] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-20 20:19:50.213978] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-20 20:19:50.423439] batch_size ................. 8000
[2022-05-20 20:19:50.423470] bs_ablation ................ False
[2022-05-20 20:19:50.423473] bs_ablation_max_beams ...... 10000
[2022-05-20 20:19:50.423476] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-20 20:19:50.423480] cuda ....................... True
[2022-05-20 20:19:50.423483] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-20 20:19:50.423486] dataset .................... amazon
[2022-05-20 20:19:50.423489] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 20:19:50.423495] device ..................... 0
[2022-05-20 20:19:50.423497] device_num ................. 0
[2022-05-20 20:19:50.423500] disable_tqdm ............... True
[2022-05-20 20:19:50.423503] do_test .................... False
[2022-05-20 20:19:50.423506] do_valid ................... True
[2022-05-20 20:19:50.423508] dont_print_args ............ True
[2022-05-20 20:19:50.423512] dont_shuffle ............... None
[2022-05-20 20:19:50.423521] dropout .................... 0.3
[2022-05-20 20:19:50.423527] estimate_type .............. <function beam_search_lower_bound at 0x7f4ef1493ee0>
[2022-05-20 20:19:50.423532] excluded_terms ............. [1]
[2022-05-20 20:19:50.423536] excluded_terms_list ........ [[]]
[2022-05-20 20:19:50.423538] finetune ................... False
[2022-05-20 20:19:50.423541] frequentist_test ........... False
[2022-05-20 20:19:50.423544] grad_clip .................. 1.0
[2022-05-20 20:19:50.423547] hidden_size ................ 512
[2022-05-20 20:19:50.423549] hist_len ................... 18
[2022-05-20 20:19:50.423552] hybrid_max_num_beams ....... 1500
[2022-05-20 20:19:50.423555] interp_func ................ <function lin_interp at 0x7f4ef1493dc0>
[2022-05-20 20:19:50.423557] log_interval ............... 100
[2022-05-20 20:19:50.423561] lr ......................... 0.001
[2022-05-20 20:19:50.423570] lr_decay_style ............. constant
[2022-05-20 20:19:50.423573] masked_lm .................. False
[2022-05-20 20:19:50.423575] max_k ...................... None
[2022-05-20 20:19:50.423578] max_num_mc_samples ......... 100000
[2022-05-20 20:19:50.423580] max_num_queries ............ 1000
[2022-05-20 20:19:50.423583] min_num_mc_samples ......... 10000
[2022-05-20 20:19:50.423585] min_phase_shift ............ 0
[2022-05-20 20:19:50.423589] min_var_reduction .......... 0.1
[2022-05-20 20:19:50.423592] min_variance ............... True
[2022-05-20 20:19:50.423594] model_budget_filepath ...... None
[2022-05-20 20:19:50.423597] needs_dl ................... True
[2022-05-20 20:19:50.423601] num_beams .................. 0.0
[2022-05-20 20:19:50.423604] num_layers ................. 2
[2022-05-20 20:19:50.423607] num_mc_samples ............. 100
[2022-05-20 20:19:50.423609] num_workers ................ 0
[2022-05-20 20:19:50.423612] optimizer .................. adam
[2022-05-20 20:19:50.423615] proposal_func .............. <function lm_proposal at 0x7f4ef1481dc0>
[2022-05-20 20:19:50.423618] rnn_type ................... LSTM
[2022-05-20 20:19:50.423620] save_epochs ................ 1
[2022-05-20 20:19:50.423622] seed ....................... 42
[2022-05-20 20:19:50.423625] seq_len .................... 15
[2022-05-20 20:19:50.423628] shuffle .................... True
[2022-05-20 20:19:50.423630] store_intermediate_lbs ..... True
[2022-05-20 20:19:50.423633] sub_estimates .............. []
[2022-05-20 20:19:50.423635] tau_a_excl_terms ........... []
[2022-05-20 20:19:50.423637] tau_b_excl_terms ........... []
[2022-05-20 20:19:50.423640] terms_of_interest .......... []
[2022-05-20 20:19:50.423642] text_dict .................. None
[2022-05-20 20:19:50.423644] top_k ...................... 0
[2022-05-20 20:19:50.423647] top_p ...................... 0
[2022-05-20 20:19:50.423649] total_seq_len .............. 20
[2022-05-20 20:19:50.423652] train_data_pct ............. 0.9
[2022-05-20 20:19:50.423654] train_epochs ............... 40
[2022-05-20 20:19:50.423656] use_gpt2 ................... False
[2022-05-20 20:19:50.423659] val_data_pct ............... 0.0001
[2022-05-20 20:19:50.423663] val_metrics ................ ['accuracy']
[2022-05-20 20:19:50.423665] valid_epochs ............... 1
[2022-05-20 20:19:50.423669] variance_epsilon ........... 5e-06
[2022-05-20 20:19:50.423671] vocab_size ................. 30
[2022-05-20 20:19:50.423674] warmup_pct ................. 0.01
[2022-05-20 20:19:50.423677] weight_decay ............... 0.0
==================================================
[2022-05-20 20:19:50.425231] | Dataset: amazon | Sample type: importance_sampling | Num samples: 10000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

................................Traceback (most recent call last):
  File "scripts/get_importance_sampling.py", line 132, in <module>
    estimates = sample_dynamic_target_token(args, val_dl, model)
  File "/home/showalte/.conda/envs/nlpenv/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/showalte/research/prob_seq_queries/seq_queries/experiments.py", line 453, in sample_dynamic_target_token
    sample_output =args.estimate_type(sample,**kwargs)
  File "/home/showalte/.conda/envs/nlpenv/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/showalte/research/prob_seq_queries/seq_queries/sample.py", line 196, in mc_estimate
    sample_out = proposal_func(
  File "/home/showalte/research/prob_seq_queries/seq_queries/sample.py", line 98, in lm_proposal
    proposal_log_prob += torch.gather(logits, dim=-1, index=last_sample).squeeze(-1)
RuntimeError: output with shape [] doesn't match the broadcast shape [1]
