==================================================
* Running for dataset shakespeare
==================================================
[2022-05-13 08:56:10.969686] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-13 08:56:10.980121] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-13 08:56:10.983311] batch_size ................. 4096
[2022-05-13 08:56:10.983330] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-13 08:56:10.983342] cuda ....................... True
[2022-05-13 08:56:10.983349] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-13 08:56:10.983354] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:56:10.983360] device ..................... 2
[2022-05-13 08:56:10.983366] device_num ................. 0
[2022-05-13 08:56:10.983372] disable_tqdm ............... True
[2022-05-13 08:56:10.983377] do_test .................... False
[2022-05-13 08:56:10.983383] do_valid ................... True
[2022-05-13 08:56:10.983388] dont_print_args ............ True
[2022-05-13 08:56:10.983395] dont_shuffle ............... None
[2022-05-13 08:56:10.983409] dropout .................... 0.3
[2022-05-13 08:56:10.983417] estimate_type .............. <function beam_search_lower_bound at 0x7f4cc3904940>
[2022-05-13 08:56:10.983428] excluded_terms ............. [1]
[2022-05-13 08:56:10.983436] finetune ................... False
[2022-05-13 08:56:10.983442] grad_clip .................. 1.0
[2022-05-13 08:56:10.983448] hidden_size ................ 128
[2022-05-13 08:56:10.983454] hist_len ................... 18
[2022-05-13 08:56:10.983462] interp_func ................ <function lin_interp at 0x7f4cc3904820>
[2022-05-13 08:56:10.983467] log_interval ............... 100
[2022-05-13 08:56:10.983474] lr ......................... 0.001
[2022-05-13 08:56:10.983479] lr_decay_style ............. constant
[2022-05-13 08:56:10.983485] masked_lm .................. False
[2022-05-13 08:56:10.983491] max_num_mc_samples ......... 100000
[2022-05-13 08:56:10.983496] max_num_queries ............ 500
[2022-05-13 08:56:10.983501] min_num_mc_samples ......... 10000
[2022-05-13 08:56:10.983507] min_phase_shift ............ 0
[2022-05-13 08:56:10.983513] min_var_reduction .......... 0.1
[2022-05-13 08:56:10.983519] min_variance ............... True
[2022-05-13 08:56:10.983525] model_budget_filepath ...... None
[2022-05-13 08:56:10.983531] num_beams .................. 0.0
[2022-05-13 08:56:10.983536] num_layers ................. 2
[2022-05-13 08:56:10.983541] num_mc_samples ............. 100
[2022-05-13 08:56:10.983547] num_workers ................ 0
[2022-05-13 08:56:10.983552] optimizer .................. adam
[2022-05-13 08:56:10.983558] proposal_func .............. <function lm_proposal at 0x7f4cc38f0820>
[2022-05-13 08:56:10.983582] rnn_type ................... LSTM
[2022-05-13 08:56:10.983588] save_epochs ................ 1
[2022-05-13 08:56:10.983593] seed ....................... 42
[2022-05-13 08:56:10.983599] seq_len .................... 100
[2022-05-13 08:56:10.983604] shuffle .................... True
[2022-05-13 08:56:10.983610] store_intermediate_lbs ..... True
[2022-05-13 08:56:10.983616] sub_estimates .............. []
[2022-05-13 08:56:10.983621] text_dict .................. None
[2022-05-13 08:56:10.983627] top_k ...................... 0
[2022-05-13 08:56:10.983632] top_p ...................... 0
[2022-05-13 08:56:10.983637] total_seq_len .............. 20
[2022-05-13 08:56:10.983644] train_data_pct ............. 0.9
[2022-05-13 08:56:10.983651] train_epochs ............... 40
[2022-05-13 08:56:10.983656] use_gpt2 ................... False
[2022-05-13 08:56:10.983662] val_data_pct ............... 0.05
[2022-05-13 08:56:10.983669] val_metrics ................ ['accuracy']
[2022-05-13 08:56:10.983675] valid_epochs ............... 1
[2022-05-13 08:56:10.983683] variance_epsilon ........... 5e-06
[2022-05-13 08:56:10.983689] vocab_size ................. 68
[2022-05-13 08:56:10.983695] warmup_pct ................. 0.01
[2022-05-13 08:56:10.983700] weight_decay ............... 0.0
==================================================
[2022-05-13 08:56:10.984247] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 12 | Total Seq Length 20 | Max num queries: 500

..