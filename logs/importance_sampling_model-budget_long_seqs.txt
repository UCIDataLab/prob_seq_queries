==================================================
* Running for dataset moocs
==================================================
[2022-05-13 08:32:35.543596] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-13 08:32:35.546889] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-13 08:32:35.634912] batch_size ................. 4096
[2022-05-13 08:32:35.634938] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-13 08:32:35.634948] cuda ....................... True
[2022-05-13 08:32:35.634954] data_path .................. data/moocs/mooc.csv
[2022-05-13 08:32:35.634960] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:32:35.634968] device ..................... 6
[2022-05-13 08:32:35.634974] device_num ................. 0
[2022-05-13 08:32:35.634979] disable_tqdm ............... True
[2022-05-13 08:32:35.634985] do_test .................... False
[2022-05-13 08:32:35.634991] do_valid ................... True
[2022-05-13 08:32:35.634996] dont_print_args ............ True
[2022-05-13 08:32:35.635003] dont_shuffle ............... None
[2022-05-13 08:32:35.635016] dropout .................... 0.3
[2022-05-13 08:32:35.635025] estimate_type .............. <function beam_search_lower_bound at 0x7f51d27e1af0>
[2022-05-13 08:32:35.635033] excluded_terms ............. [1]
[2022-05-13 08:32:35.635040] finetune ................... False
[2022-05-13 08:32:35.635046] grad_clip .................. 1.0
[2022-05-13 08:32:35.635052] hidden_size ................ 128
[2022-05-13 08:32:35.635058] hist_len ................... 18
[2022-05-13 08:32:35.635064] interp_func ................ <function lin_interp at 0x7f51d27e19d0>
[2022-05-13 08:32:35.635070] log_interval ............... 100
[2022-05-13 08:32:35.635077] lr ......................... 0.001
[2022-05-13 08:32:35.635083] lr_decay_style ............. constant
[2022-05-13 08:32:35.635089] masked_lm .................. False
[2022-05-13 08:32:35.635095] max_num_mc_samples ......... 100000
[2022-05-13 08:32:35.635101] max_num_queries ............ 1000
[2022-05-13 08:32:35.635106] min_num_mc_samples ......... 10000
[2022-05-13 08:32:35.635112] min_phase_shift ............ 0
[2022-05-13 08:32:35.635118] min_var_reduction .......... 0.1
[2022-05-13 08:32:35.635124] min_variance ............... True
[2022-05-13 08:32:35.635129] model_budget_filepath ...... None
[2022-05-13 08:32:35.635135] needs_encoding ............. False
[2022-05-13 08:32:35.635141] num_beams .................. 0.0
[2022-05-13 08:32:35.635146] num_layers ................. 2
[2022-05-13 08:32:35.635152] num_mc_samples ............. 100
[2022-05-13 08:32:35.635157] num_workers ................ 0
[2022-05-13 08:32:35.635163] optimizer .................. adam
[2022-05-13 08:32:35.635169] proposal_func .............. <function lm_proposal at 0x7f51d27cd9d0>
[2022-05-13 08:32:35.635174] rnn_type ................... LSTM
[2022-05-13 08:32:35.635180] save_epochs ................ 1
[2022-05-13 08:32:35.635185] seed ....................... 42
[2022-05-13 08:32:35.635191] seq_len .................... 15
[2022-05-13 08:32:35.635196] shuffle .................... True
[2022-05-13 08:32:35.635202] store_intermediate_lbs ..... True
[2022-05-13 08:32:35.635207] sub_estimates .............. []
[2022-05-13 08:32:35.635213] text_dict .................. None
[2022-05-13 08:32:35.635218] top_k ...................... 0
[2022-05-13 08:32:35.635223] top_p ...................... 0
[2022-05-13 08:32:35.635229] total_seq_len .............. 20
[2022-05-13 08:32:35.635235] train_data_pct ............. 0.9
[2022-05-13 08:32:35.635240] train_epochs ............... 40
[2022-05-13 08:32:35.635246] use_gpt2 ................... False
[2022-05-13 08:32:35.635251] val_data_pct ............... 0.01
[2022-05-13 08:32:35.635258] val_metrics ................ ['accuracy']
[2022-05-13 08:32:35.635263] valid_epochs ............... 1
[2022-05-13 08:32:35.635271] variance_epsilon ........... 5e-06
[2022-05-13 08:32:35.635276] vocab_size ................. 98
[2022-05-13 08:32:35.635282] warmup_pct ................. 0.01
[2022-05-13 08:32:35.635288] weight_decay ............... 0.0
==================================================
[2022-05-13 08:32:35.636090] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-13 08:33:25.519303] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-13 08:34:26.503933] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-13 08:36:47.305769] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-13 08:36:47.325538] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-13 08:36:47.854056] batch_size ................. 4096
[2022-05-13 08:36:47.854090] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-13 08:36:47.854099] cuda ....................... True
[2022-05-13 08:36:47.854105] data_path .................. data/apps/lsapp.tsv
[2022-05-13 08:36:47.854111] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:36:47.854117] device ..................... 6
[2022-05-13 08:36:47.854122] device_num ................. 0
[2022-05-13 08:36:47.854128] disable_tqdm ............... True
[2022-05-13 08:36:47.854134] do_test .................... False
[2022-05-13 08:36:47.854140] do_valid ................... True
[2022-05-13 08:36:47.854146] dont_print_args ............ True
[2022-05-13 08:36:47.854152] dont_shuffle ............... None
[2022-05-13 08:36:47.854166] dropout .................... 0.3
[2022-05-13 08:36:47.854174] estimate_type .............. <function beam_search_lower_bound at 0x7f51d27e1af0>
[2022-05-13 08:36:47.854182] excluded_terms ............. [1]
[2022-05-13 08:36:47.854188] finetune ................... False
[2022-05-13 08:36:47.854195] grad_clip .................. 1.0
[2022-05-13 08:36:47.854201] hidden_size ................ 512
[2022-05-13 08:36:47.854206] hist_len ................... 18
[2022-05-13 08:36:47.854213] interp_func ................ <function lin_interp at 0x7f51d27e19d0>
[2022-05-13 08:36:47.854218] log_interval ............... 100
[2022-05-13 08:36:47.854226] lr ......................... 0.001
[2022-05-13 08:36:47.854231] lr_decay_style ............. constant
[2022-05-13 08:36:47.854237] masked_lm .................. False
[2022-05-13 08:36:47.854243] max_num_mc_samples ......... 100000
[2022-05-13 08:36:47.854248] max_num_queries ............ 1000
[2022-05-13 08:36:47.854253] min_num_mc_samples ......... 10000
[2022-05-13 08:36:47.854259] min_phase_shift ............ 0
[2022-05-13 08:36:47.854265] min_var_reduction .......... 0.1
[2022-05-13 08:36:47.854271] min_variance ............... True
[2022-05-13 08:36:47.854276] model_budget_filepath ...... None
[2022-05-13 08:36:47.854282] needs_encoding ............. True
[2022-05-13 08:36:47.854288] num_beams .................. 0.0
[2022-05-13 08:36:47.854293] num_layers ................. 2
[2022-05-13 08:36:47.854299] num_mc_samples ............. 100
[2022-05-13 08:36:47.854304] num_workers ................ 0
[2022-05-13 08:36:47.854310] optimizer .................. adam
[2022-05-13 08:36:47.854316] proposal_func .............. <function lm_proposal at 0x7f51d27cd9d0>
[2022-05-13 08:36:47.854321] rnn_type ................... LSTM
[2022-05-13 08:36:47.854327] save_epochs ................ 1
[2022-05-13 08:36:47.854332] seed ....................... 42
[2022-05-13 08:36:47.854338] seq_len .................... 15
[2022-05-13 08:36:47.854343] shuffle .................... True
[2022-05-13 08:36:47.854349] store_intermediate_lbs ..... True
[2022-05-13 08:36:47.854354] sub_estimates .............. []
[2022-05-13 08:36:47.854360] text_dict .................. None
[2022-05-13 08:36:47.854365] top_k ...................... 0
[2022-05-13 08:36:47.854371] top_p ...................... 0
[2022-05-13 08:36:47.854377] total_seq_len .............. 20
[2022-05-13 08:36:47.854382] train_data_pct ............. 0.9
[2022-05-13 08:36:47.854388] train_epochs ............... 40
[2022-05-13 08:36:47.854393] use_gpt2 ................... False
[2022-05-13 08:36:47.854399] val_data_pct ............... 0.001
[2022-05-13 08:36:47.854406] val_metrics ................ ['accuracy']
[2022-05-13 08:36:47.854412] valid_epochs ............... 1
[2022-05-13 08:36:47.854420] variance_epsilon ........... 5e-06
[2022-05-13 08:36:47.854426] vocab_size ................. 88
[2022-05-13 08:36:47.854431] warmup_pct ................. 0.01
[2022-05-13 08:36:47.854437] weight_decay ............... 0.0
==================================================
[2022-05-13 08:36:47.855861] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-13 08:38:27.610924] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-13 08:40:45.223949] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-13 08:45:34.731366] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-13 08:45:34.746547] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-13 08:45:34.937673] batch_size ................. 4096
[2022-05-13 08:45:34.937717] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-13 08:45:34.937726] cuda ....................... True
[2022-05-13 08:45:34.937732] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-13 08:45:34.937737] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 08:45:34.937744] device ..................... 6
[2022-05-13 08:45:34.937750] device_num ................. 0
[2022-05-13 08:45:34.937755] disable_tqdm ............... True
[2022-05-13 08:45:34.937762] do_test .................... False
[2022-05-13 08:45:34.937767] do_valid ................... True
[2022-05-13 08:45:34.937773] dont_print_args ............ True
[2022-05-13 08:45:34.937779] dont_shuffle ............... None
[2022-05-13 08:45:34.937796] dropout .................... 0.3
[2022-05-13 08:45:34.937804] estimate_type .............. <function beam_search_lower_bound at 0x7f51d27e1af0>
[2022-05-13 08:45:34.937814] excluded_terms ............. [1]
[2022-05-13 08:45:34.937821] finetune ................... False
[2022-05-13 08:45:34.937827] grad_clip .................. 1.0
[2022-05-13 08:45:34.937833] hidden_size ................ 512
[2022-05-13 08:45:34.937838] hist_len ................... 18
[2022-05-13 08:45:34.937845] interp_func ................ <function lin_interp at 0x7f51d27e19d0>
[2022-05-13 08:45:34.937850] log_interval ............... 100
[2022-05-13 08:45:34.937857] lr ......................... 0.001
[2022-05-13 08:45:34.937863] lr_decay_style ............. constant
[2022-05-13 08:45:34.937868] masked_lm .................. False
[2022-05-13 08:45:34.937874] max_num_mc_samples ......... 100000
[2022-05-13 08:45:34.937879] max_num_queries ............ 1000
[2022-05-13 08:45:34.937885] min_num_mc_samples ......... 10000
[2022-05-13 08:45:34.937890] min_phase_shift ............ 0
[2022-05-13 08:45:34.937896] min_var_reduction .......... 0.1
[2022-05-13 08:45:34.937902] min_variance ............... True
[2022-05-13 08:45:34.937908] model_budget_filepath ...... None
[2022-05-13 08:45:34.937914] num_beams .................. 0.0
[2022-05-13 08:45:34.937919] num_layers ................. 2
[2022-05-13 08:45:34.937925] num_mc_samples ............. 100
[2022-05-13 08:45:34.937930] num_workers ................ 0
[2022-05-13 08:45:34.937936] optimizer .................. adam
[2022-05-13 08:45:34.937942] proposal_func .............. <function lm_proposal at 0x7f51d27cd9d0>
[2022-05-13 08:45:34.937947] rnn_type ................... LSTM
[2022-05-13 08:45:34.937952] save_epochs ................ 1
[2022-05-13 08:45:34.937957] seed ....................... 42
[2022-05-13 08:45:34.937963] seq_len .................... 15
[2022-05-13 08:45:34.937968] shuffle .................... True
[2022-05-13 08:45:34.937974] store_intermediate_lbs ..... True
[2022-05-13 08:45:34.937979] sub_estimates .............. []
[2022-05-13 08:45:34.937985] text_dict .................. None
[2022-05-13 08:45:34.937990] top_k ...................... 0
[2022-05-13 08:45:34.937996] top_p ...................... 0
[2022-05-13 08:45:34.938001] total_seq_len .............. 20
[2022-05-13 08:45:34.938007] train_data_pct ............. 0.9
[2022-05-13 08:45:34.938013] train_epochs ............... 40
[2022-05-13 08:45:34.938018] use_gpt2 ................... False
[2022-05-13 08:45:34.938024] val_data_pct ............... 0.0001
[2022-05-13 08:45:34.938033] val_metrics ................ ['accuracy']
[2022-05-13 08:45:34.938038] valid_epochs ............... 1
[2022-05-13 08:45:34.938047] variance_epsilon ........... 5e-06
[2022-05-13 08:45:34.938052] vocab_size ................. 30
[2022-05-13 08:45:34.938058] warmup_pct ................. 0.01
[2022-05-13 08:45:34.938064] weight_decay ............... 0.0
==================================================
[2022-05-13 08:45:34.939512] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-13 08:46:52.352087] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
[2022-05-13 08:48:42.895941] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

....................................................................................................
==================================================
