==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 15:46:46.551826] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 15:46:46.556550] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 15:46:46.561234] batch_size ................. 4096
[2022-05-16 15:46:46.561256] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 15:46:46.561276] cuda ....................... True
[2022-05-16 15:46:46.561284] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 15:46:46.561292] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 15:46:46.561300] device ..................... 6
[2022-05-16 15:46:46.561308] device_num ................. 0
[2022-05-16 15:46:46.561316] disable_tqdm ............... True
[2022-05-16 15:46:46.561324] do_test .................... False
[2022-05-16 15:46:46.561331] do_valid ................... True
[2022-05-16 15:46:46.561337] dont_print_args ............ True
[2022-05-16 15:46:46.561343] dont_shuffle ............... None
[2022-05-16 15:46:46.561355] dropout .................... 0.3
[2022-05-16 15:46:46.561363] estimate_type .............. <function beam_search_lower_bound at 0x7f1a25960e50>
[2022-05-16 15:46:46.561372] excluded_terms ............. [1]
[2022-05-16 15:46:46.561379] excluded_terms_list ........ [[]]
[2022-05-16 15:46:46.561385] finetune ................... False
[2022-05-16 15:46:46.561391] grad_clip .................. 1.0
[2022-05-16 15:46:46.561397] hidden_size ................ 128
[2022-05-16 15:46:46.561403] hist_len ................... 18
[2022-05-16 15:46:46.561408] hybrid_max_num_beams ....... 1500
[2022-05-16 15:46:46.561415] interp_func ................ <function lin_interp at 0x7f1a25960d30>
[2022-05-16 15:46:46.561424] log_interval ............... 100
[2022-05-16 15:46:46.561442] lr ......................... 0.001
[2022-05-16 15:46:46.561461] lr_decay_style ............. constant
[2022-05-16 15:46:46.561477] masked_lm .................. False
[2022-05-16 15:46:46.561494] max_k ...................... None
[2022-05-16 15:46:46.561511] max_num_mc_samples ......... 100000
[2022-05-16 15:46:46.561524] max_num_queries ............ 1000
[2022-05-16 15:46:46.561539] min_num_mc_samples ......... 10000
[2022-05-16 15:46:46.561554] min_phase_shift ............ 0
[2022-05-16 15:46:46.561569] min_var_reduction .......... 0.1
[2022-05-16 15:46:46.561583] min_variance ............... True
[2022-05-16 15:46:46.561598] model_budget_filepath ...... None
[2022-05-16 15:46:46.561614] num_beams .................. 0.0
[2022-05-16 15:46:46.561629] num_layers ................. 2
[2022-05-16 15:46:46.561644] num_mc_samples ............. 100
[2022-05-16 15:46:46.561660] num_workers ................ 0
[2022-05-16 15:46:46.561676] optimizer .................. adam
[2022-05-16 15:46:46.561694] proposal_func .............. <function lm_proposal at 0x7f1a2594cd30>
[2022-05-16 15:46:46.561709] rnn_type ................... LSTM
[2022-05-16 15:46:46.561721] save_epochs ................ 1
[2022-05-16 15:46:46.561737] seed ....................... 42
[2022-05-16 15:46:46.561753] seq_len .................... 100
[2022-05-16 15:46:46.561762] shuffle .................... True
[2022-05-16 15:46:46.561770] store_intermediate_lbs ..... True
[2022-05-16 15:46:46.561777] sub_estimates .............. []
[2022-05-16 15:46:46.561783] tau_a_excl_terms ........... []
[2022-05-16 15:46:46.561790] tau_b_excl_terms ........... []
[2022-05-16 15:46:46.561797] terms_of_interest .......... []
[2022-05-16 15:46:46.561804] text_dict .................. None
[2022-05-16 15:46:46.561811] top_k ...................... 0
[2022-05-16 15:46:46.561816] top_p ...................... 0
[2022-05-16 15:46:46.561823] total_seq_len .............. 20
[2022-05-16 15:46:46.561831] train_data_pct ............. 0.9
[2022-05-16 15:46:46.561838] train_epochs ............... 40
[2022-05-16 15:46:46.561845] use_gpt2 ................... False
[2022-05-16 15:46:46.561852] val_data_pct ............... 0.05
[2022-05-16 15:46:46.561873] val_metrics ................ ['accuracy']
[2022-05-16 15:46:46.561880] valid_epochs ............... 1
[2022-05-16 15:46:46.561893] variance_epsilon ........... 5e-06
[2022-05-16 15:46:46.561900] vocab_size ................. 68
[2022-05-16 15:46:46.561907] warmup_pct ................. 0.01
[2022-05-16 15:46:46.561914] weight_decay ............... 0.0
==================================================
[2022-05-16 15:46:46.562878] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 14 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-16 16:22:03.974945] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-16 16:22:03.977938] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-16 16:22:04.031713] batch_size ................. 4096
[2022-05-16 16:22:04.031729] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-16 16:22:04.031735] cuda ....................... True
[2022-05-16 16:22:04.031739] data_path .................. data/moocs/mooc.csv
[2022-05-16 16:22:04.031743] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:22:04.031747] device ..................... 6
[2022-05-16 16:22:04.031751] device_num ................. 0
[2022-05-16 16:22:04.031755] disable_tqdm ............... True
[2022-05-16 16:22:04.031759] do_test .................... False
[2022-05-16 16:22:04.031763] do_valid ................... True
[2022-05-16 16:22:04.031766] dont_print_args ............ True
[2022-05-16 16:22:04.031772] dont_shuffle ............... None
[2022-05-16 16:22:04.031781] dropout .................... 0.3
[2022-05-16 16:22:04.031787] estimate_type .............. <function beam_search_lower_bound at 0x7f1a25960e50>
[2022-05-16 16:22:04.031792] excluded_terms ............. [1]
[2022-05-16 16:22:04.031804] excluded_terms_list ........ [[]]
[2022-05-16 16:22:04.031808] finetune ................... False
[2022-05-16 16:22:04.031812] grad_clip .................. 1.0
[2022-05-16 16:22:04.031816] hidden_size ................ 128
[2022-05-16 16:22:04.031820] hist_len ................... 18
[2022-05-16 16:22:04.031823] hybrid_max_num_beams ....... 1500
[2022-05-16 16:22:04.031827] interp_func ................ <function lin_interp at 0x7f1a25960d30>
[2022-05-16 16:22:04.031831] log_interval ............... 100
[2022-05-16 16:22:04.031838] lr ......................... 0.001
[2022-05-16 16:22:04.031842] lr_decay_style ............. constant
[2022-05-16 16:22:04.031846] masked_lm .................. False
[2022-05-16 16:22:04.031850] max_k ...................... None
[2022-05-16 16:22:04.031853] max_num_mc_samples ......... 100000
[2022-05-16 16:22:04.031858] max_num_queries ............ 1000
[2022-05-16 16:22:04.031861] min_num_mc_samples ......... 10000
[2022-05-16 16:22:04.031865] min_phase_shift ............ 0
[2022-05-16 16:22:04.031869] min_var_reduction .......... 0.1
[2022-05-16 16:22:04.031872] min_variance ............... True
[2022-05-16 16:22:04.031876] model_budget_filepath ...... None
[2022-05-16 16:22:04.031881] needs_encoding ............. False
[2022-05-16 16:22:04.031885] num_beams .................. 0.0
[2022-05-16 16:22:04.031889] num_layers ................. 2
[2022-05-16 16:22:04.031892] num_mc_samples ............. 100
[2022-05-16 16:22:04.031896] num_workers ................ 0
[2022-05-16 16:22:04.031899] optimizer .................. adam
[2022-05-16 16:22:04.031903] proposal_func .............. <function lm_proposal at 0x7f1a2594cd30>
[2022-05-16 16:22:04.031908] rnn_type ................... LSTM
[2022-05-16 16:22:04.031911] save_epochs ................ 1
[2022-05-16 16:22:04.031915] seed ....................... 42
[2022-05-16 16:22:04.031918] seq_len .................... 15
[2022-05-16 16:22:04.031922] shuffle .................... True
[2022-05-16 16:22:04.031925] store_intermediate_lbs ..... True
[2022-05-16 16:22:04.031929] sub_estimates .............. []
[2022-05-16 16:22:04.031934] tau_a_excl_terms ........... []
[2022-05-16 16:22:04.031938] tau_b_excl_terms ........... []
[2022-05-16 16:22:04.031941] terms_of_interest .......... []
[2022-05-16 16:22:04.031945] text_dict .................. None
[2022-05-16 16:22:04.031948] top_k ...................... 0
[2022-05-16 16:22:04.031951] top_p ...................... 0
[2022-05-16 16:22:04.031955] total_seq_len .............. 20
[2022-05-16 16:22:04.031959] train_data_pct ............. 0.9
[2022-05-16 16:22:04.031963] train_epochs ............... 40
[2022-05-16 16:22:04.031966] use_gpt2 ................... False
[2022-05-16 16:22:04.031970] val_data_pct ............... 0.01
[2022-05-16 16:22:04.031974] val_metrics ................ ['accuracy']
[2022-05-16 16:22:04.031978] valid_epochs ............... 1
[2022-05-16 16:22:04.031983] variance_epsilon ........... 5e-06
[2022-05-16 16:22:04.031987] vocab_size ................. 98
[2022-05-16 16:22:04.031990] warmup_pct ................. 0.01
[2022-05-16 16:22:04.031994] weight_decay ............... 0.0
==================================================
[2022-05-16 16:22:04.032472] | Dataset: moocs | Sample type: pseudo_gt | Num samples: None | Hist length 9 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-16 16:47:25.734768] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-16 16:47:25.743055] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-16 16:47:26.022844] batch_size ................. 4096
[2022-05-16 16:47:26.022869] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-16 16:47:26.022874] cuda ....................... True
[2022-05-16 16:47:26.022877] data_path .................. data/apps/lsapp.tsv
[2022-05-16 16:47:26.022880] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:47:26.022883] device ..................... 6
[2022-05-16 16:47:26.022885] device_num ................. 0
[2022-05-16 16:47:26.022888] disable_tqdm ............... True
[2022-05-16 16:47:26.022891] do_test .................... False
[2022-05-16 16:47:26.022894] do_valid ................... True
[2022-05-16 16:47:26.022896] dont_print_args ............ True
[2022-05-16 16:47:26.022900] dont_shuffle ............... None
[2022-05-16 16:47:26.022907] dropout .................... 0.3
[2022-05-16 16:47:26.022912] estimate_type .............. <function beam_search_lower_bound at 0x7f1a25960e50>
[2022-05-16 16:47:26.022917] excluded_terms ............. [1]
[2022-05-16 16:47:26.022922] excluded_terms_list ........ [[]]
[2022-05-16 16:47:26.022925] finetune ................... False
[2022-05-16 16:47:26.022928] grad_clip .................. 1.0
[2022-05-16 16:47:26.022931] hidden_size ................ 512
[2022-05-16 16:47:26.022943] hist_len ................... 18
[2022-05-16 16:47:26.022946] hybrid_max_num_beams ....... 1500
[2022-05-16 16:47:26.022949] interp_func ................ <function lin_interp at 0x7f1a25960d30>
[2022-05-16 16:47:26.022952] log_interval ............... 100
[2022-05-16 16:47:26.022960] lr ......................... 0.001
[2022-05-16 16:47:26.022963] lr_decay_style ............. constant
[2022-05-16 16:47:26.022965] masked_lm .................. False
[2022-05-16 16:47:26.022968] max_k ...................... None
[2022-05-16 16:47:26.022971] max_num_mc_samples ......... 100000
[2022-05-16 16:47:26.022974] max_num_queries ............ 1000
[2022-05-16 16:47:26.022976] min_num_mc_samples ......... 10000
[2022-05-16 16:47:26.022979] min_phase_shift ............ 0
[2022-05-16 16:47:26.022982] min_var_reduction .......... 0.1
[2022-05-16 16:47:26.022984] min_variance ............... True
[2022-05-16 16:47:26.022987] model_budget_filepath ...... None
[2022-05-16 16:47:26.022990] needs_encoding ............. True
[2022-05-16 16:47:26.022993] num_beams .................. 0.0
[2022-05-16 16:47:26.022995] num_layers ................. 2
[2022-05-16 16:47:26.022998] num_mc_samples ............. 100
[2022-05-16 16:47:26.023000] num_workers ................ 0
[2022-05-16 16:47:26.023003] optimizer .................. adam
[2022-05-16 16:47:26.023006] proposal_func .............. <function lm_proposal at 0x7f1a2594cd30>
[2022-05-16 16:47:26.023009] rnn_type ................... LSTM
[2022-05-16 16:47:26.023011] save_epochs ................ 1
[2022-05-16 16:47:26.023014] seed ....................... 42
[2022-05-16 16:47:26.023016] seq_len .................... 15
[2022-05-16 16:47:26.023019] shuffle .................... True
[2022-05-16 16:47:26.023021] store_intermediate_lbs ..... True
[2022-05-16 16:47:26.023024] sub_estimates .............. []
[2022-05-16 16:47:26.023027] tau_a_excl_terms ........... []
[2022-05-16 16:47:26.023030] tau_b_excl_terms ........... []
[2022-05-16 16:47:26.023032] terms_of_interest .......... []
[2022-05-16 16:47:26.023035] text_dict .................. None
[2022-05-16 16:47:26.023037] top_k ...................... 0
[2022-05-16 16:47:26.023039] top_p ...................... 0
[2022-05-16 16:47:26.023042] total_seq_len .............. 20
[2022-05-16 16:47:26.023044] train_data_pct ............. 0.9
[2022-05-16 16:47:26.023047] train_epochs ............... 40
[2022-05-16 16:47:26.023050] use_gpt2 ................... False
[2022-05-16 16:47:26.023053] val_data_pct ............... 0.001
[2022-05-16 16:47:26.023056] val_metrics ................ ['accuracy']
[2022-05-16 16:47:26.023059] valid_epochs ............... 1
[2022-05-16 16:47:26.023063] variance_epsilon ........... 5e-06
[2022-05-16 16:47:26.023066] vocab_size ................. 88
[2022-05-16 16:47:26.023068] warmup_pct ................. 0.01
[2022-05-16 16:47:26.023071] weight_decay ............... 0.0
==================================================
[2022-05-16 16:47:26.023347] | Dataset: apps | Sample type: pseudo_gt | Num samples: None | Hist length 9 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-16 16:56:59.850453] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-16 16:56:59.859951] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-16 16:57:00.012090] batch_size ................. 4096
[2022-05-16 16:57:00.012112] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-16 16:57:00.012117] cuda ....................... True
[2022-05-16 16:57:00.012120] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-16 16:57:00.012123] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:57:00.012128] device ..................... 6
[2022-05-16 16:57:00.012131] device_num ................. 0
[2022-05-16 16:57:00.012133] disable_tqdm ............... True
[2022-05-16 16:57:00.012137] do_test .................... False
[2022-05-16 16:57:00.012140] do_valid ................... True
[2022-05-16 16:57:00.012142] dont_print_args ............ True
[2022-05-16 16:57:00.012146] dont_shuffle ............... None
[2022-05-16 16:57:00.012153] dropout .................... 0.3
[2022-05-16 16:57:00.012159] estimate_type .............. <function beam_search_lower_bound at 0x7f1a25960e50>
[2022-05-16 16:57:00.012164] excluded_terms ............. [1]
[2022-05-16 16:57:00.012168] excluded_terms_list ........ [[]]
[2022-05-16 16:57:00.012171] finetune ................... False
[2022-05-16 16:57:00.012174] grad_clip .................. 1.0
[2022-05-16 16:57:00.012177] hidden_size ................ 512
[2022-05-16 16:57:00.012193] hist_len ................... 18
[2022-05-16 16:57:00.012195] hybrid_max_num_beams ....... 1500
[2022-05-16 16:57:00.012198] interp_func ................ <function lin_interp at 0x7f1a25960d30>
[2022-05-16 16:57:00.012201] log_interval ............... 100
[2022-05-16 16:57:00.012211] lr ......................... 0.001
[2022-05-16 16:57:00.012214] lr_decay_style ............. constant
[2022-05-16 16:57:00.012217] masked_lm .................. False
[2022-05-16 16:57:00.012220] max_k ...................... None
[2022-05-16 16:57:00.012222] max_num_mc_samples ......... 100000
[2022-05-16 16:57:00.012225] max_num_queries ............ 1000
[2022-05-16 16:57:00.012228] min_num_mc_samples ......... 10000
[2022-05-16 16:57:00.012231] min_phase_shift ............ 0
[2022-05-16 16:57:00.012234] min_var_reduction .......... 0.1
[2022-05-16 16:57:00.012236] min_variance ............... True
[2022-05-16 16:57:00.012239] model_budget_filepath ...... None
[2022-05-16 16:57:00.012243] num_beams .................. 0.0
[2022-05-16 16:57:00.012246] num_layers ................. 2
[2022-05-16 16:57:00.012248] num_mc_samples ............. 100
[2022-05-16 16:57:00.012251] num_workers ................ 0
[2022-05-16 16:57:00.012253] optimizer .................. adam
[2022-05-16 16:57:00.012256] proposal_func .............. <function lm_proposal at 0x7f1a2594cd30>
[2022-05-16 16:57:00.012259] rnn_type ................... LSTM
[2022-05-16 16:57:00.012263] save_epochs ................ 1
[2022-05-16 16:57:00.012265] seed ....................... 42
[2022-05-16 16:57:00.012268] seq_len .................... 15
[2022-05-16 16:57:00.012271] shuffle .................... True
[2022-05-16 16:57:00.012273] store_intermediate_lbs ..... True
[2022-05-16 16:57:00.012276] sub_estimates .............. []
[2022-05-16 16:57:00.012278] tau_a_excl_terms ........... []
[2022-05-16 16:57:00.012281] tau_b_excl_terms ........... []
[2022-05-16 16:57:00.012284] terms_of_interest .......... []
[2022-05-16 16:57:00.012287] text_dict .................. None
[2022-05-16 16:57:00.012289] top_k ...................... 0
[2022-05-16 16:57:00.012292] top_p ...................... 0
[2022-05-16 16:57:00.012295] total_seq_len .............. 20
[2022-05-16 16:57:00.012298] train_data_pct ............. 0.9
[2022-05-16 16:57:00.012300] train_epochs ............... 40
[2022-05-16 16:57:00.012303] use_gpt2 ................... False
[2022-05-16 16:57:00.012306] val_data_pct ............... 0.0001
[2022-05-16 16:57:00.012309] val_metrics ................ ['accuracy']
[2022-05-16 16:57:00.012312] valid_epochs ............... 1
[2022-05-16 16:57:00.012316] variance_epsilon ........... 5e-06
[2022-05-16 16:57:00.012319] vocab_size ................. 30
[2022-05-16 16:57:00.012321] warmup_pct ................. 0.01
[2022-05-16 16:57:00.012324] weight_decay ............... 0.0
==================================================
[2022-05-16 16:57:00.012511] | Dataset: amazon | Sample type: pseudo_gt | Num samples: None | Hist length 9 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
