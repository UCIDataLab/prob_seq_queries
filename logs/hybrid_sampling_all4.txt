==================================================
* Running for dataset shakespeare
==================================================
[2022-05-10 15:18:27.024706] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-10 15:18:27.027958] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-10 15:18:27.029584] batch_size ................. 4096
[2022-05-10 15:18:27.029594] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-10 15:18:27.029609] cuda ....................... True
[2022-05-10 15:18:27.029612] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-10 15:18:27.029614] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 15:18:27.029617] device ..................... 5
[2022-05-10 15:18:27.029620] device_num ................. 0
[2022-05-10 15:18:27.029623] disable_tqdm ............... True
[2022-05-10 15:18:27.029625] do_test .................... False
[2022-05-10 15:18:27.029628] do_valid ................... True
[2022-05-10 15:18:27.029630] dont_print_args ............ True
[2022-05-10 15:18:27.029635] dont_shuffle ............... None
[2022-05-10 15:18:27.029641] dropout .................... 0.3
[2022-05-10 15:18:27.029645] estimate_type .............. <function beam_search_lower_bound at 0x7f733504caf0>
[2022-05-10 15:18:27.029649] excluded_terms ............. [1]
[2022-05-10 15:18:27.029652] finetune ................... False
[2022-05-10 15:18:27.029656] grad_clip .................. 1.0
[2022-05-10 15:18:27.029659] hidden_size ................ 128
[2022-05-10 15:18:27.029661] hist_len ................... 18
[2022-05-10 15:18:27.029665] interp_func ................ <function lin_interp at 0x7f733504c9d0>
[2022-05-10 15:18:27.029667] log_interval ............... 100
[2022-05-10 15:18:27.029671] lr ......................... 0.001
[2022-05-10 15:18:27.029673] lr_decay_style ............. constant
[2022-05-10 15:18:27.029676] masked_lm .................. False
[2022-05-10 15:18:27.029678] min_phase_shift ............ 0
[2022-05-10 15:18:27.029681] min_var_reduction .......... 0.1
[2022-05-10 15:18:27.029684] min_variance ............... True
[2022-05-10 15:18:27.029686] model_budget_filepath ...... None
[2022-05-10 15:18:27.029689] num_beams .................. 0.0
[2022-05-10 15:18:27.029692] num_layers ................. 2
[2022-05-10 15:18:27.029694] num_mc_samples ............. 100
[2022-05-10 15:18:27.029697] num_workers ................ 0
[2022-05-10 15:18:27.029699] optimizer .................. adam
[2022-05-10 15:18:27.029702] proposal_func .............. <function lm_proposal at 0x7f73350479d0>
[2022-05-10 15:18:27.029705] rnn_type ................... LSTM
[2022-05-10 15:18:27.029707] save_epochs ................ 1
[2022-05-10 15:18:27.029709] seed ....................... 42
[2022-05-10 15:18:27.029712] seq_len .................... 100
[2022-05-10 15:18:27.029714] shuffle .................... True
[2022-05-10 15:18:27.029717] store_intermediate_lbs ..... True
[2022-05-10 15:18:27.029719] sub_estimates .............. []
[2022-05-10 15:18:27.029722] text_dict .................. None
[2022-05-10 15:18:27.029724] top_k ...................... 0
[2022-05-10 15:18:27.029727] top_p ...................... 0
[2022-05-10 15:18:27.029729] total_seq_len .............. 20
[2022-05-10 15:18:27.029732] train_data_pct ............. 0.9
[2022-05-10 15:18:27.029734] train_epochs ............... 40
[2022-05-10 15:18:27.029736] val_data_pct ............... 0.05
[2022-05-10 15:18:27.029744] val_metrics ................ ['accuracy']
[2022-05-10 15:18:27.029746] valid_epochs ............... 1
[2022-05-10 15:18:27.029749] vocab_size ................. 68
[2022-05-10 15:18:27.029751] warmup_pct ................. 0.01
[2022-05-10 15:18:27.029754] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-10 15:39:35.034034] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-10 15:39:35.048952] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-10 15:39:35.235374] batch_size ................. 4096
[2022-05-10 15:39:35.235400] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-10 15:39:35.235411] cuda ....................... True
[2022-05-10 15:39:35.235415] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-10 15:39:35.235419] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 15:39:35.235423] device ..................... 5
[2022-05-10 15:39:35.235427] device_num ................. 0
[2022-05-10 15:39:35.235431] disable_tqdm ............... True
[2022-05-10 15:39:35.235436] do_test .................... False
[2022-05-10 15:39:35.235440] do_valid ................... True
[2022-05-10 15:39:35.235443] dont_print_args ............ True
[2022-05-10 15:39:35.235448] dont_shuffle ............... None
[2022-05-10 15:39:35.235456] dropout .................... 0.3
[2022-05-10 15:39:35.235462] estimate_type .............. <function beam_search_lower_bound at 0x7f733504caf0>
[2022-05-10 15:39:35.235467] excluded_terms ............. [1]
[2022-05-10 15:39:35.235475] finetune ................... False
[2022-05-10 15:39:35.235481] grad_clip .................. 1.0
[2022-05-10 15:39:35.235485] hidden_size ................ 512
[2022-05-10 15:39:35.235488] hist_len ................... 18
[2022-05-10 15:39:35.235492] interp_func ................ <function lin_interp at 0x7f733504c9d0>
[2022-05-10 15:39:35.235496] log_interval ............... 100
[2022-05-10 15:39:35.235501] lr ......................... 0.001
[2022-05-10 15:39:35.235504] lr_decay_style ............. constant
[2022-05-10 15:39:35.235508] masked_lm .................. False
[2022-05-10 15:39:35.235511] min_phase_shift ............ 0
[2022-05-10 15:39:35.235516] min_var_reduction .......... 0.1
[2022-05-10 15:39:35.235520] min_variance ............... True
[2022-05-10 15:39:35.235524] model_budget_filepath ...... None
[2022-05-10 15:39:35.235528] num_beams .................. 0.0
[2022-05-10 15:39:35.235531] num_layers ................. 2
[2022-05-10 15:39:35.235535] num_mc_samples ............. 100
[2022-05-10 15:39:35.235538] num_workers ................ 0
[2022-05-10 15:39:35.235542] optimizer .................. adam
[2022-05-10 15:39:35.235546] proposal_func .............. <function lm_proposal at 0x7f73350479d0>
[2022-05-10 15:39:35.235549] rnn_type ................... LSTM
[2022-05-10 15:39:35.235554] save_epochs ................ 1
[2022-05-10 15:39:35.235557] seed ....................... 42
[2022-05-10 15:39:35.235561] seq_len .................... 15
[2022-05-10 15:39:35.235574] shuffle .................... True
[2022-05-10 15:39:35.235578] store_intermediate_lbs ..... True
[2022-05-10 15:39:35.235582] sub_estimates .............. []
[2022-05-10 15:39:35.235585] text_dict .................. None
[2022-05-10 15:39:35.235589] top_k ...................... 0
[2022-05-10 15:39:35.235592] top_p ...................... 0
[2022-05-10 15:39:35.235595] total_seq_len .............. 20
[2022-05-10 15:39:35.235599] train_data_pct ............. 0.9
[2022-05-10 15:39:35.235602] train_epochs ............... 40
[2022-05-10 15:39:35.235606] val_data_pct ............... 0.0001
[2022-05-10 15:39:35.235611] val_metrics ................ ['accuracy']
[2022-05-10 15:39:35.235614] valid_epochs ............... 1
[2022-05-10 15:39:35.235618] vocab_size ................. 30
[2022-05-10 15:39:35.235621] warmup_pct ................. 0.01
[2022-05-10 15:39:35.235625] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-10 16:52:09.622871] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-10 16:52:09.633602] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-10 16:52:09.769035] batch_size ................. 4096
[2022-05-10 16:52:09.769066] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-10 16:52:09.769076] cuda ....................... True
[2022-05-10 16:52:09.769083] data_path .................. data/moocs/mooc.csv
[2022-05-10 16:52:09.769089] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 16:52:09.769095] device ..................... 5
[2022-05-10 16:52:09.769101] device_num ................. 0
[2022-05-10 16:52:09.769107] disable_tqdm ............... True
[2022-05-10 16:52:09.769113] do_test .................... False
[2022-05-10 16:52:09.769119] do_valid ................... True
[2022-05-10 16:52:09.769125] dont_print_args ............ True
[2022-05-10 16:52:09.769132] dont_shuffle ............... None
[2022-05-10 16:52:09.769144] dropout .................... 0.3
[2022-05-10 16:52:09.769153] estimate_type .............. <function beam_search_lower_bound at 0x7f733504caf0>
[2022-05-10 16:52:09.769164] excluded_terms ............. [1]
[2022-05-10 16:52:09.769172] finetune ................... False
[2022-05-10 16:52:09.769179] grad_clip .................. 1.0
[2022-05-10 16:52:09.769185] hidden_size ................ 128
[2022-05-10 16:52:09.769190] hist_len ................... 18
[2022-05-10 16:52:09.769197] interp_func ................ <function lin_interp at 0x7f733504c9d0>
[2022-05-10 16:52:09.769203] log_interval ............... 100
[2022-05-10 16:52:09.769210] lr ......................... 0.001
[2022-05-10 16:52:09.769216] lr_decay_style ............. constant
[2022-05-10 16:52:09.769222] masked_lm .................. False
[2022-05-10 16:52:09.769228] min_phase_shift ............ 0
[2022-05-10 16:52:09.769234] min_var_reduction .......... 0.1
[2022-05-10 16:52:09.769240] min_variance ............... True
[2022-05-10 16:52:09.769246] model_budget_filepath ...... None
[2022-05-10 16:52:09.769253] needs_encoding ............. False
[2022-05-10 16:52:09.769259] num_beams .................. 0.0
[2022-05-10 16:52:09.769265] num_layers ................. 2
[2022-05-10 16:52:09.769271] num_mc_samples ............. 100
[2022-05-10 16:52:09.769277] num_workers ................ 0
[2022-05-10 16:52:09.769282] optimizer .................. adam
[2022-05-10 16:52:09.769289] proposal_func .............. <function lm_proposal at 0x7f73350479d0>
[2022-05-10 16:52:09.769295] rnn_type ................... LSTM
[2022-05-10 16:52:09.769300] save_epochs ................ 1
[2022-05-10 16:52:09.769306] seed ....................... 42
[2022-05-10 16:52:09.769311] seq_len .................... 15
[2022-05-10 16:52:09.769317] shuffle .................... True
[2022-05-10 16:52:09.769323] store_intermediate_lbs ..... True
[2022-05-10 16:52:09.769329] sub_estimates .............. []
[2022-05-10 16:52:09.769335] text_dict .................. None
[2022-05-10 16:52:09.769341] top_k ...................... 0
[2022-05-10 16:52:09.769347] top_p ...................... 0
[2022-05-10 16:52:09.769352] total_seq_len .............. 20
[2022-05-10 16:52:09.769358] train_data_pct ............. 0.9
[2022-05-10 16:52:09.769365] train_epochs ............... 40
[2022-05-10 16:52:09.769371] val_data_pct ............... 0.01
[2022-05-10 16:52:09.769378] val_metrics ................ ['accuracy']
[2022-05-10 16:52:09.769384] valid_epochs ............... 1
[2022-05-10 16:52:09.769389] vocab_size ................. 98
[2022-05-10 16:52:09.769395] warmup_pct ................. 0.01
[2022-05-10 16:52:09.769401] weight_decay ............... 0.0
==================================================
Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 13 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 12 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-10 17:31:53.239999] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-10 17:31:53.313448] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-10 17:31:53.670480] batch_size ................. 4096
[2022-05-10 17:31:53.670516] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-10 17:31:53.670527] cuda ....................... True
[2022-05-10 17:31:53.670534] data_path .................. data/apps/lsapp.tsv
[2022-05-10 17:31:53.670540] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 17:31:53.670548] device ..................... 5
[2022-05-10 17:31:53.670554] device_num ................. 0
[2022-05-10 17:31:53.670561] disable_tqdm ............... True
[2022-05-10 17:31:53.670572] do_test .................... False
[2022-05-10 17:31:53.670579] do_valid ................... True
[2022-05-10 17:31:53.670585] dont_print_args ............ True
[2022-05-10 17:31:53.670595] dont_shuffle ............... None
[2022-05-10 17:31:53.670610] dropout .................... 0.3
[2022-05-10 17:31:53.670620] estimate_type .............. <function beam_search_lower_bound at 0x7f733504caf0>
[2022-05-10 17:31:53.670630] excluded_terms ............. [1]
[2022-05-10 17:31:53.670664] finetune ................... False
[2022-05-10 17:31:53.670672] grad_clip .................. 1.0
[2022-05-10 17:31:53.670678] hidden_size ................ 512
[2022-05-10 17:31:53.670685] hist_len ................... 18
[2022-05-10 17:31:53.670694] interp_func ................ <function lin_interp at 0x7f733504c9d0>
[2022-05-10 17:31:53.670700] log_interval ............... 100
[2022-05-10 17:31:53.670708] lr ......................... 0.001
[2022-05-10 17:31:53.670715] lr_decay_style ............. constant
[2022-05-10 17:31:53.670724] masked_lm .................. False
[2022-05-10 17:31:53.670730] min_phase_shift ............ 0
[2022-05-10 17:31:53.670738] min_var_reduction .......... 0.1
[2022-05-10 17:31:53.670744] min_variance ............... True
[2022-05-10 17:31:53.670751] model_budget_filepath ...... None
[2022-05-10 17:31:53.670759] needs_encoding ............. True
[2022-05-10 17:31:53.670766] num_beams .................. 0.0
[2022-05-10 17:31:53.670773] num_layers ................. 2
[2022-05-10 17:31:53.670779] num_mc_samples ............. 100
[2022-05-10 17:31:53.670786] num_workers ................ 0
[2022-05-10 17:31:53.670792] optimizer .................. adam
[2022-05-10 17:31:53.670805] proposal_func .............. <function lm_proposal at 0x7f73350479d0>
[2022-05-10 17:31:53.670812] rnn_type ................... LSTM
[2022-05-10 17:31:53.670818] save_epochs ................ 1
[2022-05-10 17:31:53.670825] seed ....................... 42
[2022-05-10 17:31:53.670831] seq_len .................... 15
[2022-05-10 17:31:53.670838] shuffle .................... True
[2022-05-10 17:31:53.670844] store_intermediate_lbs ..... True
[2022-05-10 17:31:53.670856] sub_estimates .............. []
[2022-05-10 17:31:53.670863] text_dict .................. None
[2022-05-10 17:31:53.670869] top_k ...................... 0
[2022-05-10 17:31:53.670876] top_p ...................... 0
[2022-05-10 17:31:53.670882] total_seq_len .............. 20
[2022-05-10 17:31:53.670890] train_data_pct ............. 0.9
[2022-05-10 17:31:53.670896] train_epochs ............... 40
[2022-05-10 17:31:53.670907] val_data_pct ............... 0.001
[2022-05-10 17:31:53.670916] val_metrics ................ ['accuracy']
[2022-05-10 17:31:53.670922] valid_epochs ............... 1
[2022-05-10 17:31:53.670929] vocab_size ................. 88
[2022-05-10 17:31:53.670936] warmup_pct ................. 0.01
[2022-05-10 17:31:53.670943] weight_decay ............... 0.0
==================================================
Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
