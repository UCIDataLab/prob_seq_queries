==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 14:05:47.684844] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 14:05:47.688555] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 14:05:47.691179] batch_size ................. 4096
[2022-05-12 14:05:47.691195] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 14:05:47.691207] cuda ....................... True
[2022-05-12 14:05:47.691213] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 14:05:47.691218] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:05:47.691225] device ..................... 7
[2022-05-12 14:05:47.691231] device_num ................. 0
[2022-05-12 14:05:47.691237] disable_tqdm ............... True
[2022-05-12 14:05:47.691243] do_test .................... False
[2022-05-12 14:05:47.691249] do_valid ................... True
[2022-05-12 14:05:47.691255] dont_print_args ............ True
[2022-05-12 14:05:47.691261] dont_shuffle ............... None
[2022-05-12 14:05:47.691288] dropout .................... 0.3
[2022-05-12 14:05:47.691296] estimate_type .............. <function beam_search_lower_bound at 0x7fa1d13e1940>
[2022-05-12 14:05:47.691305] excluded_terms ............. [1]
[2022-05-12 14:05:47.691313] finetune ................... False
[2022-05-12 14:05:47.691319] grad_clip .................. 1.0
[2022-05-12 14:05:47.691325] hidden_size ................ 128
[2022-05-12 14:05:47.691331] hist_len ................... 18
[2022-05-12 14:05:47.691337] interp_func ................ <function lin_interp at 0x7fa1d13e1820>
[2022-05-12 14:05:47.691343] log_interval ............... 100
[2022-05-12 14:05:47.691350] lr ......................... 0.001
[2022-05-12 14:05:47.691356] lr_decay_style ............. constant
[2022-05-12 14:05:47.691362] masked_lm .................. False
[2022-05-12 14:05:47.691368] max_num_mc_samples ......... 100000
[2022-05-12 14:05:47.691374] max_num_queries ............ 100
[2022-05-12 14:05:47.691379] min_num_mc_samples ......... 10000
[2022-05-12 14:05:47.691385] min_phase_shift ............ 0
[2022-05-12 14:05:47.691391] min_var_reduction .......... 0.1
[2022-05-12 14:05:47.691398] min_variance ............... True
[2022-05-12 14:05:47.691403] model_budget_filepath ...... None
[2022-05-12 14:05:47.691409] num_beams .................. 0.0
[2022-05-12 14:05:47.691415] num_layers ................. 2
[2022-05-12 14:05:47.691421] num_mc_samples ............. 100
[2022-05-12 14:05:47.691426] num_workers ................ 0
[2022-05-12 14:05:47.691432] optimizer .................. adam
[2022-05-12 14:05:47.691438] proposal_func .............. <function lm_proposal at 0x7fa1d13d0940>
[2022-05-12 14:05:47.691443] rnn_type ................... LSTM
[2022-05-12 14:05:47.691449] save_epochs ................ 1
[2022-05-12 14:05:47.691454] seed ....................... 42
[2022-05-12 14:05:47.691460] seq_len .................... 100
[2022-05-12 14:05:47.691466] shuffle .................... True
[2022-05-12 14:05:47.691471] store_intermediate_lbs ..... True
[2022-05-12 14:05:47.691477] sub_estimates .............. []
[2022-05-12 14:05:47.691483] text_dict .................. None
[2022-05-12 14:05:47.691489] top_k ...................... 0
[2022-05-12 14:05:47.691494] top_p ...................... 0
[2022-05-12 14:05:47.691500] total_seq_len .............. 20
[2022-05-12 14:05:47.691506] train_data_pct ............. 0.9
[2022-05-12 14:05:47.691512] train_epochs ............... 40
[2022-05-12 14:05:47.691517] use_gpt2 ................... False
[2022-05-12 14:05:47.691523] val_data_pct ............... 0.05
[2022-05-12 14:05:47.691530] val_metrics ................ ['accuracy']
[2022-05-12 14:05:47.691536] valid_epochs ............... 1
[2022-05-12 14:05:47.691544] variance_epsilon ........... 5e-06
[2022-05-12 14:05:47.691550] vocab_size ................. 68
[2022-05-12 14:05:47.691556] warmup_pct ................. 0.01
[2022-05-12 14:05:47.691568] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_10h_20s_1000mc_100q.pkl
[2022-05-12 14:05:47.692079] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 10 | Total Seq Length 20

..........
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_12h_20s_1000mc_100q.pkl
[2022-05-12 14:06:02.336375] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 12 | Total Seq Length 20

..........
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_100q.pkl
[2022-05-12 14:06:07.193330] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

..........
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 14:06:42.351777] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 14:06:42.363323] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 14:06:43.288216] batch_size ................. 4096
[2022-05-12 14:06:43.288248] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 14:06:43.288260] cuda ....................... True
[2022-05-12 14:06:43.288268] data_path .................. data/apps/lsapp.tsv
[2022-05-12 14:06:43.288275] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:06:43.288284] device ..................... 7
[2022-05-12 14:06:43.288291] device_num ................. 0
[2022-05-12 14:06:43.288298] disable_tqdm ............... True
[2022-05-12 14:06:43.288306] do_test .................... False
[2022-05-12 14:06:43.288313] do_valid ................... True
[2022-05-12 14:06:43.288320] dont_print_args ............ True
[2022-05-12 14:06:43.288328] dont_shuffle ............... None
[2022-05-12 14:06:43.288342] dropout .................... 0.3
[2022-05-12 14:06:43.288352] estimate_type .............. <function beam_search_lower_bound at 0x7fa1d13e1940>
[2022-05-12 14:06:43.288362] excluded_terms ............. [1]
[2022-05-12 14:06:43.288372] finetune ................... False
[2022-05-12 14:06:43.288379] grad_clip .................. 1.0
[2022-05-12 14:06:43.288386] hidden_size ................ 512
[2022-05-12 14:06:43.288393] hist_len ................... 18
[2022-05-12 14:06:43.288401] interp_func ................ <function lin_interp at 0x7fa1d13e1820>
[2022-05-12 14:06:43.288408] log_interval ............... 100
[2022-05-12 14:06:43.288416] lr ......................... 0.001
[2022-05-12 14:06:43.288422] lr_decay_style ............. constant
[2022-05-12 14:06:43.288429] masked_lm .................. False
[2022-05-12 14:06:43.288436] max_num_mc_samples ......... 100000
[2022-05-12 14:06:43.288442] max_num_queries ............ 100
[2022-05-12 14:06:43.288449] min_num_mc_samples ......... 10000
[2022-05-12 14:06:43.288456] min_phase_shift ............ 0
[2022-05-12 14:06:43.288464] min_var_reduction .......... 0.1
[2022-05-12 14:06:43.288471] min_variance ............... True
[2022-05-12 14:06:43.288478] model_budget_filepath ...... None
[2022-05-12 14:06:43.288485] needs_encoding ............. True
[2022-05-12 14:06:43.288492] num_beams .................. 0.0
[2022-05-12 14:06:43.288499] num_layers ................. 2
[2022-05-12 14:06:43.288506] num_mc_samples ............. 100
[2022-05-12 14:06:43.288512] num_workers ................ 0
[2022-05-12 14:06:43.288519] optimizer .................. adam
[2022-05-12 14:06:43.288527] proposal_func .............. <function lm_proposal at 0x7fa1d13d0940>
[2022-05-12 14:06:43.288533] rnn_type ................... LSTM
[2022-05-12 14:06:43.288540] save_epochs ................ 1
[2022-05-12 14:06:43.288546] seed ....................... 42
[2022-05-12 14:06:43.288553] seq_len .................... 15
[2022-05-12 14:06:43.288560] shuffle .................... True
[2022-05-12 14:06:43.288567] store_intermediate_lbs ..... True
[2022-05-12 14:06:43.288573] sub_estimates .............. []
[2022-05-12 14:06:43.288580] text_dict .................. None
[2022-05-12 14:06:43.288587] top_k ...................... 0
[2022-05-12 14:06:43.288593] top_p ...................... 0
[2022-05-12 14:06:43.288600] total_seq_len .............. 20
[2022-05-12 14:06:43.288607] train_data_pct ............. 0.9
[2022-05-12 14:06:43.288614] train_epochs ............... 40
[2022-05-12 14:06:43.288621] use_gpt2 ................... False
[2022-05-12 14:06:43.288628] val_data_pct ............... 0.001
[2022-05-12 14:06:43.288637] val_metrics ................ ['accuracy']
[2022-05-12 14:06:43.288644] valid_epochs ............... 1
[2022-05-12 14:06:43.288653] variance_epsilon ........... 5e-06
[2022-05-12 14:06:43.288661] vocab_size ................. 88
[2022-05-12 14:06:43.288668] warmup_pct ................. 0.01
[2022-05-12 14:06:43.288675] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_5h_15s_1000mc_100q.pkl
[2022-05-12 14:06:43.289422] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 5 | Total Seq Length 15

..........
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_8h_15s_1000mc_100q.pkl
[2022-05-12 14:06:55.499853] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

..........
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_11h_15s_1000mc_100q.pkl
[2022-05-12 14:07:01.659846] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

..........
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-12 14:07:07.851624] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-12 14:07:07.855370] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-12 14:07:07.987088] batch_size ................. 4096
[2022-05-12 14:07:07.987117] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-12 14:07:07.987126] cuda ....................... True
[2022-05-12 14:07:07.987132] data_path .................. data/moocs/mooc.csv
[2022-05-12 14:07:07.987138] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:07:07.987144] device ..................... 7
[2022-05-12 14:07:07.987150] device_num ................. 0
[2022-05-12 14:07:07.987156] disable_tqdm ............... True
[2022-05-12 14:07:07.987162] do_test .................... False
[2022-05-12 14:07:07.987168] do_valid ................... True
[2022-05-12 14:07:07.987174] dont_print_args ............ True
[2022-05-12 14:07:07.987181] dont_shuffle ............... None
[2022-05-12 14:07:07.987194] dropout .................... 0.3
[2022-05-12 14:07:07.987201] estimate_type .............. <function beam_search_lower_bound at 0x7fa1d13e1940>
[2022-05-12 14:07:07.987210] excluded_terms ............. [1]
[2022-05-12 14:07:07.987218] finetune ................... False
[2022-05-12 14:07:07.987224] grad_clip .................. 1.0
[2022-05-12 14:07:07.987230] hidden_size ................ 128
[2022-05-12 14:07:07.987236] hist_len ................... 18
[2022-05-12 14:07:07.987242] interp_func ................ <function lin_interp at 0x7fa1d13e1820>
[2022-05-12 14:07:07.987248] log_interval ............... 100
[2022-05-12 14:07:07.987255] lr ......................... 0.001
[2022-05-12 14:07:07.987261] lr_decay_style ............. constant
[2022-05-12 14:07:07.987267] masked_lm .................. False
[2022-05-12 14:07:07.987273] max_num_mc_samples ......... 100000
[2022-05-12 14:07:07.987278] max_num_queries ............ 100
[2022-05-12 14:07:07.987284] min_num_mc_samples ......... 10000
[2022-05-12 14:07:07.987290] min_phase_shift ............ 0
[2022-05-12 14:07:07.987296] min_var_reduction .......... 0.1
[2022-05-12 14:07:07.987302] min_variance ............... True
[2022-05-12 14:07:07.987308] model_budget_filepath ...... None
[2022-05-12 14:07:07.987314] needs_encoding ............. False
[2022-05-12 14:07:07.987320] num_beams .................. 0.0
[2022-05-12 14:07:07.987326] num_layers ................. 2
[2022-05-12 14:07:07.987331] num_mc_samples ............. 100
[2022-05-12 14:07:07.987337] num_workers ................ 0
[2022-05-12 14:07:07.987342] optimizer .................. adam
[2022-05-12 14:07:07.987348] proposal_func .............. <function lm_proposal at 0x7fa1d13d0940>
[2022-05-12 14:07:07.987354] rnn_type ................... LSTM
[2022-05-12 14:07:07.987359] save_epochs ................ 1
[2022-05-12 14:07:07.987365] seed ....................... 42
[2022-05-12 14:07:07.987410] seq_len .................... 15
[2022-05-12 14:07:07.987416] shuffle .................... True
[2022-05-12 14:07:07.987421] store_intermediate_lbs ..... True
[2022-05-12 14:07:07.987427] sub_estimates .............. []
[2022-05-12 14:07:07.987433] text_dict .................. None
[2022-05-12 14:07:07.987438] top_k ...................... 0
[2022-05-12 14:07:07.987444] top_p ...................... 0
[2022-05-12 14:07:07.987456] total_seq_len .............. 20
[2022-05-12 14:07:07.987462] train_data_pct ............. 0.9
[2022-05-12 14:07:07.987468] train_epochs ............... 40
[2022-05-12 14:07:07.987473] use_gpt2 ................... False
[2022-05-12 14:07:07.987479] val_data_pct ............... 0.01
[2022-05-12 14:07:07.987487] val_metrics ................ ['accuracy']
[2022-05-12 14:07:07.987492] valid_epochs ............... 1
[2022-05-12 14:07:07.987500] variance_epsilon ........... 5e-06
[2022-05-12 14:07:07.987507] vocab_size ................. 98
[2022-05-12 14:07:07.987514] warmup_pct ................. 0.01
[2022-05-12 14:07:07.987520] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_5h_15s_1000mc_100q.pkl
[2022-05-12 14:07:07.988352] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 5 | Total Seq Length 15

..........
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_8h_15s_1000mc_100q.pkl
[2022-05-12 14:07:22.406445] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

..........
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_11h_15s_1000mc_100q.pkl
[2022-05-12 14:07:31.993234] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

..........
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 14:09:10.677191] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 14:09:10.691799] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 14:09:10.958450] batch_size ................. 4096
[2022-05-12 14:09:10.958479] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 14:09:10.958487] cuda ....................... True
[2022-05-12 14:09:10.958493] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 14:09:10.958501] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:09:10.958509] device ..................... 7
[2022-05-12 14:09:10.958515] device_num ................. 0
[2022-05-12 14:09:10.958521] disable_tqdm ............... True
[2022-05-12 14:09:10.958528] do_test .................... False
[2022-05-12 14:09:10.958534] do_valid ................... True
[2022-05-12 14:09:10.958540] dont_print_args ............ True
[2022-05-12 14:09:10.958547] dont_shuffle ............... None
[2022-05-12 14:09:10.958561] dropout .................... 0.3
[2022-05-12 14:09:10.958569] estimate_type .............. <function beam_search_lower_bound at 0x7fa1d13e1940>
[2022-05-12 14:09:10.958577] excluded_terms ............. [1]
[2022-05-12 14:09:10.958586] finetune ................... False
[2022-05-12 14:09:10.958593] grad_clip .................. 1.0
[2022-05-12 14:09:10.958599] hidden_size ................ 512
[2022-05-12 14:09:10.958605] hist_len ................... 18
[2022-05-12 14:09:10.958632] interp_func ................ <function lin_interp at 0x7fa1d13e1820>
[2022-05-12 14:09:10.958638] log_interval ............... 100
[2022-05-12 14:09:10.958645] lr ......................... 0.001
[2022-05-12 14:09:10.958651] lr_decay_style ............. constant
[2022-05-12 14:09:10.958663] masked_lm .................. False
[2022-05-12 14:09:10.958669] max_num_mc_samples ......... 100000
[2022-05-12 14:09:10.958674] max_num_queries ............ 100
[2022-05-12 14:09:10.958680] min_num_mc_samples ......... 10000
[2022-05-12 14:09:10.958686] min_phase_shift ............ 0
[2022-05-12 14:09:10.958694] min_var_reduction .......... 0.1
[2022-05-12 14:09:10.958700] min_variance ............... True
[2022-05-12 14:09:10.958706] model_budget_filepath ...... None
[2022-05-12 14:09:10.958712] num_beams .................. 0.0
[2022-05-12 14:09:10.958718] num_layers ................. 2
[2022-05-12 14:09:10.958724] num_mc_samples ............. 100
[2022-05-12 14:09:10.958730] num_workers ................ 0
[2022-05-12 14:09:10.958736] optimizer .................. adam
[2022-05-12 14:09:10.958742] proposal_func .............. <function lm_proposal at 0x7fa1d13d0940>
[2022-05-12 14:09:10.958748] rnn_type ................... LSTM
[2022-05-12 14:09:10.958753] save_epochs ................ 1
[2022-05-12 14:09:10.958759] seed ....................... 42
[2022-05-12 14:09:10.958764] seq_len .................... 15
[2022-05-12 14:09:10.958771] shuffle .................... True
[2022-05-12 14:09:10.958777] store_intermediate_lbs ..... True
[2022-05-12 14:09:10.958783] sub_estimates .............. []
[2022-05-12 14:09:10.958788] text_dict .................. None
[2022-05-12 14:09:10.958794] top_k ...................... 0
[2022-05-12 14:09:10.958799] top_p ...................... 0
[2022-05-12 14:09:10.958804] total_seq_len .............. 20
[2022-05-12 14:09:10.958812] train_data_pct ............. 0.9
[2022-05-12 14:09:10.958817] train_epochs ............... 40
[2022-05-12 14:09:10.958823] use_gpt2 ................... False
[2022-05-12 14:09:10.958829] val_data_pct ............... 0.0001
[2022-05-12 14:09:10.958836] val_metrics ................ ['accuracy']
[2022-05-12 14:09:10.958842] valid_epochs ............... 1
[2022-05-12 14:09:10.958850] variance_epsilon ........... 5e-06
[2022-05-12 14:09:10.958855] vocab_size ................. 30
[2022-05-12 14:09:10.958863] warmup_pct ................. 0.01
[2022-05-12 14:09:10.958869] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_5h_15s_1000mc_100q.pkl
[2022-05-12 14:09:10.959883] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 5 | Total Seq Length 15

..........
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_8h_15s_1000mc_100q.pkl
[2022-05-12 14:09:20.876159] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

..........
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc_100q.pkl
[2022-05-12 14:09:25.451274] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 11 | Total Seq Length 15

..........
==================================================
