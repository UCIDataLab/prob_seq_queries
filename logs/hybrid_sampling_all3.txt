==================================================
* Running for dataset apps
==================================================
[2022-05-04 21:29:54.845588] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-04 21:29:54.857847] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-04 21:29:54.879468] batch_size .......... 4096
[2022-05-04 21:29:54.879485] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-04 21:29:54.879490] cuda ................ True
[2022-05-04 21:29:54.879493] data_path ........... data/apps/lsapp.tsv
[2022-05-04 21:29:54.879495] device .............. 3
[2022-05-04 21:29:54.879498] device_num .......... 0
[2022-05-04 21:29:54.879501] disable_tqdm ........ True
[2022-05-04 21:29:54.879503] do_test ............. False
[2022-05-04 21:29:54.879506] do_valid ............ True
[2022-05-04 21:29:54.879509] dont_print_args ..... True
[2022-05-04 21:29:54.879512] dont_shuffle ........ None
[2022-05-04 21:29:54.879518] dropout ............. 0.3
[2022-05-04 21:29:54.879523] estimate_type ....... <function beam_search_is_hybrid at 0x7fdf85b934c0>
[2022-05-04 21:29:54.879527] excluded_terms ...... [1]
[2022-05-04 21:29:54.879530] finetune ............ False
[2022-05-04 21:29:54.879534] grad_clip ........... 1.0
[2022-05-04 21:29:54.879536] hidden_size ......... 512
[2022-05-04 21:29:54.879539] hist_len ............ 18
[2022-05-04 21:29:54.879542] interp_func ......... <function lin_interp at 0x7fdf85b93700>
[2022-05-04 21:29:54.879545] log_interval ........ 100
[2022-05-04 21:29:54.879548] lr .................. 0.001
[2022-05-04 21:29:54.879551] lr_decay_style ...... constant
[2022-05-04 21:29:54.879553] masked_lm ........... False
[2022-05-04 21:29:54.879556] min_var_reduction ... 0.1
[2022-05-04 21:29:54.879559] min_variance ........ True
[2022-05-04 21:29:54.879570] num_beams ........... 0.0
[2022-05-04 21:29:54.879573] num_layers .......... 2
[2022-05-04 21:29:54.879576] num_mc_samples ...... 1000
[2022-05-04 21:29:54.879578] num_workers ......... 0
[2022-05-04 21:29:54.879581] optimizer ........... adam
[2022-05-04 21:29:54.879584] proposal_func ....... <function lm_proposal at 0x7fdf85b8c940>
[2022-05-04 21:29:54.879586] rnn_type ............ LSTM
[2022-05-04 21:29:54.879589] save_epochs ......... 1
[2022-05-04 21:29:54.879591] seed ................ 1234321
[2022-05-04 21:29:54.879594] seq_len ............. 15
[2022-05-04 21:29:54.879597] shuffle ............. True
[2022-05-04 21:29:54.879600] sub_estimates ....... [10, 100, 1000]
[2022-05-04 21:29:54.879603] text_dict ........... None
[2022-05-04 21:29:54.879605] top_k ............... 0
[2022-05-04 21:29:54.879624] top_p ............... 0
[2022-05-04 21:29:54.879628] total_seq_len ....... 20
[2022-05-04 21:29:54.879633] train_data_pct ...... 0.9
[2022-05-04 21:29:54.879637] train_epochs ........ 40
[2022-05-04 21:29:54.879642] val_data_pct ........ 0.001
[2022-05-04 21:29:54.879647] val_metrics ......... ['accuracy']
[2022-05-04 21:29:54.879651] valid_epochs ........ 1
[2022-05-04 21:29:54.879655] vocab_size .......... 88
[2022-05-04 21:29:54.879660] warmup_pct .......... 0.01
[2022-05-04 21:29:54.879665] weight_decay ........ 0.0
==================================================
Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 10 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-04 22:37:29.278264] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-04 22:37:29.292874] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-04 22:37:29.677519] batch_size .......... 4096
[2022-05-04 22:37:29.677541] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-04 22:37:29.677551] cuda ................ True
[2022-05-04 22:37:29.677556] data_path ........... /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-04 22:37:29.677560] device .............. 3
[2022-05-04 22:37:29.677564] device_num .......... 0
[2022-05-04 22:37:29.677568] disable_tqdm ........ True
[2022-05-04 22:37:29.677571] do_test ............. False
[2022-05-04 22:37:29.677575] do_valid ............ True
[2022-05-04 22:37:29.677578] dont_print_args ..... True
[2022-05-04 22:37:29.677583] dont_shuffle ........ None
[2022-05-04 22:37:29.677591] dropout ............. 0.3
[2022-05-04 22:37:29.677597] estimate_type ....... <function beam_search_is_hybrid at 0x7fdf85b934c0>
[2022-05-04 22:37:29.677602] excluded_terms ...... [1]
[2022-05-04 22:37:29.677606] finetune ............ False
[2022-05-04 22:37:29.677615] grad_clip ........... 1.0
[2022-05-04 22:37:29.677618] hidden_size ......... 512
[2022-05-04 22:37:29.677622] hist_len ............ 18
[2022-05-04 22:37:29.677626] interp_func ......... <function lin_interp at 0x7fdf85b93700>
[2022-05-04 22:37:29.677630] log_interval ........ 100
[2022-05-04 22:37:29.677635] lr .................. 0.001
[2022-05-04 22:37:29.677638] lr_decay_style ...... constant
[2022-05-04 22:37:29.677642] masked_lm ........... False
[2022-05-04 22:37:29.677646] min_var_reduction ... 0.1
[2022-05-04 22:37:29.677650] min_variance ........ True
[2022-05-04 22:37:29.677653] num_beams ........... 0.0
[2022-05-04 22:37:29.677657] num_layers .......... 2
[2022-05-04 22:37:29.677660] num_mc_samples ...... 1000
[2022-05-04 22:37:29.677664] num_workers ......... 0
[2022-05-04 22:37:29.677667] optimizer ........... adam
[2022-05-04 22:37:29.677671] proposal_func ....... <function lm_proposal at 0x7fdf85b8c940>
[2022-05-04 22:37:29.677674] rnn_type ............ LSTM
[2022-05-04 22:37:29.677678] save_epochs ......... 1
[2022-05-04 22:37:29.677681] seed ................ 1234321
[2022-05-04 22:37:29.677686] seq_len ............. 15
[2022-05-04 22:37:29.677690] shuffle ............. True
[2022-05-04 22:37:29.677695] sub_estimates ....... [10, 100, 1000]
[2022-05-04 22:37:29.677699] text_dict ........... None
[2022-05-04 22:37:29.677702] top_k ............... 0
[2022-05-04 22:37:29.677705] top_p ............... 0
[2022-05-04 22:37:29.677709] total_seq_len ....... 20
[2022-05-04 22:37:29.677714] train_data_pct ...... 0.9
[2022-05-04 22:37:29.677718] train_epochs ........ 40
[2022-05-04 22:37:29.677722] val_data_pct ........ 0.0001
[2022-05-04 22:37:29.677726] val_metrics ......... ['accuracy']
[2022-05-04 22:37:29.677729] valid_epochs ........ 1
[2022-05-04 22:37:29.677733] vocab_size .......... 30
[2022-05-04 22:37:29.677737] warmup_pct .......... 0.01
[2022-05-04 22:37:29.677740] weight_decay ........ 0.0
==================================================
Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 9 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 8 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset shakespeare
==================================================
[2022-05-05 01:40:31.890016] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-05 01:40:31.893917] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-05 01:40:31.894079] batch_size .......... 4096
[2022-05-05 01:40:31.894089] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-05 01:40:31.894096] cuda ................ True
[2022-05-05 01:40:31.894102] data_path ........... data/shakespeare/shakespeare_input.txt
[2022-05-05 01:40:31.894107] device .............. 3
[2022-05-05 01:40:31.894113] device_num .......... 0
[2022-05-05 01:40:31.894119] disable_tqdm ........ True
[2022-05-05 01:40:31.894125] do_test ............. False
[2022-05-05 01:40:31.894131] do_valid ............ True
[2022-05-05 01:40:31.894136] dont_print_args ..... True
[2022-05-05 01:40:31.894142] dont_shuffle ........ None
[2022-05-05 01:40:31.894154] dropout ............. 0.3
[2022-05-05 01:40:31.894161] estimate_type ....... <function beam_search_is_hybrid at 0x7fdf85b934c0>
[2022-05-05 01:40:31.894168] excluded_terms ...... [1]
[2022-05-05 01:40:31.894173] finetune ............ False
[2022-05-05 01:40:31.894181] grad_clip ........... 1.0
[2022-05-05 01:40:31.894186] hidden_size ......... 128
[2022-05-05 01:40:31.894192] hist_len ............ 18
[2022-05-05 01:40:31.894198] interp_func ......... <function lin_interp at 0x7fdf85b93700>
[2022-05-05 01:40:31.894204] log_interval ........ 100
[2022-05-05 01:40:31.894210] lr .................. 0.001
[2022-05-05 01:40:31.894216] lr_decay_style ...... constant
[2022-05-05 01:40:31.894221] masked_lm ........... False
[2022-05-05 01:40:31.894227] min_var_reduction ... 0.1
[2022-05-05 01:40:31.894233] min_variance ........ True
[2022-05-05 01:40:31.894239] num_beams ........... 0.0
[2022-05-05 01:40:31.894244] num_layers .......... 2
[2022-05-05 01:40:31.894250] num_mc_samples ...... 1000
[2022-05-05 01:40:31.894256] num_workers ......... 0
[2022-05-05 01:40:31.894261] optimizer ........... adam
[2022-05-05 01:40:31.894267] proposal_func ....... <function lm_proposal at 0x7fdf85b8c940>
[2022-05-05 01:40:31.894272] rnn_type ............ LSTM
[2022-05-05 01:40:31.894278] save_epochs ......... 1
[2022-05-05 01:40:31.894283] seed ................ 1234321
[2022-05-05 01:40:31.894289] seq_len ............. 100
[2022-05-05 01:40:31.894294] shuffle ............. True
[2022-05-05 01:40:31.894301] sub_estimates ....... [10, 100, 1000]
[2022-05-05 01:40:31.894307] text_dict ........... None
[2022-05-05 01:40:31.894313] top_k ............... 0
[2022-05-05 01:40:31.894318] top_p ............... 0
[2022-05-05 01:40:31.894323] total_seq_len ....... 20
[2022-05-05 01:40:31.894329] train_data_pct ...... 0.9
[2022-05-05 01:40:31.894335] train_epochs ........ 40
[2022-05-05 01:40:31.894341] val_data_pct ........ 0.05
[2022-05-05 01:40:31.894347] val_metrics ......... ['accuracy']
[2022-05-05 01:40:31.894353] valid_epochs ........ 1
[2022-05-05 01:40:31.894358] vocab_size .......... 68
[2022-05-05 01:40:31.894364] warmup_pct .......... 0.01
[2022-05-05 01:40:31.894370] weight_decay ........ 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 15 | Total Seq Length 20

...........