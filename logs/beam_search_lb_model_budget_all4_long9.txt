==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 17:10:37.211604] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 17:10:37.216678] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 17:10:37.219123] batch_size ................. 4096
[2022-05-16 17:10:37.219140] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 17:10:37.219151] cuda ....................... True
[2022-05-16 17:10:37.219157] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 17:10:37.219163] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 17:10:37.219168] device ..................... 6
[2022-05-16 17:10:37.219174] device_num ................. 0
[2022-05-16 17:10:37.219180] disable_tqdm ............... True
[2022-05-16 17:10:37.219186] do_test .................... False
[2022-05-16 17:10:37.219192] do_valid ................... True
[2022-05-16 17:10:37.219198] dont_print_args ............ True
[2022-05-16 17:10:37.219205] dont_shuffle ............... None
[2022-05-16 17:10:37.219216] dropout .................... 0.3
[2022-05-16 17:10:37.219225] estimate_type .............. <function beam_search_lower_bound at 0x7f0afbaa3ee0>
[2022-05-16 17:10:37.219233] excluded_terms ............. [1]
[2022-05-16 17:10:37.219242] excluded_terms_list ........ [[]]
[2022-05-16 17:10:37.219248] finetune ................... False
[2022-05-16 17:10:37.219254] grad_clip .................. 1.0
[2022-05-16 17:10:37.219259] hidden_size ................ 128
[2022-05-16 17:10:37.219266] hist_len ................... 18
[2022-05-16 17:10:37.219271] hybrid_max_num_beams ....... 1500
[2022-05-16 17:10:37.219278] interp_func ................ <function lin_interp at 0x7f0afbaa3dc0>
[2022-05-16 17:10:37.219283] log_interval ............... 100
[2022-05-16 17:10:37.219290] lr ......................... 0.001
[2022-05-16 17:10:37.219296] lr_decay_style ............. constant
[2022-05-16 17:10:37.219301] masked_lm .................. False
[2022-05-16 17:10:37.219307] max_k ...................... None
[2022-05-16 17:10:37.219313] max_num_mc_samples ......... 100000
[2022-05-16 17:10:37.219319] max_num_queries ............ 1000
[2022-05-16 17:10:37.219324] min_num_mc_samples ......... 10000
[2022-05-16 17:10:37.219330] min_phase_shift ............ 0
[2022-05-16 17:10:37.219336] min_var_reduction .......... 0.1
[2022-05-16 17:10:37.219342] min_variance ............... True
[2022-05-16 17:10:37.219347] model_budget_filepath ...... None
[2022-05-16 17:10:37.219353] num_beams .................. 0.0
[2022-05-16 17:10:37.219359] num_layers ................. 2
[2022-05-16 17:10:37.219365] num_mc_samples ............. 100
[2022-05-16 17:10:37.219370] num_workers ................ 0
[2022-05-16 17:10:37.219375] optimizer .................. adam
[2022-05-16 17:10:37.219381] proposal_func .............. <function lm_proposal at 0x7f0afba90dc0>
[2022-05-16 17:10:37.219387] rnn_type ................... LSTM
[2022-05-16 17:10:37.219392] save_epochs ................ 1
[2022-05-16 17:10:37.219398] seed ....................... 42
[2022-05-16 17:10:37.219403] seq_len .................... 100
[2022-05-16 17:10:37.219409] shuffle .................... True
[2022-05-16 17:10:37.219414] store_intermediate_lbs ..... True
[2022-05-16 17:10:37.219420] sub_estimates .............. []
[2022-05-16 17:10:37.219426] tau_a_excl_terms ........... []
[2022-05-16 17:10:37.219431] tau_b_excl_terms ........... []
[2022-05-16 17:10:37.219437] terms_of_interest .......... []
[2022-05-16 17:10:37.219442] text_dict .................. None
[2022-05-16 17:10:37.219448] top_k ...................... 0
[2022-05-16 17:10:37.219453] top_p ...................... 0
[2022-05-16 17:10:37.219459] total_seq_len .............. 20
[2022-05-16 17:10:37.219464] train_data_pct ............. 0.9
[2022-05-16 17:10:37.219470] train_epochs ............... 40
[2022-05-16 17:10:37.219475] use_gpt2 ................... False
[2022-05-16 17:10:37.219482] val_data_pct ............... 0.05
[2022-05-16 17:10:37.219488] val_metrics ................ ['accuracy']
[2022-05-16 17:10:37.219493] valid_epochs ............... 1
[2022-05-16 17:10:37.219502] variance_epsilon ........... 5e-06
[2022-05-16 17:10:37.219508] vocab_size ................. 68
[2022-05-16 17:10:37.219514] warmup_pct ................. 0.01
[2022-05-16 17:10:37.219520] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc_1000q.pkl
[2022-05-16 17:10:37.225774] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 14 | Total Seq Length 20

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-16 17:12:06.733983] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-16 17:12:06.737279] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-16 17:12:06.876616] batch_size ................. 4096
[2022-05-16 17:12:06.876641] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-16 17:12:06.876650] cuda ....................... True
[2022-05-16 17:12:06.876657] data_path .................. data/moocs/mooc.csv
[2022-05-16 17:12:06.876662] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 17:12:06.876669] device ..................... 6
[2022-05-16 17:12:06.876674] device_num ................. 0
[2022-05-16 17:12:06.876680] disable_tqdm ............... True
[2022-05-16 17:12:06.876687] do_test .................... False
[2022-05-16 17:12:06.876693] do_valid ................... True
[2022-05-16 17:12:06.876699] dont_print_args ............ True
[2022-05-16 17:12:06.876706] dont_shuffle ............... None
[2022-05-16 17:12:06.876718] dropout .................... 0.3
[2022-05-16 17:12:06.876725] estimate_type .............. <function beam_search_lower_bound at 0x7f0afbaa3ee0>
[2022-05-16 17:12:06.876733] excluded_terms ............. [1]
[2022-05-16 17:12:06.876740] excluded_terms_list ........ [[]]
[2022-05-16 17:12:06.876746] finetune ................... False
[2022-05-16 17:12:06.876753] grad_clip .................. 1.0
[2022-05-16 17:12:06.876758] hidden_size ................ 128
[2022-05-16 17:12:06.876764] hist_len ................... 18
[2022-05-16 17:12:06.876769] hybrid_max_num_beams ....... 1500
[2022-05-16 17:12:06.876776] interp_func ................ <function lin_interp at 0x7f0afbaa3dc0>
[2022-05-16 17:12:06.876782] log_interval ............... 100
[2022-05-16 17:12:06.876789] lr ......................... 0.001
[2022-05-16 17:12:06.876794] lr_decay_style ............. constant
[2022-05-16 17:12:06.876800] masked_lm .................. False
[2022-05-16 17:12:06.876805] max_k ...................... None
[2022-05-16 17:12:06.876811] max_num_mc_samples ......... 100000
[2022-05-16 17:12:06.876817] max_num_queries ............ 1000
[2022-05-16 17:12:06.876822] min_num_mc_samples ......... 10000
[2022-05-16 17:12:06.876827] min_phase_shift ............ 0
[2022-05-16 17:12:06.876833] min_var_reduction .......... 0.1
[2022-05-16 17:12:06.876839] min_variance ............... True
[2022-05-16 17:12:06.876845] model_budget_filepath ...... None
[2022-05-16 17:12:06.876850] needs_encoding ............. False
[2022-05-16 17:12:06.876856] num_beams .................. 0.0
[2022-05-16 17:12:06.876862] num_layers ................. 2
[2022-05-16 17:12:06.876867] num_mc_samples ............. 100
[2022-05-16 17:12:06.876872] num_workers ................ 0
[2022-05-16 17:12:06.876878] optimizer .................. adam
[2022-05-16 17:12:06.876884] proposal_func .............. <function lm_proposal at 0x7f0afba90dc0>
[2022-05-16 17:12:06.876890] rnn_type ................... LSTM
[2022-05-16 17:12:06.876895] save_epochs ................ 1
[2022-05-16 17:12:06.876900] seed ....................... 42
[2022-05-16 17:12:06.876906] seq_len .................... 15
[2022-05-16 17:12:06.876912] shuffle .................... True
[2022-05-16 17:12:06.876917] store_intermediate_lbs ..... True
[2022-05-16 17:12:06.876923] sub_estimates .............. []
[2022-05-16 17:12:06.876929] tau_a_excl_terms ........... []
[2022-05-16 17:12:06.876934] tau_b_excl_terms ........... []
[2022-05-16 17:12:06.876940] terms_of_interest .......... []
[2022-05-16 17:12:06.876945] text_dict .................. None
[2022-05-16 17:12:06.876950] top_k ...................... 0
[2022-05-16 17:12:06.876956] top_p ...................... 0
[2022-05-16 17:12:06.876961] total_seq_len .............. 20
[2022-05-16 17:12:06.876967] train_data_pct ............. 0.9
[2022-05-16 17:12:06.876972] train_epochs ............... 40
[2022-05-16 17:12:06.876978] use_gpt2 ................... False
[2022-05-16 17:12:06.876984] val_data_pct ............... 0.01
[2022-05-16 17:12:06.876991] val_metrics ................ ['accuracy']
[2022-05-16 17:12:06.876996] valid_epochs ............... 1
[2022-05-16 17:12:06.877005] variance_epsilon ........... 5e-06
[2022-05-16 17:12:06.877010] vocab_size ................. 98
[2022-05-16 17:12:06.877016] warmup_pct ................. 0.01
[2022-05-16 17:12:06.877022] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_9h_15s_1000mc_1000q.pkl
[2022-05-16 17:12:06.878409] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-16 17:14:16.370664] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-16 17:14:16.383652] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-16 17:14:16.921226] batch_size ................. 4096
[2022-05-16 17:14:16.921257] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-16 17:14:16.921266] cuda ....................... True
[2022-05-16 17:14:16.921272] data_path .................. data/apps/lsapp.tsv
[2022-05-16 17:14:16.921277] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 17:14:16.921284] device ..................... 6
[2022-05-16 17:14:16.921290] device_num ................. 0
[2022-05-16 17:14:16.921295] disable_tqdm ............... True
[2022-05-16 17:14:16.921302] do_test .................... False
[2022-05-16 17:14:16.921308] do_valid ................... True
[2022-05-16 17:14:16.921313] dont_print_args ............ True
[2022-05-16 17:14:16.921322] dont_shuffle ............... None
[2022-05-16 17:14:16.921335] dropout .................... 0.3
[2022-05-16 17:14:16.921343] estimate_type .............. <function beam_search_lower_bound at 0x7f0afbaa3ee0>
[2022-05-16 17:14:16.921351] excluded_terms ............. [1]
[2022-05-16 17:14:16.921380] excluded_terms_list ........ [[]]
[2022-05-16 17:14:16.921386] finetune ................... False
[2022-05-16 17:14:16.921393] grad_clip .................. 1.0
[2022-05-16 17:14:16.921398] hidden_size ................ 512
[2022-05-16 17:14:16.921404] hist_len ................... 18
[2022-05-16 17:14:16.921410] hybrid_max_num_beams ....... 1500
[2022-05-16 17:14:16.921416] interp_func ................ <function lin_interp at 0x7f0afbaa3dc0>
[2022-05-16 17:14:16.921422] log_interval ............... 100
[2022-05-16 17:14:16.921434] lr ......................... 0.001
[2022-05-16 17:14:16.921439] lr_decay_style ............. constant
[2022-05-16 17:14:16.921445] masked_lm .................. False
[2022-05-16 17:14:16.921451] max_k ...................... None
[2022-05-16 17:14:16.921456] max_num_mc_samples ......... 100000
[2022-05-16 17:14:16.921462] max_num_queries ............ 1000
[2022-05-16 17:14:16.921468] min_num_mc_samples ......... 10000
[2022-05-16 17:14:16.921473] min_phase_shift ............ 0
[2022-05-16 17:14:16.921480] min_var_reduction .......... 0.1
[2022-05-16 17:14:16.921485] min_variance ............... True
[2022-05-16 17:14:16.921490] model_budget_filepath ...... None
[2022-05-16 17:14:16.921497] needs_encoding ............. True
[2022-05-16 17:14:16.921503] num_beams .................. 0.0
[2022-05-16 17:14:16.921508] num_layers ................. 2
[2022-05-16 17:14:16.921514] num_mc_samples ............. 100
[2022-05-16 17:14:16.921519] num_workers ................ 0
[2022-05-16 17:14:16.921525] optimizer .................. adam
[2022-05-16 17:14:16.921531] proposal_func .............. <function lm_proposal at 0x7f0afba90dc0>
[2022-05-16 17:14:16.921537] rnn_type ................... LSTM
[2022-05-16 17:14:16.921542] save_epochs ................ 1
[2022-05-16 17:14:16.921548] seed ....................... 42
[2022-05-16 17:14:16.921553] seq_len .................... 15
[2022-05-16 17:14:16.921558] shuffle .................... True
[2022-05-16 17:14:16.921564] store_intermediate_lbs ..... True
[2022-05-16 17:14:16.921570] sub_estimates .............. []
[2022-05-16 17:14:16.921579] tau_a_excl_terms ........... []
[2022-05-16 17:14:16.921584] tau_b_excl_terms ........... []
[2022-05-16 17:14:16.921590] terms_of_interest .......... []
[2022-05-16 17:14:16.921595] text_dict .................. None
[2022-05-16 17:14:16.921600] top_k ...................... 0
[2022-05-16 17:14:16.921606] top_p ...................... 0
[2022-05-16 17:14:16.921612] total_seq_len .............. 20
[2022-05-16 17:14:16.921617] train_data_pct ............. 0.9
[2022-05-16 17:14:16.921627] train_epochs ............... 40
[2022-05-16 17:14:16.921633] use_gpt2 ................... False
[2022-05-16 17:14:16.921639] val_data_pct ............... 0.001
[2022-05-16 17:14:16.921646] val_metrics ................ ['accuracy']
[2022-05-16 17:14:16.921651] valid_epochs ............... 1
[2022-05-16 17:14:16.921659] variance_epsilon ........... 5e-06
[2022-05-16 17:14:16.921665] vocab_size ................. 88
[2022-05-16 17:14:16.921671] warmup_pct ................. 0.01
[2022-05-16 17:14:16.921676] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_9h_15s_1000mc_1000q.pkl
[2022-05-16 17:14:16.923186] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-16 17:16:21.676189] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-16 17:16:21.686935] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-16 17:16:21.865543] batch_size ................. 4096
[2022-05-16 17:16:21.865569] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-16 17:16:21.865575] cuda ....................... True
[2022-05-16 17:16:21.865578] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-16 17:16:21.865581] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 17:16:21.865588] device ..................... 6
[2022-05-16 17:16:21.865591] device_num ................. 0
[2022-05-16 17:16:21.865593] disable_tqdm ............... True
[2022-05-16 17:16:21.865597] do_test .................... False
[2022-05-16 17:16:21.865600] do_valid ................... True
[2022-05-16 17:16:21.865602] dont_print_args ............ True
[2022-05-16 17:16:21.865606] dont_shuffle ............... None
[2022-05-16 17:16:21.865613] dropout .................... 0.3
[2022-05-16 17:16:21.865618] estimate_type .............. <function beam_search_lower_bound at 0x7f0afbaa3ee0>
[2022-05-16 17:16:21.865624] excluded_terms ............. [1]
[2022-05-16 17:16:21.865629] excluded_terms_list ........ [[]]
[2022-05-16 17:16:21.865632] finetune ................... False
[2022-05-16 17:16:21.865636] grad_clip .................. 1.0
[2022-05-16 17:16:21.865639] hidden_size ................ 512
[2022-05-16 17:16:21.865641] hist_len ................... 18
[2022-05-16 17:16:21.865644] hybrid_max_num_beams ....... 1500
[2022-05-16 17:16:21.865648] interp_func ................ <function lin_interp at 0x7f0afbaa3dc0>
[2022-05-16 17:16:21.865650] log_interval ............... 100
[2022-05-16 17:16:21.865702] lr ......................... 0.001
[2022-05-16 17:16:21.865705] lr_decay_style ............. constant
[2022-05-16 17:16:21.865708] masked_lm .................. False
[2022-05-16 17:16:21.865711] max_k ...................... None
[2022-05-16 17:16:21.865713] max_num_mc_samples ......... 100000
[2022-05-16 17:16:21.865718] max_num_queries ............ 1000
[2022-05-16 17:16:21.865720] min_num_mc_samples ......... 10000
[2022-05-16 17:16:21.865723] min_phase_shift ............ 0
[2022-05-16 17:16:21.865726] min_var_reduction .......... 0.1
[2022-05-16 17:16:21.865729] min_variance ............... True
[2022-05-16 17:16:21.865731] model_budget_filepath ...... None
[2022-05-16 17:16:21.865738] num_beams .................. 0.0
[2022-05-16 17:16:21.865740] num_layers ................. 2
[2022-05-16 17:16:21.865743] num_mc_samples ............. 100
[2022-05-16 17:16:21.865745] num_workers ................ 0
[2022-05-16 17:16:21.865748] optimizer .................. adam
[2022-05-16 17:16:21.865750] proposal_func .............. <function lm_proposal at 0x7f0afba90dc0>
[2022-05-16 17:16:21.865753] rnn_type ................... LSTM
[2022-05-16 17:16:21.865757] save_epochs ................ 1
[2022-05-16 17:16:21.865760] seed ....................... 42
[2022-05-16 17:16:21.865762] seq_len .................... 15
[2022-05-16 17:16:21.865765] shuffle .................... True
[2022-05-16 17:16:21.865768] store_intermediate_lbs ..... True
[2022-05-16 17:16:21.865770] sub_estimates .............. []
[2022-05-16 17:16:21.865773] tau_a_excl_terms ........... []
[2022-05-16 17:16:21.865778] tau_b_excl_terms ........... []
[2022-05-16 17:16:21.865781] terms_of_interest .......... []
[2022-05-16 17:16:21.865783] text_dict .................. None
[2022-05-16 17:16:21.865786] top_k ...................... 0
[2022-05-16 17:16:21.865788] top_p ...................... 0
[2022-05-16 17:16:21.865791] total_seq_len .............. 20
[2022-05-16 17:16:21.865793] train_data_pct ............. 0.9
[2022-05-16 17:16:21.865796] train_epochs ............... 40
[2022-05-16 17:16:21.865799] use_gpt2 ................... False
[2022-05-16 17:16:21.865802] val_data_pct ............... 0.0001
[2022-05-16 17:16:21.865806] val_metrics ................ ['accuracy']
[2022-05-16 17:16:21.865808] valid_epochs ............... 1
[2022-05-16 17:16:21.865812] variance_epsilon ........... 5e-06
[2022-05-16 17:16:21.865815] vocab_size ................. 30
[2022-05-16 17:16:21.865817] warmup_pct ................. 0.01
[2022-05-16 17:16:21.865820] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_9h_15s_1000mc_1000q.pkl
[2022-05-16 17:16:21.866718] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

....................................................................................................
==================================================
