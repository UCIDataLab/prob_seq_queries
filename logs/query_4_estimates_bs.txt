==================================================
* Running for dataset shakespeare
==================================================
[2022-05-23 21:58:13.943740] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-23 21:58:13.948076] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-23 21:58:13.950614] batch_size ................. 8192
[2022-05-23 21:58:13.950630] bs_ablation ................ False
[2022-05-23 21:58:13.950635] bs_ablation_max_beams ...... 10000
[2022-05-23 21:58:13.950639] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-23 21:58:13.950643] cuda ....................... True
[2022-05-23 21:58:13.950647] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-23 21:58:13.950650] dataset .................... shakespeare
[2022-05-23 21:58:13.950654] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 21:58:13.950658] device ..................... 7
[2022-05-23 21:58:13.950661] device_num ................. 0
[2022-05-23 21:58:13.950665] disable_tqdm ............... True
[2022-05-23 21:58:13.950669] do_test .................... False
[2022-05-23 21:58:13.950673] do_valid ................... True
[2022-05-23 21:58:13.950676] dont_print_args ............ True
[2022-05-23 21:58:13.950682] dont_shuffle ............... None
[2022-05-23 21:58:13.950693] dropout .................... 0.3
[2022-05-23 21:58:13.950701] estimate_type .............. <function beam_search_lower_bound at 0x7fc095986b80>
[2022-05-23 21:58:13.950706] excluded_terms ............. [1]
[2022-05-23 21:58:13.950711] excluded_terms_list ........ [[]]
[2022-05-23 21:58:13.950715] finetune ................... False
[2022-05-23 21:58:13.950718] frequentist_test ........... False
[2022-05-23 21:58:13.950723] grad_clip .................. 1.0
[2022-05-23 21:58:13.950726] hidden_size ................ 128
[2022-05-23 21:58:13.950730] hist_len ................... 18
[2022-05-23 21:58:13.950734] hybrid_max_num_beams ....... 1500
[2022-05-23 21:58:13.950738] interp_func ................ <function lin_interp at 0x7fc095986a60>
[2022-05-23 21:58:13.950741] log_interval ............... 100
[2022-05-23 21:58:13.950746] lr ......................... 0.001
[2022-05-23 21:58:13.950749] lr_decay_style ............. constant
[2022-05-23 21:58:13.950753] masked_lm .................. False
[2022-05-23 21:58:13.950757] max_k ...................... None
[2022-05-23 21:58:13.950761] max_num_mc_samples ......... 100000
[2022-05-23 21:58:13.950764] max_num_queries ............ 1000
[2022-05-23 21:58:13.950768] min_num_mc_samples ......... 10000
[2022-05-23 21:58:13.950771] min_phase_shift ............ 0
[2022-05-23 21:58:13.950775] min_var_reduction .......... 0.1
[2022-05-23 21:58:13.950779] min_variance ............... False
[2022-05-23 21:58:13.950782] model_budget_filepath ...... None
[2022-05-23 21:58:13.950786] needs_dl ................... True
[2022-05-23 21:58:13.950790] num_beams .................. 0.0
[2022-05-23 21:58:13.950793] num_layers ................. 2
[2022-05-23 21:58:13.950797] num_mc_samples ............. 100
[2022-05-23 21:58:13.950800] num_workers ................ 0
[2022-05-23 21:58:13.950803] optimizer .................. adam
[2022-05-23 21:58:13.950807] proposal_func .............. <function lm_proposal at 0x7fc095977af0>
[2022-05-23 21:58:13.950811] rnn_type ................... LSTM
[2022-05-23 21:58:13.950814] save_epochs ................ 1
[2022-05-23 21:58:13.950817] seed ....................... 42
[2022-05-23 21:58:13.950821] seq_len .................... 100
[2022-05-23 21:58:13.950824] shuffle .................... True
[2022-05-23 21:58:13.950828] store_intermediate_lbs ..... True
[2022-05-23 21:58:13.950831] sub_estimates .............. []
[2022-05-23 21:58:13.950836] tau_a_excl_terms ........... [18, 46]
[2022-05-23 21:58:13.950840] tau_b_excl_terms ........... [43, 48, 49, 52, 63, 15, 20, 21, 24, 35]
[2022-05-23 21:58:13.950844] terms_of_interest .......... []
[2022-05-23 21:58:13.950847] text_dict .................. None
[2022-05-23 21:58:13.950851] top_k ...................... 0
[2022-05-23 21:58:13.950854] top_p ...................... 0
[2022-05-23 21:58:13.950858] total_seq_len .............. 20
[2022-05-23 21:58:13.950861] train_data_pct ............. 0.9
[2022-05-23 21:58:13.950865] train_epochs ............... 40
[2022-05-23 21:58:13.950868] use_gpt2 ................... False
[2022-05-23 21:58:13.950872] val_data_pct ............... 0.05
[2022-05-23 21:58:13.950877] val_metrics ................ ['accuracy']
[2022-05-23 21:58:13.950880] valid_epochs ............... 1
[2022-05-23 21:58:13.950886] variance_epsilon ........... 5e-06
[2022-05-23 21:58:13.950890] vocab_size ................. 68
[2022-05-23 21:58:13.950894] warmup_pct ................. 0.01
[2022-05-23 21:58:13.950897] weight_decay ............... 0.0
==================================================
[2022-05-23 21:58:13.951316] | Dataset: shakespeare | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-23 22:12:57.600406] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-23 22:12:57.608019] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-23 22:12:57.956957] batch_size ................. 8192
[2022-05-23 22:12:57.956995] bs_ablation ................ False
[2022-05-23 22:12:57.957001] bs_ablation_max_beams ...... 10000
[2022-05-23 22:12:57.957007] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-23 22:12:57.957014] cuda ....................... True
[2022-05-23 22:12:57.957020] data_path .................. data/apps/lsapp.tsv
[2022-05-23 22:12:57.957025] dataset .................... apps
[2022-05-23 22:12:57.957031] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 22:12:57.957040] device ..................... 7
[2022-05-23 22:12:57.957046] device_num ................. 0
[2022-05-23 22:12:57.957052] disable_tqdm ............... True
[2022-05-23 22:12:57.957058] do_test .................... False
[2022-05-23 22:12:57.957064] do_valid ................... True
[2022-05-23 22:12:57.957070] dont_print_args ............ True
[2022-05-23 22:12:57.957077] dont_shuffle ............... None
[2022-05-23 22:12:57.957100] dropout .................... 0.3
[2022-05-23 22:12:57.957109] estimate_type .............. <function beam_search_lower_bound at 0x7fc095986b80>
[2022-05-23 22:12:57.957118] excluded_terms ............. [1]
[2022-05-23 22:12:57.957125] excluded_terms_list ........ [[]]
[2022-05-23 22:12:57.957132] finetune ................... False
[2022-05-23 22:12:57.957138] frequentist_test ........... False
[2022-05-23 22:12:57.957145] grad_clip .................. 1.0
[2022-05-23 22:12:57.957150] hidden_size ................ 512
[2022-05-23 22:12:57.957158] hist_len ................... 18
[2022-05-23 22:12:57.957164] hybrid_max_num_beams ....... 1500
[2022-05-23 22:12:57.957170] interp_func ................ <function lin_interp at 0x7fc095986a60>
[2022-05-23 22:12:57.957176] log_interval ............... 100
[2022-05-23 22:12:57.957182] lr ......................... 0.001
[2022-05-23 22:12:57.957189] lr_decay_style ............. constant
[2022-05-23 22:12:57.957195] masked_lm .................. False
[2022-05-23 22:12:57.957200] max_k ...................... None
[2022-05-23 22:12:57.957206] max_num_mc_samples ......... 100000
[2022-05-23 22:12:57.957211] max_num_queries ............ 1000
[2022-05-23 22:12:57.957217] min_num_mc_samples ......... 10000
[2022-05-23 22:12:57.957223] min_phase_shift ............ 0
[2022-05-23 22:12:57.957229] min_var_reduction .......... 0.1
[2022-05-23 22:12:57.957234] min_variance ............... False
[2022-05-23 22:12:57.957240] model_budget_filepath ...... None
[2022-05-23 22:12:57.957246] needs_dl ................... True
[2022-05-23 22:12:57.957251] needs_encoding ............. True
[2022-05-23 22:12:57.957258] num_beams .................. 0.0
[2022-05-23 22:12:57.957264] num_layers ................. 2
[2022-05-23 22:12:57.957269] num_mc_samples ............. 100
[2022-05-23 22:12:57.957275] num_workers ................ 0
[2022-05-23 22:12:57.957280] optimizer .................. adam
[2022-05-23 22:12:57.957286] proposal_func .............. <function lm_proposal at 0x7fc095977af0>
[2022-05-23 22:12:57.957292] rnn_type ................... LSTM
[2022-05-23 22:12:57.957297] save_epochs ................ 1
[2022-05-23 22:12:57.957304] seed ....................... 42
[2022-05-23 22:12:57.957309] seq_len .................... 15
[2022-05-23 22:12:57.957315] shuffle .................... True
[2022-05-23 22:12:57.957320] store_intermediate_lbs ..... True
[2022-05-23 22:12:57.957326] sub_estimates .............. []
[2022-05-23 22:12:57.957336] tau_a_excl_terms ........... [3, 14, 16, 23, 30, 39, 44, 40, 41, 51, 60, 73, 74, 79, 81, 82, 84]
[2022-05-23 22:12:57.957344] tau_b_excl_terms ........... [18, 19, 33, 34, 47, 78, 52, 55, 57, 67]
[2022-05-23 22:12:57.957350] terms_of_interest .......... []
[2022-05-23 22:12:57.957357] text_dict .................. None
[2022-05-23 22:12:57.957362] top_k ...................... 0
[2022-05-23 22:12:57.957367] top_p ...................... 0
[2022-05-23 22:12:57.957373] total_seq_len .............. 20
[2022-05-23 22:12:57.957379] train_data_pct ............. 0.9
[2022-05-23 22:12:57.957384] train_epochs ............... 40
[2022-05-23 22:12:57.957390] use_gpt2 ................... False
[2022-05-23 22:12:57.957396] val_data_pct ............... 0.001
[2022-05-23 22:12:57.957403] val_metrics ................ ['accuracy']
[2022-05-23 22:12:57.957409] valid_epochs ............... 1
[2022-05-23 22:12:57.957417] variance_epsilon ........... 5e-06
[2022-05-23 22:12:57.957423] vocab_size ................. 88
[2022-05-23 22:12:57.957428] warmup_pct ................. 0.01
[2022-05-23 22:12:57.957434] weight_decay ............... 0.0
==================================================
[2022-05-23 22:12:57.958038] | Dataset: apps | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-23 23:04:46.512419] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-23 23:04:46.516067] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-23 23:04:46.627126] batch_size ................. 8192
[2022-05-23 23:04:46.627160] bs_ablation ................ False
[2022-05-23 23:04:46.627166] bs_ablation_max_beams ...... 10000
[2022-05-23 23:04:46.627173] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-23 23:04:46.627179] cuda ....................... True
[2022-05-23 23:04:46.627186] data_path .................. data/moocs/mooc.csv
[2022-05-23 23:04:46.627192] dataset .................... moocs
[2022-05-23 23:04:46.627197] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 23:04:46.627204] device ..................... 7
[2022-05-23 23:04:46.627209] device_num ................. 0
[2022-05-23 23:04:46.627215] disable_tqdm ............... True
[2022-05-23 23:04:46.627221] do_test .................... False
[2022-05-23 23:04:46.627227] do_valid ................... True
[2022-05-23 23:04:46.627233] dont_print_args ............ True
[2022-05-23 23:04:46.627240] dont_shuffle ............... None
[2022-05-23 23:04:46.627257] dropout .................... 0.3
[2022-05-23 23:04:46.627265] estimate_type .............. <function beam_search_lower_bound at 0x7fc095986b80>
[2022-05-23 23:04:46.627276] excluded_terms ............. [1]
[2022-05-23 23:04:46.627283] excluded_terms_list ........ [[]]
[2022-05-23 23:04:46.627289] finetune ................... False
[2022-05-23 23:04:46.627294] frequentist_test ........... False
[2022-05-23 23:04:46.627302] grad_clip .................. 1.0
[2022-05-23 23:04:46.627307] hidden_size ................ 128
[2022-05-23 23:04:46.627313] hist_len ................... 18
[2022-05-23 23:04:46.627319] hybrid_max_num_beams ....... 1500
[2022-05-23 23:04:46.627325] interp_func ................ <function lin_interp at 0x7fc095986a60>
[2022-05-23 23:04:46.627331] log_interval ............... 100
[2022-05-23 23:04:46.627338] lr ......................... 0.001
[2022-05-23 23:04:46.627344] lr_decay_style ............. constant
[2022-05-23 23:04:46.627349] masked_lm .................. False
[2022-05-23 23:04:46.627355] max_k ...................... None
[2022-05-23 23:04:46.627360] max_num_mc_samples ......... 100000
[2022-05-23 23:04:46.627366] max_num_queries ............ 1000
[2022-05-23 23:04:46.627371] min_num_mc_samples ......... 10000
[2022-05-23 23:04:46.627377] min_phase_shift ............ 0
[2022-05-23 23:04:46.627383] min_var_reduction .......... 0.1
[2022-05-23 23:04:46.627389] min_variance ............... False
[2022-05-23 23:04:46.627395] model_budget_filepath ...... None
[2022-05-23 23:04:46.627400] needs_dl ................... True
[2022-05-23 23:04:46.627406] needs_encoding ............. False
[2022-05-23 23:04:46.627412] num_beams .................. 0.0
[2022-05-23 23:04:46.627418] num_layers ................. 2
[2022-05-23 23:04:46.627423] num_mc_samples ............. 100
[2022-05-23 23:04:46.627429] num_workers ................ 0
[2022-05-23 23:04:46.627435] optimizer .................. adam
[2022-05-23 23:04:46.627441] proposal_func .............. <function lm_proposal at 0x7fc095977af0>
[2022-05-23 23:04:46.627446] rnn_type ................... LSTM
[2022-05-23 23:04:46.627451] save_epochs ................ 1
[2022-05-23 23:04:46.627457] seed ....................... 42
[2022-05-23 23:04:46.627462] seq_len .................... 15
[2022-05-23 23:04:46.627468] shuffle .................... True
[2022-05-23 23:04:46.627473] store_intermediate_lbs ..... True
[2022-05-23 23:04:46.627479] sub_estimates .............. []
[2022-05-23 23:04:46.627486] tau_a_excl_terms ........... [13, 8, 21, 7]
[2022-05-23 23:04:46.627494] tau_b_excl_terms ........... [51, 33, 16, 27, 15, 24, 53]
[2022-05-23 23:04:46.627499] terms_of_interest .......... []
[2022-05-23 23:04:46.627505] text_dict .................. None
[2022-05-23 23:04:46.627510] top_k ...................... 0
[2022-05-23 23:04:46.627516] top_p ...................... 0
[2022-05-23 23:04:46.627521] total_seq_len .............. 20
[2022-05-23 23:04:46.627528] train_data_pct ............. 0.9
[2022-05-23 23:04:46.627533] train_epochs ............... 40
[2022-05-23 23:04:46.627539] use_gpt2 ................... False
[2022-05-23 23:04:46.627545] val_data_pct ............... 0.01
[2022-05-23 23:04:46.627552] val_metrics ................ ['accuracy']
[2022-05-23 23:04:46.627557] valid_epochs ............... 1
[2022-05-23 23:04:46.627575] variance_epsilon ........... 5e-06
[2022-05-23 23:04:46.627581] vocab_size ................. 98
[2022-05-23 23:04:46.627586] warmup_pct ................. 0.01
[2022-05-23 23:04:46.627592] weight_decay ............... 0.0
==================================================
[2022-05-23 23:04:46.628367] | Dataset: moocs | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-23 23:27:28.178660] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-23 23:27:28.198149] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-23 23:27:28.499982] batch_size ................. 8192
[2022-05-23 23:27:28.500019] bs_ablation ................ False
[2022-05-23 23:27:28.500026] bs_ablation_max_beams ...... 10000
[2022-05-23 23:27:28.500032] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-23 23:27:28.500038] cuda ....................... True
[2022-05-23 23:27:28.500045] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-23 23:27:28.500051] dataset .................... amazon
[2022-05-23 23:27:28.500057] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 23:27:28.500066] device ..................... 7
[2022-05-23 23:27:28.500071] device_num ................. 0
[2022-05-23 23:27:28.500077] disable_tqdm ............... True
[2022-05-23 23:27:28.500083] do_test .................... False
[2022-05-23 23:27:28.500089] do_valid ................... True
[2022-05-23 23:27:28.500095] dont_print_args ............ True
[2022-05-23 23:27:28.500103] dont_shuffle ............... None
[2022-05-23 23:27:28.500117] dropout .................... 0.3
[2022-05-23 23:27:28.500125] estimate_type .............. <function beam_search_lower_bound at 0x7fc095986b80>
[2022-05-23 23:27:28.500134] excluded_terms ............. [1]
[2022-05-23 23:27:28.500141] excluded_terms_list ........ [[]]
[2022-05-23 23:27:28.500186] finetune ................... False
[2022-05-23 23:27:28.500192] frequentist_test ........... False
[2022-05-23 23:27:28.500198] grad_clip .................. 1.0
[2022-05-23 23:27:28.500204] hidden_size ................ 512
[2022-05-23 23:27:28.500212] hist_len ................... 18
[2022-05-23 23:27:28.500218] hybrid_max_num_beams ....... 1500
[2022-05-23 23:27:28.500225] interp_func ................ <function lin_interp at 0x7fc095986a60>
[2022-05-23 23:27:28.500231] log_interval ............... 100
[2022-05-23 23:27:28.500238] lr ......................... 0.001
[2022-05-23 23:27:28.500244] lr_decay_style ............. constant
[2022-05-23 23:27:28.500250] masked_lm .................. False
[2022-05-23 23:27:28.500256] max_k ...................... None
[2022-05-23 23:27:28.500261] max_num_mc_samples ......... 100000
[2022-05-23 23:27:28.500266] max_num_queries ............ 1000
[2022-05-23 23:27:28.500272] min_num_mc_samples ......... 10000
[2022-05-23 23:27:28.500279] min_phase_shift ............ 0
[2022-05-23 23:27:28.500285] min_var_reduction .......... 0.1
[2022-05-23 23:27:28.500290] min_variance ............... False
[2022-05-23 23:27:28.500296] model_budget_filepath ...... None
[2022-05-23 23:27:28.500303] needs_dl ................... True
[2022-05-23 23:27:28.500310] num_beams .................. 0.0
[2022-05-23 23:27:28.500315] num_layers ................. 2
[2022-05-23 23:27:28.500322] num_mc_samples ............. 100
[2022-05-23 23:27:28.500327] num_workers ................ 0
[2022-05-23 23:27:28.500333] optimizer .................. adam
[2022-05-23 23:27:28.500339] proposal_func .............. <function lm_proposal at 0x7fc095977af0>
[2022-05-23 23:27:28.500345] rnn_type ................... LSTM
[2022-05-23 23:27:28.500350] save_epochs ................ 1
[2022-05-23 23:27:28.500355] seed ....................... 42
[2022-05-23 23:27:28.500362] seq_len .................... 15
[2022-05-23 23:27:28.500367] shuffle .................... True
[2022-05-23 23:27:28.500373] store_intermediate_lbs ..... True
[2022-05-23 23:27:28.500379] sub_estimates .............. []
[2022-05-23 23:27:28.500386] tau_a_excl_terms ........... [2, 3, 9, 10]
[2022-05-23 23:27:28.500393] tau_b_excl_terms ........... [17, 19, 25, 28]
[2022-05-23 23:27:28.500398] terms_of_interest .......... []
[2022-05-23 23:27:28.500404] text_dict .................. None
[2022-05-23 23:27:28.500411] top_k ...................... 0
[2022-05-23 23:27:28.500417] top_p ...................... 0
[2022-05-23 23:27:28.500422] total_seq_len .............. 20
[2022-05-23 23:27:28.500428] train_data_pct ............. 0.9
[2022-05-23 23:27:28.500433] train_epochs ............... 40
[2022-05-23 23:27:28.500439] use_gpt2 ................... False
[2022-05-23 23:27:28.500445] val_data_pct ............... 0.0001
[2022-05-23 23:27:28.500452] val_metrics ................ ['accuracy']
[2022-05-23 23:27:28.500458] valid_epochs ............... 1
[2022-05-23 23:27:28.500468] variance_epsilon ........... 5e-06
[2022-05-23 23:27:28.500473] vocab_size ................. 30
[2022-05-23 23:27:28.500479] warmup_pct ................. 0.01
[2022-05-23 23:27:28.500485] weight_decay ............... 0.0
==================================================
[2022-05-23 23:27:28.500858] | Dataset: amazon | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
