==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 12:53:32.383927] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 12:53:32.389010] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 12:53:32.391991] batch_size ................. 4096
[2022-05-12 12:53:32.392005] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 12:53:32.392029] cuda ....................... True
[2022-05-12 12:53:32.392036] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 12:53:32.392041] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 12:53:32.392048] device ..................... 3
[2022-05-12 12:53:32.392053] device_num ................. 0
[2022-05-12 12:53:32.392059] disable_tqdm ............... True
[2022-05-12 12:53:32.392065] do_test .................... False
[2022-05-12 12:53:32.392072] do_valid ................... True
[2022-05-12 12:53:32.392078] dont_print_args ............ True
[2022-05-12 12:53:32.392085] dont_shuffle ............... None
[2022-05-12 12:53:32.392099] dropout .................... 0.3
[2022-05-12 12:53:32.392107] estimate_type .............. <function beam_search_lower_bound at 0x7f7f417f1790>
[2022-05-12 12:53:32.392117] excluded_terms ............. [1]
[2022-05-12 12:53:32.392124] finetune ................... False
[2022-05-12 12:53:32.392131] grad_clip .................. 1.0
[2022-05-12 12:53:32.392136] hidden_size ................ 128
[2022-05-12 12:53:32.392142] hist_len ................... 18
[2022-05-12 12:53:32.392148] interp_func ................ <function lin_interp at 0x7f7f417f1670>
[2022-05-12 12:53:32.392154] log_interval ............... 100
[2022-05-12 12:53:32.392161] lr ......................... 0.001
[2022-05-12 12:53:32.392166] lr_decay_style ............. constant
[2022-05-12 12:53:32.392172] masked_lm .................. False
[2022-05-12 12:53:32.392178] max_num_mc_samples ......... 100000
[2022-05-12 12:53:32.392184] max_num_queries ............ 100
[2022-05-12 12:53:32.392189] min_num_mc_samples ......... 10000
[2022-05-12 12:53:32.392195] min_phase_shift ............ 0
[2022-05-12 12:53:32.392201] min_var_reduction .......... 0.1
[2022-05-12 12:53:32.392207] min_variance ............... True
[2022-05-12 12:53:32.392212] model_budget_filepath ...... None
[2022-05-12 12:53:32.392218] num_beams .................. 0.0
[2022-05-12 12:53:32.392223] num_layers ................. 2
[2022-05-12 12:53:32.392229] num_mc_samples ............. 100
[2022-05-12 12:53:32.392234] num_workers ................ 0
[2022-05-12 12:53:32.392240] optimizer .................. adam
[2022-05-12 12:53:32.392246] proposal_func .............. <function lm_proposal at 0x7f7f417df790>
[2022-05-12 12:53:32.392252] rnn_type ................... LSTM
[2022-05-12 12:53:32.392257] save_epochs ................ 1
[2022-05-12 12:53:32.392262] seed ....................... 42
[2022-05-12 12:53:32.392268] seq_len .................... 100
[2022-05-12 12:53:32.392273] shuffle .................... True
[2022-05-12 12:53:32.392279] store_intermediate_lbs ..... True
[2022-05-12 12:53:32.392285] sub_estimates .............. []
[2022-05-12 12:53:32.392290] text_dict .................. None
[2022-05-12 12:53:32.392296] top_k ...................... 0
[2022-05-12 12:53:32.392301] top_p ...................... 0
[2022-05-12 12:53:32.392306] total_seq_len .............. 20
[2022-05-12 12:53:32.392312] train_data_pct ............. 0.9
[2022-05-12 12:53:32.392319] train_epochs ............... 40
[2022-05-12 12:53:32.392325] use_gpt2 ................... False
[2022-05-12 12:53:32.392331] val_data_pct ............... 0.05
[2022-05-12 12:53:32.392338] val_metrics ................ ['accuracy']
[2022-05-12 12:53:32.392343] valid_epochs ............... 1
[2022-05-12 12:53:32.392352] variance_epsilon ........... 5e-06
[2022-05-12 12:53:32.392358] vocab_size ................. 68
[2022-05-12 12:53:32.392363] warmup_pct ................. 0.01
[2022-05-12 12:53:32.392369] weight_decay ............... 0.0
==================================================
[2022-05-12 12:53:32.393088] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 12:54:03.440435] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 12 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 12:54:44.209528] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

..........
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 12:56:25.843014] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 12:56:25.855109] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 12:56:26.464695] batch_size ................. 4096
[2022-05-12 12:56:26.464726] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 12:56:26.464735] cuda ....................... True
[2022-05-12 12:56:26.464740] data_path .................. data/apps/lsapp.tsv
[2022-05-12 12:56:26.464746] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 12:56:26.464752] device ..................... 3
[2022-05-12 12:56:26.464758] device_num ................. 0
[2022-05-12 12:56:26.464764] disable_tqdm ............... True
[2022-05-12 12:56:26.464770] do_test .................... False
[2022-05-12 12:56:26.464776] do_valid ................... True
[2022-05-12 12:56:26.464781] dont_print_args ............ True
[2022-05-12 12:56:26.464789] dont_shuffle ............... None
[2022-05-12 12:56:26.464801] dropout .................... 0.3
[2022-05-12 12:56:26.464810] estimate_type .............. <function beam_search_lower_bound at 0x7f7f417f1790>
[2022-05-12 12:56:26.464818] excluded_terms ............. [1]
[2022-05-12 12:56:26.464830] finetune ................... False
[2022-05-12 12:56:26.464837] grad_clip .................. 1.0
[2022-05-12 12:56:26.464843] hidden_size ................ 512
[2022-05-12 12:56:26.464848] hist_len ................... 18
[2022-05-12 12:56:26.464856] interp_func ................ <function lin_interp at 0x7f7f417f1670>
[2022-05-12 12:56:26.464861] log_interval ............... 100
[2022-05-12 12:56:26.464868] lr ......................... 0.001
[2022-05-12 12:56:26.464873] lr_decay_style ............. constant
[2022-05-12 12:56:26.464879] masked_lm .................. False
[2022-05-12 12:56:26.464885] max_num_mc_samples ......... 100000
[2022-05-12 12:56:26.464891] max_num_queries ............ 100
[2022-05-12 12:56:26.464897] min_num_mc_samples ......... 10000
[2022-05-12 12:56:26.464902] min_phase_shift ............ 0
[2022-05-12 12:56:26.464911] min_var_reduction .......... 0.1
[2022-05-12 12:56:26.464917] min_variance ............... True
[2022-05-12 12:56:26.464923] model_budget_filepath ...... None
[2022-05-12 12:56:26.464928] needs_encoding ............. True
[2022-05-12 12:56:26.464935] num_beams .................. 0.0
[2022-05-12 12:56:26.464940] num_layers ................. 2
[2022-05-12 12:56:26.464946] num_mc_samples ............. 100
[2022-05-12 12:56:26.464952] num_workers ................ 0
[2022-05-12 12:56:26.464957] optimizer .................. adam
[2022-05-12 12:56:26.464963] proposal_func .............. <function lm_proposal at 0x7f7f417df790>
[2022-05-12 12:56:26.464969] rnn_type ................... LSTM
[2022-05-12 12:56:26.464974] save_epochs ................ 1
[2022-05-12 12:56:26.464980] seed ....................... 42
[2022-05-12 12:56:26.464986] seq_len .................... 15
[2022-05-12 12:56:26.464991] shuffle .................... True
[2022-05-12 12:56:26.464997] store_intermediate_lbs ..... True
[2022-05-12 12:56:26.465003] sub_estimates .............. []
[2022-05-12 12:56:26.465009] text_dict .................. None
[2022-05-12 12:56:26.465014] top_k ...................... 0
[2022-05-12 12:56:26.465019] top_p ...................... 0
[2022-05-12 12:56:26.465025] total_seq_len .............. 20
[2022-05-12 12:56:26.465031] train_data_pct ............. 0.9
[2022-05-12 12:56:26.465036] train_epochs ............... 40
[2022-05-12 12:56:26.465042] use_gpt2 ................... False
[2022-05-12 12:56:26.465048] val_data_pct ............... 0.001
[2022-05-12 12:56:26.465054] val_metrics ................ ['accuracy']
[2022-05-12 12:56:26.465060] valid_epochs ............... 1
[2022-05-12 12:56:26.465068] variance_epsilon ........... 5e-06
[2022-05-12 12:56:26.465075] vocab_size ................. 88
[2022-05-12 12:56:26.465081] warmup_pct ................. 0.01
[2022-05-12 12:56:26.465086] weight_decay ............... 0.0
==================================================
[2022-05-12 12:56:26.465626] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 12:57:28.565597] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 12:58:59.961416] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 4 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 13:03:04.727182] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 13:03:04.747413] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 13:03:05.118107] batch_size ................. 4096
[2022-05-12 13:03:05.118139] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 13:03:05.118149] cuda ....................... True
[2022-05-12 13:03:05.118157] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 13:03:05.118164] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:03:05.118172] device ..................... 3
[2022-05-12 13:03:05.118179] device_num ................. 0
[2022-05-12 13:03:05.118187] disable_tqdm ............... True
[2022-05-12 13:03:05.118195] do_test .................... False
[2022-05-12 13:03:05.118203] do_valid ................... True
[2022-05-12 13:03:05.118210] dont_print_args ............ True
[2022-05-12 13:03:05.118218] dont_shuffle ............... None
[2022-05-12 13:03:05.118231] dropout .................... 0.3
[2022-05-12 13:03:05.118242] estimate_type .............. <function beam_search_lower_bound at 0x7f7f417f1790>
[2022-05-12 13:03:05.118252] excluded_terms ............. [1]
[2022-05-12 13:03:05.118268] finetune ................... False
[2022-05-12 13:03:05.118277] grad_clip .................. 1.0
[2022-05-12 13:03:05.118284] hidden_size ................ 512
[2022-05-12 13:03:05.118291] hist_len ................... 18
[2022-05-12 13:03:05.118300] interp_func ................ <function lin_interp at 0x7f7f417f1670>
[2022-05-12 13:03:05.118307] log_interval ............... 100
[2022-05-12 13:03:05.118316] lr ......................... 0.001
[2022-05-12 13:03:05.118323] lr_decay_style ............. constant
[2022-05-12 13:03:05.118335] masked_lm .................. False
[2022-05-12 13:03:05.118342] max_num_mc_samples ......... 100000
[2022-05-12 13:03:05.118349] max_num_queries ............ 100
[2022-05-12 13:03:05.118356] min_num_mc_samples ......... 10000
[2022-05-12 13:03:05.118363] min_phase_shift ............ 0
[2022-05-12 13:03:05.118371] min_var_reduction .......... 0.1
[2022-05-12 13:03:05.118379] min_variance ............... True
[2022-05-12 13:03:05.118387] model_budget_filepath ...... None
[2022-05-12 13:03:05.118395] num_beams .................. 0.0
[2022-05-12 13:03:05.118402] num_layers ................. 2
[2022-05-12 13:03:05.118409] num_mc_samples ............. 100
[2022-05-12 13:03:05.118417] num_workers ................ 0
[2022-05-12 13:03:05.118424] optimizer .................. adam
[2022-05-12 13:03:05.118431] proposal_func .............. <function lm_proposal at 0x7f7f417df790>
[2022-05-12 13:03:05.118438] rnn_type ................... LSTM
[2022-05-12 13:03:05.118445] save_epochs ................ 1
[2022-05-12 13:03:05.118451] seed ....................... 42
[2022-05-12 13:03:05.118459] seq_len .................... 15
[2022-05-12 13:03:05.118467] shuffle .................... True
[2022-05-12 13:03:05.118474] store_intermediate_lbs ..... True
[2022-05-12 13:03:05.118482] sub_estimates .............. []
[2022-05-12 13:03:05.118490] text_dict .................. None
[2022-05-12 13:03:05.118497] top_k ...................... 0
[2022-05-12 13:03:05.118504] top_p ...................... 0
[2022-05-12 13:03:05.118511] total_seq_len .............. 20
[2022-05-12 13:03:05.118519] train_data_pct ............. 0.9
[2022-05-12 13:03:05.118526] train_epochs ............... 40
[2022-05-12 13:03:05.118534] use_gpt2 ................... False
[2022-05-12 13:03:05.118542] val_data_pct ............... 0.0001
[2022-05-12 13:03:05.118550] val_metrics ................ ['accuracy']
[2022-05-12 13:03:05.118557] valid_epochs ............... 1
[2022-05-12 13:03:05.118567] variance_epsilon ........... 5e-06
[2022-05-12 13:03:05.118575] vocab_size ................. 30
[2022-05-12 13:03:05.118582] warmup_pct ................. 0.01
[2022-05-12 13:03:05.118589] weight_decay ............... 0.0
==================================================
[2022-05-12 13:03:05.118999] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 13:03:57.156443] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 13:05:15.811131] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 4 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-12 13:07:07.525615] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-12 13:07:07.529184] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-12 13:07:07.605756] batch_size ................. 4096
[2022-05-12 13:07:07.605783] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-12 13:07:07.605792] cuda ....................... True
[2022-05-12 13:07:07.605798] data_path .................. data/moocs/mooc.csv
[2022-05-12 13:07:07.605804] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:07:07.605811] device ..................... 3
[2022-05-12 13:07:07.605816] device_num ................. 0
[2022-05-12 13:07:07.605822] disable_tqdm ............... True
[2022-05-12 13:07:07.605829] do_test .................... False
[2022-05-12 13:07:07.605835] do_valid ................... True
[2022-05-12 13:07:07.605840] dont_print_args ............ True
[2022-05-12 13:07:07.605849] dont_shuffle ............... None
[2022-05-12 13:07:07.605861] dropout .................... 0.3
[2022-05-12 13:07:07.605870] estimate_type .............. <function beam_search_lower_bound at 0x7f7f417f1790>
[2022-05-12 13:07:07.605878] excluded_terms ............. [1]
[2022-05-12 13:07:07.605886] finetune ................... False
[2022-05-12 13:07:07.605892] grad_clip .................. 1.0
[2022-05-12 13:07:07.605898] hidden_size ................ 128
[2022-05-12 13:07:07.605904] hist_len ................... 18
[2022-05-12 13:07:07.605921] interp_func ................ <function lin_interp at 0x7f7f417f1670>
[2022-05-12 13:07:07.605926] log_interval ............... 100
[2022-05-12 13:07:07.605933] lr ......................... 0.001
[2022-05-12 13:07:07.605939] lr_decay_style ............. constant
[2022-05-12 13:07:07.605953] masked_lm .................. False
[2022-05-12 13:07:07.605959] max_num_mc_samples ......... 100000
[2022-05-12 13:07:07.605965] max_num_queries ............ 100
[2022-05-12 13:07:07.605971] min_num_mc_samples ......... 10000
[2022-05-12 13:07:07.605976] min_phase_shift ............ 0
[2022-05-12 13:07:07.605984] min_var_reduction .......... 0.1
[2022-05-12 13:07:07.605990] min_variance ............... True
[2022-05-12 13:07:07.605996] model_budget_filepath ...... None
[2022-05-12 13:07:07.606001] needs_encoding ............. False
[2022-05-12 13:07:07.606008] num_beams .................. 0.0
[2022-05-12 13:07:07.606013] num_layers ................. 2
[2022-05-12 13:07:07.606020] num_mc_samples ............. 100
[2022-05-12 13:07:07.606026] num_workers ................ 0
[2022-05-12 13:07:07.606031] optimizer .................. adam
[2022-05-12 13:07:07.606038] proposal_func .............. <function lm_proposal at 0x7f7f417df790>
[2022-05-12 13:07:07.606043] rnn_type ................... LSTM
[2022-05-12 13:07:07.606049] save_epochs ................ 1
[2022-05-12 13:07:07.606055] seed ....................... 42
[2022-05-12 13:07:07.606061] seq_len .................... 15
[2022-05-12 13:07:07.606067] shuffle .................... True
[2022-05-12 13:07:07.606073] store_intermediate_lbs ..... True
[2022-05-12 13:07:07.606079] sub_estimates .............. []
[2022-05-12 13:07:07.606084] text_dict .................. None
[2022-05-12 13:07:07.606090] top_k ...................... 0
[2022-05-12 13:07:07.606095] top_p ...................... 0
[2022-05-12 13:07:07.606102] total_seq_len .............. 20
[2022-05-12 13:07:07.606108] train_data_pct ............. 0.9
[2022-05-12 13:07:07.606114] train_epochs ............... 40
[2022-05-12 13:07:07.606119] use_gpt2 ................... False
[2022-05-12 13:07:07.606126] val_data_pct ............... 0.01
[2022-05-12 13:07:07.606133] val_metrics ................ ['accuracy']
[2022-05-12 13:07:07.606138] valid_epochs ............... 1
[2022-05-12 13:07:07.606147] variance_epsilon ........... 5e-06
[2022-05-12 13:07:07.606153] vocab_size ................. 98
[2022-05-12 13:07:07.606159] warmup_pct ................. 0.01
[2022-05-12 13:07:07.606165] weight_decay ............... 0.0
==================================================
[2022-05-12 13:07:07.606923] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 13:07:37.024724] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 13:08:13.535413] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 4 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
