==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 15:48:01.359198] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 15:48:01.366107] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 15:48:01.373590] batch_size ................. 4096
[2022-05-16 15:48:01.373611] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 15:48:01.373620] cuda ....................... True
[2022-05-16 15:48:01.373626] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 15:48:01.373632] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 15:48:01.373637] device ..................... 5
[2022-05-16 15:48:01.373643] device_num ................. 0
[2022-05-16 15:48:01.373649] disable_tqdm ............... True
[2022-05-16 15:48:01.373655] do_test .................... False
[2022-05-16 15:48:01.373661] do_valid ................... True
[2022-05-16 15:48:01.373666] dont_print_args ............ True
[2022-05-16 15:48:01.373672] dont_shuffle ............... None
[2022-05-16 15:48:01.373684] dropout .................... 0.3
[2022-05-16 15:48:01.373692] estimate_type .............. <function beam_search_lower_bound at 0x7f75ee4acc10>
[2022-05-16 15:48:01.373700] excluded_terms ............. [1]
[2022-05-16 15:48:01.373708] excluded_terms_list ........ [[]]
[2022-05-16 15:48:01.373714] finetune ................... False
[2022-05-16 15:48:01.373720] grad_clip .................. 1.0
[2022-05-16 15:48:01.373726] hidden_size ................ 128
[2022-05-16 15:48:01.373731] hist_len ................... 18
[2022-05-16 15:48:01.373737] hybrid_max_num_beams ....... 1500
[2022-05-16 15:48:01.373743] interp_func ................ <function lin_interp at 0x7f75ee4acaf0>
[2022-05-16 15:48:01.373748] log_interval ............... 100
[2022-05-16 15:48:01.373755] lr ......................... 0.001
[2022-05-16 15:48:01.373761] lr_decay_style ............. constant
[2022-05-16 15:48:01.373766] masked_lm .................. False
[2022-05-16 15:48:01.373772] max_k ...................... None
[2022-05-16 15:48:01.373778] max_num_mc_samples ......... 100000
[2022-05-16 15:48:01.373783] max_num_queries ............ 1000
[2022-05-16 15:48:01.373789] min_num_mc_samples ......... 10000
[2022-05-16 15:48:01.373794] min_phase_shift ............ 0
[2022-05-16 15:48:01.373801] min_var_reduction .......... 0.1
[2022-05-16 15:48:01.373806] min_variance ............... True
[2022-05-16 15:48:01.373812] model_budget_filepath ...... None
[2022-05-16 15:48:01.373818] num_beams .................. 0.0
[2022-05-16 15:48:01.373824] num_layers ................. 2
[2022-05-16 15:48:01.373829] num_mc_samples ............. 100
[2022-05-16 15:48:01.373835] num_workers ................ 0
[2022-05-16 15:48:01.373840] optimizer .................. adam
[2022-05-16 15:48:01.373846] proposal_func .............. <function lm_proposal at 0x7f75ee498af0>
[2022-05-16 15:48:01.373852] rnn_type ................... LSTM
[2022-05-16 15:48:01.373857] save_epochs ................ 1
[2022-05-16 15:48:01.373863] seed ....................... 42
[2022-05-16 15:48:01.373868] seq_len .................... 100
[2022-05-16 15:48:01.373874] shuffle .................... True
[2022-05-16 15:48:01.373879] store_intermediate_lbs ..... True
[2022-05-16 15:48:01.373885] sub_estimates .............. []
[2022-05-16 15:48:01.373891] tau_a_excl_terms ........... []
[2022-05-16 15:48:01.373896] tau_b_excl_terms ........... []
[2022-05-16 15:48:01.373902] terms_of_interest .......... []
[2022-05-16 15:48:01.373907] text_dict .................. None
[2022-05-16 15:48:01.373913] top_k ...................... 0
[2022-05-16 15:48:01.373918] top_p ...................... 0
[2022-05-16 15:48:01.373923] total_seq_len .............. 20
[2022-05-16 15:48:01.373929] train_data_pct ............. 0.9
[2022-05-16 15:48:01.373935] train_epochs ............... 40
[2022-05-16 15:48:01.373940] use_gpt2 ................... False
[2022-05-16 15:48:01.373946] val_data_pct ............... 0.05
[2022-05-16 15:48:01.373953] val_metrics ................ ['accuracy']
[2022-05-16 15:48:01.373958] valid_epochs ............... 1
[2022-05-16 15:48:01.373967] variance_epsilon ........... 5e-06
[2022-05-16 15:48:01.373972] vocab_size ................. 68
[2022-05-16 15:48:01.373978] warmup_pct ................. 0.01
[2022-05-16 15:48:01.373984] weight_decay ............... 0.0
==================================================
[2022-05-16 15:48:01.374486] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 14 | Total Seq Length 20 | Max num queries: 1000

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-16 15:58:58.651352] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-16 15:58:58.654387] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-16 15:58:58.727054] batch_size ................. 4096
[2022-05-16 15:58:58.727078] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-16 15:58:58.727087] cuda ....................... True
[2022-05-16 15:58:58.727092] data_path .................. data/moocs/mooc.csv
[2022-05-16 15:58:58.727098] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 15:58:58.727104] device ..................... 5
[2022-05-16 15:58:58.727109] device_num ................. 0
[2022-05-16 15:58:58.727115] disable_tqdm ............... True
[2022-05-16 15:58:58.727121] do_test .................... False
[2022-05-16 15:58:58.727126] do_valid ................... True
[2022-05-16 15:58:58.727132] dont_print_args ............ True
[2022-05-16 15:58:58.727139] dont_shuffle ............... None
[2022-05-16 15:58:58.727149] dropout .................... 0.3
[2022-05-16 15:58:58.727158] estimate_type .............. <function beam_search_lower_bound at 0x7f75ee4acc10>
[2022-05-16 15:58:58.727166] excluded_terms ............. [1]
[2022-05-16 15:58:58.727173] excluded_terms_list ........ [[]]
[2022-05-16 15:58:58.727179] finetune ................... False
[2022-05-16 15:58:58.727186] grad_clip .................. 1.0
[2022-05-16 15:58:58.727191] hidden_size ................ 128
[2022-05-16 15:58:58.727197] hist_len ................... 18
[2022-05-16 15:58:58.727202] hybrid_max_num_beams ....... 1500
[2022-05-16 15:58:58.727208] interp_func ................ <function lin_interp at 0x7f75ee4acaf0>
[2022-05-16 15:58:58.727214] log_interval ............... 100
[2022-05-16 15:58:58.727221] lr ......................... 0.001
[2022-05-16 15:58:58.727226] lr_decay_style ............. constant
[2022-05-16 15:58:58.727232] masked_lm .................. False
[2022-05-16 15:58:58.727237] max_k ...................... None
[2022-05-16 15:58:58.727243] max_num_mc_samples ......... 100000
[2022-05-16 15:58:58.727249] max_num_queries ............ 1000
[2022-05-16 15:58:58.727254] min_num_mc_samples ......... 10000
[2022-05-16 15:58:58.727259] min_phase_shift ............ 0
[2022-05-16 15:58:58.727265] min_var_reduction .......... 0.1
[2022-05-16 15:58:58.727271] min_variance ............... True
[2022-05-16 15:58:58.727277] model_budget_filepath ...... None
[2022-05-16 15:58:58.727282] needs_encoding ............. False
[2022-05-16 15:58:58.727288] num_beams .................. 0.0
[2022-05-16 15:58:58.727294] num_layers ................. 2
[2022-05-16 15:58:58.727299] num_mc_samples ............. 100
[2022-05-16 15:58:58.727304] num_workers ................ 0
[2022-05-16 15:58:58.727309] optimizer .................. adam
[2022-05-16 15:58:58.727316] proposal_func .............. <function lm_proposal at 0x7f75ee498af0>
[2022-05-16 15:58:58.727321] rnn_type ................... LSTM
[2022-05-16 15:58:58.727326] save_epochs ................ 1
[2022-05-16 15:58:58.727332] seed ....................... 42
[2022-05-16 15:58:58.727337] seq_len .................... 15
[2022-05-16 15:58:58.727342] shuffle .................... True
[2022-05-16 15:58:58.727348] store_intermediate_lbs ..... True
[2022-05-16 15:58:58.727353] sub_estimates .............. []
[2022-05-16 15:58:58.727359] tau_a_excl_terms ........... []
[2022-05-16 15:58:58.727364] tau_b_excl_terms ........... []
[2022-05-16 15:58:58.727370] terms_of_interest .......... []
[2022-05-16 15:58:58.727375] text_dict .................. None
[2022-05-16 15:58:58.727381] top_k ...................... 0
[2022-05-16 15:58:58.727386] top_p ...................... 0
[2022-05-16 15:58:58.727391] total_seq_len .............. 20
[2022-05-16 15:58:58.727397] train_data_pct ............. 0.9
[2022-05-16 15:58:58.727402] train_epochs ............... 40
[2022-05-16 15:58:58.727408] use_gpt2 ................... False
[2022-05-16 15:58:58.727414] val_data_pct ............... 0.01
[2022-05-16 15:58:58.727420] val_metrics ................ ['accuracy']
[2022-05-16 15:58:58.727425] valid_epochs ............... 1
[2022-05-16 15:58:58.727433] variance_epsilon ........... 5e-06
[2022-05-16 15:58:58.727439] vocab_size ................. 98
[2022-05-16 15:58:58.727444] warmup_pct ................. 0.01
[2022-05-16 15:58:58.727450] weight_decay ............... 0.0
==================================================
[2022-05-16 15:58:58.728192] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 9 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-16 16:06:56.469252] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-16 16:06:56.481386] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-16 16:06:56.661733] batch_size ................. 4096
[2022-05-16 16:06:56.661755] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-16 16:06:56.661762] cuda ....................... True
[2022-05-16 16:06:56.661766] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-16 16:06:56.661770] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:06:56.661775] device ..................... 5
[2022-05-16 16:06:56.661778] device_num ................. 0
[2022-05-16 16:06:56.661782] disable_tqdm ............... True
[2022-05-16 16:06:56.661787] do_test .................... False
[2022-05-16 16:06:56.661791] do_valid ................... True
[2022-05-16 16:06:56.661795] dont_print_args ............ True
[2022-05-16 16:06:56.661799] dont_shuffle ............... None
[2022-05-16 16:06:56.661807] dropout .................... 0.3
[2022-05-16 16:06:56.661812] estimate_type .............. <function beam_search_lower_bound at 0x7f75ee4acc10>
[2022-05-16 16:06:56.661819] excluded_terms ............. [1]
[2022-05-16 16:06:56.661826] excluded_terms_list ........ [[]]
[2022-05-16 16:06:56.661830] finetune ................... False
[2022-05-16 16:06:56.661835] grad_clip .................. 1.0
[2022-05-16 16:06:56.661838] hidden_size ................ 512
[2022-05-16 16:06:56.661842] hist_len ................... 18
[2022-05-16 16:06:56.661846] hybrid_max_num_beams ....... 1500
[2022-05-16 16:06:56.661851] interp_func ................ <function lin_interp at 0x7f75ee4acaf0>
[2022-05-16 16:06:56.661855] log_interval ............... 100
[2022-05-16 16:06:56.661859] lr ......................... 0.001
[2022-05-16 16:06:56.661863] lr_decay_style ............. constant
[2022-05-16 16:06:56.661866] masked_lm .................. False
[2022-05-16 16:06:56.661871] max_k ...................... None
[2022-05-16 16:06:56.661875] max_num_mc_samples ......... 100000
[2022-05-16 16:06:56.661878] max_num_queries ............ 1000
[2022-05-16 16:06:56.661882] min_num_mc_samples ......... 10000
[2022-05-16 16:06:56.661886] min_phase_shift ............ 0
[2022-05-16 16:06:56.661890] min_var_reduction .......... 0.1
[2022-05-16 16:06:56.661893] min_variance ............... True
[2022-05-16 16:06:56.661897] model_budget_filepath ...... None
[2022-05-16 16:06:56.661901] num_beams .................. 0.0
[2022-05-16 16:06:56.661904] num_layers ................. 2
[2022-05-16 16:06:56.661908] num_mc_samples ............. 100
[2022-05-16 16:06:56.661911] num_workers ................ 0
[2022-05-16 16:06:56.661915] optimizer .................. adam
[2022-05-16 16:06:56.661919] proposal_func .............. <function lm_proposal at 0x7f75ee498af0>
[2022-05-16 16:06:56.661922] rnn_type ................... LSTM
[2022-05-16 16:06:56.661926] save_epochs ................ 1
[2022-05-16 16:06:56.661929] seed ....................... 42
[2022-05-16 16:06:56.661932] seq_len .................... 15
[2022-05-16 16:06:56.661936] shuffle .................... True
[2022-05-16 16:06:56.661939] store_intermediate_lbs ..... True
[2022-05-16 16:06:56.661943] sub_estimates .............. []
[2022-05-16 16:06:56.661947] tau_a_excl_terms ........... []
[2022-05-16 16:06:56.661950] tau_b_excl_terms ........... []
[2022-05-16 16:06:56.661953] terms_of_interest .......... []
[2022-05-16 16:06:56.661957] text_dict .................. None
[2022-05-16 16:06:56.661960] top_k ...................... 0
[2022-05-16 16:06:56.661963] top_p ...................... 0
[2022-05-16 16:06:56.661966] total_seq_len .............. 20
[2022-05-16 16:06:56.661970] train_data_pct ............. 0.9
[2022-05-16 16:06:56.661973] train_epochs ............... 40
[2022-05-16 16:06:56.661977] use_gpt2 ................... False
[2022-05-16 16:06:56.661981] val_data_pct ............... 0.0001
[2022-05-16 16:06:56.661985] val_metrics ................ ['accuracy']
[2022-05-16 16:06:56.661989] valid_epochs ............... 1
[2022-05-16 16:06:56.661994] variance_epsilon ........... 5e-06
[2022-05-16 16:06:56.662002] vocab_size ................. 30
[2022-05-16 16:06:56.662006] warmup_pct ................. 0.01
[2022-05-16 16:06:56.662009] weight_decay ............... 0.0
==================================================
[2022-05-16 16:06:56.662308] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 9 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-16 16:13:02.179246] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-16 16:13:02.188391] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-16 16:13:02.491440] batch_size ................. 4096
[2022-05-16 16:13:02.491461] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-16 16:13:02.491467] cuda ....................... True
[2022-05-16 16:13:02.491471] data_path .................. data/apps/lsapp.tsv
[2022-05-16 16:13:02.491474] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 16:13:02.491478] device ..................... 5
[2022-05-16 16:13:02.491481] device_num ................. 0
[2022-05-16 16:13:02.491485] disable_tqdm ............... True
[2022-05-16 16:13:02.491488] do_test .................... False
[2022-05-16 16:13:02.491492] do_valid ................... True
[2022-05-16 16:13:02.491495] dont_print_args ............ True
[2022-05-16 16:13:02.491499] dont_shuffle ............... None
[2022-05-16 16:13:02.491506] dropout .................... 0.3
[2022-05-16 16:13:02.491512] estimate_type .............. <function beam_search_lower_bound at 0x7f75ee4acc10>
[2022-05-16 16:13:02.491517] excluded_terms ............. [1]
[2022-05-16 16:13:02.491524] excluded_terms_list ........ [[]]
[2022-05-16 16:13:02.491527] finetune ................... False
[2022-05-16 16:13:02.491531] grad_clip .................. 1.0
[2022-05-16 16:13:02.491534] hidden_size ................ 512
[2022-05-16 16:13:02.491538] hist_len ................... 18
[2022-05-16 16:13:02.491541] hybrid_max_num_beams ....... 1500
[2022-05-16 16:13:02.491545] interp_func ................ <function lin_interp at 0x7f75ee4acaf0>
[2022-05-16 16:13:02.491548] log_interval ............... 100
[2022-05-16 16:13:02.491574] lr ......................... 0.001
[2022-05-16 16:13:02.491578] lr_decay_style ............. constant
[2022-05-16 16:13:02.491581] masked_lm .................. False
[2022-05-16 16:13:02.491584] max_k ...................... None
[2022-05-16 16:13:02.491588] max_num_mc_samples ......... 100000
[2022-05-16 16:13:02.491592] max_num_queries ............ 1000
[2022-05-16 16:13:02.491595] min_num_mc_samples ......... 10000
[2022-05-16 16:13:02.491598] min_phase_shift ............ 0
[2022-05-16 16:13:02.491602] min_var_reduction .......... 0.1
[2022-05-16 16:13:02.491605] min_variance ............... True
[2022-05-16 16:13:02.491608] model_budget_filepath ...... None
[2022-05-16 16:13:02.491612] needs_encoding ............. True
[2022-05-16 16:13:02.491615] num_beams .................. 0.0
[2022-05-16 16:13:02.491618] num_layers ................. 2
[2022-05-16 16:13:02.491621] num_mc_samples ............. 100
[2022-05-16 16:13:02.491624] num_workers ................ 0
[2022-05-16 16:13:02.491627] optimizer .................. adam
[2022-05-16 16:13:02.491631] proposal_func .............. <function lm_proposal at 0x7f75ee498af0>
[2022-05-16 16:13:02.491635] rnn_type ................... LSTM
[2022-05-16 16:13:02.491638] save_epochs ................ 1
[2022-05-16 16:13:02.491641] seed ....................... 42
[2022-05-16 16:13:02.491644] seq_len .................... 15
[2022-05-16 16:13:02.491647] shuffle .................... True
[2022-05-16 16:13:02.491650] store_intermediate_lbs ..... True
[2022-05-16 16:13:02.491654] sub_estimates .............. []
[2022-05-16 16:13:02.491658] tau_a_excl_terms ........... []
[2022-05-16 16:13:02.491661] tau_b_excl_terms ........... []
[2022-05-16 16:13:02.491664] terms_of_interest .......... []
[2022-05-16 16:13:02.491667] text_dict .................. None
[2022-05-16 16:13:02.491670] top_k ...................... 0
[2022-05-16 16:13:02.491673] top_p ...................... 0
[2022-05-16 16:13:02.491676] total_seq_len .............. 20
[2022-05-16 16:13:02.491679] train_data_pct ............. 0.9
[2022-05-16 16:13:02.491683] train_epochs ............... 40
[2022-05-16 16:13:02.491686] use_gpt2 ................... False
[2022-05-16 16:13:02.491689] val_data_pct ............... 0.001
[2022-05-16 16:13:02.491694] val_metrics ................ ['accuracy']
[2022-05-16 16:13:02.491697] valid_epochs ............... 1
[2022-05-16 16:13:02.491702] variance_epsilon ........... 5e-06
[2022-05-16 16:13:02.491705] vocab_size ................. 88
[2022-05-16 16:13:02.491709] warmup_pct ................. 0.01
[2022-05-16 16:13:02.491712] weight_decay ............... 0.0
==================================================
[2022-05-16 16:13:02.492055] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 9 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
