==================================================
* Running for dataset shakespeare
==================================================
[2022-05-17 16:48:52.704650] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-17 16:48:52.711454] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-17 16:48:52.732490] batch_size ................. 8000
[2022-05-17 16:48:52.732522] bs_ablation ................ False
[2022-05-17 16:48:52.732533] bs_ablation_max_beams ...... 10000
[2022-05-17 16:48:52.732543] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-17 16:48:52.732554] cuda ....................... True
[2022-05-17 16:48:52.732564] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-17 16:48:52.732574] dataset .................... shakespeare
[2022-05-17 16:48:52.732584] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-17 16:48:52.732604] device ..................... 3
[2022-05-17 16:48:52.732612] device_num ................. 0
[2022-05-17 16:48:52.732621] disable_tqdm ............... True
[2022-05-17 16:48:52.732630] do_test .................... False
[2022-05-17 16:48:52.732639] do_valid ................... True
[2022-05-17 16:48:52.732648] dont_print_args ............ True
[2022-05-17 16:48:52.732662] dont_shuffle ............... None
[2022-05-17 16:48:52.732677] dropout .................... 0.3
[2022-05-17 16:48:52.732690] estimate_type .............. <function beam_search_lower_bound at 0x7fd17ed22ca0>
[2022-05-17 16:48:52.732701] excluded_terms ............. [1]
[2022-05-17 16:48:52.732711] excluded_terms_list ........ [[]]
[2022-05-17 16:48:52.732720] finetune ................... False
[2022-05-17 16:48:52.732729] grad_clip .................. 1.0
[2022-05-17 16:48:52.732738] hidden_size ................ 128
[2022-05-17 16:48:52.732746] hist_len ................... 18
[2022-05-17 16:48:52.732754] hybrid_max_num_beams ....... 1500
[2022-05-17 16:48:52.732766] interp_func ................ <function lin_interp at 0x7fd17ed22b80>
[2022-05-17 16:48:52.732774] log_interval ............... 100
[2022-05-17 16:48:52.732783] lr ......................... 0.001
[2022-05-17 16:48:52.732792] lr_decay_style ............. constant
[2022-05-17 16:48:52.732800] masked_lm .................. False
[2022-05-17 16:48:52.732809] max_k ...................... None
[2022-05-17 16:48:52.732817] max_num_mc_samples ......... 100000
[2022-05-17 16:48:52.732825] max_num_queries ............ 100
[2022-05-17 16:48:52.732833] min_num_mc_samples ......... 10000
[2022-05-17 16:48:52.732841] min_phase_shift ............ 0
[2022-05-17 16:48:52.732850] min_var_reduction .......... 0.1
[2022-05-17 16:48:52.732859] min_variance ............... True
[2022-05-17 16:48:52.732867] model_budget_filepath ...... None
[2022-05-17 16:48:52.732875] needs_dl ................... True
[2022-05-17 16:48:52.732884] num_beams .................. 0.0
[2022-05-17 16:48:52.732893] num_layers ................. 2
[2022-05-17 16:48:52.732901] num_mc_samples ............. 100
[2022-05-17 16:48:52.732909] num_workers ................ 0
[2022-05-17 16:48:52.732917] optimizer .................. adam
[2022-05-17 16:48:52.732926] proposal_func .............. <function lm_proposal at 0x7fd17ed0fb80>
[2022-05-17 16:48:52.732934] rnn_type ................... LSTM
[2022-05-17 16:48:52.732942] save_epochs ................ 1
[2022-05-17 16:48:52.732950] seed ....................... 42
[2022-05-17 16:48:52.732958] seq_len .................... 100
[2022-05-17 16:48:52.732967] shuffle .................... True
[2022-05-17 16:48:52.732976] store_intermediate_lbs ..... True
[2022-05-17 16:48:52.732984] sub_estimates .............. []
[2022-05-17 16:48:52.732992] tau_a_excl_terms ........... []
[2022-05-17 16:48:52.733000] tau_b_excl_terms ........... []
[2022-05-17 16:48:52.733008] terms_of_interest .......... []
[2022-05-17 16:48:52.733016] text_dict .................. None
[2022-05-17 16:48:52.733024] top_k ...................... 0
[2022-05-17 16:48:52.733032] top_p ...................... 0
[2022-05-17 16:48:52.733040] total_seq_len .............. 20
[2022-05-17 16:48:52.733049] train_data_pct ............. 0.9
[2022-05-17 16:48:52.733057] train_epochs ............... 40
[2022-05-17 16:48:52.733066] use_gpt2 ................... False
[2022-05-17 16:48:52.733074] val_data_pct ............... 0.05
[2022-05-17 16:48:52.733085] val_metrics ................ ['accuracy']
[2022-05-17 16:48:52.733094] valid_epochs ............... 1
[2022-05-17 16:48:52.733106] variance_epsilon ........... 5e-06
[2022-05-17 16:48:52.733114] vocab_size ................. 68
[2022-05-17 16:48:52.733123] warmup_pct ................. 0.01
[2022-05-17 16:48:52.733132] weight_decay ............... 0.0
==================================================
[2022-05-17 16:48:52.733727] | Dataset: shakespeare | Sample type: beam_search_ablation | Num Beams: 0.95 | Hist length 10 | Total Seq Length 20

..........
==================================================
[2022-05-17 16:56:24.329319] | Dataset: shakespeare | Sample type: beam_search_ablation | Num Beams: 0.75 | Hist length 10 | Total Seq Length 20

..........
==================================================
[2022-05-17 17:02:53.737640] | Dataset: shakespeare | Sample type: beam_search_ablation | Num Beams: 0.5 | Hist length 10 | Total Seq Length 20

..........
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-17 17:09:19.511803] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-17 17:09:19.516094] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-17 17:09:19.691487] batch_size ................. 8000
[2022-05-17 17:09:19.691546] bs_ablation ................ False
[2022-05-17 17:09:19.691552] bs_ablation_max_beams ...... 10000
[2022-05-17 17:09:19.691558] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-17 17:09:19.694596] cuda ....................... True
[2022-05-17 17:09:19.694603] data_path .................. data/moocs/mooc.csv
[2022-05-17 17:09:19.694609] dataset .................... moocs
[2022-05-17 17:09:19.694615] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-17 17:09:19.694621] device ..................... 3
[2022-05-17 17:09:19.694627] device_num ................. 0
[2022-05-17 17:09:19.694632] disable_tqdm ............... True
[2022-05-17 17:09:19.694639] do_test .................... False
[2022-05-17 17:09:19.694644] do_valid ................... True
[2022-05-17 17:09:19.694650] dont_print_args ............ True
[2022-05-17 17:09:19.694656] dont_shuffle ............... None
[2022-05-17 17:09:19.694672] dropout .................... 0.3
[2022-05-17 17:09:19.694680] estimate_type .............. <function beam_search_lower_bound at 0x7fd17ed22ca0>
[2022-05-17 17:09:19.694689] excluded_terms ............. [1]
[2022-05-17 17:09:19.694695] excluded_terms_list ........ [[]]
[2022-05-17 17:09:19.694731] finetune ................... False
[2022-05-17 17:09:19.694738] grad_clip .................. 1.0
[2022-05-17 17:09:19.694744] hidden_size ................ 128
[2022-05-17 17:09:19.694749] hist_len ................... 18
[2022-05-17 17:09:19.694759] hybrid_max_num_beams ....... 1500
[2022-05-17 17:09:19.694766] interp_func ................ <function lin_interp at 0x7fd17ed22b80>
[2022-05-17 17:09:19.694772] log_interval ............... 100
[2022-05-17 17:09:19.694779] lr ......................... 0.001
[2022-05-17 17:09:19.694785] lr_decay_style ............. constant
[2022-05-17 17:09:19.694791] masked_lm .................. False
[2022-05-17 17:09:19.694797] max_k ...................... None
[2022-05-17 17:09:19.694802] max_num_mc_samples ......... 100000
[2022-05-17 17:09:19.694808] max_num_queries ............ 100
[2022-05-17 17:09:19.694813] min_num_mc_samples ......... 10000
[2022-05-17 17:09:19.694819] min_phase_shift ............ 0
[2022-05-17 17:09:19.694826] min_var_reduction .......... 0.1
[2022-05-17 17:09:19.694832] min_variance ............... True
[2022-05-17 17:09:19.694838] model_budget_filepath ...... None
[2022-05-17 17:09:19.694844] needs_dl ................... True
[2022-05-17 17:09:19.694849] needs_encoding ............. False
[2022-05-17 17:09:19.694856] num_beams .................. 0.0
[2022-05-17 17:09:19.694861] num_layers ................. 2
[2022-05-17 17:09:19.694868] num_mc_samples ............. 100
[2022-05-17 17:09:19.694874] num_workers ................ 0
[2022-05-17 17:09:19.694879] optimizer .................. adam
[2022-05-17 17:09:19.694886] proposal_func .............. <function lm_proposal at 0x7fd17ed0fb80>
[2022-05-17 17:09:19.694891] rnn_type ................... LSTM
[2022-05-17 17:09:19.694897] save_epochs ................ 1
[2022-05-17 17:09:19.694902] seed ....................... 42
[2022-05-17 17:09:19.694908] seq_len .................... 15
[2022-05-17 17:09:19.694914] shuffle .................... True
[2022-05-17 17:09:19.694919] store_intermediate_lbs ..... True
[2022-05-17 17:09:19.694925] sub_estimates .............. []
[2022-05-17 17:09:19.694931] tau_a_excl_terms ........... []
[2022-05-17 17:09:19.694936] tau_b_excl_terms ........... []
[2022-05-17 17:09:19.694942] terms_of_interest .......... []
[2022-05-17 17:09:19.694947] text_dict .................. None
[2022-05-17 17:09:19.694954] top_k ...................... 0
[2022-05-17 17:09:19.694959] top_p ...................... 0
[2022-05-17 17:09:19.694965] total_seq_len .............. 20
[2022-05-17 17:09:19.694971] train_data_pct ............. 0.9
[2022-05-17 17:09:19.694976] train_epochs ............... 40
[2022-05-17 17:09:19.694981] use_gpt2 ................... False
[2022-05-17 17:09:19.694987] val_data_pct ............... 0.01
[2022-05-17 17:09:19.694994] val_metrics ................ ['accuracy']
[2022-05-17 17:09:19.695000] valid_epochs ............... 1
[2022-05-17 17:09:19.695009] variance_epsilon ........... 5e-06
[2022-05-17 17:09:19.695015] vocab_size ................. 98
[2022-05-17 17:09:19.695021] warmup_pct ................. 0.01
[2022-05-17 17:09:19.695026] weight_decay ............... 0.0
==================================================
[2022-05-17 17:09:19.695773] | Dataset: moocs | Sample type: beam_search_ablation | Num Beams: 0.95 | Hist length 5 | Total Seq Length 15

..........
==================================================
[2022-05-17 17:17:30.730109] | Dataset: moocs | Sample type: beam_search_ablation | Num Beams: 0.75 | Hist length 5 | Total Seq Length 15

..........
==================================================
[2022-05-17 17:24:52.016214] | Dataset: moocs | Sample type: beam_search_ablation | Num Beams: 0.5 | Hist length 5 | Total Seq Length 15

..........
==================================================
