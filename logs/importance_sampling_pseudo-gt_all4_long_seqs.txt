==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 16:57:32.961422] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 16:57:32.964895] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 16:57:32.966555] batch_size ................. 4096
[2022-05-12 16:57:32.966564] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 16:57:32.966575] cuda ....................... True
[2022-05-12 16:57:32.966578] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 16:57:32.966581] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 16:57:32.966584] device ..................... 7
[2022-05-12 16:57:32.966586] device_num ................. 0
[2022-05-12 16:57:32.966589] disable_tqdm ............... True
[2022-05-12 16:57:32.966592] do_test .................... False
[2022-05-12 16:57:32.966595] do_valid ................... True
[2022-05-12 16:57:32.966597] dont_print_args ............ True
[2022-05-12 16:57:32.966604] dont_shuffle ............... None
[2022-05-12 16:57:32.966610] dropout .................... 0.3
[2022-05-12 16:57:32.966614] estimate_type .............. <function beam_search_lower_bound at 0x7f90af1d4820>
[2022-05-12 16:57:32.966618] excluded_terms ............. [1]
[2022-05-12 16:57:32.966622] finetune ................... False
[2022-05-12 16:57:32.966625] grad_clip .................. 1.0
[2022-05-12 16:57:32.966627] hidden_size ................ 128
[2022-05-12 16:57:32.966629] hist_len ................... 18
[2022-05-12 16:57:32.966633] interp_func ................ <function lin_interp at 0x7f90af1d4700>
[2022-05-12 16:57:32.966635] log_interval ............... 100
[2022-05-12 16:57:32.966638] lr ......................... 0.001
[2022-05-12 16:57:32.966641] lr_decay_style ............. constant
[2022-05-12 16:57:32.966643] masked_lm .................. False
[2022-05-12 16:57:32.966646] max_num_mc_samples ......... 100000
[2022-05-12 16:57:32.966649] max_num_queries ............ 1500
[2022-05-12 16:57:32.966651] min_num_mc_samples ......... 10000
[2022-05-12 16:57:32.966653] min_phase_shift ............ 0
[2022-05-12 16:57:32.966656] min_var_reduction .......... 0.1
[2022-05-12 16:57:32.966659] min_variance ............... True
[2022-05-12 16:57:32.966661] model_budget_filepath ...... None
[2022-05-12 16:57:32.966664] num_beams .................. 0.0
[2022-05-12 16:57:32.966666] num_layers ................. 2
[2022-05-12 16:57:32.966669] num_mc_samples ............. 100
[2022-05-12 16:57:32.966671] num_workers ................ 0
[2022-05-12 16:57:32.966674] optimizer .................. adam
[2022-05-12 16:57:32.966677] proposal_func .............. <function lm_proposal at 0x7f90af1c1820>
[2022-05-12 16:57:32.966679] rnn_type ................... LSTM
[2022-05-12 16:57:32.966682] save_epochs ................ 1
[2022-05-12 16:57:32.966684] seed ....................... 42
[2022-05-12 16:57:32.966686] seq_len .................... 100
[2022-05-12 16:57:32.966689] shuffle .................... True
[2022-05-12 16:57:32.966691] store_intermediate_lbs ..... True
[2022-05-12 16:57:32.966694] sub_estimates .............. []
[2022-05-12 16:57:32.966696] text_dict .................. None
[2022-05-12 16:57:32.966699] top_k ...................... 0
[2022-05-12 16:57:32.966701] top_p ...................... 0
[2022-05-12 16:57:32.966704] total_seq_len .............. 20
[2022-05-12 16:57:32.966707] train_data_pct ............. 0.9
[2022-05-12 16:57:32.966709] train_epochs ............... 40
[2022-05-12 16:57:32.966712] use_gpt2 ................... False
[2022-05-12 16:57:32.966715] val_data_pct ............... 0.05
[2022-05-12 16:57:32.966718] val_metrics ................ ['accuracy']
[2022-05-12 16:57:32.966720] valid_epochs ............... 1
[2022-05-12 16:57:32.966724] variance_epsilon ........... 5e-06
[2022-05-12 16:57:32.966727] vocab_size ................. 68
[2022-05-12 16:57:32.966729] warmup_pct ................. 0.01
[2022-05-12 16:57:32.966732] weight_decay ............... 0.0
==================================================
[2022-05-12 16:57:32.967092] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
[2022-05-12 17:00:35.589015] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 12 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
[2022-05-12 17:04:58.857761] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 17:10:33.367437] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 17:10:33.375006] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 17:10:33.713391] batch_size ................. 4096
[2022-05-12 17:10:33.713419] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 17:10:33.713427] cuda ....................... True
[2022-05-12 17:10:33.713430] data_path .................. data/apps/lsapp.tsv
[2022-05-12 17:10:33.713434] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 17:10:33.713439] device ..................... 7
[2022-05-12 17:10:33.713443] device_num ................. 0
[2022-05-12 17:10:33.713446] disable_tqdm ............... True
[2022-05-12 17:10:33.713451] do_test .................... False
[2022-05-12 17:10:33.713454] do_valid ................... True
[2022-05-12 17:10:33.713458] dont_print_args ............ True
[2022-05-12 17:10:33.713470] dont_shuffle ............... None
[2022-05-12 17:10:33.713479] dropout .................... 0.3
[2022-05-12 17:10:33.713485] estimate_type .............. <function beam_search_lower_bound at 0x7f90af1d4820>
[2022-05-12 17:10:33.713491] excluded_terms ............. [1]
[2022-05-12 17:10:33.713496] finetune ................... False
[2022-05-12 17:10:33.713501] grad_clip .................. 1.0
[2022-05-12 17:10:33.713504] hidden_size ................ 512
[2022-05-12 17:10:33.713508] hist_len ................... 18
[2022-05-12 17:10:33.713512] interp_func ................ <function lin_interp at 0x7f90af1d4700>
[2022-05-12 17:10:33.713516] log_interval ............... 100
[2022-05-12 17:10:33.713520] lr ......................... 0.001
[2022-05-12 17:10:33.713524] lr_decay_style ............. constant
[2022-05-12 17:10:33.713527] masked_lm .................. False
[2022-05-12 17:10:33.713531] max_num_mc_samples ......... 100000
[2022-05-12 17:10:33.713534] max_num_queries ............ 1500
[2022-05-12 17:10:33.713538] min_num_mc_samples ......... 10000
[2022-05-12 17:10:33.713541] min_phase_shift ............ 0
[2022-05-12 17:10:33.713547] min_var_reduction .......... 0.1
[2022-05-12 17:10:33.713551] min_variance ............... True
[2022-05-12 17:10:33.713555] model_budget_filepath ...... None
[2022-05-12 17:10:33.713558] needs_encoding ............. True
[2022-05-12 17:10:33.713562] num_beams .................. 0.0
[2022-05-12 17:10:33.713566] num_layers ................. 2
[2022-05-12 17:10:33.713570] num_mc_samples ............. 100
[2022-05-12 17:10:33.713573] num_workers ................ 0
[2022-05-12 17:10:33.713576] optimizer .................. adam
[2022-05-12 17:10:33.713580] proposal_func .............. <function lm_proposal at 0x7f90af1c1820>
[2022-05-12 17:10:33.713583] rnn_type ................... LSTM
[2022-05-12 17:10:33.713587] save_epochs ................ 1
[2022-05-12 17:10:33.713590] seed ....................... 42
[2022-05-12 17:10:33.713594] seq_len .................... 15
[2022-05-12 17:10:33.713597] shuffle .................... True
[2022-05-12 17:10:33.713601] store_intermediate_lbs ..... True
[2022-05-12 17:10:33.713605] sub_estimates .............. []
[2022-05-12 17:10:33.713608] text_dict .................. None
[2022-05-12 17:10:33.713611] top_k ...................... 0
[2022-05-12 17:10:33.713615] top_p ...................... 0
[2022-05-12 17:10:33.713618] total_seq_len .............. 20
[2022-05-12 17:10:33.713622] train_data_pct ............. 0.9
[2022-05-12 17:10:33.713625] train_epochs ............... 40
[2022-05-12 17:10:33.713629] use_gpt2 ................... False
[2022-05-12 17:10:33.713632] val_data_pct ............... 0.001
[2022-05-12 17:10:33.713637] val_metrics ................ ['accuracy']
[2022-05-12 17:10:33.713640] valid_epochs ............... 1
[2022-05-12 17:10:33.713645] variance_epsilon ........... 5e-06
[2022-05-12 17:10:33.713650] vocab_size ................. 88
[2022-05-12 17:10:33.713653] warmup_pct ................. 0.01
[2022-05-12 17:10:33.713657] weight_decay ............... 0.0
==================================================
[2022-05-12 17:10:33.714014] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
[2022-05-12 17:17:49.358330] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
[2022-05-12 17:28:42.247092] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 17:43:20.206687] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 17:43:20.215512] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 17:43:20.416103] batch_size ................. 4096
[2022-05-12 17:43:20.416131] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 17:43:20.416142] cuda ....................... True
[2022-05-12 17:43:20.416146] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 17:43:20.416150] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 17:43:20.416155] device ..................... 7
[2022-05-12 17:43:20.416158] device_num ................. 0
[2022-05-12 17:43:20.416162] disable_tqdm ............... True
[2022-05-12 17:43:20.416166] do_test .................... False
[2022-05-12 17:43:20.416169] do_valid ................... True
[2022-05-12 17:43:20.416173] dont_print_args ............ True
[2022-05-12 17:43:20.416177] dont_shuffle ............... None
[2022-05-12 17:43:20.416187] dropout .................... 0.3
[2022-05-12 17:43:20.416192] estimate_type .............. <function beam_search_lower_bound at 0x7f90af1d4820>
[2022-05-12 17:43:20.416201] excluded_terms ............. [1]
[2022-05-12 17:43:20.416206] finetune ................... False
[2022-05-12 17:43:20.416211] grad_clip .................. 1.0
[2022-05-12 17:43:20.416214] hidden_size ................ 512
[2022-05-12 17:43:20.416217] hist_len ................... 18
[2022-05-12 17:43:20.416222] interp_func ................ <function lin_interp at 0x7f90af1d4700>
[2022-05-12 17:43:20.416225] log_interval ............... 100
[2022-05-12 17:43:20.416230] lr ......................... 0.001
[2022-05-12 17:43:20.416233] lr_decay_style ............. constant
[2022-05-12 17:43:20.416237] masked_lm .................. False
[2022-05-12 17:43:20.416240] max_num_mc_samples ......... 100000
[2022-05-12 17:43:20.416244] max_num_queries ............ 1500
[2022-05-12 17:43:20.416247] min_num_mc_samples ......... 10000
[2022-05-12 17:43:20.416250] min_phase_shift ............ 0
[2022-05-12 17:43:20.416263] min_var_reduction .......... 0.1
[2022-05-12 17:43:20.416267] min_variance ............... True
[2022-05-12 17:43:20.416271] model_budget_filepath ...... None
[2022-05-12 17:43:20.416275] num_beams .................. 0.0
[2022-05-12 17:43:20.416278] num_layers ................. 2
[2022-05-12 17:43:20.416282] num_mc_samples ............. 100
[2022-05-12 17:43:20.416285] num_workers ................ 0
[2022-05-12 17:43:20.416289] optimizer .................. adam
[2022-05-12 17:43:20.416293] proposal_func .............. <function lm_proposal at 0x7f90af1c1820>
[2022-05-12 17:43:20.416296] rnn_type ................... LSTM
[2022-05-12 17:43:20.416299] save_epochs ................ 1
[2022-05-12 17:43:20.416303] seed ....................... 42
[2022-05-12 17:43:20.416306] seq_len .................... 15
[2022-05-12 17:43:20.416311] shuffle .................... True
[2022-05-12 17:43:20.416314] store_intermediate_lbs ..... True
[2022-05-12 17:43:20.416318] sub_estimates .............. []
[2022-05-12 17:43:20.416321] text_dict .................. None
[2022-05-12 17:43:20.416324] top_k ...................... 0
[2022-05-12 17:43:20.416328] top_p ...................... 0
[2022-05-12 17:43:20.416331] total_seq_len .............. 20
[2022-05-12 17:43:20.416335] train_data_pct ............. 0.9
[2022-05-12 17:43:20.416339] train_epochs ............... 40
[2022-05-12 17:43:20.416342] use_gpt2 ................... False
[2022-05-12 17:43:20.416346] val_data_pct ............... 0.0001
[2022-05-12 17:43:20.416351] val_metrics ................ ['accuracy']
[2022-05-12 17:43:20.416354] valid_epochs ............... 1
[2022-05-12 17:43:20.416359] variance_epsilon ........... 5e-06
[2022-05-12 17:43:20.416363] vocab_size ................. 30
[2022-05-12 17:43:20.416368] warmup_pct ................. 0.01
[2022-05-12 17:43:20.416371] weight_decay ............... 0.0
==================================================
[2022-05-12 17:43:20.416604] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
[2022-05-12 17:50:05.854894] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
[2022-05-12 17:59:41.600126] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-12 18:12:16.763740] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-12 18:12:16.766961] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-12 18:12:16.838230] batch_size ................. 4096
[2022-05-12 18:12:16.838247] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-12 18:12:16.838256] cuda ....................... True
[2022-05-12 18:12:16.838263] data_path .................. data/moocs/mooc.csv
[2022-05-12 18:12:16.838268] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 18:12:16.838275] device ..................... 7
[2022-05-12 18:12:16.838280] device_num ................. 0
[2022-05-12 18:12:16.838286] disable_tqdm ............... True
[2022-05-12 18:12:16.838292] do_test .................... False
[2022-05-12 18:12:16.838298] do_valid ................... True
[2022-05-12 18:12:16.838304] dont_print_args ............ True
[2022-05-12 18:12:16.838310] dont_shuffle ............... None
[2022-05-12 18:12:16.838322] dropout .................... 0.3
[2022-05-12 18:12:16.838329] estimate_type .............. <function beam_search_lower_bound at 0x7f90af1d4820>
[2022-05-12 18:12:16.838338] excluded_terms ............. [1]
[2022-05-12 18:12:16.838354] finetune ................... False
[2022-05-12 18:12:16.838360] grad_clip .................. 1.0
[2022-05-12 18:12:16.838366] hidden_size ................ 128
[2022-05-12 18:12:16.838371] hist_len ................... 18
[2022-05-12 18:12:16.838379] interp_func ................ <function lin_interp at 0x7f90af1d4700>
[2022-05-12 18:12:16.838384] log_interval ............... 100
[2022-05-12 18:12:16.838391] lr ......................... 0.001
[2022-05-12 18:12:16.838397] lr_decay_style ............. constant
[2022-05-12 18:12:16.838402] masked_lm .................. False
[2022-05-12 18:12:16.838408] max_num_mc_samples ......... 100000
[2022-05-12 18:12:16.838413] max_num_queries ............ 1500
[2022-05-12 18:12:16.838419] min_num_mc_samples ......... 10000
[2022-05-12 18:12:16.838424] min_phase_shift ............ 0
[2022-05-12 18:12:16.838432] min_var_reduction .......... 0.1
[2022-05-12 18:12:16.838437] min_variance ............... True
[2022-05-12 18:12:16.838443] model_budget_filepath ...... None
[2022-05-12 18:12:16.838449] needs_encoding ............. False
[2022-05-12 18:12:16.838455] num_beams .................. 0.0
[2022-05-12 18:12:16.838460] num_layers ................. 2
[2022-05-12 18:12:16.838466] num_mc_samples ............. 100
[2022-05-12 18:12:16.838472] num_workers ................ 0
[2022-05-12 18:12:16.838477] optimizer .................. adam
[2022-05-12 18:12:16.838483] proposal_func .............. <function lm_proposal at 0x7f90af1c1820>
[2022-05-12 18:12:16.838488] rnn_type ................... LSTM
[2022-05-12 18:12:16.838494] save_epochs ................ 1
[2022-05-12 18:12:16.838500] seed ....................... 42
[2022-05-12 18:12:16.838506] seq_len .................... 15
[2022-05-12 18:12:16.838512] shuffle .................... True
[2022-05-12 18:12:16.838517] store_intermediate_lbs ..... True
[2022-05-12 18:12:16.838523] sub_estimates .............. []
[2022-05-12 18:12:16.838529] text_dict .................. None
[2022-05-12 18:12:16.838534] top_k ...................... 0
[2022-05-12 18:12:16.838540] top_p ...................... 0
[2022-05-12 18:12:16.838546] total_seq_len .............. 20
[2022-05-12 18:12:16.838552] train_data_pct ............. 0.9
[2022-05-12 18:12:16.838557] train_epochs ............... 40
[2022-05-12 18:12:16.838563] use_gpt2 ................... False
[2022-05-12 18:12:16.838569] val_data_pct ............... 0.01
[2022-05-12 18:12:16.838575] val_metrics ................ ['accuracy']
[2022-05-12 18:12:16.838581] valid_epochs ............... 1
[2022-05-12 18:12:16.838589] variance_epsilon ........... 5e-06
[2022-05-12 18:12:16.838595] vocab_size ................. 98
[2022-05-12 18:12:16.838601] warmup_pct ................. 0.01
[2022-05-12 18:12:16.838606] weight_decay ............... 0.0
==================================================
[2022-05-12 18:12:16.839292] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
[2022-05-12 18:15:45.487516] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
[2022-05-12 18:20:15.326460] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

......................................................................................................................................................
==================================================
