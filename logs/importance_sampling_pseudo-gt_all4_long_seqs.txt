==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 14:07:05.174836] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 14:07:05.178101] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 14:07:05.181032] batch_size ................. 4096
[2022-05-12 14:07:05.181046] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 14:07:05.181056] cuda ....................... True
[2022-05-12 14:07:05.181062] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 14:07:05.181068] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:07:05.181074] device ..................... 7
[2022-05-12 14:07:05.181080] device_num ................. 0
[2022-05-12 14:07:05.181086] disable_tqdm ............... True
[2022-05-12 14:07:05.181091] do_test .................... False
[2022-05-12 14:07:05.181097] do_valid ................... True
[2022-05-12 14:07:05.181103] dont_print_args ............ True
[2022-05-12 14:07:05.181110] dont_shuffle ............... None
[2022-05-12 14:07:05.181123] dropout .................... 0.3
[2022-05-12 14:07:05.181130] estimate_type .............. <function beam_search_lower_bound at 0x7fe48fda8820>
[2022-05-12 14:07:05.181138] excluded_terms ............. [1]
[2022-05-12 14:07:05.181144] finetune ................... False
[2022-05-12 14:07:05.181151] grad_clip .................. 1.0
[2022-05-12 14:07:05.181156] hidden_size ................ 128
[2022-05-12 14:07:05.181162] hist_len ................... 18
[2022-05-12 14:07:05.181168] interp_func ................ <function lin_interp at 0x7fe48fda8700>
[2022-05-12 14:07:05.181174] log_interval ............... 100
[2022-05-12 14:07:05.181181] lr ......................... 0.001
[2022-05-12 14:07:05.181187] lr_decay_style ............. constant
[2022-05-12 14:07:05.181192] masked_lm .................. False
[2022-05-12 14:07:05.181198] max_num_mc_samples ......... 100000
[2022-05-12 14:07:05.181204] max_num_queries ............ None
[2022-05-12 14:07:05.181209] min_num_mc_samples ......... 10000
[2022-05-12 14:07:05.181215] min_phase_shift ............ 0
[2022-05-12 14:07:05.181221] min_var_reduction .......... 0.1
[2022-05-12 14:07:05.181227] min_variance ............... True
[2022-05-12 14:07:05.181232] model_budget_filepath ...... None
[2022-05-12 14:07:05.181239] num_beams .................. 0.0
[2022-05-12 14:07:05.181244] num_layers ................. 2
[2022-05-12 14:07:05.181249] num_mc_samples ............. 100
[2022-05-12 14:07:05.181255] num_workers ................ 0
[2022-05-12 14:07:05.181260] optimizer .................. adam
[2022-05-12 14:07:05.181267] proposal_func .............. <function lm_proposal at 0x7fe48fd95820>
[2022-05-12 14:07:05.181272] rnn_type ................... LSTM
[2022-05-12 14:07:05.181277] save_epochs ................ 1
[2022-05-12 14:07:05.181283] seed ....................... 42
[2022-05-12 14:07:05.181288] seq_len .................... 100
[2022-05-12 14:07:05.181294] shuffle .................... True
[2022-05-12 14:07:05.181300] store_intermediate_lbs ..... True
[2022-05-12 14:07:05.181306] sub_estimates .............. []
[2022-05-12 14:07:05.181311] text_dict .................. None
[2022-05-12 14:07:05.181317] top_k ...................... 0
[2022-05-12 14:07:05.181322] top_p ...................... 0
[2022-05-12 14:07:05.181328] total_seq_len .............. 20
[2022-05-12 14:07:05.181334] train_data_pct ............. 0.9
[2022-05-12 14:07:05.181340] train_epochs ............... 40
[2022-05-12 14:07:05.181345] use_gpt2 ................... False
[2022-05-12 14:07:05.181351] val_data_pct ............... 0.05
[2022-05-12 14:07:05.181358] val_metrics ................ ['accuracy']
[2022-05-12 14:07:05.181363] valid_epochs ............... 1
[2022-05-12 14:07:05.181371] variance_epsilon ........... 5e-06
[2022-05-12 14:07:05.181376] vocab_size ................. 68
[2022-05-12 14:07:05.181382] warmup_pct ................. 0.01
[2022-05-12 14:07:05.181388] weight_decay ............... 0.0
==================================================
[2022-05-12 14:07:05.181852] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
[2022-05-12 14:12:13.957632] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 12 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
[2022-05-12 14:19:12.066087] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 14:27:33.545759] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 14:27:33.555229] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 14:27:33.840511] batch_size ................. 4096
[2022-05-12 14:27:33.840537] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 14:27:33.840542] cuda ....................... True
[2022-05-12 14:27:33.840545] data_path .................. data/apps/lsapp.tsv
[2022-05-12 14:27:33.840547] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:27:33.840551] device ..................... 7
[2022-05-12 14:27:33.840553] device_num ................. 0
[2022-05-12 14:27:33.840556] disable_tqdm ............... True
[2022-05-12 14:27:33.840560] do_test .................... False
[2022-05-12 14:27:33.840562] do_valid ................... True
[2022-05-12 14:27:33.840565] dont_print_args ............ True
[2022-05-12 14:27:33.840569] dont_shuffle ............... None
[2022-05-12 14:27:33.840578] dropout .................... 0.3
[2022-05-12 14:27:33.840584] estimate_type .............. <function beam_search_lower_bound at 0x7fe48fda8820>
[2022-05-12 14:27:33.840589] excluded_terms ............. [1]
[2022-05-12 14:27:33.840593] finetune ................... False
[2022-05-12 14:27:33.840596] grad_clip .................. 1.0
[2022-05-12 14:27:33.840599] hidden_size ................ 512
[2022-05-12 14:27:33.840602] hist_len ................... 18
[2022-05-12 14:27:33.840605] interp_func ................ <function lin_interp at 0x7fe48fda8700>
[2022-05-12 14:27:33.840608] log_interval ............... 100
[2022-05-12 14:27:33.840611] lr ......................... 0.001
[2022-05-12 14:27:33.840614] lr_decay_style ............. constant
[2022-05-12 14:27:33.840620] masked_lm .................. False
[2022-05-12 14:27:33.840623] max_num_mc_samples ......... 100000
[2022-05-12 14:27:33.840626] max_num_queries ............ None
[2022-05-12 14:27:33.840628] min_num_mc_samples ......... 10000
[2022-05-12 14:27:33.840631] min_phase_shift ............ 0
[2022-05-12 14:27:33.840634] min_var_reduction .......... 0.1
[2022-05-12 14:27:33.840637] min_variance ............... True
[2022-05-12 14:27:33.840640] model_budget_filepath ...... None
[2022-05-12 14:27:33.840643] needs_encoding ............. True
[2022-05-12 14:27:33.840646] num_beams .................. 0.0
[2022-05-12 14:27:33.840649] num_layers ................. 2
[2022-05-12 14:27:33.840652] num_mc_samples ............. 100
[2022-05-12 14:27:33.840654] num_workers ................ 0
[2022-05-12 14:27:33.840657] optimizer .................. adam
[2022-05-12 14:27:33.840660] proposal_func .............. <function lm_proposal at 0x7fe48fd95820>
[2022-05-12 14:27:33.840662] rnn_type ................... LSTM
[2022-05-12 14:27:33.840665] save_epochs ................ 1
[2022-05-12 14:27:33.840667] seed ....................... 42
[2022-05-12 14:27:33.840670] seq_len .................... 15
[2022-05-12 14:27:33.840673] shuffle .................... True
[2022-05-12 14:27:33.840675] store_intermediate_lbs ..... True
[2022-05-12 14:27:33.840678] sub_estimates .............. []
[2022-05-12 14:27:33.840681] text_dict .................. None
[2022-05-12 14:27:33.840684] top_k ...................... 0
[2022-05-12 14:27:33.840686] top_p ...................... 0
[2022-05-12 14:27:33.840689] total_seq_len .............. 20
[2022-05-12 14:27:33.840692] train_data_pct ............. 0.9
[2022-05-12 14:27:33.840695] train_epochs ............... 40
[2022-05-12 14:27:33.840697] use_gpt2 ................... False
[2022-05-12 14:27:33.840700] val_data_pct ............... 0.001
[2022-05-12 14:27:33.840704] val_metrics ................ ['accuracy']
[2022-05-12 14:27:33.840706] valid_epochs ............... 1
[2022-05-12 14:27:33.840711] variance_epsilon ........... 5e-06
[2022-05-12 14:27:33.840714] vocab_size ................. 88
[2022-05-12 14:27:33.840717] warmup_pct ................. 0.01
[2022-05-12 14:27:33.840719] weight_decay ............... 0.0
==================================================
[2022-05-12 14:27:33.841003] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
[2022-05-12 14:46:01.851361] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
[2022-05-12 15:12:30.422056] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 15:48:50.327623] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 15:48:50.337751] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 15:48:50.490693] batch_size ................. 4096
[2022-05-12 15:48:50.490718] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 15:48:50.490723] cuda ....................... True
[2022-05-12 15:48:50.490727] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 15:48:50.490729] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 15:48:50.490733] device ..................... 7
[2022-05-12 15:48:50.490735] device_num ................. 0
[2022-05-12 15:48:50.490738] disable_tqdm ............... True
[2022-05-12 15:48:50.490741] do_test .................... False
[2022-05-12 15:48:50.490743] do_valid ................... True
[2022-05-12 15:48:50.490746] dont_print_args ............ True
[2022-05-12 15:48:50.490749] dont_shuffle ............... None
[2022-05-12 15:48:50.490757] dropout .................... 0.3
[2022-05-12 15:48:50.490763] estimate_type .............. <function beam_search_lower_bound at 0x7fe48fda8820>
[2022-05-12 15:48:50.490770] excluded_terms ............. [1]
[2022-05-12 15:48:50.490779] finetune ................... False
[2022-05-12 15:48:50.490782] grad_clip .................. 1.0
[2022-05-12 15:48:50.490785] hidden_size ................ 512
[2022-05-12 15:48:50.490787] hist_len ................... 18
[2022-05-12 15:48:50.490791] interp_func ................ <function lin_interp at 0x7fe48fda8700>
[2022-05-12 15:48:50.490793] log_interval ............... 100
[2022-05-12 15:48:50.490797] lr ......................... 0.001
[2022-05-12 15:48:50.490800] lr_decay_style ............. constant
[2022-05-12 15:48:50.490809] masked_lm .................. False
[2022-05-12 15:48:50.490812] max_num_mc_samples ......... 100000
[2022-05-12 15:48:50.490815] max_num_queries ............ None
[2022-05-12 15:48:50.490817] min_num_mc_samples ......... 10000
[2022-05-12 15:48:50.490820] min_phase_shift ............ 0
[2022-05-12 15:48:50.490823] min_var_reduction .......... 0.1
[2022-05-12 15:48:50.490826] min_variance ............... True
[2022-05-12 15:48:50.490828] model_budget_filepath ...... None
[2022-05-12 15:48:50.490831] num_beams .................. 0.0
[2022-05-12 15:48:50.490834] num_layers ................. 2
[2022-05-12 15:48:50.490836] num_mc_samples ............. 100
[2022-05-12 15:48:50.490840] num_workers ................ 0
[2022-05-12 15:48:50.490842] optimizer .................. adam
[2022-05-12 15:48:50.490845] proposal_func .............. <function lm_proposal at 0x7fe48fd95820>
[2022-05-12 15:48:50.490848] rnn_type ................... LSTM
[2022-05-12 15:48:50.490850] save_epochs ................ 1
[2022-05-12 15:48:50.490852] seed ....................... 42
[2022-05-12 15:48:50.490855] seq_len .................... 15
[2022-05-12 15:48:50.490857] shuffle .................... True
[2022-05-12 15:48:50.490860] store_intermediate_lbs ..... True
[2022-05-12 15:48:50.490863] sub_estimates .............. []
[2022-05-12 15:48:50.490865] text_dict .................. None
[2022-05-12 15:48:50.490868] top_k ...................... 0
[2022-05-12 15:48:50.490870] top_p ...................... 0
[2022-05-12 15:48:50.490873] total_seq_len .............. 20
[2022-05-12 15:48:50.490876] train_data_pct ............. 0.9
[2022-05-12 15:48:50.490879] train_epochs ............... 40
[2022-05-12 15:48:50.490881] use_gpt2 ................... False
[2022-05-12 15:48:50.490884] val_data_pct ............... 0.0001
[2022-05-12 15:48:50.490887] val_metrics ................ ['accuracy']
[2022-05-12 15:48:50.490890] valid_epochs ............... 1
[2022-05-12 15:48:50.490894] variance_epsilon ........... 5e-06
[2022-05-12 15:48:50.490896] vocab_size ................. 30
[2022-05-12 15:48:50.490900] warmup_pct ................. 0.01
[2022-05-12 15:48:50.490902] weight_decay ............... 0.0
==================================================
[2022-05-12 15:48:50.491082] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........