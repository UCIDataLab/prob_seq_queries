==================================================
* Running for dataset shakespeare
==================================================
[2022-05-10 22:56:25.606948] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-10 22:56:25.610535] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-10 22:56:25.612259] batch_size ................. 4096
[2022-05-10 22:56:25.612269] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-10 22:56:25.612273] cuda ....................... True
[2022-05-10 22:56:25.612276] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-10 22:56:25.612279] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 22:56:25.612282] device ..................... 1
[2022-05-10 22:56:25.612285] device_num ................. 0
[2022-05-10 22:56:25.612288] disable_tqdm ............... True
[2022-05-10 22:56:25.612290] do_test .................... False
[2022-05-10 22:56:25.612293] do_valid ................... True
[2022-05-10 22:56:25.612296] dont_print_args ............ True
[2022-05-10 22:56:25.612303] dont_shuffle ............... None
[2022-05-10 22:56:25.612310] dropout .................... 0.3
[2022-05-10 22:56:25.612314] estimate_type .............. <function beam_search_lower_bound at 0x7fd351b52ee0>
[2022-05-10 22:56:25.612319] excluded_terms ............. [1]
[2022-05-10 22:56:25.612323] finetune ................... False
[2022-05-10 22:56:25.612326] grad_clip .................. 1.0
[2022-05-10 22:56:25.612329] hidden_size ................ 128
[2022-05-10 22:56:25.612331] hist_len ................... 18
[2022-05-10 22:56:25.612335] interp_func ................ <function lin_interp at 0x7fd351b52dc0>
[2022-05-10 22:56:25.612337] log_interval ............... 100
[2022-05-10 22:56:25.612341] lr ......................... 0.001
[2022-05-10 22:56:25.612343] lr_decay_style ............. constant
[2022-05-10 22:56:25.612346] masked_lm .................. False
[2022-05-10 22:56:25.612348] min_phase_shift ............ 0
[2022-05-10 22:56:25.612351] min_var_reduction .......... 0.1
[2022-05-10 22:56:25.612354] min_variance ............... True
[2022-05-10 22:56:25.612357] model_budget_filepath ...... None
[2022-05-10 22:56:25.612360] num_beams .................. 0.0
[2022-05-10 22:56:25.612362] num_layers ................. 2
[2022-05-10 22:56:25.612365] num_mc_samples ............. 100
[2022-05-10 22:56:25.612367] num_workers ................ 0
[2022-05-10 22:56:25.612370] optimizer .................. adam
[2022-05-10 22:56:25.612373] proposal_func .............. <function lm_proposal at 0x7fd351b4edc0>
[2022-05-10 22:56:25.612375] rnn_type ................... LSTM
[2022-05-10 22:56:25.612378] save_epochs ................ 1
[2022-05-10 22:56:25.612380] seed ....................... 42
[2022-05-10 22:56:25.612383] seq_len .................... 100
[2022-05-10 22:56:25.612385] shuffle .................... True
[2022-05-10 22:56:25.612388] store_intermediate_lbs ..... True
[2022-05-10 22:56:25.612391] sub_estimates .............. []
[2022-05-10 22:56:25.612394] text_dict .................. None
[2022-05-10 22:56:25.612396] top_k ...................... 0
[2022-05-10 22:56:25.612399] top_p ...................... 0
[2022-05-10 22:56:25.612402] total_seq_len .............. 20
[2022-05-10 22:56:25.612404] train_data_pct ............. 0.9
[2022-05-10 22:56:25.612407] train_epochs ............... 40
[2022-05-10 22:56:25.612410] val_data_pct ............... 0.05
[2022-05-10 22:56:25.612418] val_metrics ................ ['accuracy']
[2022-05-10 22:56:25.612421] valid_epochs ............... 1
[2022-05-10 22:56:25.612423] vocab_size ................. 68
[2022-05-10 22:56:25.612426] warmup_pct ................. 0.01
[2022-05-10 22:56:25.612428] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_18h_20s_1000mc.pkl
[2022-05-10 22:56:25.613209] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_17h_20s_1000mc.pkl
[2022-05-10 22:56:39.402669] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-10 22:57:54.397142] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-10 22:57:54.408351] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-10 22:57:54.607460] batch_size ................. 4096
[2022-05-10 22:57:54.607486] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-10 22:57:54.607492] cuda ....................... True
[2022-05-10 22:57:54.607495] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-10 22:57:54.607498] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 22:57:54.607501] device ..................... 1
[2022-05-10 22:57:54.607503] device_num ................. 0
[2022-05-10 22:57:54.607506] disable_tqdm ............... True
[2022-05-10 22:57:54.607510] do_test .................... False
[2022-05-10 22:57:54.607512] do_valid ................... True
[2022-05-10 22:57:54.607515] dont_print_args ............ True
[2022-05-10 22:57:54.607521] dont_shuffle ............... None
[2022-05-10 22:57:54.607530] dropout .................... 0.3
[2022-05-10 22:57:54.607536] estimate_type .............. <function beam_search_lower_bound at 0x7fd351b52ee0>
[2022-05-10 22:57:54.607541] excluded_terms ............. [1]
[2022-05-10 22:57:54.607545] finetune ................... False
[2022-05-10 22:57:54.607549] grad_clip .................. 1.0
[2022-05-10 22:57:54.607552] hidden_size ................ 512
[2022-05-10 22:57:54.607554] hist_len ................... 18
[2022-05-10 22:57:54.607558] interp_func ................ <function lin_interp at 0x7fd351b52dc0>
[2022-05-10 22:57:54.607560] log_interval ............... 100
[2022-05-10 22:57:54.607570] lr ......................... 0.001
[2022-05-10 22:57:54.607573] lr_decay_style ............. constant
[2022-05-10 22:57:54.607576] masked_lm .................. False
[2022-05-10 22:57:54.607578] min_phase_shift ............ 0
[2022-05-10 22:57:54.607581] min_var_reduction .......... 0.1
[2022-05-10 22:57:54.607601] min_variance ............... True
[2022-05-10 22:57:54.607604] model_budget_filepath ...... None
[2022-05-10 22:57:54.607607] num_beams .................. 0.0
[2022-05-10 22:57:54.607610] num_layers ................. 2
[2022-05-10 22:57:54.607612] num_mc_samples ............. 100
[2022-05-10 22:57:54.607615] num_workers ................ 0
[2022-05-10 22:57:54.607617] optimizer .................. adam
[2022-05-10 22:57:54.607620] proposal_func .............. <function lm_proposal at 0x7fd351b4edc0>
[2022-05-10 22:57:54.607623] rnn_type ................... LSTM
[2022-05-10 22:57:54.607625] save_epochs ................ 1
[2022-05-10 22:57:54.607628] seed ....................... 42
[2022-05-10 22:57:54.607631] seq_len .................... 15
[2022-05-10 22:57:54.607633] shuffle .................... True
[2022-05-10 22:57:54.607636] store_intermediate_lbs ..... True
[2022-05-10 22:57:54.607639] sub_estimates .............. []
[2022-05-10 22:57:54.607642] text_dict .................. None
[2022-05-10 22:57:54.607644] top_k ...................... 0
[2022-05-10 22:57:54.607647] top_p ...................... 0
[2022-05-10 22:57:54.607649] total_seq_len .............. 20
[2022-05-10 22:57:54.607652] train_data_pct ............. 0.9
[2022-05-10 22:57:54.607655] train_epochs ............... 40
[2022-05-10 22:57:54.607658] val_data_pct ............... 0.0001
[2022-05-10 22:57:54.607662] val_metrics ................ ['accuracy']
[2022-05-10 22:57:54.607665] valid_epochs ............... 1
[2022-05-10 22:57:54.607668] vocab_size ................. 30
[2022-05-10 22:57:54.607670] warmup_pct ................. 0.01
[2022-05-10 22:57:54.607673] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_13h_15s_1000mc.pkl
[2022-05-10 22:57:54.608764] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_12h_15s_1000mc.pkl
[2022-05-10 22:58:38.104780] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc.pkl
[2022-05-10 23:00:07.509109] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-10 23:02:30.735911] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-10 23:02:30.744047] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-10 23:02:31.150784] batch_size ................. 4096
[2022-05-10 23:02:31.150809] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-10 23:02:31.150815] cuda ....................... True
[2022-05-10 23:02:31.150818] data_path .................. data/apps/lsapp.tsv
[2022-05-10 23:02:31.150821] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 23:02:31.150825] device ..................... 1
[2022-05-10 23:02:31.150827] device_num ................. 0
[2022-05-10 23:02:31.150830] disable_tqdm ............... True
[2022-05-10 23:02:31.150833] do_test .................... False
[2022-05-10 23:02:31.150836] do_valid ................... True
[2022-05-10 23:02:31.150838] dont_print_args ............ True
[2022-05-10 23:02:31.150842] dont_shuffle ............... None
[2022-05-10 23:02:31.150850] dropout .................... 0.3
[2022-05-10 23:02:31.150856] estimate_type .............. <function beam_search_lower_bound at 0x7fd351b52ee0>
[2022-05-10 23:02:31.150861] excluded_terms ............. [1]
[2022-05-10 23:02:31.150865] finetune ................... False
[2022-05-10 23:02:31.150869] grad_clip .................. 1.0
[2022-05-10 23:02:31.150871] hidden_size ................ 512
[2022-05-10 23:02:31.150874] hist_len ................... 18
[2022-05-10 23:02:31.150878] interp_func ................ <function lin_interp at 0x7fd351b52dc0>
[2022-05-10 23:02:31.150880] log_interval ............... 100
[2022-05-10 23:02:31.150884] lr ......................... 0.001
[2022-05-10 23:02:31.150887] lr_decay_style ............. constant
[2022-05-10 23:02:31.150895] masked_lm .................. False
[2022-05-10 23:02:31.150898] min_phase_shift ............ 0
[2022-05-10 23:02:31.150901] min_var_reduction .......... 0.1
[2022-05-10 23:02:31.150904] min_variance ............... True
[2022-05-10 23:02:31.150907] model_budget_filepath ...... None
[2022-05-10 23:02:31.150910] needs_encoding ............. True
[2022-05-10 23:02:31.150913] num_beams .................. 0.0
[2022-05-10 23:02:31.150916] num_layers ................. 2
[2022-05-10 23:02:31.150918] num_mc_samples ............. 100
[2022-05-10 23:02:31.150921] num_workers ................ 0
[2022-05-10 23:02:31.150923] optimizer .................. adam
[2022-05-10 23:02:31.150927] proposal_func .............. <function lm_proposal at 0x7fd351b4edc0>
[2022-05-10 23:02:31.150930] rnn_type ................... LSTM
[2022-05-10 23:02:31.150933] save_epochs ................ 1
[2022-05-10 23:02:31.150935] seed ....................... 42
[2022-05-10 23:02:31.150938] seq_len .................... 15
[2022-05-10 23:02:31.150940] shuffle .................... True
[2022-05-10 23:02:31.150943] store_intermediate_lbs ..... True
[2022-05-10 23:02:31.150946] sub_estimates .............. []
[2022-05-10 23:02:31.150949] text_dict .................. None
[2022-05-10 23:02:31.150952] top_k ...................... 0
[2022-05-10 23:02:31.150954] top_p ...................... 0
[2022-05-10 23:02:31.150956] total_seq_len .............. 20
[2022-05-10 23:02:31.150959] train_data_pct ............. 0.9
[2022-05-10 23:02:31.150962] train_epochs ............... 40
[2022-05-10 23:02:31.150966] val_data_pct ............... 0.001
[2022-05-10 23:02:31.150970] val_metrics ................ ['accuracy']
[2022-05-10 23:02:31.150972] valid_epochs ............... 1
[2022-05-10 23:02:31.150975] vocab_size ................. 88
[2022-05-10 23:02:31.150977] warmup_pct ................. 0.01
[2022-05-10 23:02:31.150980] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_13h_15s_1000mc.pkl
[2022-05-10 23:02:31.152284] | Dataset: apps | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_12h_15s_1000mc.pkl
[2022-05-10 23:03:12.536157] | Dataset: apps | Sample type: beam_search | Num Beams: 0.98 | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-10 23:04:17.122479] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-10 23:04:17.126478] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-10 23:04:17.197066] batch_size ................. 4096
[2022-05-10 23:04:17.197089] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-10 23:04:17.197101] cuda ....................... True
[2022-05-10 23:04:17.197109] data_path .................. data/moocs/mooc.csv
[2022-05-10 23:04:17.197118] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 23:04:17.197126] device ..................... 1
[2022-05-10 23:04:17.197135] device_num ................. 0
[2022-05-10 23:04:17.197143] disable_tqdm ............... True
[2022-05-10 23:04:17.197153] do_test .................... False
[2022-05-10 23:04:17.197161] do_valid ................... True
[2022-05-10 23:04:17.197169] dont_print_args ............ True
[2022-05-10 23:04:17.197179] dont_shuffle ............... None
[2022-05-10 23:04:17.197193] dropout .................... 0.3
[2022-05-10 23:04:17.197205] estimate_type .............. <function beam_search_lower_bound at 0x7fd351b52ee0>
[2022-05-10 23:04:17.197215] excluded_terms ............. [1]
[2022-05-10 23:04:17.197237] finetune ................... False
[2022-05-10 23:04:17.197247] grad_clip .................. 1.0
[2022-05-10 23:04:17.197255] hidden_size ................ 128
[2022-05-10 23:04:17.197263] hist_len ................... 18
[2022-05-10 23:04:17.197274] interp_func ................ <function lin_interp at 0x7fd351b52dc0>
[2022-05-10 23:04:17.197282] log_interval ............... 100
[2022-05-10 23:04:17.197292] lr ......................... 0.001
[2022-05-10 23:04:17.197300] lr_decay_style ............. constant
[2022-05-10 23:04:17.197313] masked_lm .................. False
[2022-05-10 23:04:17.197321] min_phase_shift ............ 0
[2022-05-10 23:04:17.197330] min_var_reduction .......... 0.1
[2022-05-10 23:04:17.197339] min_variance ............... True
[2022-05-10 23:04:17.197348] model_budget_filepath ...... None
[2022-05-10 23:04:17.197357] needs_encoding ............. False
[2022-05-10 23:04:17.197366] num_beams .................. 0.0
[2022-05-10 23:04:17.197374] num_layers ................. 2
[2022-05-10 23:04:17.197382] num_mc_samples ............. 100
[2022-05-10 23:04:17.197390] num_workers ................ 0
[2022-05-10 23:04:17.197398] optimizer .................. adam
[2022-05-10 23:04:17.197408] proposal_func .............. <function lm_proposal at 0x7fd351b4edc0>
[2022-05-10 23:04:17.197416] rnn_type ................... LSTM
[2022-05-10 23:04:17.197424] save_epochs ................ 1
[2022-05-10 23:04:17.197434] seed ....................... 42
[2022-05-10 23:04:17.197442] seq_len .................... 15
[2022-05-10 23:04:17.197451] shuffle .................... True
[2022-05-10 23:04:17.197459] store_intermediate_lbs ..... True
[2022-05-10 23:04:17.197469] sub_estimates .............. []
[2022-05-10 23:04:17.197478] text_dict .................. None
[2022-05-10 23:04:17.197485] top_k ...................... 0
[2022-05-10 23:04:17.197494] top_p ...................... 0
[2022-05-10 23:04:17.197502] total_seq_len .............. 20
[2022-05-10 23:04:17.197510] train_data_pct ............. 0.9
[2022-05-10 23:04:17.197519] train_epochs ............... 40
[2022-05-10 23:04:17.197529] val_data_pct ............... 0.01
[2022-05-10 23:04:17.197539] val_metrics ................ ['accuracy']
[2022-05-10 23:04:17.197547] valid_epochs ............... 1
[2022-05-10 23:04:17.197555] vocab_size ................. 98
[2022-05-10 23:04:17.197564] warmup_pct ................. 0.01
[2022-05-10 23:04:17.197573] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_13h_15s_1000mc.pkl
[2022-05-10 23:04:17.199400] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_12h_15s_1000mc.pkl
[2022-05-10 23:04:37.941793] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.98 | Hist length 12 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................................................................
==================================================
