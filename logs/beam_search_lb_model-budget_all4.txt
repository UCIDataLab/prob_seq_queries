==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 07:51:29.540825] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 07:51:29.548421] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 07:51:29.551552] batch_size ................. 4096
[2022-05-16 07:51:29.551574] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 07:51:29.551586] cuda ....................... True
[2022-05-16 07:51:29.551592] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 07:51:29.551598] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:51:29.551604] device ..................... 6
[2022-05-16 07:51:29.551610] device_num ................. 0
[2022-05-16 07:51:29.551616] disable_tqdm ............... True
[2022-05-16 07:51:29.551621] do_test .................... False
[2022-05-16 07:51:29.551627] do_valid ................... True
[2022-05-16 07:51:29.551633] dont_print_args ............ True
[2022-05-16 07:51:29.551639] dont_shuffle ............... None
[2022-05-16 07:51:29.551650] dropout .................... 0.3
[2022-05-16 07:51:29.551659] estimate_type .............. <function beam_search_lower_bound at 0x7fb561957e50>
[2022-05-16 07:51:29.551666] excluded_terms ............. [1]
[2022-05-16 07:51:29.551673] excluded_terms_list ........ [[]]
[2022-05-16 07:51:29.551679] finetune ................... False
[2022-05-16 07:51:29.551685] grad_clip .................. 1.0
[2022-05-16 07:51:29.551691] hidden_size ................ 128
[2022-05-16 07:51:29.551697] hist_len ................... 18
[2022-05-16 07:51:29.551702] hybrid_max_num_beams ....... 1500
[2022-05-16 07:51:29.551709] interp_func ................ <function lin_interp at 0x7fb561957d30>
[2022-05-16 07:51:29.551715] k_range .................... []
[2022-05-16 07:51:29.551720] log_interval ............... 100
[2022-05-16 07:51:29.551727] lr ......................... 0.001
[2022-05-16 07:51:29.551733] lr_decay_style ............. constant
[2022-05-16 07:51:29.551738] masked_lm .................. False
[2022-05-16 07:51:29.551744] max_num_mc_samples ......... 100000
[2022-05-16 07:51:29.551750] max_num_queries ............ 1000
[2022-05-16 07:51:29.551755] min_num_mc_samples ......... 10000
[2022-05-16 07:51:29.551761] min_phase_shift ............ 0
[2022-05-16 07:51:29.551767] min_var_reduction .......... 0.1
[2022-05-16 07:51:29.551772] min_variance ............... True
[2022-05-16 07:51:29.551778] model_budget_filepath ...... None
[2022-05-16 07:51:29.551784] num_beams .................. 0.0
[2022-05-16 07:51:29.551789] num_layers ................. 2
[2022-05-16 07:51:29.551795] num_mc_samples ............. 100
[2022-05-16 07:51:29.551800] num_workers ................ 0
[2022-05-16 07:51:29.551806] optimizer .................. adam
[2022-05-16 07:51:29.551812] proposal_func .............. <function lm_proposal at 0x7fb561944ca0>
[2022-05-16 07:51:29.551818] rnn_type ................... LSTM
[2022-05-16 07:51:29.551824] save_epochs ................ 1
[2022-05-16 07:51:29.551829] seed ....................... 42
[2022-05-16 07:51:29.551834] seq_len .................... 100
[2022-05-16 07:51:29.551840] shuffle .................... True
[2022-05-16 07:51:29.551846] store_intermediate_lbs ..... True
[2022-05-16 07:51:29.551851] sub_estimates .............. []
[2022-05-16 07:51:29.551857] terms_of_interest .......... []
[2022-05-16 07:51:29.551863] text_dict .................. None
[2022-05-16 07:51:29.551868] top_k ...................... 0
[2022-05-16 07:51:29.551873] top_p ...................... 0
[2022-05-16 07:51:29.551879] total_seq_len .............. 20
[2022-05-16 07:51:29.551885] train_data_pct ............. 0.9
[2022-05-16 07:51:29.551890] train_epochs ............... 40
[2022-05-16 07:51:29.551896] use_gpt2 ................... False
[2022-05-16 07:51:29.551902] val_data_pct ............... 0.05
[2022-05-16 07:51:29.551908] val_metrics ................ ['accuracy']
[2022-05-16 07:51:29.551914] valid_epochs ............... 1
[2022-05-16 07:51:29.551922] variance_epsilon ........... 5e-06
[2022-05-16 07:51:29.551928] vocab_size ................. 68
[2022-05-16 07:51:29.551934] warmup_pct ................. 0.01
[2022-05-16 07:51:29.551939] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc_1000q.pkl
[2022-05-16 07:51:29.552469] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 15 | Total Seq Length 20

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_13h_20s_1000mc_1000q.pkl
[2022-05-16 07:52:18.142570] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 13 | Total Seq Length 20

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_11h_20s_1000mc_1000q.pkl
[2022-05-16 07:53:19.521191] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 11 | Total Seq Length 20

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-16 07:54:47.432060] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-16 07:54:47.435402] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-16 07:54:47.511590] batch_size ................. 4096
[2022-05-16 07:54:47.511613] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-16 07:54:47.511622] cuda ....................... True
[2022-05-16 07:54:47.511628] data_path .................. data/moocs/mooc.csv
[2022-05-16 07:54:47.511633] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:54:47.511640] device ..................... 6
[2022-05-16 07:54:47.511645] device_num ................. 0
[2022-05-16 07:54:47.511651] disable_tqdm ............... True
[2022-05-16 07:54:47.511657] do_test .................... False
[2022-05-16 07:54:47.511663] do_valid ................... True
[2022-05-16 07:54:47.511668] dont_print_args ............ True
[2022-05-16 07:54:47.511675] dont_shuffle ............... None
[2022-05-16 07:54:47.511686] dropout .................... 0.3
[2022-05-16 07:54:47.511695] estimate_type .............. <function beam_search_lower_bound at 0x7fb561957e50>
[2022-05-16 07:54:47.511703] excluded_terms ............. [1]
[2022-05-16 07:54:47.511718] excluded_terms_list ........ [[]]
[2022-05-16 07:54:47.511724] finetune ................... False
[2022-05-16 07:54:47.511730] grad_clip .................. 1.0
[2022-05-16 07:54:47.511736] hidden_size ................ 128
[2022-05-16 07:54:47.511742] hist_len ................... 18
[2022-05-16 07:54:47.511748] hybrid_max_num_beams ....... 1500
[2022-05-16 07:54:47.511754] interp_func ................ <function lin_interp at 0x7fb561957d30>
[2022-05-16 07:54:47.511760] k_range .................... []
[2022-05-16 07:54:47.511768] log_interval ............... 100
[2022-05-16 07:54:47.511775] lr ......................... 0.001
[2022-05-16 07:54:47.511781] lr_decay_style ............. constant
[2022-05-16 07:54:47.511787] masked_lm .................. False
[2022-05-16 07:54:47.511792] max_num_mc_samples ......... 100000
[2022-05-16 07:54:47.511798] max_num_queries ............ 1000
[2022-05-16 07:54:47.511804] min_num_mc_samples ......... 10000
[2022-05-16 07:54:47.511809] min_phase_shift ............ 0
[2022-05-16 07:54:47.511815] min_var_reduction .......... 0.1
[2022-05-16 07:54:47.511821] min_variance ............... True
[2022-05-16 07:54:47.511826] model_budget_filepath ...... None
[2022-05-16 07:54:47.511833] needs_encoding ............. False
[2022-05-16 07:54:47.511839] num_beams .................. 0.0
[2022-05-16 07:54:47.511844] num_layers ................. 2
[2022-05-16 07:54:47.511850] num_mc_samples ............. 100
[2022-05-16 07:54:47.511855] num_workers ................ 0
[2022-05-16 07:54:47.511860] optimizer .................. adam
[2022-05-16 07:54:47.511866] proposal_func .............. <function lm_proposal at 0x7fb561944ca0>
[2022-05-16 07:54:47.511873] rnn_type ................... LSTM
[2022-05-16 07:54:47.511878] save_epochs ................ 1
[2022-05-16 07:54:47.511884] seed ....................... 42
[2022-05-16 07:54:47.511889] seq_len .................... 15
[2022-05-16 07:54:47.511895] shuffle .................... True
[2022-05-16 07:54:47.511900] store_intermediate_lbs ..... True
[2022-05-16 07:54:47.511906] sub_estimates .............. []
[2022-05-16 07:54:47.511912] terms_of_interest .......... []
[2022-05-16 07:54:47.511918] text_dict .................. None
[2022-05-16 07:54:47.511923] top_k ...................... 0
[2022-05-16 07:54:47.511929] top_p ...................... 0
[2022-05-16 07:54:47.511934] total_seq_len .............. 20
[2022-05-16 07:54:47.511940] train_data_pct ............. 0.9
[2022-05-16 07:54:47.511945] train_epochs ............... 40
[2022-05-16 07:54:47.511951] use_gpt2 ................... False
[2022-05-16 07:54:47.511958] val_data_pct ............... 0.01
[2022-05-16 07:54:47.511964] val_metrics ................ ['accuracy']
[2022-05-16 07:54:47.511970] valid_epochs ............... 1
[2022-05-16 07:54:47.511978] variance_epsilon ........... 5e-06
[2022-05-16 07:54:47.511983] vocab_size ................. 98
[2022-05-16 07:54:47.511989] warmup_pct ................. 0.01
[2022-05-16 07:54:47.511995] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_10h_15s_1000mc_1000q.pkl
[2022-05-16 07:54:47.514084] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 10 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_7h_15s_1000mc_1000q.pkl
[2022-05-16 07:55:17.953730] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 7 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_6h_15s_1000mc_1000q.pkl
[2022-05-16 07:56:17.698683] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.8 | Hist length 6 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-16 07:58:24.136159] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-16 07:58:24.146925] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-16 07:58:24.565872] batch_size ................. 4096
[2022-05-16 07:58:24.565901] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-16 07:58:24.565914] cuda ....................... True
[2022-05-16 07:58:24.565920] data_path .................. data/apps/lsapp.tsv
[2022-05-16 07:58:24.565925] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 07:58:24.565932] device ..................... 6
[2022-05-16 07:58:24.565937] device_num ................. 0
[2022-05-16 07:58:24.565943] disable_tqdm ............... True
[2022-05-16 07:58:24.565950] do_test .................... False
[2022-05-16 07:58:24.565955] do_valid ................... True
[2022-05-16 07:58:24.565961] dont_print_args ............ True
[2022-05-16 07:58:24.565969] dont_shuffle ............... None
[2022-05-16 07:58:24.565982] dropout .................... 0.3
[2022-05-16 07:58:24.565990] estimate_type .............. <function beam_search_lower_bound at 0x7fb561957e50>
[2022-05-16 07:58:24.565998] excluded_terms ............. [1]
[2022-05-16 07:58:24.566023] excluded_terms_list ........ [[]]
[2022-05-16 07:58:24.566029] finetune ................... False
[2022-05-16 07:58:24.566035] grad_clip .................. 1.0
[2022-05-16 07:58:24.566041] hidden_size ................ 512
[2022-05-16 07:58:24.566047] hist_len ................... 18
[2022-05-16 07:58:24.566053] hybrid_max_num_beams ....... 1500
[2022-05-16 07:58:24.566060] interp_func ................ <function lin_interp at 0x7fb561957d30>
[2022-05-16 07:58:24.566065] k_range .................... []
[2022-05-16 07:58:24.566078] log_interval ............... 100
[2022-05-16 07:58:24.566085] lr ......................... 0.001
[2022-05-16 07:58:24.566090] lr_decay_style ............. constant
[2022-05-16 07:58:24.566096] masked_lm .................. False
[2022-05-16 07:58:24.566101] max_num_mc_samples ......... 100000
[2022-05-16 07:58:24.566108] max_num_queries ............ 1000
[2022-05-16 07:58:24.566114] min_num_mc_samples ......... 10000
[2022-05-16 07:58:24.566119] min_phase_shift ............ 0
[2022-05-16 07:58:24.566125] min_var_reduction .......... 0.1
[2022-05-16 07:58:24.566131] min_variance ............... True
[2022-05-16 07:58:24.566137] model_budget_filepath ...... None
[2022-05-16 07:58:24.566143] needs_encoding ............. True
[2022-05-16 07:58:24.566149] num_beams .................. 0.0
[2022-05-16 07:58:24.566155] num_layers ................. 2
[2022-05-16 07:58:24.566160] num_mc_samples ............. 100
[2022-05-16 07:58:24.566166] num_workers ................ 0
[2022-05-16 07:58:24.566171] optimizer .................. adam
[2022-05-16 07:58:24.566177] proposal_func .............. <function lm_proposal at 0x7fb561944ca0>
[2022-05-16 07:58:24.566183] rnn_type ................... LSTM
[2022-05-16 07:58:24.566189] save_epochs ................ 1
[2022-05-16 07:58:24.566194] seed ....................... 42
[2022-05-16 07:58:24.566200] seq_len .................... 15
[2022-05-16 07:58:24.566205] shuffle .................... True
[2022-05-16 07:58:24.566211] store_intermediate_lbs ..... True
[2022-05-16 07:58:24.566217] sub_estimates .............. []
[2022-05-16 07:58:24.566223] terms_of_interest .......... []
[2022-05-16 07:58:24.566229] text_dict .................. None
[2022-05-16 07:58:24.566234] top_k ...................... 0
[2022-05-16 07:58:24.566240] top_p ...................... 0
[2022-05-16 07:58:24.566245] total_seq_len .............. 20
[2022-05-16 07:58:24.566251] train_data_pct ............. 0.9
[2022-05-16 07:58:24.566256] train_epochs ............... 40
[2022-05-16 07:58:24.566262] use_gpt2 ................... False
[2022-05-16 07:58:24.566269] val_data_pct ............... 0.001
[2022-05-16 07:58:24.566276] val_metrics ................ ['accuracy']
[2022-05-16 07:58:24.566281] valid_epochs ............... 1
[2022-05-16 07:58:24.566290] variance_epsilon ........... 5e-06
[2022-05-16 07:58:24.566296] vocab_size ................. 88
[2022-05-16 07:58:24.566302] warmup_pct ................. 0.01
[2022-05-16 07:58:24.566307] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_10h_15s_1000mc_1000q.pkl
[2022-05-16 07:58:24.567254] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 10 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_7h_15s_1000mc_1000q.pkl
[2022-05-16 07:59:24.964314] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 7 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_6h_15s_1000mc_1000q.pkl
[2022-05-16 08:00:20.886320] | Dataset: apps | Sample type: beam_search | Num Beams: 0.8 | Hist length 6 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-16 08:03:18.205368] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-16 08:03:18.216206] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-16 08:03:18.396322] batch_size ................. 4096
[2022-05-16 08:03:18.396347] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-16 08:03:18.396354] cuda ....................... True
[2022-05-16 08:03:18.396359] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-16 08:03:18.396364] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 08:03:18.396371] device ..................... 6
[2022-05-16 08:03:18.396376] device_num ................. 0
[2022-05-16 08:03:18.396381] disable_tqdm ............... True
[2022-05-16 08:03:18.396386] do_test .................... False
[2022-05-16 08:03:18.396390] do_valid ................... True
[2022-05-16 08:03:18.396395] dont_print_args ............ True
[2022-05-16 08:03:18.396400] dont_shuffle ............... None
[2022-05-16 08:03:18.396409] dropout .................... 0.3
[2022-05-16 08:03:18.396416] estimate_type .............. <function beam_search_lower_bound at 0x7fb561957e50>
[2022-05-16 08:03:18.396423] excluded_terms ............. [1]
[2022-05-16 08:03:18.396445] excluded_terms_list ........ [[]]
[2022-05-16 08:03:18.396449] finetune ................... False
[2022-05-16 08:03:18.396455] grad_clip .................. 1.0
[2022-05-16 08:03:18.396459] hidden_size ................ 512
[2022-05-16 08:03:18.396465] hist_len ................... 18
[2022-05-16 08:03:18.396469] hybrid_max_num_beams ....... 1500
[2022-05-16 08:03:18.396474] interp_func ................ <function lin_interp at 0x7fb561957d30>
[2022-05-16 08:03:18.396479] k_range .................... []
[2022-05-16 08:03:18.396500] log_interval ............... 100
[2022-05-16 08:03:18.396505] lr ......................... 0.001
[2022-05-16 08:03:18.396510] lr_decay_style ............. constant
[2022-05-16 08:03:18.396515] masked_lm .................. False
[2022-05-16 08:03:18.396519] max_num_mc_samples ......... 100000
[2022-05-16 08:03:18.396524] max_num_queries ............ 1000
[2022-05-16 08:03:18.396529] min_num_mc_samples ......... 10000
[2022-05-16 08:03:18.396533] min_phase_shift ............ 0
[2022-05-16 08:03:18.396539] min_var_reduction .......... 0.1
[2022-05-16 08:03:18.396543] min_variance ............... True
[2022-05-16 08:03:18.396548] model_budget_filepath ...... None
[2022-05-16 08:03:18.396554] num_beams .................. 0.0
[2022-05-16 08:03:18.396559] num_layers ................. 2
[2022-05-16 08:03:18.396563] num_mc_samples ............. 100
[2022-05-16 08:03:18.396568] num_workers ................ 0
[2022-05-16 08:03:18.396572] optimizer .................. adam
[2022-05-16 08:03:18.396577] proposal_func .............. <function lm_proposal at 0x7fb561944ca0>
[2022-05-16 08:03:18.396581] rnn_type ................... LSTM
[2022-05-16 08:03:18.396586] save_epochs ................ 1
[2022-05-16 08:03:18.396591] seed ....................... 42
[2022-05-16 08:03:18.396595] seq_len .................... 15
[2022-05-16 08:03:18.396600] shuffle .................... True
[2022-05-16 08:03:18.396604] store_intermediate_lbs ..... True
[2022-05-16 08:03:18.396609] sub_estimates .............. []
[2022-05-16 08:03:18.396613] terms_of_interest .......... []
[2022-05-16 08:03:18.396620] text_dict .................. None
[2022-05-16 08:03:18.396625] top_k ...................... 0
[2022-05-16 08:03:18.396629] top_p ...................... 0
[2022-05-16 08:03:18.396634] total_seq_len .............. 20
[2022-05-16 08:03:18.396638] train_data_pct ............. 0.9
[2022-05-16 08:03:18.396643] train_epochs ............... 40
[2022-05-16 08:03:18.396647] use_gpt2 ................... False
[2022-05-16 08:03:18.396652] val_data_pct ............... 0.0001
[2022-05-16 08:03:18.396659] val_metrics ................ ['accuracy']
[2022-05-16 08:03:18.396663] valid_epochs ............... 1
[2022-05-16 08:03:18.396670] variance_epsilon ........... 5e-06
[2022-05-16 08:03:18.396674] vocab_size ................. 30
[2022-05-16 08:03:18.396679] warmup_pct ................. 0.01
[2022-05-16 08:03:18.396684] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_10h_15s_1000mc_1000q.pkl
[2022-05-16 08:03:18.397703] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 10 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_7h_15s_1000mc_1000q.pkl
[2022-05-16 08:03:48.048495] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 7 | Total Seq Length 15

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_6h_15s_1000mc_1000q.pkl
[2022-05-16 08:04:36.244802] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 6 | Total Seq Length 15

....................................................................................................
==================================================
