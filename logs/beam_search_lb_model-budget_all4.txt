==================================================
* Running for dataset shakespeare
==================================================
[2022-05-11 22:59:11.861098] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-11 22:59:11.864261] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-11 22:59:11.865870] batch_size ................. 4096
[2022-05-11 22:59:11.865881] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-11 22:59:11.865888] cuda ....................... True
[2022-05-11 22:59:11.865892] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-11 22:59:11.865895] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-11 22:59:11.865899] device ..................... 7
[2022-05-11 22:59:11.865902] device_num ................. 0
[2022-05-11 22:59:11.865906] disable_tqdm ............... True
[2022-05-11 22:59:11.865909] do_test .................... False
[2022-05-11 22:59:11.865913] do_valid ................... True
[2022-05-11 22:59:11.865916] dont_print_args ............ True
[2022-05-11 22:59:11.865920] dont_shuffle ............... None
[2022-05-11 22:59:11.865927] dropout .................... 0.3
[2022-05-11 22:59:11.865932] estimate_type .............. <function beam_search_lower_bound at 0x7fb07a9b68b0>
[2022-05-11 22:59:11.865937] excluded_terms ............. [1]
[2022-05-11 22:59:11.865942] finetune ................... False
[2022-05-11 22:59:11.865946] grad_clip .................. 1.0
[2022-05-11 22:59:11.865949] hidden_size ................ 128
[2022-05-11 22:59:11.865952] hist_len ................... 18
[2022-05-11 22:59:11.865956] interp_func ................ <function lin_interp at 0x7fb07a9b6790>
[2022-05-11 22:59:11.865959] log_interval ............... 100
[2022-05-11 22:59:11.865963] lr ......................... 0.001
[2022-05-11 22:59:11.865966] lr_decay_style ............. constant
[2022-05-11 22:59:11.865969] masked_lm .................. False
[2022-05-11 22:59:11.865973] max_num_mc_samples ......... 100000
[2022-05-11 22:59:11.865976] min_num_mc_samples ......... 10000
[2022-05-11 22:59:11.865979] min_phase_shift ............ 0
[2022-05-11 22:59:11.865982] min_var_reduction .......... 0.1
[2022-05-11 22:59:11.865986] min_variance ............... True
[2022-05-11 22:59:11.865989] model_budget_filepath ...... None
[2022-05-11 22:59:11.865993] num_beams .................. 0.0
[2022-05-11 22:59:11.865996] num_layers ................. 2
[2022-05-11 22:59:11.865999] num_mc_samples ............. 100
[2022-05-11 22:59:11.866002] num_workers ................ 0
[2022-05-11 22:59:11.866005] optimizer .................. adam
[2022-05-11 22:59:11.866009] proposal_func .............. <function lm_proposal at 0x7fb07a9b3700>
[2022-05-11 22:59:11.866012] rnn_type ................... LSTM
[2022-05-11 22:59:11.866015] save_epochs ................ 1
[2022-05-11 22:59:11.866018] seed ....................... 42
[2022-05-11 22:59:11.866021] seq_len .................... 100
[2022-05-11 22:59:11.866024] shuffle .................... True
[2022-05-11 22:59:11.866028] store_intermediate_lbs ..... True
[2022-05-11 22:59:11.866031] sub_estimates .............. []
[2022-05-11 22:59:11.866035] text_dict .................. None
[2022-05-11 22:59:11.866038] top_k ...................... 0
[2022-05-11 22:59:11.866041] top_p ...................... 0
[2022-05-11 22:59:11.866044] total_seq_len .............. 20
[2022-05-11 22:59:11.866047] train_data_pct ............. 0.9
[2022-05-11 22:59:11.866051] train_epochs ............... 40
[2022-05-11 22:59:11.866054] use_gpt2 ................... False
[2022-05-11 22:59:11.866057] val_data_pct ............... 0.05
[2022-05-11 22:59:11.866061] val_metrics ................ ['accuracy']
[2022-05-11 22:59:11.866065] valid_epochs ............... 1
[2022-05-11 22:59:11.866070] variance_epsilon ........... 1e-07
[2022-05-11 22:59:11.866073] vocab_size ................. 68
[2022-05-11 22:59:11.866076] warmup_pct ................. 0.01
[2022-05-11 22:59:11.866079] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_18h_20s_1000mc.pkl
[2022-05-11 22:59:11.866754] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_17h_20s_1000mc.pkl
[2022-05-11 22:59:26.243321] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-11 23:00:09.878041] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-11 23:00:09.886460] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-11 23:00:10.300939] batch_size ................. 4096
[2022-05-11 23:00:10.300965] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-11 23:00:10.300972] cuda ....................... True
[2022-05-11 23:00:10.300975] data_path .................. data/apps/lsapp.tsv
[2022-05-11 23:00:10.300977] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-11 23:00:10.300981] device ..................... 7
[2022-05-11 23:00:10.300984] device_num ................. 0
[2022-05-11 23:00:10.300986] disable_tqdm ............... True
[2022-05-11 23:00:10.300990] do_test .................... False
[2022-05-11 23:00:10.300993] do_valid ................... True
[2022-05-11 23:00:10.300995] dont_print_args ............ True
[2022-05-11 23:00:10.300999] dont_shuffle ............... None
[2022-05-11 23:00:10.301007] dropout .................... 0.3
[2022-05-11 23:00:10.301011] estimate_type .............. <function beam_search_lower_bound at 0x7fb07a9b68b0>
[2022-05-11 23:00:10.301016] excluded_terms ............. [1]
[2022-05-11 23:00:10.301020] finetune ................... False
[2022-05-11 23:00:10.301024] grad_clip .................. 1.0
[2022-05-11 23:00:10.301026] hidden_size ................ 512
[2022-05-11 23:00:10.301029] hist_len ................... 18
[2022-05-11 23:00:10.301032] interp_func ................ <function lin_interp at 0x7fb07a9b6790>
[2022-05-11 23:00:10.301035] log_interval ............... 100
[2022-05-11 23:00:10.301038] lr ......................... 0.001
[2022-05-11 23:00:10.301041] lr_decay_style ............. constant
[2022-05-11 23:00:10.301047] masked_lm .................. False
[2022-05-11 23:00:10.301050] max_num_mc_samples ......... 100000
[2022-05-11 23:00:10.301052] min_num_mc_samples ......... 10000
[2022-05-11 23:00:10.301055] min_phase_shift ............ 0
[2022-05-11 23:00:10.301058] min_var_reduction .......... 0.1
[2022-05-11 23:00:10.301061] min_variance ............... True
[2022-05-11 23:00:10.301064] model_budget_filepath ...... None
[2022-05-11 23:00:10.301066] needs_encoding ............. True
[2022-05-11 23:00:10.301070] num_beams .................. 0.0
[2022-05-11 23:00:10.301072] num_layers ................. 2
[2022-05-11 23:00:10.301074] num_mc_samples ............. 100
[2022-05-11 23:00:10.301078] num_workers ................ 0
[2022-05-11 23:00:10.301081] optimizer .................. adam
[2022-05-11 23:00:10.301083] proposal_func .............. <function lm_proposal at 0x7fb07a9b3700>
[2022-05-11 23:00:10.301086] rnn_type ................... LSTM
[2022-05-11 23:00:10.301088] save_epochs ................ 1
[2022-05-11 23:00:10.301091] seed ....................... 42
[2022-05-11 23:00:10.301093] seq_len .................... 15
[2022-05-11 23:00:10.301096] shuffle .................... True
[2022-05-11 23:00:10.301099] store_intermediate_lbs ..... True
[2022-05-11 23:00:10.301101] sub_estimates .............. []
[2022-05-11 23:00:10.301104] text_dict .................. None
[2022-05-11 23:00:10.301106] top_k ...................... 0
[2022-05-11 23:00:10.301108] top_p ...................... 0
[2022-05-11 23:00:10.301111] total_seq_len .............. 20
[2022-05-11 23:00:10.301114] train_data_pct ............. 0.9
[2022-05-11 23:00:10.301117] train_epochs ............... 40
[2022-05-11 23:00:10.301119] use_gpt2 ................... False
[2022-05-11 23:00:10.301122] val_data_pct ............... 0.001
[2022-05-11 23:00:10.301126] val_metrics ................ ['accuracy']
[2022-05-11 23:00:10.301128] valid_epochs ............... 1
[2022-05-11 23:00:10.301133] variance_epsilon ........... 1e-07
[2022-05-11 23:00:10.301136] vocab_size ................. 88
[2022-05-11 23:00:10.301139] warmup_pct ................. 0.01
[2022-05-11 23:00:10.301142] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_13h_15s_1000mc.pkl
[2022-05-11 23:00:10.302608] | Dataset: apps | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/apps/val_dl/val-dl_apps_beam-search-is-hybrid_12h_15s_1000mc.pkl
[2022-05-11 23:00:54.970391] | Dataset: apps | Sample type: beam_search | Num Beams: 0.98 | Hist length 12 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-11 23:02:03.375010] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-11 23:02:03.377935] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-11 23:02:03.425925] batch_size ................. 4096
[2022-05-11 23:02:03.425941] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-11 23:02:03.425947] cuda ....................... True
[2022-05-11 23:02:03.425951] data_path .................. data/moocs/mooc.csv
[2022-05-11 23:02:03.425955] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-11 23:02:03.425960] device ..................... 7
[2022-05-11 23:02:03.425963] device_num ................. 0
[2022-05-11 23:02:03.425967] disable_tqdm ............... True
[2022-05-11 23:02:03.425971] do_test .................... False
[2022-05-11 23:02:03.425974] do_valid ................... True
[2022-05-11 23:02:03.425978] dont_print_args ............ True
[2022-05-11 23:02:03.425982] dont_shuffle ............... None
[2022-05-11 23:02:03.425990] dropout .................... 0.3
[2022-05-11 23:02:03.425995] estimate_type .............. <function beam_search_lower_bound at 0x7fb07a9b68b0>
[2022-05-11 23:02:03.426001] excluded_terms ............. [1]
[2022-05-11 23:02:03.426012] finetune ................... False
[2022-05-11 23:02:03.426016] grad_clip .................. 1.0
[2022-05-11 23:02:03.426020] hidden_size ................ 128
[2022-05-11 23:02:03.426023] hist_len ................... 18
[2022-05-11 23:02:03.426028] interp_func ................ <function lin_interp at 0x7fb07a9b6790>
[2022-05-11 23:02:03.426031] log_interval ............... 100
[2022-05-11 23:02:03.426036] lr ......................... 0.001
[2022-05-11 23:02:03.426040] lr_decay_style ............. constant
[2022-05-11 23:02:03.426044] masked_lm .................. False
[2022-05-11 23:02:03.426048] max_num_mc_samples ......... 100000
[2022-05-11 23:02:03.426051] min_num_mc_samples ......... 10000
[2022-05-11 23:02:03.426055] min_phase_shift ............ 0
[2022-05-11 23:02:03.426059] min_var_reduction .......... 0.1
[2022-05-11 23:02:03.426063] min_variance ............... True
[2022-05-11 23:02:03.426067] model_budget_filepath ...... None
[2022-05-11 23:02:03.426071] needs_encoding ............. False
[2022-05-11 23:02:03.426075] num_beams .................. 0.0
[2022-05-11 23:02:03.426078] num_layers ................. 2
[2022-05-11 23:02:03.426082] num_mc_samples ............. 100
[2022-05-11 23:02:03.426086] num_workers ................ 0
[2022-05-11 23:02:03.426089] optimizer .................. adam
[2022-05-11 23:02:03.426093] proposal_func .............. <function lm_proposal at 0x7fb07a9b3700>
[2022-05-11 23:02:03.426096] rnn_type ................... LSTM
[2022-05-11 23:02:03.426100] save_epochs ................ 1
[2022-05-11 23:02:03.426103] seed ....................... 42
[2022-05-11 23:02:03.426106] seq_len .................... 15
[2022-05-11 23:02:03.426111] shuffle .................... True
[2022-05-11 23:02:03.426115] store_intermediate_lbs ..... True
[2022-05-11 23:02:03.426118] sub_estimates .............. []
[2022-05-11 23:02:03.426122] text_dict .................. None
[2022-05-11 23:02:03.426125] top_k ...................... 0
[2022-05-11 23:02:03.426129] top_p ...................... 0
[2022-05-11 23:02:03.426132] total_seq_len .............. 20
[2022-05-11 23:02:03.426137] train_data_pct ............. 0.9
[2022-05-11 23:02:03.426140] train_epochs ............... 40
[2022-05-11 23:02:03.426144] use_gpt2 ................... False
[2022-05-11 23:02:03.426147] val_data_pct ............... 0.01
[2022-05-11 23:02:03.426152] val_metrics ................ ['accuracy']
[2022-05-11 23:02:03.426156] valid_epochs ............... 1
[2022-05-11 23:02:03.426161] variance_epsilon ........... 1e-07
[2022-05-11 23:02:03.426165] vocab_size ................. 98
[2022-05-11 23:02:03.426169] warmup_pct ................. 0.01
[2022-05-11 23:02:03.426172] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_13h_15s_1000mc.pkl
[2022-05-11 23:02:03.427546] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/moocs/val_dl/val-dl_moocs_beam-search-is-hybrid_12h_15s_1000mc.pkl
[2022-05-11 23:02:23.537433] | Dataset: moocs | Sample type: beam_search | Num Beams: 0.98 | Hist length 12 | Total Seq Length 15

...............................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-11 23:03:45.893949] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-11 23:03:45.904455] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-11 23:03:46.072977] batch_size ................. 4096
[2022-05-11 23:03:46.073001] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-11 23:03:46.073007] cuda ....................... True
[2022-05-11 23:03:46.073010] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-11 23:03:46.073013] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-11 23:03:46.073017] device ..................... 7
[2022-05-11 23:03:46.073020] device_num ................. 0
[2022-05-11 23:03:46.073022] disable_tqdm ............... True
[2022-05-11 23:03:46.073026] do_test .................... False
[2022-05-11 23:03:46.073028] do_valid ................... True
[2022-05-11 23:03:46.073031] dont_print_args ............ True
[2022-05-11 23:03:46.073035] dont_shuffle ............... None
[2022-05-11 23:03:46.073043] dropout .................... 0.3
[2022-05-11 23:03:46.073047] estimate_type .............. <function beam_search_lower_bound at 0x7fb07a9b68b0>
[2022-05-11 23:03:46.073052] excluded_terms ............. [1]
[2022-05-11 23:03:46.073072] finetune ................... False
[2022-05-11 23:03:46.073075] grad_clip .................. 1.0
[2022-05-11 23:03:46.073078] hidden_size ................ 512
[2022-05-11 23:03:46.073080] hist_len ................... 18
[2022-05-11 23:03:46.073084] interp_func ................ <function lin_interp at 0x7fb07a9b6790>
[2022-05-11 23:03:46.073087] log_interval ............... 100
[2022-05-11 23:03:46.073090] lr ......................... 0.001
[2022-05-11 23:03:46.073093] lr_decay_style ............. constant
[2022-05-11 23:03:46.073102] masked_lm .................. False
[2022-05-11 23:03:46.073104] max_num_mc_samples ......... 100000
[2022-05-11 23:03:46.073107] min_num_mc_samples ......... 10000
[2022-05-11 23:03:46.073109] min_phase_shift ............ 0
[2022-05-11 23:03:46.073113] min_var_reduction .......... 0.1
[2022-05-11 23:03:46.073116] min_variance ............... True
[2022-05-11 23:03:46.073119] model_budget_filepath ...... None
[2022-05-11 23:03:46.073122] num_beams .................. 0.0
[2022-05-11 23:03:46.073124] num_layers ................. 2
[2022-05-11 23:03:46.073127] num_mc_samples ............. 100
[2022-05-11 23:03:46.073129] num_workers ................ 0
[2022-05-11 23:03:46.073132] optimizer .................. adam
[2022-05-11 23:03:46.073135] proposal_func .............. <function lm_proposal at 0x7fb07a9b3700>
[2022-05-11 23:03:46.073138] rnn_type ................... LSTM
[2022-05-11 23:03:46.073140] save_epochs ................ 1
[2022-05-11 23:03:46.073142] seed ....................... 42
[2022-05-11 23:03:46.073145] seq_len .................... 15
[2022-05-11 23:03:46.073147] shuffle .................... True
[2022-05-11 23:03:46.073163] store_intermediate_lbs ..... True
[2022-05-11 23:03:46.073166] sub_estimates .............. []
[2022-05-11 23:03:46.073169] text_dict .................. None
[2022-05-11 23:03:46.073171] top_k ...................... 0
[2022-05-11 23:03:46.073173] top_p ...................... 0
[2022-05-11 23:03:46.073176] total_seq_len .............. 20
[2022-05-11 23:03:46.073179] train_data_pct ............. 0.9
[2022-05-11 23:03:46.073182] train_epochs ............... 40
[2022-05-11 23:03:46.073184] use_gpt2 ................... False
[2022-05-11 23:03:46.073187] val_data_pct ............... 0.0001
[2022-05-11 23:03:46.073192] val_metrics ................ ['accuracy']
[2022-05-11 23:03:46.073195] valid_epochs ............... 1
[2022-05-11 23:03:46.073199] variance_epsilon ........... 1e-07
[2022-05-11 23:03:46.073202] vocab_size ................. 30
[2022-05-11 23:03:46.073205] warmup_pct ................. 0.01
[2022-05-11 23:03:46.073208] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_12h_15s_1000mc.pkl
[2022-05-11 23:03:46.074764] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_13h_15s_1000mc.pkl
[2022-05-11 23:05:27.785632] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/amazon/val_dl/val-dl_amazon_beam-search-is-hybrid_11h_15s_1000mc.pkl
[2022-05-11 23:06:14.810807] | Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
