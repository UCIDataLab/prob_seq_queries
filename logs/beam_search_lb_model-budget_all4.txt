==================================================
* Running for dataset shakespeare
==================================================
[2022-05-10 13:28:18.702280] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-10 13:28:18.706813] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-10 13:28:18.710857] batch_size ................. 4096
[2022-05-10 13:28:18.710877] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-10 13:28:18.710887] cuda ....................... True
[2022-05-10 13:28:18.710893] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-10 13:28:18.710899] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 13:28:18.710904] device ..................... 1
[2022-05-10 13:28:18.710910] device_num ................. 0
[2022-05-10 13:28:18.710916] disable_tqdm ............... True
[2022-05-10 13:28:18.710922] do_test .................... False
[2022-05-10 13:28:18.710928] do_valid ................... True
[2022-05-10 13:28:18.710934] dont_print_args ............ True
[2022-05-10 13:28:18.710940] dont_shuffle ............... None
[2022-05-10 13:28:18.710952] dropout .................... 0.3
[2022-05-10 13:28:18.710960] estimate_type .............. <function beam_search_lower_bound at 0x7fb423b44040>
[2022-05-10 13:28:18.710968] excluded_terms ............. [1]
[2022-05-10 13:28:18.710975] finetune ................... False
[2022-05-10 13:28:18.710981] grad_clip .................. 1.0
[2022-05-10 13:28:18.710987] hidden_size ................ 128
[2022-05-10 13:28:18.710992] hist_len ................... 18
[2022-05-10 13:28:18.710999] interp_func ................ <function lin_interp at 0x7fb423b43ee0>
[2022-05-10 13:28:18.711004] log_interval ............... 100
[2022-05-10 13:28:18.711011] lr ......................... 0.001
[2022-05-10 13:28:18.711016] lr_decay_style ............. constant
[2022-05-10 13:28:18.711022] masked_lm .................. False
[2022-05-10 13:28:18.711028] min_phase_shift ............ 0
[2022-05-10 13:28:18.711034] min_var_reduction .......... 0.1
[2022-05-10 13:28:18.711039] min_variance ............... True
[2022-05-10 13:28:18.711045] model_budget_filepath ...... None
[2022-05-10 13:28:18.711051] num_beams .................. 0.0
[2022-05-10 13:28:18.711057] num_layers ................. 2
[2022-05-10 13:28:18.711062] num_mc_samples ............. 100
[2022-05-10 13:28:18.711068] num_workers ................ 0
[2022-05-10 13:28:18.711073] optimizer .................. adam
[2022-05-10 13:28:18.711079] proposal_func .............. <function lm_proposal at 0x7fb423b3fee0>
[2022-05-10 13:28:18.711084] rnn_type ................... LSTM
[2022-05-10 13:28:18.711090] save_epochs ................ 1
[2022-05-10 13:28:18.711095] seed ....................... 1234321
[2022-05-10 13:28:18.711101] seq_len .................... 100
[2022-05-10 13:28:18.711106] shuffle .................... True
[2022-05-10 13:28:18.711112] store_intermediate_lbs ..... True
[2022-05-10 13:28:18.711117] sub_estimates .............. []
[2022-05-10 13:28:18.711123] text_dict .................. None
[2022-05-10 13:28:18.711129] top_k ...................... 0
[2022-05-10 13:28:18.711134] top_p ...................... 0
[2022-05-10 13:28:18.711139] total_seq_len .............. 20
[2022-05-10 13:28:18.711145] train_data_pct ............. 0.9
[2022-05-10 13:28:18.711152] train_epochs ............... 40
[2022-05-10 13:28:18.711158] val_data_pct ............... 0.05
[2022-05-10 13:28:18.711168] val_metrics ................ ['accuracy']
[2022-05-10 13:28:18.711174] valid_epochs ............... 1
[2022-05-10 13:28:18.711181] vocab_size ................. 68
[2022-05-10 13:28:18.711193] warmup_pct ................. 0.01
[2022-05-10 13:28:18.711201] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.98 | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.95 | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_15h_20s_1000mc.pkl does not exist
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl
Model budget filepath /home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_14h_20s_1000mc.pkl does not exist
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-10 13:30:42.626986] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-10 13:30:42.640345] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-10 13:30:42.861683] batch_size ................. 4096
[2022-05-10 13:30:42.861713] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-10 13:30:42.861720] cuda ....................... True
[2022-05-10 13:30:42.861724] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-10 13:30:42.861728] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 13:30:42.861732] device ..................... 1
[2022-05-10 13:30:42.861735] device_num ................. 0
[2022-05-10 13:30:42.861739] disable_tqdm ............... True
[2022-05-10 13:30:42.861744] do_test .................... False
[2022-05-10 13:30:42.861747] do_valid ................... True
[2022-05-10 13:30:42.861751] dont_print_args ............ True
[2022-05-10 13:30:42.861759] dont_shuffle ............... None
[2022-05-10 13:30:42.861783] dropout .................... 0.3
[2022-05-10 13:30:42.861790] estimate_type .............. <function beam_search_lower_bound at 0x7fb423b44040>
[2022-05-10 13:30:42.861796] excluded_terms ............. [1]
[2022-05-10 13:30:42.861800] finetune ................... False
[2022-05-10 13:30:42.861805] grad_clip .................. 1.0
[2022-05-10 13:30:42.861809] hidden_size ................ 512
[2022-05-10 13:30:42.861812] hist_len ................... 18
[2022-05-10 13:30:42.861816] interp_func ................ <function lin_interp at 0x7fb423b43ee0>
[2022-05-10 13:30:42.861825] log_interval ............... 100
[2022-05-10 13:30:42.861829] lr ......................... 0.001
[2022-05-10 13:30:42.861833] lr_decay_style ............. constant
[2022-05-10 13:30:42.861837] masked_lm .................. False
[2022-05-10 13:30:42.861840] min_phase_shift ............ 0
[2022-05-10 13:30:42.861845] min_var_reduction .......... 0.1
[2022-05-10 13:30:42.861848] min_variance ............... True
[2022-05-10 13:30:42.861852] model_budget_filepath ...... None
[2022-05-10 13:30:42.861856] num_beams .................. 0.0
[2022-05-10 13:30:42.861860] num_layers ................. 2
[2022-05-10 13:30:42.861863] num_mc_samples ............. 100
[2022-05-10 13:30:42.861867] num_workers ................ 0
[2022-05-10 13:30:42.861871] optimizer .................. adam
[2022-05-10 13:30:42.861874] proposal_func .............. <function lm_proposal at 0x7fb423b3fee0>
[2022-05-10 13:30:42.861878] rnn_type ................... LSTM
[2022-05-10 13:30:42.861881] save_epochs ................ 1
[2022-05-10 13:30:42.861884] seed ....................... 1234321
[2022-05-10 13:30:42.861888] seq_len .................... 15
[2022-05-10 13:30:42.861892] shuffle .................... True
[2022-05-10 13:30:42.861895] store_intermediate_lbs ..... True
[2022-05-10 13:30:42.861899] sub_estimates .............. []
[2022-05-10 13:30:42.861903] text_dict .................. None
[2022-05-10 13:30:42.861906] top_k ...................... 0
[2022-05-10 13:30:42.861910] top_p ...................... 0
[2022-05-10 13:30:42.861913] total_seq_len .............. 20
[2022-05-10 13:30:42.861918] train_data_pct ............. 0.9
[2022-05-10 13:30:42.861922] train_epochs ............... 40
[2022-05-10 13:30:42.861926] val_data_pct ............... 0.0001
[2022-05-10 13:30:42.861930] val_metrics ................ ['accuracy']
[2022-05-10 13:30:42.861934] valid_epochs ............... 1
[2022-05-10 13:30:42.861937] vocab_size ................. 30
[2022-05-10 13:30:42.861941] warmup_pct ................. 0.01
[2022-05-10 13:30:42.861944] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.98 | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.95 | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.85 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 9 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.8 | Hist length 8 | Total Seq Length 15

...................................................................................................................................................................................