==================================================
* Running for dataset shakespeare
==================================================
[2022-05-15 20:08:09.554844] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-15 20:08:09.558415] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-15 20:08:09.561316] batch_size ................. 4096
[2022-05-15 20:08:09.561331] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-15 20:08:09.561344] cuda ....................... True
[2022-05-15 20:08:09.561349] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-15 20:08:09.561355] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 20:08:09.561361] device ..................... 7
[2022-05-15 20:08:09.561368] device_num ................. 0
[2022-05-15 20:08:09.561373] disable_tqdm ............... True
[2022-05-15 20:08:09.561379] do_test .................... False
[2022-05-15 20:08:09.561385] do_valid ................... True
[2022-05-15 20:08:09.561391] dont_print_args ............ True
[2022-05-15 20:08:09.561399] dont_shuffle ............... None
[2022-05-15 20:08:09.561412] dropout .................... 0.3
[2022-05-15 20:08:09.561420] estimate_type .............. <function beam_search_lower_bound at 0x7f11d0f2ad30>
[2022-05-15 20:08:09.561430] excluded_terms ............. [1]
[2022-05-15 20:08:09.561437] excluded_terms_list ........ [[]]
[2022-05-15 20:08:09.561443] finetune ................... False
[2022-05-15 20:08:09.561449] grad_clip .................. 1.0
[2022-05-15 20:08:09.561455] hidden_size ................ 128
[2022-05-15 20:08:09.561460] hist_len ................... 18
[2022-05-15 20:08:09.561466] hybrid_max_num_beams ....... 1500
[2022-05-15 20:08:09.561473] interp_func ................ <function lin_interp at 0x7f11d0f2ac10>
[2022-05-15 20:08:09.561478] k_range .................... []
[2022-05-15 20:08:09.561484] log_interval ............... 100
[2022-05-15 20:08:09.561491] lr ......................... 0.001
[2022-05-15 20:08:09.561497] lr_decay_style ............. constant
[2022-05-15 20:08:09.561503] masked_lm .................. False
[2022-05-15 20:08:09.561508] max_num_mc_samples ......... 100000
[2022-05-15 20:08:09.561514] max_num_queries ............ 1000
[2022-05-15 20:08:09.561520] min_num_mc_samples ......... 10000
[2022-05-15 20:08:09.561525] min_phase_shift ............ 0
[2022-05-15 20:08:09.561531] min_var_reduction .......... 0.1
[2022-05-15 20:08:09.561537] min_variance ............... True
[2022-05-15 20:08:09.561543] model_budget_filepath ...... None
[2022-05-15 20:08:09.561549] num_beams .................. 0.0
[2022-05-15 20:08:09.561555] num_layers ................. 2
[2022-05-15 20:08:09.561560] num_mc_samples ............. 100
[2022-05-15 20:08:09.561566] num_workers ................ 0
[2022-05-15 20:08:09.561571] optimizer .................. adam
[2022-05-15 20:08:09.561578] proposal_func .............. <function lm_proposal at 0x7f11d0f18c10>
[2022-05-15 20:08:09.561583] rnn_type ................... LSTM
[2022-05-15 20:08:09.561589] save_epochs ................ 1
[2022-05-15 20:08:09.561594] seed ....................... 42
[2022-05-15 20:08:09.561600] seq_len .................... 100
[2022-05-15 20:08:09.561605] shuffle .................... True
[2022-05-15 20:08:09.561611] store_intermediate_lbs ..... True
[2022-05-15 20:08:09.561617] sub_estimates .............. []
[2022-05-15 20:08:09.561622] terms_of_interest .......... []
[2022-05-15 20:08:09.561628] text_dict .................. None
[2022-05-15 20:08:09.561633] top_k ...................... 0
[2022-05-15 20:08:09.561639] top_p ...................... 0
[2022-05-15 20:08:09.561644] total_seq_len .............. 20
[2022-05-15 20:08:09.561650] train_data_pct ............. 0.9
[2022-05-15 20:08:09.561655] train_epochs ............... 40
[2022-05-15 20:08:09.561661] use_gpt2 ................... False
[2022-05-15 20:08:09.561667] val_data_pct ............... 0.05
[2022-05-15 20:08:09.561673] val_metrics ................ ['accuracy']
[2022-05-15 20:08:09.561679] valid_epochs ............... 1
[2022-05-15 20:08:09.561687] variance_epsilon ........... 5e-06
[2022-05-15 20:08:09.561693] vocab_size ................. 68
[2022-05-15 20:08:09.561699] warmup_pct ................. 0.01
[2022-05-15 20:08:09.561704] weight_decay ............... 0.0
==================================================
[2022-05-15 20:08:09.562293] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 15 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 20:12:20.994508] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 13 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

........................................