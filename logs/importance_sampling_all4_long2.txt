==================================================
* Running for dataset shakespeare
==================================================
[2022-05-15 20:08:09.554844] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-15 20:08:09.558415] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-15 20:08:09.561316] batch_size ................. 4096
[2022-05-15 20:08:09.561331] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-15 20:08:09.561344] cuda ....................... True
[2022-05-15 20:08:09.561349] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-15 20:08:09.561355] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 20:08:09.561361] device ..................... 7
[2022-05-15 20:08:09.561368] device_num ................. 0
[2022-05-15 20:08:09.561373] disable_tqdm ............... True
[2022-05-15 20:08:09.561379] do_test .................... False
[2022-05-15 20:08:09.561385] do_valid ................... True
[2022-05-15 20:08:09.561391] dont_print_args ............ True
[2022-05-15 20:08:09.561399] dont_shuffle ............... None
[2022-05-15 20:08:09.561412] dropout .................... 0.3
[2022-05-15 20:08:09.561420] estimate_type .............. <function beam_search_lower_bound at 0x7f11d0f2ad30>
[2022-05-15 20:08:09.561430] excluded_terms ............. [1]
[2022-05-15 20:08:09.561437] excluded_terms_list ........ [[]]
[2022-05-15 20:08:09.561443] finetune ................... False
[2022-05-15 20:08:09.561449] grad_clip .................. 1.0
[2022-05-15 20:08:09.561455] hidden_size ................ 128
[2022-05-15 20:08:09.561460] hist_len ................... 18
[2022-05-15 20:08:09.561466] hybrid_max_num_beams ....... 1500
[2022-05-15 20:08:09.561473] interp_func ................ <function lin_interp at 0x7f11d0f2ac10>
[2022-05-15 20:08:09.561478] k_range .................... []
[2022-05-15 20:08:09.561484] log_interval ............... 100
[2022-05-15 20:08:09.561491] lr ......................... 0.001
[2022-05-15 20:08:09.561497] lr_decay_style ............. constant
[2022-05-15 20:08:09.561503] masked_lm .................. False
[2022-05-15 20:08:09.561508] max_num_mc_samples ......... 100000
[2022-05-15 20:08:09.561514] max_num_queries ............ 1000
[2022-05-15 20:08:09.561520] min_num_mc_samples ......... 10000
[2022-05-15 20:08:09.561525] min_phase_shift ............ 0
[2022-05-15 20:08:09.561531] min_var_reduction .......... 0.1
[2022-05-15 20:08:09.561537] min_variance ............... True
[2022-05-15 20:08:09.561543] model_budget_filepath ...... None
[2022-05-15 20:08:09.561549] num_beams .................. 0.0
[2022-05-15 20:08:09.561555] num_layers ................. 2
[2022-05-15 20:08:09.561560] num_mc_samples ............. 100
[2022-05-15 20:08:09.561566] num_workers ................ 0
[2022-05-15 20:08:09.561571] optimizer .................. adam
[2022-05-15 20:08:09.561578] proposal_func .............. <function lm_proposal at 0x7f11d0f18c10>
[2022-05-15 20:08:09.561583] rnn_type ................... LSTM
[2022-05-15 20:08:09.561589] save_epochs ................ 1
[2022-05-15 20:08:09.561594] seed ....................... 42
[2022-05-15 20:08:09.561600] seq_len .................... 100
[2022-05-15 20:08:09.561605] shuffle .................... True
[2022-05-15 20:08:09.561611] store_intermediate_lbs ..... True
[2022-05-15 20:08:09.561617] sub_estimates .............. []
[2022-05-15 20:08:09.561622] terms_of_interest .......... []
[2022-05-15 20:08:09.561628] text_dict .................. None
[2022-05-15 20:08:09.561633] top_k ...................... 0
[2022-05-15 20:08:09.561639] top_p ...................... 0
[2022-05-15 20:08:09.561644] total_seq_len .............. 20
[2022-05-15 20:08:09.561650] train_data_pct ............. 0.9
[2022-05-15 20:08:09.561655] train_epochs ............... 40
[2022-05-15 20:08:09.561661] use_gpt2 ................... False
[2022-05-15 20:08:09.561667] val_data_pct ............... 0.05
[2022-05-15 20:08:09.561673] val_metrics ................ ['accuracy']
[2022-05-15 20:08:09.561679] valid_epochs ............... 1
[2022-05-15 20:08:09.561687] variance_epsilon ........... 5e-06
[2022-05-15 20:08:09.561693] vocab_size ................. 68
[2022-05-15 20:08:09.561699] warmup_pct ................. 0.01
[2022-05-15 20:08:09.561704] weight_decay ............... 0.0
==================================================
[2022-05-15 20:08:09.562293] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 15 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 20:12:20.994508] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 13 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 20:17:57.559598] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 11 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-15 20:24:39.274632] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-15 20:24:39.277761] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-15 20:24:39.348284] batch_size ................. 4096
[2022-05-15 20:24:39.348307] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-15 20:24:39.348316] cuda ....................... True
[2022-05-15 20:24:39.348321] data_path .................. data/moocs/mooc.csv
[2022-05-15 20:24:39.348327] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 20:24:39.348333] device ..................... 7
[2022-05-15 20:24:39.348339] device_num ................. 0
[2022-05-15 20:24:39.348345] disable_tqdm ............... True
[2022-05-15 20:24:39.348351] do_test .................... False
[2022-05-15 20:24:39.348357] do_valid ................... True
[2022-05-15 20:24:39.348362] dont_print_args ............ True
[2022-05-15 20:24:39.348369] dont_shuffle ............... None
[2022-05-15 20:24:39.348381] dropout .................... 0.3
[2022-05-15 20:24:39.348389] estimate_type .............. <function beam_search_lower_bound at 0x7f11d0f2ad30>
[2022-05-15 20:24:39.348396] excluded_terms ............. [1]
[2022-05-15 20:24:39.348412] excluded_terms_list ........ [[]]
[2022-05-15 20:24:39.348418] finetune ................... False
[2022-05-15 20:24:39.348424] grad_clip .................. 1.0
[2022-05-15 20:24:39.348430] hidden_size ................ 128
[2022-05-15 20:24:39.348436] hist_len ................... 18
[2022-05-15 20:24:39.348441] hybrid_max_num_beams ....... 1500
[2022-05-15 20:24:39.348448] interp_func ................ <function lin_interp at 0x7f11d0f2ac10>
[2022-05-15 20:24:39.348454] k_range .................... []
[2022-05-15 20:24:39.348463] log_interval ............... 100
[2022-05-15 20:24:39.348470] lr ......................... 0.001
[2022-05-15 20:24:39.348475] lr_decay_style ............. constant
[2022-05-15 20:24:39.348482] masked_lm .................. False
[2022-05-15 20:24:39.348487] max_num_mc_samples ......... 100000
[2022-05-15 20:24:39.348494] max_num_queries ............ 1000
[2022-05-15 20:24:39.348499] min_num_mc_samples ......... 10000
[2022-05-15 20:24:39.348505] min_phase_shift ............ 0
[2022-05-15 20:24:39.348511] min_var_reduction .......... 0.1
[2022-05-15 20:24:39.348517] min_variance ............... True
[2022-05-15 20:24:39.348523] model_budget_filepath ...... None
[2022-05-15 20:24:39.348529] needs_encoding ............. False
[2022-05-15 20:24:39.348535] num_beams .................. 0.0
[2022-05-15 20:24:39.348541] num_layers ................. 2
[2022-05-15 20:24:39.348546] num_mc_samples ............. 100
[2022-05-15 20:24:39.348552] num_workers ................ 0
[2022-05-15 20:24:39.348557] optimizer .................. adam
[2022-05-15 20:24:39.348564] proposal_func .............. <function lm_proposal at 0x7f11d0f18c10>
[2022-05-15 20:24:39.348570] rnn_type ................... LSTM
[2022-05-15 20:24:39.348575] save_epochs ................ 1
[2022-05-15 20:24:39.348580] seed ....................... 42
[2022-05-15 20:24:39.348586] seq_len .................... 15
[2022-05-15 20:24:39.348591] shuffle .................... True
[2022-05-15 20:24:39.348597] store_intermediate_lbs ..... True
[2022-05-15 20:24:39.348603] sub_estimates .............. []
[2022-05-15 20:24:39.348609] terms_of_interest .......... []
[2022-05-15 20:24:39.348615] text_dict .................. None
[2022-05-15 20:24:39.348620] top_k ...................... 0
[2022-05-15 20:24:39.348625] top_p ...................... 0
[2022-05-15 20:24:39.348631] total_seq_len .............. 20
[2022-05-15 20:24:39.348637] train_data_pct ............. 0.9
[2022-05-15 20:24:39.348642] train_epochs ............... 40
[2022-05-15 20:24:39.348648] use_gpt2 ................... False
[2022-05-15 20:24:39.348654] val_data_pct ............... 0.01
[2022-05-15 20:24:39.348661] val_metrics ................ ['accuracy']
[2022-05-15 20:24:39.348666] valid_epochs ............... 1
[2022-05-15 20:24:39.348675] variance_epsilon ........... 5e-06
[2022-05-15 20:24:39.348680] vocab_size ................. 98
[2022-05-15 20:24:39.348686] warmup_pct ................. 0.01
[2022-05-15 20:24:39.348692] weight_decay ............... 0.0
==================================================
[2022-05-15 20:24:39.349406] | Dataset: moocs | Sample type: pseudo_gt | Num samples: None | Hist length 10 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 20:31:23.832308] | Dataset: moocs | Sample type: pseudo_gt | Num samples: None | Hist length 7 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 20:38:05.828924] | Dataset: moocs | Sample type: pseudo_gt | Num samples: None | Hist length 6 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-15 20:45:36.092563] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-15 20:45:36.108198] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-15 20:45:36.572015] batch_size ................. 4096
[2022-05-15 20:45:36.572036] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-15 20:45:36.572056] cuda ....................... True
[2022-05-15 20:45:36.572060] data_path .................. data/apps/lsapp.tsv
[2022-05-15 20:45:36.572063] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 20:45:36.572066] device ..................... 7
[2022-05-15 20:45:36.572069] device_num ................. 0
[2022-05-15 20:45:36.572072] disable_tqdm ............... True
[2022-05-15 20:45:36.572077] do_test .................... False
[2022-05-15 20:45:36.572080] do_valid ................... True
[2022-05-15 20:45:36.572083] dont_print_args ............ True
[2022-05-15 20:45:36.572088] dont_shuffle ............... None
[2022-05-15 20:45:36.572095] dropout .................... 0.3
[2022-05-15 20:45:36.572100] estimate_type .............. <function beam_search_lower_bound at 0x7f11d0f2ad30>
[2022-05-15 20:45:36.572104] excluded_terms ............. [1]
[2022-05-15 20:45:36.572121] excluded_terms_list ........ [[]]
[2022-05-15 20:45:36.572124] finetune ................... False
[2022-05-15 20:45:36.572127] grad_clip .................. 1.0
[2022-05-15 20:45:36.572130] hidden_size ................ 512
[2022-05-15 20:45:36.572133] hist_len ................... 18
[2022-05-15 20:45:36.572136] hybrid_max_num_beams ....... 1500
[2022-05-15 20:45:36.572139] interp_func ................ <function lin_interp at 0x7f11d0f2ac10>
[2022-05-15 20:45:36.572142] k_range .................... []
[2022-05-15 20:45:36.572160] log_interval ............... 100
[2022-05-15 20:45:36.572164] lr ......................... 0.001
[2022-05-15 20:45:36.572167] lr_decay_style ............. constant
[2022-05-15 20:45:36.572169] masked_lm .................. False
[2022-05-15 20:45:36.572172] max_num_mc_samples ......... 100000
[2022-05-15 20:45:36.572175] max_num_queries ............ 1000
[2022-05-15 20:45:36.572178] min_num_mc_samples ......... 10000
[2022-05-15 20:45:36.572181] min_phase_shift ............ 0
[2022-05-15 20:45:36.572184] min_var_reduction .......... 0.1
[2022-05-15 20:45:36.572187] min_variance ............... True
[2022-05-15 20:45:36.572190] model_budget_filepath ...... None
[2022-05-15 20:45:36.572193] needs_encoding ............. True
[2022-05-15 20:45:36.572196] num_beams .................. 0.0
[2022-05-15 20:45:36.572199] num_layers ................. 2
[2022-05-15 20:45:36.572202] num_mc_samples ............. 100
[2022-05-15 20:45:36.572204] num_workers ................ 0
[2022-05-15 20:45:36.572207] optimizer .................. adam
[2022-05-15 20:45:36.572210] proposal_func .............. <function lm_proposal at 0x7f11d0f18c10>
[2022-05-15 20:45:36.572213] rnn_type ................... LSTM
[2022-05-15 20:45:36.572216] save_epochs ................ 1
[2022-05-15 20:45:36.572218] seed ....................... 42
[2022-05-15 20:45:36.572221] seq_len .................... 15
[2022-05-15 20:45:36.572224] shuffle .................... True
[2022-05-15 20:45:36.572226] store_intermediate_lbs ..... True
[2022-05-15 20:45:36.572229] sub_estimates .............. []
[2022-05-15 20:45:36.572233] terms_of_interest .......... []
[2022-05-15 20:45:36.572236] text_dict .................. None
[2022-05-15 20:45:36.572239] top_k ...................... 0
[2022-05-15 20:45:36.572241] top_p ...................... 0
[2022-05-15 20:45:36.572244] total_seq_len .............. 20
[2022-05-15 20:45:36.572247] train_data_pct ............. 0.9
[2022-05-15 20:45:36.572249] train_epochs ............... 40
[2022-05-15 20:45:36.572252] use_gpt2 ................... False
[2022-05-15 20:45:36.572255] val_data_pct ............... 0.001
[2022-05-15 20:45:36.572259] val_metrics ................ ['accuracy']
[2022-05-15 20:45:36.572261] valid_epochs ............... 1
[2022-05-15 20:45:36.572266] variance_epsilon ........... 5e-06
[2022-05-15 20:45:36.572269] vocab_size ................. 88
[2022-05-15 20:45:36.572272] warmup_pct ................. 0.01
[2022-05-15 20:45:36.572275] weight_decay ............... 0.0
==================================================
[2022-05-15 20:45:36.572581] | Dataset: apps | Sample type: pseudo_gt | Num samples: None | Hist length 10 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 20:54:48.279916] | Dataset: apps | Sample type: pseudo_gt | Num samples: None | Hist length 7 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 21:08:00.971773] | Dataset: apps | Sample type: pseudo_gt | Num samples: None | Hist length 6 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-15 21:24:03.557149] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-15 21:24:03.578337] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-15 21:24:03.811270] batch_size ................. 4096
[2022-05-15 21:24:03.811293] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-15 21:24:03.811298] cuda ....................... True
[2022-05-15 21:24:03.811301] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-15 21:24:03.811304] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-15 21:24:03.811308] device ..................... 7
[2022-05-15 21:24:03.811311] device_num ................. 0
[2022-05-15 21:24:03.811314] disable_tqdm ............... True
[2022-05-15 21:24:03.811319] do_test .................... False
[2022-05-15 21:24:03.811322] do_valid ................... True
[2022-05-15 21:24:03.811324] dont_print_args ............ True
[2022-05-15 21:24:03.811328] dont_shuffle ............... None
[2022-05-15 21:24:03.811335] dropout .................... 0.3
[2022-05-15 21:24:03.811340] estimate_type .............. <function beam_search_lower_bound at 0x7f11d0f2ad30>
[2022-05-15 21:24:03.811344] excluded_terms ............. [1]
[2022-05-15 21:24:03.811367] excluded_terms_list ........ [[]]
[2022-05-15 21:24:03.811369] finetune ................... False
[2022-05-15 21:24:03.811373] grad_clip .................. 1.0
[2022-05-15 21:24:03.811376] hidden_size ................ 512
[2022-05-15 21:24:03.811379] hist_len ................... 18
[2022-05-15 21:24:03.811382] hybrid_max_num_beams ....... 1500
[2022-05-15 21:24:03.811385] interp_func ................ <function lin_interp at 0x7f11d0f2ac10>
[2022-05-15 21:24:03.811388] k_range .................... []
[2022-05-15 21:24:03.811407] log_interval ............... 100
[2022-05-15 21:24:03.811411] lr ......................... 0.001
[2022-05-15 21:24:03.811414] lr_decay_style ............. constant
[2022-05-15 21:24:03.811416] masked_lm .................. False
[2022-05-15 21:24:03.811419] max_num_mc_samples ......... 100000
[2022-05-15 21:24:03.811422] max_num_queries ............ 1000
[2022-05-15 21:24:03.811425] min_num_mc_samples ......... 10000
[2022-05-15 21:24:03.811428] min_phase_shift ............ 0
[2022-05-15 21:24:03.811431] min_var_reduction .......... 0.1
[2022-05-15 21:24:03.811433] min_variance ............... True
[2022-05-15 21:24:03.811436] model_budget_filepath ...... None
[2022-05-15 21:24:03.811440] num_beams .................. 0.0
[2022-05-15 21:24:03.811442] num_layers ................. 2
[2022-05-15 21:24:03.811445] num_mc_samples ............. 100
[2022-05-15 21:24:03.811448] num_workers ................ 0
[2022-05-15 21:24:03.811450] optimizer .................. adam
[2022-05-15 21:24:03.811453] proposal_func .............. <function lm_proposal at 0x7f11d0f18c10>
[2022-05-15 21:24:03.811456] rnn_type ................... LSTM
[2022-05-15 21:24:03.811459] save_epochs ................ 1
[2022-05-15 21:24:03.811462] seed ....................... 42
[2022-05-15 21:24:03.811465] seq_len .................... 15
[2022-05-15 21:24:03.811467] shuffle .................... True
[2022-05-15 21:24:03.811470] store_intermediate_lbs ..... True
[2022-05-15 21:24:03.811473] sub_estimates .............. []
[2022-05-15 21:24:03.811475] terms_of_interest .......... []
[2022-05-15 21:24:03.811480] text_dict .................. None
[2022-05-15 21:24:03.811482] top_k ...................... 0
[2022-05-15 21:24:03.811485] top_p ...................... 0
[2022-05-15 21:24:03.811487] total_seq_len .............. 20
[2022-05-15 21:24:03.811490] train_data_pct ............. 0.9
[2022-05-15 21:24:03.811493] train_epochs ............... 40
[2022-05-15 21:24:03.811495] use_gpt2 ................... False
[2022-05-15 21:24:03.811498] val_data_pct ............... 0.0001
[2022-05-15 21:24:03.811502] val_metrics ................ ['accuracy']
[2022-05-15 21:24:03.811505] valid_epochs ............... 1
[2022-05-15 21:24:03.811509] variance_epsilon ........... 5e-06
[2022-05-15 21:24:03.811511] vocab_size ................. 30
[2022-05-15 21:24:03.811514] warmup_pct ................. 0.01
[2022-05-15 21:24:03.811517] weight_decay ............... 0.0
==================================================
[2022-05-15 21:24:03.811738] | Dataset: amazon | Sample type: pseudo_gt | Num samples: None | Hist length 10 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 21:32:34.056591] | Dataset: amazon | Sample type: pseudo_gt | Num samples: None | Hist length 7 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-15 21:45:23.091617] | Dataset: amazon | Sample type: pseudo_gt | Num samples: None | Hist length 6 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
