==================================================
* Running for dataset shakespeare
==================================================
[2022-05-10 15:39:52.331649] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-10 15:39:52.340052] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-10 15:39:52.343600] batch_size ................. 4096
[2022-05-10 15:39:52.343615] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-10 15:39:52.343634] cuda ....................... True
[2022-05-10 15:39:52.343640] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-10 15:39:52.343645] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 15:39:52.343651] device ..................... 1
[2022-05-10 15:39:52.343657] device_num ................. 0
[2022-05-10 15:39:52.343662] disable_tqdm ............... True
[2022-05-10 15:39:52.343668] do_test .................... False
[2022-05-10 15:39:52.343674] do_valid ................... True
[2022-05-10 15:39:52.343680] dont_print_args ............ True
[2022-05-10 15:39:52.343686] dont_shuffle ............... None
[2022-05-10 15:39:52.343698] dropout .................... 0.3
[2022-05-10 15:39:52.343706] estimate_type .............. <function beam_search_lower_bound at 0x7f68bfafde50>
[2022-05-10 15:39:52.343713] excluded_terms ............. [1]
[2022-05-10 15:39:52.343719] finetune ................... False
[2022-05-10 15:39:52.343726] grad_clip .................. 1.0
[2022-05-10 15:39:52.343732] hidden_size ................ 128
[2022-05-10 15:39:52.343737] hist_len ................... 18
[2022-05-10 15:39:52.343744] interp_func ................ <function lin_interp at 0x7f68bfafdd30>
[2022-05-10 15:39:52.343749] log_interval ............... 100
[2022-05-10 15:39:52.343756] lr ......................... 0.001
[2022-05-10 15:39:52.343762] lr_decay_style ............. constant
[2022-05-10 15:39:52.343767] masked_lm .................. False
[2022-05-10 15:39:52.343773] min_phase_shift ............ 0
[2022-05-10 15:39:52.343779] min_var_reduction .......... 0.1
[2022-05-10 15:39:52.343785] min_variance ............... True
[2022-05-10 15:39:52.343790] model_budget_filepath ...... None
[2022-05-10 15:39:52.343796] num_beams .................. 0.0
[2022-05-10 15:39:52.343802] num_layers ................. 2
[2022-05-10 15:39:52.343807] num_mc_samples ............. 100
[2022-05-10 15:39:52.343813] num_workers ................ 0
[2022-05-10 15:39:52.343818] optimizer .................. adam
[2022-05-10 15:39:52.343824] proposal_func .............. <function lm_proposal at 0x7f68bfaf9d30>
[2022-05-10 15:39:52.343829] rnn_type ................... LSTM
[2022-05-10 15:39:52.343835] save_epochs ................ 1
[2022-05-10 15:39:52.343840] seed ....................... 42
[2022-05-10 15:39:52.343846] seq_len .................... 100
[2022-05-10 15:39:52.343851] shuffle .................... True
[2022-05-10 15:39:52.343857] store_intermediate_lbs ..... True
[2022-05-10 15:39:52.343862] sub_estimates .............. []
[2022-05-10 15:39:52.343868] text_dict .................. None
[2022-05-10 15:39:52.343873] top_k ...................... 0
[2022-05-10 15:39:52.343879] top_p ...................... 0
[2022-05-10 15:39:52.343884] total_seq_len .............. 20
[2022-05-10 15:39:52.343890] train_data_pct ............. 0.9
[2022-05-10 15:39:52.343896] train_epochs ............... 40
[2022-05-10 15:39:52.343902] val_data_pct ............... 0.05
[2022-05-10 15:39:52.343909] val_metrics ................ ['accuracy']
[2022-05-10 15:39:52.343914] valid_epochs ............... 1
[2022-05-10 15:39:52.343919] vocab_size ................. 68
[2022-05-10 15:39:52.343926] warmup_pct ................. 0.01
[2022-05-10 15:39:52.343931] weight_decay ............... 0.0
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 16 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 15 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.9 | Hist length 14 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.85 | Hist length 13 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-10 16:28:17.948903] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-10 16:28:17.959405] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-10 16:28:18.217815] batch_size ................. 4096
[2022-05-10 16:28:18.217851] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-10 16:28:18.217861] cuda ....................... True
[2022-05-10 16:28:18.217867] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-10 16:28:18.217872] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 16:28:18.217878] device ..................... 1
[2022-05-10 16:28:18.217884] device_num ................. 0
[2022-05-10 16:28:18.217890] disable_tqdm ............... True
[2022-05-10 16:28:18.217896] do_test .................... False
[2022-05-10 16:28:18.217902] do_valid ................... True
[2022-05-10 16:28:18.217907] dont_print_args ............ True
[2022-05-10 16:28:18.217915] dont_shuffle ............... None
[2022-05-10 16:28:18.217927] dropout .................... 0.3
[2022-05-10 16:28:18.217936] estimate_type .............. <function beam_search_lower_bound at 0x7f68bfafde50>
[2022-05-10 16:28:18.217945] excluded_terms ............. [1]
[2022-05-10 16:28:18.217952] finetune ................... False
[2022-05-10 16:28:18.217959] grad_clip .................. 1.0
[2022-05-10 16:28:18.217964] hidden_size ................ 512
[2022-05-10 16:28:18.217970] hist_len ................... 18
[2022-05-10 16:28:18.217977] interp_func ................ <function lin_interp at 0x7f68bfafdd30>
[2022-05-10 16:28:18.217982] log_interval ............... 100
[2022-05-10 16:28:18.217989] lr ......................... 0.001
[2022-05-10 16:28:18.217995] lr_decay_style ............. constant
[2022-05-10 16:28:18.218001] masked_lm .................. False
[2022-05-10 16:28:18.218006] min_phase_shift ............ 0
[2022-05-10 16:28:18.218012] min_var_reduction .......... 0.1
[2022-05-10 16:28:18.218018] min_variance ............... True
[2022-05-10 16:28:18.218024] model_budget_filepath ...... None
[2022-05-10 16:28:18.218030] num_beams .................. 0.0
[2022-05-10 16:28:18.218035] num_layers ................. 2
[2022-05-10 16:28:18.218041] num_mc_samples ............. 100
[2022-05-10 16:28:18.218046] num_workers ................ 0
[2022-05-10 16:28:18.218052] optimizer .................. adam
[2022-05-10 16:28:18.218058] proposal_func .............. <function lm_proposal at 0x7f68bfaf9d30>
[2022-05-10 16:28:18.218064] rnn_type ................... LSTM
[2022-05-10 16:28:18.218069] save_epochs ................ 1
[2022-05-10 16:28:18.218074] seed ....................... 42
[2022-05-10 16:28:18.218080] seq_len .................... 15
[2022-05-10 16:28:18.218085] shuffle .................... True
[2022-05-10 16:28:18.218091] store_intermediate_lbs ..... True
[2022-05-10 16:28:18.218096] sub_estimates .............. []
[2022-05-10 16:28:18.218102] text_dict .................. None
[2022-05-10 16:28:18.218108] top_k ...................... 0
[2022-05-10 16:28:18.218113] top_p ...................... 0
[2022-05-10 16:28:18.218118] total_seq_len .............. 20
[2022-05-10 16:28:18.218124] train_data_pct ............. 0.9
[2022-05-10 16:28:18.218130] train_epochs ............... 40
[2022-05-10 16:28:18.218136] val_data_pct ............... 0.0001
[2022-05-10 16:28:18.218143] val_metrics ................ ['accuracy']
[2022-05-10 16:28:18.218149] valid_epochs ............... 1
[2022-05-10 16:28:18.218154] vocab_size ................. 30
[2022-05-10 16:28:18.218161] warmup_pct ................. 0.01
[2022-05-10 16:28:18.218166] weight_decay ............... 0.0
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 11 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 10 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: beam_search | Num Beams: 0.9 | Hist length 9 | Total Seq Length 15

...................................