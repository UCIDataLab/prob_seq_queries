==================================================
* Running for dataset shakespeare
==================================================
[2022-05-10 14:19:03.098362] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-10 14:19:03.102599] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-10 14:19:03.106290] batch_size ................. 4096
[2022-05-10 14:19:03.106303] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-10 14:19:03.106311] cuda ....................... True
[2022-05-10 14:19:03.106316] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-10 14:19:03.106322] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-10 14:19:03.106327] device ..................... 1
[2022-05-10 14:19:03.106333] device_num ................. 0
[2022-05-10 14:19:03.106339] disable_tqdm ............... True
[2022-05-10 14:19:03.106345] do_test .................... False
[2022-05-10 14:19:03.106351] do_valid ................... True
[2022-05-10 14:19:03.106356] dont_print_args ............ True
[2022-05-10 14:19:03.106363] dont_shuffle ............... None
[2022-05-10 14:19:03.106375] dropout .................... 0.3
[2022-05-10 14:19:03.106383] estimate_type .............. <function beam_search_lower_bound at 0x7f849f38e0d0>
[2022-05-10 14:19:03.106391] excluded_terms ............. [1]
[2022-05-10 14:19:03.106398] finetune ................... False
[2022-05-10 14:19:03.106405] grad_clip .................. 1.0
[2022-05-10 14:19:03.106411] hidden_size ................ 128
[2022-05-10 14:19:03.106416] hist_len ................... 18
[2022-05-10 14:19:03.106423] interp_func ................ <function lin_interp at 0x7f849f38bf70>
[2022-05-10 14:19:03.106428] log_interval ............... 100
[2022-05-10 14:19:03.106435] lr ......................... 0.001
[2022-05-10 14:19:03.106441] lr_decay_style ............. constant
[2022-05-10 14:19:03.106446] masked_lm .................. False
[2022-05-10 14:19:03.106452] min_phase_shift ............ 0
[2022-05-10 14:19:03.106458] min_var_reduction .......... 0.1
[2022-05-10 14:19:03.106464] min_variance ............... True
[2022-05-10 14:19:03.106469] model_budget_filepath ...... None
[2022-05-10 14:19:03.106476] num_beams .................. 0.0
[2022-05-10 14:19:03.106482] num_layers ................. 2
[2022-05-10 14:19:03.106487] num_mc_samples ............. 100
[2022-05-10 14:19:03.106492] num_workers ................ 0
[2022-05-10 14:19:03.106498] optimizer .................. adam
[2022-05-10 14:19:03.106504] proposal_func .............. <function lm_proposal at 0x7f849f389f70>
[2022-05-10 14:19:03.106509] rnn_type ................... LSTM
[2022-05-10 14:19:03.106514] save_epochs ................ 1
[2022-05-10 14:19:03.106520] seed ....................... 0
[2022-05-10 14:19:03.106525] seq_len .................... 100
[2022-05-10 14:19:03.106530] shuffle .................... True
[2022-05-10 14:19:03.106536] store_intermediate_lbs ..... True
[2022-05-10 14:19:03.106542] sub_estimates .............. []
[2022-05-10 14:19:03.106548] text_dict .................. None
[2022-05-10 14:19:03.106553] top_k ...................... 0
[2022-05-10 14:19:03.106558] top_p ...................... 0
[2022-05-10 14:19:03.106564] total_seq_len .............. 20
[2022-05-10 14:19:03.106570] train_data_pct ............. 0.9
[2022-05-10 14:19:03.106575] train_epochs ............... 40
[2022-05-10 14:19:03.106581] val_data_pct ............... 0.05
[2022-05-10 14:19:03.106588] val_metrics ................ ['accuracy']
[2022-05-10 14:19:03.106593] valid_epochs ............... 1
[2022-05-10 14:19:03.106598] vocab_size ................. 68
[2022-05-10 14:19:03.106604] warmup_pct ................. 0.01
[2022-05-10 14:19:03.106610] weight_decay ............... 0.0
==================================================
Traceback (most recent call last):
  File "scripts/get_beam_search_lower_bound.py", line 80, in <module>
    if model_budget:
NameError: name 'model_budget' is not defined
