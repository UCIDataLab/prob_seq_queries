==================================================
* Running for dataset shakespeare
==================================================
[2022-05-18 08:21:12.085316] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-18 08:21:12.088665] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-18 08:21:12.095358] batch_size ................. 8000
[2022-05-18 08:21:12.095382] bs_ablation ................ False
[2022-05-18 08:21:12.095389] bs_ablation_max_beams ...... 10000
[2022-05-18 08:21:12.095395] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-18 08:21:12.095401] cuda ....................... True
[2022-05-18 08:21:12.095406] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-18 08:21:12.095412] dataset .................... shakespeare
[2022-05-18 08:21:12.095418] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-18 08:21:12.095424] device ..................... 6
[2022-05-18 08:21:12.095429] device_num ................. 0
[2022-05-18 08:21:12.095435] disable_tqdm ............... True
[2022-05-18 08:21:12.095440] do_test .................... False
[2022-05-18 08:21:12.095446] do_valid ................... True
[2022-05-18 08:21:12.095452] dont_print_args ............ True
[2022-05-18 08:21:12.095458] dont_shuffle ............... None
[2022-05-18 08:21:12.095473] dropout .................... 0.3
[2022-05-18 08:21:12.095481] estimate_type .............. <function beam_search_lower_bound at 0x7f5f14e13ee0>
[2022-05-18 08:21:12.095489] excluded_terms ............. [1]
[2022-05-18 08:21:12.095495] excluded_terms_list ........ [[]]
[2022-05-18 08:21:12.095501] finetune ................... False
[2022-05-18 08:21:12.095507] grad_clip .................. 1.0
[2022-05-18 08:21:12.095513] hidden_size ................ 128
[2022-05-18 08:21:12.095518] hist_len ................... 18
[2022-05-18 08:21:12.095523] hybrid_max_num_beams ....... 1500
[2022-05-18 08:21:12.095530] interp_func ................ <function lin_interp at 0x7f5f14e13dc0>
[2022-05-18 08:21:12.095536] log_interval ............... 100
[2022-05-18 08:21:12.095542] lr ......................... 0.001
[2022-05-18 08:21:12.095548] lr_decay_style ............. constant
[2022-05-18 08:21:12.095554] masked_lm .................. False
[2022-05-18 08:21:12.095560] max_k ...................... None
[2022-05-18 08:21:12.095575] max_num_mc_samples ......... 100000
[2022-05-18 08:21:12.095581] max_num_queries ............ 1000
[2022-05-18 08:21:12.095586] min_num_mc_samples ......... 10000
[2022-05-18 08:21:12.095592] min_phase_shift ............ 0
[2022-05-18 08:21:12.095598] min_var_reduction .......... 0.1
[2022-05-18 08:21:12.095604] min_variance ............... True
[2022-05-18 08:21:12.095609] model_budget_filepath ...... None
[2022-05-18 08:21:12.095615] needs_dl ................... True
[2022-05-18 08:21:12.095621] num_beams .................. 0.0
[2022-05-18 08:21:12.095626] num_layers ................. 2
[2022-05-18 08:21:12.095632] num_mc_samples ............. 100
[2022-05-18 08:21:12.095637] num_workers ................ 0
[2022-05-18 08:21:12.095643] optimizer .................. adam
[2022-05-18 08:21:12.095649] proposal_func .............. <function lm_proposal at 0x7f5f14dffdc0>
[2022-05-18 08:21:12.095654] rnn_type ................... LSTM
[2022-05-18 08:21:12.095660] save_epochs ................ 1
[2022-05-18 08:21:12.095665] seed ....................... 42
[2022-05-18 08:21:12.095671] seq_len .................... 100
[2022-05-18 08:21:12.095677] shuffle .................... True
[2022-05-18 08:21:12.095682] store_intermediate_lbs ..... True
[2022-05-18 08:21:12.095688] sub_estimates .............. []
[2022-05-18 08:21:12.095694] tau_a_excl_terms ........... []
[2022-05-18 08:21:12.095699] tau_b_excl_terms ........... []
[2022-05-18 08:21:12.095705] terms_of_interest .......... []
[2022-05-18 08:21:12.095710] text_dict .................. None
[2022-05-18 08:21:12.095716] top_k ...................... 0
[2022-05-18 08:21:12.095721] top_p ...................... 0
[2022-05-18 08:21:12.095727] total_seq_len .............. 20
[2022-05-18 08:21:12.095733] train_data_pct ............. 0.9
[2022-05-18 08:21:12.095738] train_epochs ............... 40
[2022-05-18 08:21:12.095744] use_gpt2 ................... False
[2022-05-18 08:21:12.095749] val_data_pct ............... 0.05
[2022-05-18 08:21:12.095756] val_metrics ................ ['accuracy']
[2022-05-18 08:21:12.095761] valid_epochs ............... 1
[2022-05-18 08:21:12.095770] variance_epsilon ........... 5e-06
[2022-05-18 08:21:12.095775] vocab_size ................. 68
[2022-05-18 08:21:12.095781] warmup_pct ................. 0.01
[2022-05-18 08:21:12.095787] weight_decay ............... 0.0
==================================================
[2022-05-18 08:21:12.096281] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 10 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

..................