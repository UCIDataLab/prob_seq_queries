[2022-05-05 14:12:03.073754] batch_size .......... 2048
[2022-05-05 14:12:03.073781] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-05 14:12:03.073789] cuda ................ True
[2022-05-05 14:12:03.073795] data_path ........... /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-05 14:12:03.073801] device_num .......... 7
[2022-05-05 14:12:03.073806] disable_tqdm ........ True
[2022-05-05 14:12:03.073812] do_test ............. False
[2022-05-05 14:12:03.073818] do_valid ............ True
[2022-05-05 14:12:03.073823] dont_print_args ..... False
[2022-05-05 14:12:03.073830] dont_shuffle ........ None
[2022-05-05 14:12:03.073842] dropout ............. 0.3
[2022-05-05 14:12:03.073850] estimate_type ....... <function mc_estimate at 0x7f5ec90d2430>
[2022-05-05 14:12:03.073858] excluded_terms ...... [1]
[2022-05-05 14:12:03.073864] finetune ............ False
[2022-05-05 14:12:03.073870] grad_clip ........... 1.0
[2022-05-05 14:12:03.073876] hidden_size ......... 512
[2022-05-05 14:12:03.073881] hist_len ............ 18
[2022-05-05 14:12:03.073888] interp_func ......... <function lin_interp at 0x7f5ec90d2790>
[2022-05-05 14:12:03.073893] log_interval ........ 100
[2022-05-05 14:12:03.073901] lr .................. 0.001
[2022-05-05 14:12:03.073907] lr_decay_style ...... constant
[2022-05-05 14:12:03.073912] masked_lm ........... False
[2022-05-05 14:12:03.073918] min_var_reduction ... 0.0
[2022-05-05 14:12:03.073924] min_variance ........ False
[2022-05-05 14:12:03.073930] num_beams ........... 0.85
[2022-05-05 14:12:03.073936] num_layers .......... 2
[2022-05-05 14:12:03.073942] num_mc_samples ...... 10000
[2022-05-05 14:12:03.073947] num_workers ......... 0
[2022-05-05 14:12:03.073952] optimizer ........... adam
[2022-05-05 14:12:03.073959] proposal_func ....... <function lm_proposal at 0x7f5ec90cc9d0>
[2022-05-05 14:12:03.073964] rnn_type ............ LSTM
[2022-05-05 14:12:03.073969] save_epochs ......... 1
[2022-05-05 14:12:03.073975] seed ................ 1234321
[2022-05-05 14:12:03.073981] seq_len ............. 15
[2022-05-05 14:12:03.073986] shuffle ............. True
[2022-05-05 14:12:03.073992] sub_estimates ....... []
[2022-05-05 14:12:03.073997] top_k ............... 0
[2022-05-05 14:12:03.074003] top_p ............... 0
[2022-05-05 14:12:03.074008] total_seq_len ....... 20
[2022-05-05 14:12:03.074014] train_data_pct ...... 0.9
[2022-05-05 14:12:03.074020] train_epochs ........ 40
[2022-05-05 14:12:03.074026] val_data_pct ........ 0.0001
[2022-05-05 14:12:03.074032] val_metrics ......... ['accuracy']
[2022-05-05 14:12:03.074038] valid_epochs ........ 1
[2022-05-05 14:12:03.074043] vocab_size .......... 30
[2022-05-05 14:12:03.074052] warmup_pct .......... 0.01
[2022-05-05 14:12:03.074058] weight_decay ........ 0.0
==================================================
[2022-05-05 14:12:03.117345] batch_size .......... 2048
[2022-05-05 14:12:03.117368] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-05 14:12:03.117377] cuda ................ True
[2022-05-05 14:12:03.117382] data_path ........... /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-05 14:12:03.117388] device_num .......... 7
[2022-05-05 14:12:03.117394] disable_tqdm ........ True
[2022-05-05 14:12:03.117400] do_test ............. False
[2022-05-05 14:12:03.117405] do_valid ............ True
[2022-05-05 14:12:03.117411] dont_print_args ..... False
[2022-05-05 14:12:03.117417] dont_shuffle ........ None
[2022-05-05 14:12:03.117429] dropout ............. 0.3
[2022-05-05 14:12:03.117436] estimate_type ....... <function mc_estimate at 0x7f5ec90d2430>
[2022-05-05 14:12:03.117444] excluded_terms ...... [1]
[2022-05-05 14:12:03.117450] finetune ............ False
[2022-05-05 14:12:03.117457] grad_clip ........... 1.0
[2022-05-05 14:12:03.117462] hidden_size ......... 512
[2022-05-05 14:12:03.117467] hist_len ............ 18
[2022-05-05 14:12:03.117473] interp_func ......... <function lin_interp at 0x7f5ec90d2790>
[2022-05-05 14:12:03.117479] log_interval ........ 100
[2022-05-05 14:12:03.117486] lr .................. 0.001
[2022-05-05 14:12:03.117491] lr_decay_style ...... constant
[2022-05-05 14:12:03.117497] masked_lm ........... False
[2022-05-05 14:12:03.117503] min_var_reduction ... 0.0
[2022-05-05 14:12:03.117509] min_variance ........ False
[2022-05-05 14:12:03.117515] num_beams ........... 0.85
[2022-05-05 14:12:03.117520] num_layers .......... 2
[2022-05-05 14:12:03.117526] num_mc_samples ...... 10000
[2022-05-05 14:12:03.117531] num_workers ......... 0
[2022-05-05 14:12:03.117536] optimizer ........... adam
[2022-05-05 14:12:03.117543] proposal_func ....... <function lm_proposal at 0x7f5ec90cc9d0>
[2022-05-05 14:12:03.117548] rnn_type ............ LSTM
[2022-05-05 14:12:03.117553] save_epochs ......... 1
[2022-05-05 14:12:03.117559] seed ................ 1234321
[2022-05-05 14:12:03.117564] seq_len ............. 15
[2022-05-05 14:12:03.117570] shuffle ............. True
[2022-05-05 14:12:03.117575] sub_estimates ....... []
[2022-05-05 14:12:03.117581] top_k ............... 0
[2022-05-05 14:12:03.117586] top_p ............... 0
[2022-05-05 14:12:03.117591] total_seq_len ....... 20
[2022-05-05 14:12:03.117597] train_data_pct ...... 0.9
[2022-05-05 14:12:03.117602] train_epochs ........ 40
[2022-05-05 14:12:03.117609] val_data_pct ........ 0.0001
[2022-05-05 14:12:03.117615] val_metrics ......... ['accuracy']
[2022-05-05 14:12:03.117621] valid_epochs ........ 1
[2022-05-05 14:12:03.117626] vocab_size .......... 30
[2022-05-05 14:12:03.117632] warmup_pct .......... 0.01
[2022-05-05 14:12:03.117637] weight_decay ........ 0.0
==================================================
[2022-05-05 14:14:37.759738] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-05 14:14:37.769851] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-05 14:14:38.381270] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_000.pt
{'loss': 1.7337634563446045, 'accuracy': 50.924482345581055}
==================================================
[2022-05-05 14:14:38.617032] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_001.pt
{'loss': 1.7326478064060211, 'accuracy': 50.996639251708984}
==================================================
[2022-05-05 14:14:38.749985] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_002.pt
{'loss': 1.731614887714386, 'accuracy': 50.97488307952881}
==================================================
[2022-05-05 14:14:38.886431] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_003.pt
{'loss': 1.7301785051822662, 'accuracy': 51.015249252319336}
==================================================
[2022-05-05 14:14:39.013924] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_004.pt
{'loss': 1.7295593917369843, 'accuracy': 51.062124252319336}
==================================================
[2022-05-05 14:14:39.108584] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_005.pt
{'loss': 1.7291169166564941, 'accuracy': 51.017632484436035}
==================================================
[2022-05-05 14:14:39.200981] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_006.pt
{'loss': 1.7288238406181335, 'accuracy': 51.03564739227295}
==================================================
[2022-05-05 14:14:39.316909] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_007.pt
{'loss': 1.728197067975998, 'accuracy': 51.032283782958984}
==================================================
[2022-05-05 14:14:39.440044] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_008.pt
{'loss': 1.7278973758220673, 'accuracy': 51.045305252075195}
==================================================
[2022-05-05 14:14:39.535305] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_009.pt
{'loss': 1.72764453291893, 'accuracy': 51.03380298614502}
==================================================
[2022-05-05 14:14:39.631470] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_010.pt
{'loss': 1.72744882106781, 'accuracy': 51.04324150085449}
==================================================
[2022-05-05 14:14:39.748799] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_011.pt
{'loss': 1.727128118276596, 'accuracy': 51.07259464263916}
==================================================
[2022-05-05 14:14:39.844552] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_012.pt
{'loss': 1.726744294166565, 'accuracy': 51.03597164154053}
==================================================
[2022-05-05 14:14:39.928063] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_013.pt
{'loss': 1.7264710068702698, 'accuracy': 51.05913829803467}
==================================================
[2022-05-05 14:14:40.011679] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_014.pt
{'loss': 1.7257746756076813, 'accuracy': 51.120718002319336}
==================================================
[2022-05-05 14:14:40.095878] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_015.pt
{'loss': 1.7266213297843933, 'accuracy': 51.072322845458984}
==================================================
[2022-05-05 14:14:40.180144] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_016.pt
{'loss': 1.7263445258140564, 'accuracy': 51.09022521972656}
==================================================
[2022-05-05 14:14:40.263262] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_017.pt
{'loss': 1.7260155975818634, 'accuracy': 51.077205657958984}
==================================================
[2022-05-05 14:14:40.347484] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_018.pt
{'loss': 1.7260733842849731, 'accuracy': 51.1171350479126}
==================================================
[2022-05-05 14:14:40.457180] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_019.pt
{'loss': 1.7261170744895935, 'accuracy': 51.0746545791626}
==================================================
[2022-05-05 14:14:40.560629] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_020.pt
{'loss': 1.7258311212062836, 'accuracy': 51.09472846984863}
==================================================
[2022-05-05 14:14:40.682622] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_021.pt
{'loss': 1.725926250219345, 'accuracy': 51.05631637573242}
==================================================
[2022-05-05 14:14:40.780293] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_022.pt
{'loss': 1.725418895483017, 'accuracy': 51.05604553222656}
==================================================
[2022-05-05 14:14:40.906614] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_023.pt
{'loss': 1.7255939543247223, 'accuracy': 51.12565231323242}
==================================================
[2022-05-05 14:14:41.071385] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_024.pt
{'loss': 1.7254474461078644, 'accuracy': 51.116700172424316}
==================================================
[2022-05-05 14:14:41.194238] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_025.pt
{'loss': 1.7255087494850159, 'accuracy': 51.141225814819336}
==================================================
[2022-05-05 14:14:41.280126] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_026.pt
{'loss': 1.7251401841640472, 'accuracy': 51.09879684448242}
==================================================
[2022-05-05 14:14:41.463206] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_027.pt
{'loss': 1.7253265380859375, 'accuracy': 51.07058525085449}
==================================================
[2022-05-05 14:14:41.581668] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_028.pt
{'loss': 1.7247419655323029, 'accuracy': 51.106934547424316}
==================================================
[2022-05-05 14:14:41.664080] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_029.pt
{'loss': 1.7246487140655518, 'accuracy': 51.20198917388916}
==================================================
[2022-05-05 14:14:41.780020] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_030.pt
{'loss': 1.724978893995285, 'accuracy': 51.08973693847656}
==================================================
[2022-05-05 14:14:41.890581] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_031.pt
{'loss': 1.7241843938827515, 'accuracy': 51.1241340637207}
==================================================
[2022-05-05 14:14:41.988356] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_032.pt
{'loss': 1.7249441742897034, 'accuracy': 51.10129356384277}
==================================================
[2022-05-05 14:14:42.147958] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_033.pt
{'loss': 1.7245805263519287, 'accuracy': 51.12283229827881}
==================================================
[2022-05-05 14:14:42.295446] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_034.pt
{'loss': 1.7246467471122742, 'accuracy': 51.10937690734863}
==================================================
[2022-05-05 14:14:42.401541] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_035.pt
{'loss': 1.7241584658622742, 'accuracy': 51.14974117279053}
==================================================
[2022-05-05 14:14:42.495351] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_036.pt
{'loss': 1.7246636152267456, 'accuracy': 51.141714096069336}
==================================================
[2022-05-05 14:14:42.764803] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_037.pt
{'loss': 1.7242353558540344, 'accuracy': 51.117082595825195}
==================================================
[2022-05-05 14:14:42.848848] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_038.pt
{'loss': 1.7247358560562134, 'accuracy': 51.10867214202881}
==================================================
[2022-05-05 14:14:42.934290] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_039.pt
{'loss': 1.724962830543518, 'accuracy': 51.13379096984863}
==================================================
[2022-05-05 14:14:43.068808] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_040.pt
{'loss': 1.724962830543518, 'accuracy': 51.13379096984863}
==================================================
[2022-05-05 14:14:43.182824] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_041.pt
{'loss': 1.7240141332149506, 'accuracy': 51.174211502075195}
==================================================
[2022-05-05 14:14:43.266578] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_044.pt
{'loss': 1.7241052091121674, 'accuracy': 51.12407875061035}
==================================================
[2022-05-05 14:14:43.350833] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_047.pt
{'loss': 1.7239599227905273, 'accuracy': 51.16683101654053}
==================================================
[2022-05-05 14:14:43.457219] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_050.pt
{'loss': 1.723921924829483, 'accuracy': 51.221192359924316}
==================================================
[2022-05-05 14:14:43.572309] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_053.pt
{'loss': 1.7239151000976562, 'accuracy': 51.176218032836914}
==================================================
[2022-05-05 14:14:43.673782] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_056.pt
{'loss': 1.7238619923591614, 'accuracy': 51.158748626708984}
==================================================
[2022-05-05 14:14:43.756971] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_059.pt
{'loss': 1.724052518606186, 'accuracy': 51.14035511016846}
==================================================
[2022-05-05 14:14:43.851616] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_062.pt
{'loss': 1.7249063849449158, 'accuracy': 51.12776851654053}
==================================================
[2022-05-05 14:14:43.935884] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_065.pt
{'loss': 1.7256572842597961, 'accuracy': 51.10200023651123}
==================================================
[2022-05-05 14:14:44.021119] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_068.pt
{'loss': 1.7256892621517181, 'accuracy': 51.14279842376709}
==================================================
[2022-05-05 14:14:44.118641] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_071.pt
{'loss': 1.7254639267921448, 'accuracy': 51.145729064941406}
==================================================
[2022-05-05 14:14:44.203574] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_074.pt
{'loss': 1.7252565324306488, 'accuracy': 51.11887168884277}
==================================================
[2022-05-05 14:14:44.288981] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_077.pt
{'loss': 1.7251317501068115, 'accuracy': 51.1000452041626}
==================================================
[2022-05-05 14:14:44.382239] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_080.pt
{'loss': 1.726394385099411, 'accuracy': 51.08491039276123}
==================================================
[2022-05-05 14:14:44.504111] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_083.pt
{'loss': 1.7245861887931824, 'accuracy': 51.12245273590088}
==================================================
[2022-05-05 14:14:44.595796] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_086.pt
{'loss': 1.7248158156871796, 'accuracy': 51.031413078308105}
==================================================
[2022-05-05 14:14:44.684403] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_089.pt
{'loss': 1.7245215475559235, 'accuracy': 51.14491271972656}
==================================================
[2022-05-05 14:14:44.770528] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_092.pt
{'loss': 1.7245411574840546, 'accuracy': 51.13221836090088}
==================================================
[2022-05-05 14:14:44.857974] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_095.pt
{'loss': 1.724787712097168, 'accuracy': 51.11756896972656}
==================================================
[2022-05-05 14:14:44.960527] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_098.pt
{'loss': 1.724367618560791, 'accuracy': 51.12814712524414}
==================================================
[2022-05-05 14:14:45.044346] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
{'loss': 1.7246723473072052, 'accuracy': 51.091421127319336}
==================================================
