==================================================
* Running for dataset shakespeare
==================================================
[2022-05-16 15:37:16.307931] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-16 15:37:16.311217] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-16 15:37:16.312912] batch_size ................. 4096
[2022-05-16 15:37:16.312924] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-16 15:37:16.312935] cuda ....................... True
[2022-05-16 15:37:16.312940] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-16 15:37:16.312943] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-16 15:37:16.312946] device ..................... 1
[2022-05-16 15:37:16.312949] device_num ................. 0
[2022-05-16 15:37:16.312953] disable_tqdm ............... True
[2022-05-16 15:37:16.312956] do_test .................... False
[2022-05-16 15:37:16.312960] do_valid ................... True
[2022-05-16 15:37:16.312963] dont_print_args ............ True
[2022-05-16 15:37:16.312968] dont_shuffle ............... None
[2022-05-16 15:37:16.312976] dropout .................... 0.3
[2022-05-16 15:37:16.312981] estimate_type .............. <function beam_search_lower_bound at 0x7f4b8f78f9d0>
[2022-05-16 15:37:16.312985] excluded_terms ............. [1]
[2022-05-16 15:37:16.312990] excluded_terms_list ........ [[]]
[2022-05-16 15:37:16.312993] finetune ................... False
[2022-05-16 15:37:16.312997] grad_clip .................. 1.0
[2022-05-16 15:37:16.313001] hidden_size ................ 128
[2022-05-16 15:37:16.313004] hist_len ................... 18
[2022-05-16 15:37:16.313008] hybrid_max_num_beams ....... 1500
[2022-05-16 15:37:16.313012] interp_func ................ <function lin_interp at 0x7f4b8f78f8b0>
[2022-05-16 15:37:16.313015] log_interval ............... 100
[2022-05-16 15:37:16.313019] lr ......................... 0.001
[2022-05-16 15:37:16.313023] lr_decay_style ............. constant
[2022-05-16 15:37:16.313026] masked_lm .................. False
[2022-05-16 15:37:16.313030] max_k ...................... None
[2022-05-16 15:37:16.313033] max_num_mc_samples ......... 100000
[2022-05-16 15:37:16.313036] max_num_queries ............ 1000
[2022-05-16 15:37:16.313040] min_num_mc_samples ......... 10000
[2022-05-16 15:37:16.313043] min_phase_shift ............ 0
[2022-05-16 15:37:16.313047] min_var_reduction .......... 0.1
[2022-05-16 15:37:16.313050] min_variance ............... True
[2022-05-16 15:37:16.313053] model_budget_filepath ...... None
[2022-05-16 15:37:16.313057] num_beams .................. 0.0
[2022-05-16 15:37:16.313060] num_layers ................. 2
[2022-05-16 15:37:16.313063] num_mc_samples ............. 100
[2022-05-16 15:37:16.313067] num_workers ................ 0
[2022-05-16 15:37:16.313070] optimizer .................. adam
[2022-05-16 15:37:16.313074] proposal_func .............. <function lm_proposal at 0x7f4b8f77e940>
[2022-05-16 15:37:16.313077] rnn_type ................... LSTM
[2022-05-16 15:37:16.313080] save_epochs ................ 1
[2022-05-16 15:37:16.313083] seed ....................... 42
[2022-05-16 15:37:16.313086] seq_len .................... 100
[2022-05-16 15:37:16.313090] shuffle .................... True
[2022-05-16 15:37:16.313093] store_intermediate_lbs ..... True
[2022-05-16 15:37:16.313096] sub_estimates .............. []
[2022-05-16 15:37:16.313099] tau_a_excl_terms ........... []
[2022-05-16 15:37:16.313102] tau_b_excl_terms ........... []
[2022-05-16 15:37:16.313106] terms_of_interest .......... []
[2022-05-16 15:37:16.313109] text_dict .................. None
[2022-05-16 15:37:16.313112] top_k ...................... 0
[2022-05-16 15:37:16.313115] top_p ...................... 0
[2022-05-16 15:37:16.313118] total_seq_len .............. 20
[2022-05-16 15:37:16.313122] train_data_pct ............. 0.9
[2022-05-16 15:37:16.313125] train_epochs ............... 40
[2022-05-16 15:37:16.313128] use_gpt2 ................... False
[2022-05-16 15:37:16.313132] val_data_pct ............... 0.05
[2022-05-16 15:37:16.313136] val_metrics ................ ['accuracy']
[2022-05-16 15:37:16.313139] valid_epochs ............... 1
[2022-05-16 15:37:16.313144] variance_epsilon ........... 5e-06
[2022-05-16 15:37:16.313147] vocab_size ................. 68
[2022-05-16 15:37:16.313150] warmup_pct ................. 0.01
[2022-05-16 15:37:16.313154] weight_decay ............... 0.0
==================================================
[2022-05-16 15:37:16.313516] | Dataset: shakespeare | Sample type: entropy_ablation | Num samples: 10000 | Hist length 10 | Total Seq Length 20

...........................................................................