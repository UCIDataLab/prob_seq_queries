==================================================
* Running for dataset moocs
==================================================
[2022-05-20 16:23:07.031346] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-20 16:23:07.034692] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-20 16:23:07.092733] batch_size ................. 8000
[2022-05-20 16:23:07.092759] bs_ablation ................ False
[2022-05-20 16:23:07.092764] bs_ablation_max_beams ...... 10000
[2022-05-20 16:23:07.092768] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-20 16:23:07.092772] cuda ....................... True
[2022-05-20 16:23:07.092776] data_path .................. data/moocs/mooc.csv
[2022-05-20 16:23:07.092780] dataset .................... moocs
[2022-05-20 16:23:07.092784] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 16:23:07.092788] device ..................... 2
[2022-05-20 16:23:07.092791] device_num ................. 0
[2022-05-20 16:23:07.092795] disable_tqdm ............... True
[2022-05-20 16:23:07.092799] do_test .................... False
[2022-05-20 16:23:07.092803] do_valid ................... True
[2022-05-20 16:23:07.092806] dont_print_args ............ True
[2022-05-20 16:23:07.092813] dont_shuffle ............... None
[2022-05-20 16:23:07.092823] dropout .................... 0.3
[2022-05-20 16:23:07.092829] estimate_type .............. <function beam_search_lower_bound at 0x7fd1aad63ca0>
[2022-05-20 16:23:07.092845] excluded_terms ............. [1]
[2022-05-20 16:23:07.092849] excluded_terms_list ........ [[]]
[2022-05-20 16:23:07.092853] finetune ................... False
[2022-05-20 16:23:07.092857] frequentist_test ........... False
[2022-05-20 16:23:07.092861] grad_clip .................. 1.0
[2022-05-20 16:23:07.092865] hidden_size ................ 128
[2022-05-20 16:23:07.092868] hist_len ................... 18
[2022-05-20 16:23:07.092872] hybrid_max_num_beams ....... 1500
[2022-05-20 16:23:07.092878] interp_func ................ <function lin_interp at 0x7fd1aad63b80>
[2022-05-20 16:23:07.092881] log_interval ............... 100
[2022-05-20 16:23:07.092886] lr ......................... 0.001
[2022-05-20 16:23:07.092889] lr_decay_style ............. constant
[2022-05-20 16:23:07.092893] masked_lm .................. False
[2022-05-20 16:23:07.092897] max_k ...................... None
[2022-05-20 16:23:07.092900] max_num_mc_samples ......... 100000
[2022-05-20 16:23:07.092904] max_num_queries ............ 1000
[2022-05-20 16:23:07.092907] min_num_mc_samples ......... 10000
[2022-05-20 16:23:07.092910] min_phase_shift ............ 0
[2022-05-20 16:23:07.092915] min_var_reduction .......... 0.1
[2022-05-20 16:23:07.092918] min_variance ............... True
[2022-05-20 16:23:07.092922] model_budget_filepath ...... None
[2022-05-20 16:23:07.092925] needs_dl ................... True
[2022-05-20 16:23:07.092929] needs_encoding ............. False
[2022-05-20 16:23:07.092932] num_beams .................. 0.0
[2022-05-20 16:23:07.092936] num_layers ................. 2
[2022-05-20 16:23:07.092939] num_mc_samples ............. 100
[2022-05-20 16:23:07.092943] num_workers ................ 0
[2022-05-20 16:23:07.092946] optimizer .................. adam
[2022-05-20 16:23:07.092950] proposal_func .............. <function lm_proposal at 0x7fd1aad4fb80>
[2022-05-20 16:23:07.092953] rnn_type ................... LSTM
[2022-05-20 16:23:07.092957] save_epochs ................ 1
[2022-05-20 16:23:07.092960] seed ....................... 42
[2022-05-20 16:23:07.092964] seq_len .................... 15
[2022-05-20 16:23:07.092967] shuffle .................... True
[2022-05-20 16:23:07.092970] store_intermediate_lbs ..... True
[2022-05-20 16:23:07.092974] sub_estimates .............. []
[2022-05-20 16:23:07.092978] tau_a_excl_terms ........... []
[2022-05-20 16:23:07.092981] tau_b_excl_terms ........... []
[2022-05-20 16:23:07.092984] terms_of_interest .......... []
[2022-05-20 16:23:07.092988] text_dict .................. None
[2022-05-20 16:23:07.092992] top_k ...................... 0
[2022-05-20 16:23:07.092996] top_p ...................... 0
[2022-05-20 16:23:07.092999] total_seq_len .............. 20
[2022-05-20 16:23:07.093003] train_data_pct ............. 0.9
[2022-05-20 16:23:07.093006] train_epochs ............... 40
[2022-05-20 16:23:07.093010] use_gpt2 ................... False
[2022-05-20 16:23:07.093013] val_data_pct ............... 0.01
[2022-05-20 16:23:07.093020] val_metrics ................ ['accuracy']
[2022-05-20 16:23:07.093023] valid_epochs ............... 1
[2022-05-20 16:23:07.093028] variance_epsilon ........... 5e-06
[2022-05-20 16:23:07.093032] vocab_size ................. 98
[2022-05-20 16:23:07.093035] warmup_pct ................. 0.01
[2022-05-20 16:23:07.093039] weight_decay ............... 0.0
==================================================
[2022-05-20 16:23:07.093706] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 10000 | Hist length 5 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-20 17:35:45.775147] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 10000 | Hist length 9 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
[2022-05-20 18:36:24.507373] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 10000 | Hist length 13 | Total Seq Length 15 | Max num queries: 1000

....................................................................................................
==================================================
