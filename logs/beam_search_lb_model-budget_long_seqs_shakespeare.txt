==================================================
* Running for dataset shakespeare
==================================================
[2022-05-13 11:01:21.452929] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-13 11:01:21.456188] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-13 11:01:21.459171] batch_size ................. 4096
[2022-05-13 11:01:21.459187] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-13 11:01:21.459200] cuda ....................... True
[2022-05-13 11:01:21.459207] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-13 11:01:21.459214] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 11:01:21.459220] device ..................... 5
[2022-05-13 11:01:21.459228] device_num ................. 0
[2022-05-13 11:01:21.459235] disable_tqdm ............... True
[2022-05-13 11:01:21.459242] do_test .................... False
[2022-05-13 11:01:21.459249] do_valid ................... True
[2022-05-13 11:01:21.459256] dont_print_args ............ True
[2022-05-13 11:01:21.459263] dont_shuffle ............... None
[2022-05-13 11:01:21.459276] dropout .................... 0.3
[2022-05-13 11:01:21.459286] estimate_type .............. <function beam_search_lower_bound at 0x7f365229eca0>
[2022-05-13 11:01:21.459295] excluded_terms ............. [1]
[2022-05-13 11:01:21.459303] finetune ................... False
[2022-05-13 11:01:21.459311] grad_clip .................. 1.0
[2022-05-13 11:01:21.459317] hidden_size ................ 128
[2022-05-13 11:01:21.459324] hist_len ................... 18
[2022-05-13 11:01:21.459331] hybrid_max_num_beams ....... 1500
[2022-05-13 11:01:21.459339] interp_func ................ <function lin_interp at 0x7f365229eb80>
[2022-05-13 11:01:21.459346] log_interval ............... 100
[2022-05-13 11:01:21.459354] lr ......................... 0.001
[2022-05-13 11:01:21.459361] lr_decay_style ............. constant
[2022-05-13 11:01:21.459368] masked_lm .................. False
[2022-05-13 11:01:21.459375] max_num_mc_samples ......... 100000
[2022-05-13 11:01:21.459381] max_num_queries ............ 1000
[2022-05-13 11:01:21.459388] min_num_mc_samples ......... 10000
[2022-05-13 11:01:21.459395] min_phase_shift ............ 0
[2022-05-13 11:01:21.459402] min_var_reduction .......... 0.1
[2022-05-13 11:01:21.459409] min_variance ............... True
[2022-05-13 11:01:21.459416] model_budget_filepath ...... None
[2022-05-13 11:01:21.459423] num_beams .................. 0.0
[2022-05-13 11:01:21.459430] num_layers ................. 2
[2022-05-13 11:01:21.459436] num_mc_samples ............. 100
[2022-05-13 11:01:21.459443] num_workers ................ 0
[2022-05-13 11:01:21.459450] optimizer .................. adam
[2022-05-13 11:01:21.459457] proposal_func .............. <function lm_proposal at 0x7f365228db80>
[2022-05-13 11:01:21.459464] rnn_type ................... LSTM
[2022-05-13 11:01:21.459470] save_epochs ................ 1
[2022-05-13 11:01:21.459477] seed ....................... 42
[2022-05-13 11:01:21.459484] seq_len .................... 100
[2022-05-13 11:01:21.459490] shuffle .................... True
[2022-05-13 11:01:21.459497] store_intermediate_lbs ..... True
[2022-05-13 11:01:21.459504] sub_estimates .............. []
[2022-05-13 11:01:21.459511] text_dict .................. None
[2022-05-13 11:01:21.459518] top_k ...................... 0
[2022-05-13 11:01:21.459525] top_p ...................... 0
[2022-05-13 11:01:21.459531] total_seq_len .............. 20
[2022-05-13 11:01:21.459539] train_data_pct ............. 0.9
[2022-05-13 11:01:21.459545] train_epochs ............... 40
[2022-05-13 11:01:21.459552] use_gpt2 ................... False
[2022-05-13 11:01:21.459559] val_data_pct ............... 0.05
[2022-05-13 11:01:21.459579] val_metrics ................ ['accuracy']
[2022-05-13 11:01:21.459586] valid_epochs ............... 1
[2022-05-13 11:01:21.459595] variance_epsilon ........... 5e-06
[2022-05-13 11:01:21.459602] vocab_size ................. 68
[2022-05-13 11:01:21.459610] warmup_pct ................. 0.01
[2022-05-13 11:01:21.459617] weight_decay ............... 0.0
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_10h_20s_1000mc_1000q.pkl
[2022-05-13 11:01:21.460252] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 10 | Total Seq Length 20

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_12h_20s_1000mc_1000q.pkl
[2022-05-13 11:02:16.795441] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 12 | Total Seq Length 20

....................................................................................................
==================================================
/home/showalte/research/prob_seq_queries/data/beam_search_is_hybrid/shakespeare/val_dl/val-dl_shakespeare_beam-search-is-hybrid_16h_20s_1000mc_1000q.pkl
[2022-05-13 11:02:45.198701] | Dataset: shakespeare | Sample type: beam_search | Num Beams: 0.8 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
