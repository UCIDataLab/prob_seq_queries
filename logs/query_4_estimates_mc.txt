==================================================
* Running for dataset shakespeare
==================================================
[2022-05-23 21:04:34.861698] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-23 21:04:34.865358] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-23 21:04:34.867546] batch_size ................. 8192
[2022-05-23 21:04:34.867574] bs_ablation ................ False
[2022-05-23 21:04:34.867579] bs_ablation_max_beams ...... 10000
[2022-05-23 21:04:34.867583] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-23 21:04:34.867587] cuda ....................... True
[2022-05-23 21:04:34.867590] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-23 21:04:34.867594] dataset .................... shakespeare
[2022-05-23 21:04:34.867598] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 21:04:34.867601] device ..................... 6
[2022-05-23 21:04:34.867605] device_num ................. 0
[2022-05-23 21:04:34.867609] disable_tqdm ............... True
[2022-05-23 21:04:34.867612] do_test .................... False
[2022-05-23 21:04:34.867616] do_valid ................... True
[2022-05-23 21:04:34.867620] dont_print_args ............ True
[2022-05-23 21:04:34.867628] dont_shuffle ............... None
[2022-05-23 21:04:34.867636] dropout .................... 0.3
[2022-05-23 21:04:34.867641] estimate_type .............. <function beam_search_lower_bound at 0x7fef64c52d30>
[2022-05-23 21:04:34.867646] excluded_terms ............. [1]
[2022-05-23 21:04:34.867650] excluded_terms_list ........ [[]]
[2022-05-23 21:04:34.867654] finetune ................... False
[2022-05-23 21:04:34.867657] frequentist_test ........... False
[2022-05-23 21:04:34.867661] grad_clip .................. 1.0
[2022-05-23 21:04:34.867665] hidden_size ................ 128
[2022-05-23 21:04:34.867668] hist_len ................... 18
[2022-05-23 21:04:34.867672] hybrid_max_num_beams ....... 1500
[2022-05-23 21:04:34.867676] interp_func ................ <function lin_interp at 0x7fef64c52c10>
[2022-05-23 21:04:34.867679] log_interval ............... 100
[2022-05-23 21:04:34.867684] lr ......................... 0.001
[2022-05-23 21:04:34.867687] lr_decay_style ............. constant
[2022-05-23 21:04:34.867691] masked_lm .................. False
[2022-05-23 21:04:34.867694] max_k ...................... None
[2022-05-23 21:04:34.867698] max_num_mc_samples ......... 100000
[2022-05-23 21:04:34.867701] max_num_queries ............ 1000
[2022-05-23 21:04:34.867704] min_num_mc_samples ......... 10000
[2022-05-23 21:04:34.867708] min_phase_shift ............ 0
[2022-05-23 21:04:34.867712] min_var_reduction .......... 0.1
[2022-05-23 21:04:34.867715] min_variance ............... False
[2022-05-23 21:04:34.867718] model_budget_filepath ...... None
[2022-05-23 21:04:34.867722] needs_dl ................... True
[2022-05-23 21:04:34.867726] num_beams .................. 0.0
[2022-05-23 21:04:34.867729] num_layers ................. 2
[2022-05-23 21:04:34.867733] num_mc_samples ............. 100
[2022-05-23 21:04:34.867736] num_workers ................ 0
[2022-05-23 21:04:34.867740] optimizer .................. adam
[2022-05-23 21:04:34.867743] proposal_func .............. <function lm_proposal at 0x7fef64c3ec10>
[2022-05-23 21:04:34.867747] rnn_type ................... LSTM
[2022-05-23 21:04:34.867750] save_epochs ................ 1
[2022-05-23 21:04:34.867753] seed ....................... 42
[2022-05-23 21:04:34.867756] seq_len .................... 100
[2022-05-23 21:04:34.867760] shuffle .................... True
[2022-05-23 21:04:34.867763] store_intermediate_lbs ..... True
[2022-05-23 21:04:34.867767] sub_estimates .............. []
[2022-05-23 21:04:34.867771] tau_a_excl_terms ........... [18, 46]
[2022-05-23 21:04:34.867775] tau_b_excl_terms ........... [43, 48, 49, 52, 63, 15, 20, 21, 24, 35]
[2022-05-23 21:04:34.867779] terms_of_interest .......... []
[2022-05-23 21:04:34.867782] text_dict .................. None
[2022-05-23 21:04:34.867785] top_k ...................... 0
[2022-05-23 21:04:34.867789] top_p ...................... 0
[2022-05-23 21:04:34.867792] total_seq_len .............. 20
[2022-05-23 21:04:34.867796] train_data_pct ............. 0.9
[2022-05-23 21:04:34.867799] train_epochs ............... 40
[2022-05-23 21:04:34.867802] use_gpt2 ................... False
[2022-05-23 21:04:34.867806] val_data_pct ............... 0.05
[2022-05-23 21:04:34.867814] val_metrics ................ ['accuracy']
[2022-05-23 21:04:34.867818] valid_epochs ............... 1
[2022-05-23 21:04:34.867823] variance_epsilon ........... 5e-06
[2022-05-23 21:04:34.867827] vocab_size ................. 68
[2022-05-23 21:04:34.867831] warmup_pct ................. 0.01
[2022-05-23 21:04:34.867834] weight_decay ............... 0.0
==================================================
[2022-05-23 21:04:34.868368] | Dataset: shakespeare | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-23 21:16:17.908666] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-23 21:16:17.918090] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-23 21:16:18.224171] batch_size ................. 8192
[2022-05-23 21:16:18.224194] bs_ablation ................ False
[2022-05-23 21:16:18.224199] bs_ablation_max_beams ...... 10000
[2022-05-23 21:16:18.224203] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-23 21:16:18.224206] cuda ....................... True
[2022-05-23 21:16:18.224210] data_path .................. data/apps/lsapp.tsv
[2022-05-23 21:16:18.224213] dataset .................... apps
[2022-05-23 21:16:18.224217] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 21:16:18.224220] device ..................... 6
[2022-05-23 21:16:18.224224] device_num ................. 0
[2022-05-23 21:16:18.224228] disable_tqdm ............... True
[2022-05-23 21:16:18.224232] do_test .................... False
[2022-05-23 21:16:18.224236] do_valid ................... True
[2022-05-23 21:16:18.224239] dont_print_args ............ True
[2022-05-23 21:16:18.224244] dont_shuffle ............... None
[2022-05-23 21:16:18.224268] dropout .................... 0.3
[2022-05-23 21:16:18.224274] estimate_type .............. <function beam_search_lower_bound at 0x7fef64c52d30>
[2022-05-23 21:16:18.224280] excluded_terms ............. [1]
[2022-05-23 21:16:18.224284] excluded_terms_list ........ [[]]
[2022-05-23 21:16:18.224289] finetune ................... False
[2022-05-23 21:16:18.224292] frequentist_test ........... False
[2022-05-23 21:16:18.224296] grad_clip .................. 1.0
[2022-05-23 21:16:18.224300] hidden_size ................ 512
[2022-05-23 21:16:18.224303] hist_len ................... 18
[2022-05-23 21:16:18.224307] hybrid_max_num_beams ....... 1500
[2022-05-23 21:16:18.224311] interp_func ................ <function lin_interp at 0x7fef64c52c10>
[2022-05-23 21:16:18.224314] log_interval ............... 100
[2022-05-23 21:16:18.224318] lr ......................... 0.001
[2022-05-23 21:16:18.224324] lr_decay_style ............. constant
[2022-05-23 21:16:18.224327] masked_lm .................. False
[2022-05-23 21:16:18.224331] max_k ...................... None
[2022-05-23 21:16:18.224334] max_num_mc_samples ......... 100000
[2022-05-23 21:16:18.224337] max_num_queries ............ 1000
[2022-05-23 21:16:18.224341] min_num_mc_samples ......... 10000
[2022-05-23 21:16:18.224344] min_phase_shift ............ 0
[2022-05-23 21:16:18.224348] min_var_reduction .......... 0.1
[2022-05-23 21:16:18.224352] min_variance ............... False
[2022-05-23 21:16:18.224355] model_budget_filepath ...... None
[2022-05-23 21:16:18.224359] needs_dl ................... True
[2022-05-23 21:16:18.224362] needs_encoding ............. True
[2022-05-23 21:16:18.224366] num_beams .................. 0.0
[2022-05-23 21:16:18.224369] num_layers ................. 2
[2022-05-23 21:16:18.224373] num_mc_samples ............. 100
[2022-05-23 21:16:18.224376] num_workers ................ 0
[2022-05-23 21:16:18.224379] optimizer .................. adam
[2022-05-23 21:16:18.224383] proposal_func .............. <function lm_proposal at 0x7fef64c3ec10>
[2022-05-23 21:16:18.224386] rnn_type ................... LSTM
[2022-05-23 21:16:18.224390] save_epochs ................ 1
[2022-05-23 21:16:18.224393] seed ....................... 42
[2022-05-23 21:16:18.224396] seq_len .................... 15
[2022-05-23 21:16:18.224400] shuffle .................... True
[2022-05-23 21:16:18.224403] store_intermediate_lbs ..... True
[2022-05-23 21:16:18.224407] sub_estimates .............. []
[2022-05-23 21:16:18.224413] tau_a_excl_terms ........... [3, 14, 16, 23, 30, 39, 44, 40, 41, 51, 60, 73, 74, 79, 81, 82, 84]
[2022-05-23 21:16:18.224419] tau_b_excl_terms ........... [18, 19, 33, 34, 47, 78, 52, 55, 57, 67]
[2022-05-23 21:16:18.224422] terms_of_interest .......... []
[2022-05-23 21:16:18.224426] text_dict .................. None
[2022-05-23 21:16:18.224430] top_k ...................... 0
[2022-05-23 21:16:18.224433] top_p ...................... 0
[2022-05-23 21:16:18.224436] total_seq_len .............. 20
[2022-05-23 21:16:18.224441] train_data_pct ............. 0.9
[2022-05-23 21:16:18.224444] train_epochs ............... 40
[2022-05-23 21:16:18.224447] use_gpt2 ................... False
[2022-05-23 21:16:18.224451] val_data_pct ............... 0.001
[2022-05-23 21:16:18.224455] val_metrics ................ ['accuracy']
[2022-05-23 21:16:18.224459] valid_epochs ............... 1
[2022-05-23 21:16:18.224468] variance_epsilon ........... 5e-06
[2022-05-23 21:16:18.224472] vocab_size ................. 88
[2022-05-23 21:16:18.224476] warmup_pct ................. 0.01
[2022-05-23 21:16:18.224479] weight_decay ............... 0.0
==================================================
[2022-05-23 21:16:18.224899] | Dataset: apps | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-23 21:47:23.674421] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-23 21:47:23.677560] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-23 21:47:23.747348] batch_size ................. 8192
[2022-05-23 21:47:23.747366] bs_ablation ................ False
[2022-05-23 21:47:23.747373] bs_ablation_max_beams ...... 10000
[2022-05-23 21:47:23.747378] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-23 21:47:23.747384] cuda ....................... True
[2022-05-23 21:47:23.747390] data_path .................. data/moocs/mooc.csv
[2022-05-23 21:47:23.747395] dataset .................... moocs
[2022-05-23 21:47:23.747401] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 21:47:23.747406] device ..................... 6
[2022-05-23 21:47:23.747412] device_num ................. 0
[2022-05-23 21:47:23.747417] disable_tqdm ............... True
[2022-05-23 21:47:23.747423] do_test .................... False
[2022-05-23 21:47:23.747429] do_valid ................... True
[2022-05-23 21:47:23.747434] dont_print_args ............ True
[2022-05-23 21:47:23.747441] dont_shuffle ............... None
[2022-05-23 21:47:23.747463] dropout .................... 0.3
[2022-05-23 21:47:23.747471] estimate_type .............. <function beam_search_lower_bound at 0x7fef64c52d30>
[2022-05-23 21:47:23.747480] excluded_terms ............. [1]
[2022-05-23 21:47:23.747487] excluded_terms_list ........ [[]]
[2022-05-23 21:47:23.747493] finetune ................... False
[2022-05-23 21:47:23.747499] frequentist_test ........... False
[2022-05-23 21:47:23.747505] grad_clip .................. 1.0
[2022-05-23 21:47:23.747510] hidden_size ................ 128
[2022-05-23 21:47:23.747516] hist_len ................... 18
[2022-05-23 21:47:23.747522] hybrid_max_num_beams ....... 1500
[2022-05-23 21:47:23.747528] interp_func ................ <function lin_interp at 0x7fef64c52c10>
[2022-05-23 21:47:23.747534] log_interval ............... 100
[2022-05-23 21:47:23.747540] lr ......................... 0.001
[2022-05-23 21:47:23.747547] lr_decay_style ............. constant
[2022-05-23 21:47:23.747553] masked_lm .................. False
[2022-05-23 21:47:23.747559] max_k ...................... None
[2022-05-23 21:47:23.747573] max_num_mc_samples ......... 100000
[2022-05-23 21:47:23.747579] max_num_queries ............ 1000
[2022-05-23 21:47:23.747584] min_num_mc_samples ......... 10000
[2022-05-23 21:47:23.747590] min_phase_shift ............ 0
[2022-05-23 21:47:23.747597] min_var_reduction .......... 0.1
[2022-05-23 21:47:23.747602] min_variance ............... False
[2022-05-23 21:47:23.747608] model_budget_filepath ...... None
[2022-05-23 21:47:23.747613] needs_dl ................... True
[2022-05-23 21:47:23.747619] needs_encoding ............. False
[2022-05-23 21:47:23.747625] num_beams .................. 0.0
[2022-05-23 21:47:23.747632] num_layers ................. 2
[2022-05-23 21:47:23.747637] num_mc_samples ............. 100
[2022-05-23 21:47:23.747642] num_workers ................ 0
[2022-05-23 21:47:23.747647] optimizer .................. adam
[2022-05-23 21:47:23.747653] proposal_func .............. <function lm_proposal at 0x7fef64c3ec10>
[2022-05-23 21:47:23.747659] rnn_type ................... LSTM
[2022-05-23 21:47:23.747664] save_epochs ................ 1
[2022-05-23 21:47:23.747670] seed ....................... 42
[2022-05-23 21:47:23.747675] seq_len .................... 15
[2022-05-23 21:47:23.747680] shuffle .................... True
[2022-05-23 21:47:23.747686] store_intermediate_lbs ..... True
[2022-05-23 21:47:23.747691] sub_estimates .............. []
[2022-05-23 21:47:23.747699] tau_a_excl_terms ........... [13, 8, 21, 7]
[2022-05-23 21:47:23.747706] tau_b_excl_terms ........... [51, 33, 16, 27, 15, 24, 53]
[2022-05-23 21:47:23.747711] terms_of_interest .......... []
[2022-05-23 21:47:23.747717] text_dict .................. None
[2022-05-23 21:47:23.747723] top_k ...................... 0
[2022-05-23 21:47:23.747728] top_p ...................... 0
[2022-05-23 21:47:23.747734] total_seq_len .............. 20
[2022-05-23 21:47:23.747740] train_data_pct ............. 0.9
[2022-05-23 21:47:23.747745] train_epochs ............... 40
[2022-05-23 21:47:23.747751] use_gpt2 ................... False
[2022-05-23 21:47:23.747756] val_data_pct ............... 0.01
[2022-05-23 21:47:23.747763] val_metrics ................ ['accuracy']
[2022-05-23 21:47:23.747769] valid_epochs ............... 1
[2022-05-23 21:47:23.747777] variance_epsilon ........... 5e-06
[2022-05-23 21:47:23.747782] vocab_size ................. 98
[2022-05-23 21:47:23.747788] warmup_pct ................. 0.01
[2022-05-23 21:47:23.747794] weight_decay ............... 0.0
==================================================
[2022-05-23 21:47:23.748550] | Dataset: moocs | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-23 22:00:23.343586] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-23 22:00:23.355792] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-23 22:00:23.537007] batch_size ................. 8192
[2022-05-23 22:00:23.537037] bs_ablation ................ False
[2022-05-23 22:00:23.537041] bs_ablation_max_beams ...... 10000
[2022-05-23 22:00:23.537045] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-23 22:00:23.537049] cuda ....................... True
[2022-05-23 22:00:23.537053] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-23 22:00:23.537057] dataset .................... amazon
[2022-05-23 22:00:23.537061] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-23 22:00:23.537066] device ..................... 6
[2022-05-23 22:00:23.537070] device_num ................. 0
[2022-05-23 22:00:23.537073] disable_tqdm ............... True
[2022-05-23 22:00:23.537077] do_test .................... False
[2022-05-23 22:00:23.537081] do_valid ................... True
[2022-05-23 22:00:23.537084] dont_print_args ............ True
[2022-05-23 22:00:23.537089] dont_shuffle ............... None
[2022-05-23 22:00:23.537115] dropout .................... 0.3
[2022-05-23 22:00:23.537122] estimate_type .............. <function beam_search_lower_bound at 0x7fef64c52d30>
[2022-05-23 22:00:23.537129] excluded_terms ............. [1]
[2022-05-23 22:00:23.537133] excluded_terms_list ........ [[]]
[2022-05-23 22:00:23.537138] finetune ................... False
[2022-05-23 22:00:23.537141] frequentist_test ........... False
[2022-05-23 22:00:23.537146] grad_clip .................. 1.0
[2022-05-23 22:00:23.537149] hidden_size ................ 512
[2022-05-23 22:00:23.537152] hist_len ................... 18
[2022-05-23 22:00:23.537156] hybrid_max_num_beams ....... 1500
[2022-05-23 22:00:23.537160] interp_func ................ <function lin_interp at 0x7fef64c52c10>
[2022-05-23 22:00:23.537163] log_interval ............... 100
[2022-05-23 22:00:23.537168] lr ......................... 0.001
[2022-05-23 22:00:23.537172] lr_decay_style ............. constant
[2022-05-23 22:00:23.537175] masked_lm .................. False
[2022-05-23 22:00:23.537179] max_k ...................... None
[2022-05-23 22:00:23.537182] max_num_mc_samples ......... 100000
[2022-05-23 22:00:23.537186] max_num_queries ............ 1000
[2022-05-23 22:00:23.537189] min_num_mc_samples ......... 10000
[2022-05-23 22:00:23.537193] min_phase_shift ............ 0
[2022-05-23 22:00:23.537197] min_var_reduction .......... 0.1
[2022-05-23 22:00:23.537201] min_variance ............... False
[2022-05-23 22:00:23.537205] model_budget_filepath ...... None
[2022-05-23 22:00:23.537208] needs_dl ................... True
[2022-05-23 22:00:23.537212] num_beams .................. 0.0
[2022-05-23 22:00:23.537216] num_layers ................. 2
[2022-05-23 22:00:23.537220] num_mc_samples ............. 100
[2022-05-23 22:00:23.537223] num_workers ................ 0
[2022-05-23 22:00:23.537226] optimizer .................. adam
[2022-05-23 22:00:23.537230] proposal_func .............. <function lm_proposal at 0x7fef64c3ec10>
[2022-05-23 22:00:23.537234] rnn_type ................... LSTM
[2022-05-23 22:00:23.537237] save_epochs ................ 1
[2022-05-23 22:00:23.537240] seed ....................... 42
[2022-05-23 22:00:23.537244] seq_len .................... 15
[2022-05-23 22:00:23.537247] shuffle .................... True
[2022-05-23 22:00:23.537251] store_intermediate_lbs ..... True
[2022-05-23 22:00:23.537254] sub_estimates .............. []
[2022-05-23 22:00:23.537258] tau_a_excl_terms ........... [2, 3, 9, 10]
[2022-05-23 22:00:23.537262] tau_b_excl_terms ........... [17, 19, 25, 28]
[2022-05-23 22:00:23.537266] terms_of_interest .......... []
[2022-05-23 22:00:23.537270] text_dict .................. None
[2022-05-23 22:00:23.537273] top_k ...................... 0
[2022-05-23 22:00:23.537277] top_p ...................... 0
[2022-05-23 22:00:23.537280] total_seq_len .............. 20
[2022-05-23 22:00:23.537284] train_data_pct ............. 0.9
[2022-05-23 22:00:23.537287] train_epochs ............... 40
[2022-05-23 22:00:23.537291] use_gpt2 ................... False
[2022-05-23 22:00:23.537295] val_data_pct ............... 0.0001
[2022-05-23 22:00:23.537300] val_metrics ................ ['accuracy']
[2022-05-23 22:00:23.537303] valid_epochs ............... 1
[2022-05-23 22:00:23.537309] variance_epsilon ........... 5e-06
[2022-05-23 22:00:23.537312] vocab_size ................. 30
[2022-05-23 22:00:23.537316] warmup_pct ................. 0.01
[2022-05-23 22:00:23.537320] weight_decay ............... 0.0
==================================================
[2022-05-23 22:00:23.537566] | Dataset: amazon | Sample type: query_4 | Num samples: 10000 | Hist length 10 | Total Seq Length 15 | Pseudo GT: False | Model Budget: False

....................................................................................................
==================================================
