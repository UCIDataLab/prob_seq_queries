==================================================
* Running for dataset shakespeare
==================================================
[2022-05-13 11:31:43.510055] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-13 11:31:43.513651] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-13 11:31:43.515332] batch_size ................. 4096
[2022-05-13 11:31:43.515343] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-13 11:31:43.515350] cuda ....................... True
[2022-05-13 11:31:43.515353] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-13 11:31:43.515355] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 11:31:43.515358] device ..................... 6
[2022-05-13 11:31:43.515361] device_num ................. 0
[2022-05-13 11:31:43.515364] disable_tqdm ............... True
[2022-05-13 11:31:43.515366] do_test .................... False
[2022-05-13 11:31:43.515369] do_valid ................... True
[2022-05-13 11:31:43.515372] dont_print_args ............ True
[2022-05-13 11:31:43.515376] dont_shuffle ............... None
[2022-05-13 11:31:43.515383] dropout .................... 0.3
[2022-05-13 11:31:43.515388] estimate_type .............. <function beam_search_lower_bound at 0x7f2ed77f6c10>
[2022-05-13 11:31:43.515393] excluded_terms ............. [1]
[2022-05-13 11:31:43.515396] finetune ................... False
[2022-05-13 11:31:43.515399] grad_clip .................. 1.0
[2022-05-13 11:31:43.515402] hidden_size ................ 128
[2022-05-13 11:31:43.515404] hist_len ................... 18
[2022-05-13 11:31:43.515407] hybrid_max_num_beams ....... 1500
[2022-05-13 11:31:43.515410] interp_func ................ <function lin_interp at 0x7f2ed77f6af0>
[2022-05-13 11:31:43.515412] log_interval ............... 100
[2022-05-13 11:31:43.515416] lr ......................... 0.001
[2022-05-13 11:31:43.515418] lr_decay_style ............. constant
[2022-05-13 11:31:43.515421] masked_lm .................. False
[2022-05-13 11:31:43.515423] max_num_mc_samples ......... 100000
[2022-05-13 11:31:43.515426] max_num_queries ............ 1000
[2022-05-13 11:31:43.515428] min_num_mc_samples ......... 10000
[2022-05-13 11:31:43.515431] min_phase_shift ............ 0
[2022-05-13 11:31:43.515434] min_var_reduction .......... 0.1
[2022-05-13 11:31:43.515436] min_variance ............... True
[2022-05-13 11:31:43.515439] model_budget_filepath ...... None
[2022-05-13 11:31:43.515442] num_beams .................. 0.0
[2022-05-13 11:31:43.515444] num_layers ................. 2
[2022-05-13 11:31:43.515447] num_mc_samples ............. 100
[2022-05-13 11:31:43.515449] num_workers ................ 0
[2022-05-13 11:31:43.515452] optimizer .................. adam
[2022-05-13 11:31:43.515455] proposal_func .............. <function lm_proposal at 0x7f2ed77e2af0>
[2022-05-13 11:31:43.515457] rnn_type ................... LSTM
[2022-05-13 11:31:43.515460] save_epochs ................ 1
[2022-05-13 11:31:43.515462] seed ....................... 42
[2022-05-13 11:31:43.515464] seq_len .................... 100
[2022-05-13 11:31:43.515467] shuffle .................... True
[2022-05-13 11:31:43.515469] store_intermediate_lbs ..... True
[2022-05-13 11:31:43.515472] sub_estimates .............. []
[2022-05-13 11:31:43.515475] text_dict .................. None
[2022-05-13 11:31:43.515478] top_k ...................... 0
[2022-05-13 11:31:43.515480] top_p ...................... 0
[2022-05-13 11:31:43.515483] total_seq_len .............. 20
[2022-05-13 11:31:43.515486] train_data_pct ............. 0.9
[2022-05-13 11:31:43.515488] train_epochs ............... 40
[2022-05-13 11:31:43.515491] use_gpt2 ................... False
[2022-05-13 11:31:43.515493] val_data_pct ............... 0.05
[2022-05-13 11:31:43.515501] val_metrics ................ ['accuracy']
[2022-05-13 11:31:43.515504] valid_epochs ............... 1
[2022-05-13 11:31:43.515508] variance_epsilon ........... 5e-06
[2022-05-13 11:31:43.515510] vocab_size ................. 68
[2022-05-13 11:31:43.515513] warmup_pct ................. 0.01
[2022-05-13 11:31:43.515516] weight_decay ............... 0.0
==================================================
[2022-05-13 11:31:43.515948] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 16 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-13 11:33:36.309010] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 12 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-13 11:37:48.272530] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: None | Hist length 10 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-13 11:43:14.637318] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-13 11:43:14.647025] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-13 11:43:14.722436] batch_size ................. 4096
[2022-05-13 11:43:14.722453] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-13 11:43:14.722462] cuda ....................... True
[2022-05-13 11:43:14.722467] data_path .................. data/moocs/mooc.csv
[2022-05-13 11:43:14.722473] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 11:43:14.722479] device ..................... 6
[2022-05-13 11:43:14.722485] device_num ................. 0
[2022-05-13 11:43:14.722490] disable_tqdm ............... True
[2022-05-13 11:43:14.722497] do_test .................... False
[2022-05-13 11:43:14.722502] do_valid ................... True
[2022-05-13 11:43:14.722508] dont_print_args ............ True
[2022-05-13 11:43:14.722516] dont_shuffle ............... None
[2022-05-13 11:43:14.722527] dropout .................... 0.3
[2022-05-13 11:43:14.722534] estimate_type .............. <function beam_search_lower_bound at 0x7f2ed77f6c10>
[2022-05-13 11:43:14.722542] excluded_terms ............. [1]
[2022-05-13 11:43:14.722555] finetune ................... False
[2022-05-13 11:43:14.722562] grad_clip .................. 1.0
[2022-05-13 11:43:14.722567] hidden_size ................ 128
[2022-05-13 11:43:14.722572] hist_len ................... 18
[2022-05-13 11:43:14.722579] hybrid_max_num_beams ....... 1500
[2022-05-13 11:43:14.722585] interp_func ................ <function lin_interp at 0x7f2ed77f6af0>
[2022-05-13 11:43:14.722591] log_interval ............... 100
[2022-05-13 11:43:14.722598] lr ......................... 0.001
[2022-05-13 11:43:14.722603] lr_decay_style ............. constant
[2022-05-13 11:43:14.722609] masked_lm .................. False
[2022-05-13 11:43:14.722614] max_num_mc_samples ......... 100000
[2022-05-13 11:43:14.722620] max_num_queries ............ 1000
[2022-05-13 11:43:14.722625] min_num_mc_samples ......... 10000
[2022-05-13 11:43:14.722635] min_phase_shift ............ 0
[2022-05-13 11:43:14.722641] min_var_reduction .......... 0.1
[2022-05-13 11:43:14.722647] min_variance ............... True
[2022-05-13 11:43:14.722652] model_budget_filepath ...... None
[2022-05-13 11:43:14.722658] needs_encoding ............. False
[2022-05-13 11:43:14.722664] num_beams .................. 0.0
[2022-05-13 11:43:14.722673] num_layers ................. 2
[2022-05-13 11:43:14.722679] num_mc_samples ............. 100
[2022-05-13 11:43:14.722684] num_workers ................ 0
[2022-05-13 11:43:14.722690] optimizer .................. adam
[2022-05-13 11:43:14.722696] proposal_func .............. <function lm_proposal at 0x7f2ed77e2af0>
[2022-05-13 11:43:14.722701] rnn_type ................... LSTM
[2022-05-13 11:43:14.722707] save_epochs ................ 1
[2022-05-13 11:43:14.722713] seed ....................... 42
[2022-05-13 11:43:14.722719] seq_len .................... 15
[2022-05-13 11:43:14.722724] shuffle .................... True
[2022-05-13 11:43:14.722730] store_intermediate_lbs ..... True
[2022-05-13 11:43:14.722736] sub_estimates .............. []
[2022-05-13 11:43:14.722741] text_dict .................. None
[2022-05-13 11:43:14.722746] top_k ...................... 0
[2022-05-13 11:43:14.722752] top_p ...................... 0
[2022-05-13 11:43:14.722758] total_seq_len .............. 20
[2022-05-13 11:43:14.722764] train_data_pct ............. 0.9
[2022-05-13 11:43:14.722769] train_epochs ............... 40
[2022-05-13 11:43:14.722775] use_gpt2 ................... False
[2022-05-13 11:43:14.722780] val_data_pct ............... 0.01
[2022-05-13 11:43:14.722787] val_metrics ................ ['accuracy']
[2022-05-13 11:43:14.722792] valid_epochs ............... 1
[2022-05-13 11:43:14.722800] variance_epsilon ........... 5e-06
[2022-05-13 11:43:14.722806] vocab_size ................. 98
[2022-05-13 11:43:14.722812] warmup_pct ................. 0.01
[2022-05-13 11:43:14.722817] weight_decay ............... 0.0
==================================================
[2022-05-13 11:43:14.723532] | Dataset: moocs | Sample type: pseudo_gt | Num samples: None | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-13 11:45:53.358877] | Dataset: moocs | Sample type: pseudo_gt | Num samples: None | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-13 11:49:01.588741] | Dataset: moocs | Sample type: pseudo_gt | Num samples: None | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-13 11:54:08.525830] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-13 11:54:08.587108] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-13 11:54:08.921670] batch_size ................. 4096
[2022-05-13 11:54:08.921696] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-13 11:54:08.921702] cuda ....................... True
[2022-05-13 11:54:08.921706] data_path .................. data/apps/lsapp.tsv
[2022-05-13 11:54:08.921709] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 11:54:08.921713] device ..................... 6
[2022-05-13 11:54:08.921717] device_num ................. 0
[2022-05-13 11:54:08.921721] disable_tqdm ............... True
[2022-05-13 11:54:08.921728] do_test .................... False
[2022-05-13 11:54:08.921732] do_valid ................... True
[2022-05-13 11:54:08.921735] dont_print_args ............ True
[2022-05-13 11:54:08.921752] dont_shuffle ............... None
[2022-05-13 11:54:08.921759] dropout .................... 0.3
[2022-05-13 11:54:08.921765] estimate_type .............. <function beam_search_lower_bound at 0x7f2ed77f6c10>
[2022-05-13 11:54:08.921770] excluded_terms ............. [1]
[2022-05-13 11:54:08.921789] finetune ................... False
[2022-05-13 11:54:08.921794] grad_clip .................. 1.0
[2022-05-13 11:54:08.921798] hidden_size ................ 512
[2022-05-13 11:54:08.921801] hist_len ................... 18
[2022-05-13 11:54:08.921806] hybrid_max_num_beams ....... 1500
[2022-05-13 11:54:08.921810] interp_func ................ <function lin_interp at 0x7f2ed77f6af0>
[2022-05-13 11:54:08.921814] log_interval ............... 100
[2022-05-13 11:54:08.921818] lr ......................... 0.001
[2022-05-13 11:54:08.921832] lr_decay_style ............. constant
[2022-05-13 11:54:08.921836] masked_lm .................. False
[2022-05-13 11:54:08.921839] max_num_mc_samples ......... 100000
[2022-05-13 11:54:08.921843] max_num_queries ............ 1000
[2022-05-13 11:54:08.921847] min_num_mc_samples ......... 10000
[2022-05-13 11:54:08.921851] min_phase_shift ............ 0
[2022-05-13 11:54:08.921855] min_var_reduction .......... 0.1
[2022-05-13 11:54:08.921858] min_variance ............... True
[2022-05-13 11:54:08.921862] model_budget_filepath ...... None
[2022-05-13 11:54:08.921866] needs_encoding ............. True
[2022-05-13 11:54:08.921870] num_beams .................. 0.0
[2022-05-13 11:54:08.921876] num_layers ................. 2
[2022-05-13 11:54:08.921879] num_mc_samples ............. 100
[2022-05-13 11:54:08.921883] num_workers ................ 0
[2022-05-13 11:54:08.921886] optimizer .................. adam
[2022-05-13 11:54:08.921891] proposal_func .............. <function lm_proposal at 0x7f2ed77e2af0>
[2022-05-13 11:54:08.921894] rnn_type ................... LSTM
[2022-05-13 11:54:08.921898] save_epochs ................ 1
[2022-05-13 11:54:08.921902] seed ....................... 42
[2022-05-13 11:54:08.921905] seq_len .................... 15
[2022-05-13 11:54:08.921909] shuffle .................... True
[2022-05-13 11:54:08.921913] store_intermediate_lbs ..... True
[2022-05-13 11:54:08.921916] sub_estimates .............. []
[2022-05-13 11:54:08.921920] text_dict .................. None
[2022-05-13 11:54:08.921923] top_k ...................... 0
[2022-05-13 11:54:08.921928] top_p ...................... 0
[2022-05-13 11:54:08.921931] total_seq_len .............. 20
[2022-05-13 11:54:08.921935] train_data_pct ............. 0.9
[2022-05-13 11:54:08.921938] train_epochs ............... 40
[2022-05-13 11:54:08.921942] use_gpt2 ................... False
[2022-05-13 11:54:08.921946] val_data_pct ............... 0.001
[2022-05-13 11:54:08.921950] val_metrics ................ ['accuracy']
[2022-05-13 11:54:08.921953] valid_epochs ............... 1
[2022-05-13 11:54:08.921959] variance_epsilon ........... 5e-06
[2022-05-13 11:54:08.921963] vocab_size ................. 88
[2022-05-13 11:54:08.921967] warmup_pct ................. 0.01
[2022-05-13 11:54:08.921970] weight_decay ............... 0.0
==================================================
[2022-05-13 11:54:08.922328] | Dataset: apps | Sample type: pseudo_gt | Num samples: None | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-13 11:59:28.474130] | Dataset: apps | Sample type: pseudo_gt | Num samples: None | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-13 12:06:58.348350] | Dataset: apps | Sample type: pseudo_gt | Num samples: None | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-13 12:17:58.245082] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-13 12:17:58.338834] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-13 12:17:58.580051] batch_size ................. 4096
[2022-05-13 12:17:58.580073] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-13 12:17:58.580079] cuda ....................... True
[2022-05-13 12:17:58.580083] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-13 12:17:58.580086] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-13 12:17:58.580092] device ..................... 6
[2022-05-13 12:17:58.580095] device_num ................. 0
[2022-05-13 12:17:58.580098] disable_tqdm ............... True
[2022-05-13 12:17:58.580102] do_test .................... False
[2022-05-13 12:17:58.580105] do_valid ................... True
[2022-05-13 12:17:58.580108] dont_print_args ............ True
[2022-05-13 12:17:58.580113] dont_shuffle ............... None
[2022-05-13 12:17:58.580120] dropout .................... 0.3
[2022-05-13 12:17:58.580125] estimate_type .............. <function beam_search_lower_bound at 0x7f2ed77f6c10>
[2022-05-13 12:17:58.580130] excluded_terms ............. [1]
[2022-05-13 12:17:58.580150] finetune ................... False
[2022-05-13 12:17:58.580154] grad_clip .................. 1.0
[2022-05-13 12:17:58.580158] hidden_size ................ 512
[2022-05-13 12:17:58.580161] hist_len ................... 18
[2022-05-13 12:17:58.580165] hybrid_max_num_beams ....... 1500
[2022-05-13 12:17:58.580169] interp_func ................ <function lin_interp at 0x7f2ed77f6af0>
[2022-05-13 12:17:58.580172] log_interval ............... 100
[2022-05-13 12:17:58.580175] lr ......................... 0.001
[2022-05-13 12:17:58.580186] lr_decay_style ............. constant
[2022-05-13 12:17:58.580189] masked_lm .................. False
[2022-05-13 12:17:58.580192] max_num_mc_samples ......... 100000
[2022-05-13 12:17:58.580195] max_num_queries ............ 1000
[2022-05-13 12:17:58.580199] min_num_mc_samples ......... 10000
[2022-05-13 12:17:58.580202] min_phase_shift ............ 0
[2022-05-13 12:17:58.580206] min_var_reduction .......... 0.1
[2022-05-13 12:17:58.580209] min_variance ............... True
[2022-05-13 12:17:58.580212] model_budget_filepath ...... None
[2022-05-13 12:17:58.580216] num_beams .................. 0.0
[2022-05-13 12:17:58.580219] num_layers ................. 2
[2022-05-13 12:17:58.580224] num_mc_samples ............. 100
[2022-05-13 12:17:58.580227] num_workers ................ 0
[2022-05-13 12:17:58.580230] optimizer .................. adam
[2022-05-13 12:17:58.580234] proposal_func .............. <function lm_proposal at 0x7f2ed77e2af0>
[2022-05-13 12:17:58.580237] rnn_type ................... LSTM
[2022-05-13 12:17:58.580240] save_epochs ................ 1
[2022-05-13 12:17:58.580243] seed ....................... 42
[2022-05-13 12:17:58.580247] seq_len .................... 15
[2022-05-13 12:17:58.580250] shuffle .................... True
[2022-05-13 12:17:58.580253] store_intermediate_lbs ..... True
[2022-05-13 12:17:58.580257] sub_estimates .............. []
[2022-05-13 12:17:58.580260] text_dict .................. None
[2022-05-13 12:17:58.580263] top_k ...................... 0
[2022-05-13 12:17:58.580266] top_p ...................... 0
[2022-05-13 12:17:58.580270] total_seq_len .............. 20
[2022-05-13 12:17:58.580274] train_data_pct ............. 0.9
[2022-05-13 12:17:58.580277] train_epochs ............... 40
[2022-05-13 12:17:58.580280] use_gpt2 ................... False
[2022-05-13 12:17:58.580283] val_data_pct ............... 0.0001
[2022-05-13 12:17:58.580287] val_metrics ................ ['accuracy']
[2022-05-13 12:17:58.580290] valid_epochs ............... 1
[2022-05-13 12:17:58.580295] variance_epsilon ........... 5e-06
[2022-05-13 12:17:58.580299] vocab_size ................. 30
[2022-05-13 12:17:58.580303] warmup_pct ................. 0.01
[2022-05-13 12:17:58.580306] weight_decay ............... 0.0
==================================================
[2022-05-13 12:17:58.580518] | Dataset: amazon | Sample type: pseudo_gt | Num samples: None | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-13 12:23:48.882469] | Dataset: amazon | Sample type: pseudo_gt | Num samples: None | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
[2022-05-13 12:33:22.529872] | Dataset: amazon | Sample type: pseudo_gt | Num samples: None | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................
==================================================
