==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 13:18:29.702928] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 13:18:29.706487] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 13:18:29.708083] batch_size ................. 4096
[2022-05-12 13:18:29.708093] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 13:18:29.708099] cuda ....................... True
[2022-05-12 13:18:29.708102] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 13:18:29.708105] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:18:29.708108] device ..................... 3
[2022-05-12 13:18:29.708110] device_num ................. 0
[2022-05-12 13:18:29.708113] disable_tqdm ............... True
[2022-05-12 13:18:29.708116] do_test .................... False
[2022-05-12 13:18:29.708119] do_valid ................... True
[2022-05-12 13:18:29.708121] dont_print_args ............ True
[2022-05-12 13:18:29.708125] dont_shuffle ............... None
[2022-05-12 13:18:29.708131] dropout .................... 0.3
[2022-05-12 13:18:29.708136] estimate_type .............. <function beam_search_lower_bound at 0x7f3cafd92820>
[2022-05-12 13:18:29.708140] excluded_terms ............. [1]
[2022-05-12 13:18:29.708143] finetune ................... False
[2022-05-12 13:18:29.708146] grad_clip .................. 1.0
[2022-05-12 13:18:29.708149] hidden_size ................ 128
[2022-05-12 13:18:29.708151] hist_len ................... 18
[2022-05-12 13:18:29.708155] interp_func ................ <function lin_interp at 0x7f3cafd92700>
[2022-05-12 13:18:29.708157] log_interval ............... 100
[2022-05-12 13:18:29.708161] lr ......................... 0.001
[2022-05-12 13:18:29.708163] lr_decay_style ............. constant
[2022-05-12 13:18:29.708166] masked_lm .................. False
[2022-05-12 13:18:29.708168] max_num_mc_samples ......... 100000
[2022-05-12 13:18:29.708171] max_num_queries ............ None
[2022-05-12 13:18:29.708173] min_num_mc_samples ......... 10000
[2022-05-12 13:18:29.708175] min_phase_shift ............ 0
[2022-05-12 13:18:29.708178] min_var_reduction .......... 0.1
[2022-05-12 13:18:29.708181] min_variance ............... True
[2022-05-12 13:18:29.708183] model_budget_filepath ...... None
[2022-05-12 13:18:29.708186] num_beams .................. 0.0
[2022-05-12 13:18:29.708188] num_layers ................. 2
[2022-05-12 13:18:29.708191] num_mc_samples ............. 100
[2022-05-12 13:18:29.708193] num_workers ................ 0
[2022-05-12 13:18:29.708195] optimizer .................. adam
[2022-05-12 13:18:29.708198] proposal_func .............. <function lm_proposal at 0x7f3cafd80820>
[2022-05-12 13:18:29.708200] rnn_type ................... LSTM
[2022-05-12 13:18:29.708203] save_epochs ................ 1
[2022-05-12 13:18:29.708205] seed ....................... 42
[2022-05-12 13:18:29.708207] seq_len .................... 100
[2022-05-12 13:18:29.708210] shuffle .................... True
[2022-05-12 13:18:29.708212] store_intermediate_lbs ..... True
[2022-05-12 13:18:29.708215] sub_estimates .............. []
[2022-05-12 13:18:29.708217] text_dict .................. None
[2022-05-12 13:18:29.708220] top_k ...................... 0
[2022-05-12 13:18:29.708223] top_p ...................... 0
[2022-05-12 13:18:29.708226] total_seq_len .............. 20
[2022-05-12 13:18:29.708229] train_data_pct ............. 0.9
[2022-05-12 13:18:29.708231] train_epochs ............... 40
[2022-05-12 13:18:29.708234] use_gpt2 ................... False
[2022-05-12 13:18:29.708236] val_data_pct ............... 0.05
[2022-05-12 13:18:29.708239] val_metrics ................ ['accuracy']
[2022-05-12 13:18:29.708242] valid_epochs ............... 1
[2022-05-12 13:18:29.708245] variance_epsilon ........... 5e-06
[2022-05-12 13:18:29.708248] vocab_size ................. 68
[2022-05-12 13:18:29.708250] warmup_pct ................. 0.01
[2022-05-12 13:18:29.708253] weight_decay ............... 0.0
==================================================
[2022-05-12 13:18:29.708531] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
[2022-05-12 13:22:51.802893] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 12 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
[2022-05-12 13:29:39.340752] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 13:38:05.260405] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 13:38:05.268693] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 13:38:05.559133] batch_size ................. 4096
[2022-05-12 13:38:05.559154] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 13:38:05.559159] cuda ....................... True
[2022-05-12 13:38:05.559162] data_path .................. data/apps/lsapp.tsv
[2022-05-12 13:38:05.559164] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:38:05.559168] device ..................... 3
[2022-05-12 13:38:05.559171] device_num ................. 0
[2022-05-12 13:38:05.559174] disable_tqdm ............... True
[2022-05-12 13:38:05.559177] do_test .................... False
[2022-05-12 13:38:05.559179] do_valid ................... True
[2022-05-12 13:38:05.559182] dont_print_args ............ True
[2022-05-12 13:38:05.559186] dont_shuffle ............... None
[2022-05-12 13:38:05.559194] dropout .................... 0.3
[2022-05-12 13:38:05.559199] estimate_type .............. <function beam_search_lower_bound at 0x7f3cafd92820>
[2022-05-12 13:38:05.559204] excluded_terms ............. [1]
[2022-05-12 13:38:05.559208] finetune ................... False
[2022-05-12 13:38:05.559212] grad_clip .................. 1.0
[2022-05-12 13:38:05.559214] hidden_size ................ 512
[2022-05-12 13:38:05.559217] hist_len ................... 18
[2022-05-12 13:38:05.559222] interp_func ................ <function lin_interp at 0x7f3cafd92700>
[2022-05-12 13:38:05.559224] log_interval ............... 100
[2022-05-12 13:38:05.559228] lr ......................... 0.001
[2022-05-12 13:38:05.559230] lr_decay_style ............. constant
[2022-05-12 13:38:05.559233] masked_lm .................. False
[2022-05-12 13:38:05.559236] max_num_mc_samples ......... 100000
[2022-05-12 13:38:05.559238] max_num_queries ............ None
[2022-05-12 13:38:05.559241] min_num_mc_samples ......... 10000
[2022-05-12 13:38:05.559243] min_phase_shift ............ 0
[2022-05-12 13:38:05.559250] min_var_reduction .......... 0.1
[2022-05-12 13:38:05.559253] min_variance ............... True
[2022-05-12 13:38:05.559256] model_budget_filepath ...... None
[2022-05-12 13:38:05.559258] needs_encoding ............. True
[2022-05-12 13:38:05.559261] num_beams .................. 0.0
[2022-05-12 13:38:05.559264] num_layers ................. 2
[2022-05-12 13:38:05.559266] num_mc_samples ............. 100
[2022-05-12 13:38:05.559269] num_workers ................ 0
[2022-05-12 13:38:05.559271] optimizer .................. adam
[2022-05-12 13:38:05.559274] proposal_func .............. <function lm_proposal at 0x7f3cafd80820>
[2022-05-12 13:38:05.559277] rnn_type ................... LSTM
[2022-05-12 13:38:05.559279] save_epochs ................ 1
[2022-05-12 13:38:05.559282] seed ....................... 42
[2022-05-12 13:38:05.559284] seq_len .................... 15
[2022-05-12 13:38:05.559287] shuffle .................... True
[2022-05-12 13:38:05.559289] store_intermediate_lbs ..... True
[2022-05-12 13:38:05.559292] sub_estimates .............. []
[2022-05-12 13:38:05.559295] text_dict .................. None
[2022-05-12 13:38:05.559297] top_k ...................... 0
[2022-05-12 13:38:05.559300] top_p ...................... 0
[2022-05-12 13:38:05.559302] total_seq_len .............. 20
[2022-05-12 13:38:05.559305] train_data_pct ............. 0.9
[2022-05-12 13:38:05.559308] train_epochs ............... 40
[2022-05-12 13:38:05.559310] use_gpt2 ................... False
[2022-05-12 13:38:05.559313] val_data_pct ............... 0.001
[2022-05-12 13:38:05.559316] val_metrics ................ ['accuracy']
[2022-05-12 13:38:05.559319] valid_epochs ............... 1
[2022-05-12 13:38:05.559323] variance_epsilon ........... 5e-06
[2022-05-12 13:38:05.559326] vocab_size ................. 88
[2022-05-12 13:38:05.559329] warmup_pct ................. 0.01
[2022-05-12 13:38:05.559331] weight_decay ............... 0.0
==================================================
[2022-05-12 13:38:05.559613] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
[2022-05-12 13:54:27.467213] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

....................................................................................................................................................................................