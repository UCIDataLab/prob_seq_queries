==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 10:11:55.588900] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 10:11:55.592198] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 10:11:55.593848] batch_size ................. 4096
[2022-05-12 10:11:55.593856] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 10:11:55.593863] cuda ....................... True
[2022-05-12 10:11:55.593866] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 10:11:55.593869] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 10:11:55.593871] device ..................... 7
[2022-05-12 10:11:55.593874] device_num ................. 0
[2022-05-12 10:11:55.593877] disable_tqdm ............... True
[2022-05-12 10:11:55.593879] do_test .................... False
[2022-05-12 10:11:55.593882] do_valid ................... True
[2022-05-12 10:11:55.593885] dont_print_args ............ True
[2022-05-12 10:11:55.593890] dont_shuffle ............... None
[2022-05-12 10:11:55.593896] dropout .................... 0.3
[2022-05-12 10:11:55.593901] estimate_type .............. <function beam_search_lower_bound at 0x7f1209d84820>
[2022-05-12 10:11:55.593906] excluded_terms ............. [1]
[2022-05-12 10:11:55.593910] finetune ................... False
[2022-05-12 10:11:55.593913] grad_clip .................. 1.0
[2022-05-12 10:11:55.593916] hidden_size ................ 128
[2022-05-12 10:11:55.593918] hist_len ................... 18
[2022-05-12 10:11:55.593921] interp_func ................ <function lin_interp at 0x7f1209d84700>
[2022-05-12 10:11:55.593924] log_interval ............... 100
[2022-05-12 10:11:55.593927] lr ......................... 0.001
[2022-05-12 10:11:55.593929] lr_decay_style ............. constant
[2022-05-12 10:11:55.593932] masked_lm .................. False
[2022-05-12 10:11:55.593935] max_num_mc_samples ......... 100000
[2022-05-12 10:11:55.593937] min_num_mc_samples ......... 10000
[2022-05-12 10:11:55.593939] min_phase_shift ............ 0
[2022-05-12 10:11:55.593942] min_var_reduction .......... 0.1
[2022-05-12 10:11:55.593945] min_variance ............... True
[2022-05-12 10:11:55.593947] model_budget_filepath ...... None
[2022-05-12 10:11:55.593950] num_beams .................. 0.0
[2022-05-12 10:11:55.593952] num_layers ................. 2
[2022-05-12 10:11:55.593955] num_mc_samples ............. 100
[2022-05-12 10:11:55.593957] num_workers ................ 0
[2022-05-12 10:11:55.593960] optimizer .................. adam
[2022-05-12 10:11:55.593963] proposal_func .............. <function lm_proposal at 0x7f1209d82670>
[2022-05-12 10:11:55.593965] rnn_type ................... LSTM
[2022-05-12 10:11:55.593967] save_epochs ................ 1
[2022-05-12 10:11:55.593970] seed ....................... 42
[2022-05-12 10:11:55.593972] seq_len .................... 100
[2022-05-12 10:11:55.593974] shuffle .................... True
[2022-05-12 10:11:55.593977] store_intermediate_lbs ..... True
[2022-05-12 10:11:55.593979] sub_estimates .............. []
[2022-05-12 10:11:55.593982] text_dict .................. None
[2022-05-12 10:11:55.593984] top_k ...................... 0
[2022-05-12 10:11:55.593987] top_p ...................... 0
[2022-05-12 10:11:55.593989] total_seq_len .............. 20
[2022-05-12 10:11:55.593992] train_data_pct ............. 0.9
[2022-05-12 10:11:55.593994] train_epochs ............... 40
[2022-05-12 10:11:55.593996] use_gpt2 ................... False
[2022-05-12 10:11:55.593999] val_data_pct ............... 0.05
[2022-05-12 10:11:55.594002] val_metrics ................ ['accuracy']
[2022-05-12 10:11:55.594005] valid_epochs ............... 1
[2022-05-12 10:11:55.594009] variance_epsilon ........... 5e-06
[2022-05-12 10:11:55.594012] vocab_size ................. 68
[2022-05-12 10:11:55.594015] warmup_pct ................. 0.01
[2022-05-12 10:11:55.594018] weight_decay ............... 0.0
==================================================
[2022-05-12 10:11:55.594302] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
[2022-05-12 10:16:35.302712] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 12 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
[2022-05-12 10:24:56.398042] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 10:35:26.985485] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 10:35:26.997804] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 10:35:27.299752] batch_size ................. 4096
[2022-05-12 10:35:27.299778] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 10:35:27.299784] cuda ....................... True
[2022-05-12 10:35:27.299788] data_path .................. data/apps/lsapp.tsv
[2022-05-12 10:35:27.299792] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 10:35:27.299796] device ..................... 7
[2022-05-12 10:35:27.299800] device_num ................. 0
[2022-05-12 10:35:27.299803] disable_tqdm ............... True
[2022-05-12 10:35:27.299809] do_test .................... False
[2022-05-12 10:35:27.299813] do_valid ................... True
[2022-05-12 10:35:27.299816] dont_print_args ............ True
[2022-05-12 10:35:27.299821] dont_shuffle ............... None
[2022-05-12 10:35:27.299830] dropout .................... 0.3
[2022-05-12 10:35:27.299836] estimate_type .............. <function beam_search_lower_bound at 0x7f1209d84820>
[2022-05-12 10:35:27.299842] excluded_terms ............. [1]
[2022-05-12 10:35:27.299847] finetune ................... False
[2022-05-12 10:35:27.299851] grad_clip .................. 1.0
[2022-05-12 10:35:27.299855] hidden_size ................ 512
[2022-05-12 10:35:27.299858] hist_len ................... 18
[2022-05-12 10:35:27.299862] interp_func ................ <function lin_interp at 0x7f1209d84700>
[2022-05-12 10:35:27.299866] log_interval ............... 100
[2022-05-12 10:35:27.299870] lr ......................... 0.001
[2022-05-12 10:35:27.299874] lr_decay_style ............. constant
[2022-05-12 10:35:27.299878] masked_lm .................. False
[2022-05-12 10:35:27.299881] max_num_mc_samples ......... 100000
[2022-05-12 10:35:27.299885] min_num_mc_samples ......... 10000
[2022-05-12 10:35:27.299888] min_phase_shift ............ 0
[2022-05-12 10:35:27.299892] min_var_reduction .......... 0.1
[2022-05-12 10:35:27.299896] min_variance ............... True
[2022-05-12 10:35:27.299900] model_budget_filepath ...... None
[2022-05-12 10:35:27.299903] needs_encoding ............. True
[2022-05-12 10:35:27.299907] num_beams .................. 0.0
[2022-05-12 10:35:27.299911] num_layers ................. 2
[2022-05-12 10:35:27.299914] num_mc_samples ............. 100
[2022-05-12 10:35:27.299918] num_workers ................ 0
[2022-05-12 10:35:27.299921] optimizer .................. adam
[2022-05-12 10:35:27.299925] proposal_func .............. <function lm_proposal at 0x7f1209d82670>
[2022-05-12 10:35:27.299929] rnn_type ................... LSTM
[2022-05-12 10:35:27.299932] save_epochs ................ 1
[2022-05-12 10:35:27.299935] seed ....................... 42
[2022-05-12 10:35:27.299938] seq_len .................... 15
[2022-05-12 10:35:27.299942] shuffle .................... True
[2022-05-12 10:35:27.299946] store_intermediate_lbs ..... True
[2022-05-12 10:35:27.299949] sub_estimates .............. []
[2022-05-12 10:35:27.299953] text_dict .................. None
[2022-05-12 10:35:27.299956] top_k ...................... 0
[2022-05-12 10:35:27.299959] top_p ...................... 0
[2022-05-12 10:35:27.299963] total_seq_len .............. 20
[2022-05-12 10:35:27.299966] train_data_pct ............. 0.9
[2022-05-12 10:35:27.299970] train_epochs ............... 40
[2022-05-12 10:35:27.299973] use_gpt2 ................... False
[2022-05-12 10:35:27.299977] val_data_pct ............... 0.001
[2022-05-12 10:35:27.299981] val_metrics ................ ['accuracy']
[2022-05-12 10:35:27.299985] valid_epochs ............... 1
[2022-05-12 10:35:27.299990] variance_epsilon ........... 5e-06
[2022-05-12 10:35:27.299994] vocab_size ................. 88
[2022-05-12 10:35:27.299998] warmup_pct ................. 0.01
[2022-05-12 10:35:27.300001] weight_decay ............... 0.0
==================================================
[2022-05-12 10:35:27.300368] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
[2022-05-12 10:54:07.168997] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
[2022-05-12 11:19:58.743926] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 4 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 11:59:05.850989] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 11:59:05.861911] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 11:59:06.064234] batch_size ................. 4096
[2022-05-12 11:59:06.064262] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 11:59:06.064268] cuda ....................... True
[2022-05-12 11:59:06.064272] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 11:59:06.064276] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 11:59:06.064281] device ..................... 7
[2022-05-12 11:59:06.064285] device_num ................. 0
[2022-05-12 11:59:06.064288] disable_tqdm ............... True
[2022-05-12 11:59:06.064292] do_test .................... False
[2022-05-12 11:59:06.064296] do_valid ................... True
[2022-05-12 11:59:06.064299] dont_print_args ............ True
[2022-05-12 11:59:06.064304] dont_shuffle ............... None
[2022-05-12 11:59:06.064313] dropout .................... 0.3
[2022-05-12 11:59:06.064320] estimate_type .............. <function beam_search_lower_bound at 0x7f1209d84820>
[2022-05-12 11:59:06.064329] excluded_terms ............. [1]
[2022-05-12 11:59:06.064345] finetune ................... False
[2022-05-12 11:59:06.064349] grad_clip .................. 1.0
[2022-05-12 11:59:06.064353] hidden_size ................ 512
[2022-05-12 11:59:06.064357] hist_len ................... 18
[2022-05-12 11:59:06.064362] interp_func ................ <function lin_interp at 0x7f1209d84700>
[2022-05-12 11:59:06.064365] log_interval ............... 100
[2022-05-12 11:59:06.064370] lr ......................... 0.001
[2022-05-12 11:59:06.064373] lr_decay_style ............. constant
[2022-05-12 11:59:06.064377] masked_lm .................. False
[2022-05-12 11:59:06.064381] max_num_mc_samples ......... 100000
[2022-05-12 11:59:06.064384] min_num_mc_samples ......... 10000
[2022-05-12 11:59:06.064387] min_phase_shift ............ 0
[2022-05-12 11:59:06.064391] min_var_reduction .......... 0.1
[2022-05-12 11:59:06.064402] min_variance ............... True
[2022-05-12 11:59:06.064405] model_budget_filepath ...... None
[2022-05-12 11:59:06.064409] num_beams .................. 0.0
[2022-05-12 11:59:06.064413] num_layers ................. 2
[2022-05-12 11:59:06.064416] num_mc_samples ............. 100
[2022-05-12 11:59:06.064420] num_workers ................ 0
[2022-05-12 11:59:06.064424] optimizer .................. adam
[2022-05-12 11:59:06.064428] proposal_func .............. <function lm_proposal at 0x7f1209d82670>
[2022-05-12 11:59:06.064431] rnn_type ................... LSTM
[2022-05-12 11:59:06.064435] save_epochs ................ 1
[2022-05-12 11:59:06.064438] seed ....................... 42
[2022-05-12 11:59:06.064441] seq_len .................... 15
[2022-05-12 11:59:06.064445] shuffle .................... True
[2022-05-12 11:59:06.064449] store_intermediate_lbs ..... True
[2022-05-12 11:59:06.064452] sub_estimates .............. []
[2022-05-12 11:59:06.064456] text_dict .................. None
[2022-05-12 11:59:06.064459] top_k ...................... 0
[2022-05-12 11:59:06.064463] top_p ...................... 0
[2022-05-12 11:59:06.064466] total_seq_len .............. 20
[2022-05-12 11:59:06.064470] train_data_pct ............. 0.9
[2022-05-12 11:59:06.064475] train_epochs ............... 40
[2022-05-12 11:59:06.064478] use_gpt2 ................... False
[2022-05-12 11:59:06.064482] val_data_pct ............... 0.0001
[2022-05-12 11:59:06.064487] val_metrics ................ ['accuracy']
[2022-05-12 11:59:06.064490] valid_epochs ............... 1
[2022-05-12 11:59:06.064495] variance_epsilon ........... 5e-06
[2022-05-12 11:59:06.064499] vocab_size ................. 30
[2022-05-12 11:59:06.064502] warmup_pct ................. 0.01
[2022-05-12 11:59:06.064507] weight_decay ............... 0.0
==================================================
[2022-05-12 11:59:06.064808] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
[2022-05-12 12:27:35.570298] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

...........................................................................................................................................................................................................................................................................................................................................................