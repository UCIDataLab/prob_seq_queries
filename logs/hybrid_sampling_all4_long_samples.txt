==================================================
* Running for dataset moocs
==================================================
[2022-05-12 21:36:57.053339] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-12 21:36:57.056730] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-12 21:36:57.096887] batch_size ................. 4096
[2022-05-12 21:36:57.096898] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-12 21:36:57.096907] cuda ....................... True
[2022-05-12 21:36:57.096910] data_path .................. data/moocs/mooc.csv
[2022-05-12 21:36:57.096913] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 21:36:57.096916] device ..................... 2
[2022-05-12 21:36:57.096919] device_num ................. 0
[2022-05-12 21:36:57.096922] disable_tqdm ............... True
[2022-05-12 21:36:57.096924] do_test .................... False
[2022-05-12 21:36:57.096927] do_valid ................... True
[2022-05-12 21:36:57.096930] dont_print_args ............ True
[2022-05-12 21:36:57.096933] dont_shuffle ............... None
[2022-05-12 21:36:57.096940] dropout .................... 0.3
[2022-05-12 21:36:57.096944] estimate_type .............. <function beam_search_lower_bound at 0x7f98854b38b0>
[2022-05-12 21:36:57.096948] excluded_terms ............. [1]
[2022-05-12 21:36:57.096951] finetune ................... False
[2022-05-12 21:36:57.096955] grad_clip .................. 1.0
[2022-05-12 21:36:57.096957] hidden_size ................ 128
[2022-05-12 21:36:57.096960] hist_len ................... 18
[2022-05-12 21:36:57.096963] interp_func ................ <function lin_interp at 0x7f98854b3790>
[2022-05-12 21:36:57.096966] log_interval ............... 100
[2022-05-12 21:36:57.096969] lr ......................... 0.001
[2022-05-12 21:36:57.096972] lr_decay_style ............. constant
[2022-05-12 21:36:57.096974] masked_lm .................. False
[2022-05-12 21:36:57.096977] max_num_mc_samples ......... 100000
[2022-05-12 21:36:57.096980] max_num_queries ............ 1000
[2022-05-12 21:36:57.096982] min_num_mc_samples ......... 10000
[2022-05-12 21:36:57.096985] min_phase_shift ............ 0
[2022-05-12 21:36:57.096988] min_var_reduction .......... 0.1
[2022-05-12 21:36:57.096990] min_variance ............... True
[2022-05-12 21:36:57.096993] model_budget_filepath ...... None
[2022-05-12 21:36:57.096996] needs_encoding ............. False
[2022-05-12 21:36:57.096999] num_beams .................. 0.0
[2022-05-12 21:36:57.097001] num_layers ................. 2
[2022-05-12 21:36:57.097003] num_mc_samples ............. 100
[2022-05-12 21:36:57.097006] num_workers ................ 0
[2022-05-12 21:36:57.097009] optimizer .................. adam
[2022-05-12 21:36:57.097012] proposal_func .............. <function lm_proposal at 0x7f988549f790>
[2022-05-12 21:36:57.097014] rnn_type ................... LSTM
[2022-05-12 21:36:57.097016] save_epochs ................ 1
[2022-05-12 21:36:57.097019] seed ....................... 42
[2022-05-12 21:36:57.097021] seq_len .................... 15
[2022-05-12 21:36:57.097024] shuffle .................... True
[2022-05-12 21:36:57.097026] store_intermediate_lbs ..... True
[2022-05-12 21:36:57.097029] sub_estimates .............. []
[2022-05-12 21:36:57.097032] text_dict .................. None
[2022-05-12 21:36:57.097034] top_k ...................... 0
[2022-05-12 21:36:57.097036] top_p ...................... 0
[2022-05-12 21:36:57.097039] total_seq_len .............. 20
[2022-05-12 21:36:57.097042] train_data_pct ............. 0.9
[2022-05-12 21:36:57.097045] train_epochs ............... 40
[2022-05-12 21:36:57.097047] use_gpt2 ................... False
[2022-05-12 21:36:57.097050] val_data_pct ............... 0.01
[2022-05-12 21:36:57.097057] val_metrics ................ ['accuracy']
[2022-05-12 21:36:57.097060] valid_epochs ............... 1
[2022-05-12 21:36:57.097064] variance_epsilon ........... 5e-06
[2022-05-12 21:36:57.097066] vocab_size ................. 98
[2022-05-12 21:36:57.097069] warmup_pct ................. 0.01
[2022-05-12 21:36:57.097072] weight_decay ............... 0.0
==================================================
[2022-05-12 21:36:57.097573] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-12 21:41:52.134821] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-12 21:47:49.720227] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 21:55:32.682148] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 21:55:32.692931] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 21:55:32.869792] batch_size ................. 4096
[2022-05-12 21:55:32.869813] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 21:55:32.869819] cuda ....................... True
[2022-05-12 21:55:32.869823] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 21:55:32.869826] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 21:55:32.869829] device ..................... 2
[2022-05-12 21:55:32.869843] device_num ................. 0
[2022-05-12 21:55:32.869846] disable_tqdm ............... True
[2022-05-12 21:55:32.869850] do_test .................... False
[2022-05-12 21:55:32.869853] do_valid ................... True
[2022-05-12 21:55:32.869856] dont_print_args ............ True
[2022-05-12 21:55:32.869861] dont_shuffle ............... None
[2022-05-12 21:55:32.869868] dropout .................... 0.3
[2022-05-12 21:55:32.869872] estimate_type .............. <function beam_search_lower_bound at 0x7f98854b38b0>
[2022-05-12 21:55:32.869877] excluded_terms ............. [1]
[2022-05-12 21:55:32.869883] finetune ................... False
[2022-05-12 21:55:32.869886] grad_clip .................. 1.0
[2022-05-12 21:55:32.869889] hidden_size ................ 512
[2022-05-12 21:55:32.869891] hist_len ................... 18
[2022-05-12 21:55:32.869895] interp_func ................ <function lin_interp at 0x7f98854b3790>
[2022-05-12 21:55:32.869897] log_interval ............... 100
[2022-05-12 21:55:32.869901] lr ......................... 0.001
[2022-05-12 21:55:32.869904] lr_decay_style ............. constant
[2022-05-12 21:55:32.869907] masked_lm .................. False
[2022-05-12 21:55:32.869910] max_num_mc_samples ......... 100000
[2022-05-12 21:55:32.869913] max_num_queries ............ 1000
[2022-05-12 21:55:32.869916] min_num_mc_samples ......... 10000
[2022-05-12 21:55:32.869918] min_phase_shift ............ 0
[2022-05-12 21:55:32.869921] min_var_reduction .......... 0.1
[2022-05-12 21:55:32.869924] min_variance ............... True
[2022-05-12 21:55:32.869927] model_budget_filepath ...... None
[2022-05-12 21:55:32.869930] num_beams .................. 0.0
[2022-05-12 21:55:32.869933] num_layers ................. 2
[2022-05-12 21:55:32.869935] num_mc_samples ............. 100
[2022-05-12 21:55:32.869938] num_workers ................ 0
[2022-05-12 21:55:32.869941] optimizer .................. adam
[2022-05-12 21:55:32.869944] proposal_func .............. <function lm_proposal at 0x7f988549f790>
[2022-05-12 21:55:32.869947] rnn_type ................... LSTM
[2022-05-12 21:55:32.869949] save_epochs ................ 1
[2022-05-12 21:55:32.869952] seed ....................... 42
[2022-05-12 21:55:32.869955] seq_len .................... 15
[2022-05-12 21:55:32.869958] shuffle .................... True
[2022-05-12 21:55:32.869960] store_intermediate_lbs ..... True
[2022-05-12 21:55:32.869963] sub_estimates .............. []
[2022-05-12 21:55:32.869966] text_dict .................. None
[2022-05-12 21:55:32.869969] top_k ...................... 0
[2022-05-12 21:55:32.869971] top_p ...................... 0
[2022-05-12 21:55:32.869974] total_seq_len .............. 20
[2022-05-12 21:55:32.869977] train_data_pct ............. 0.9
[2022-05-12 21:55:32.869980] train_epochs ............... 40
[2022-05-12 21:55:32.869982] use_gpt2 ................... False
[2022-05-12 21:55:32.869985] val_data_pct ............... 0.0001
[2022-05-12 21:55:32.869989] val_metrics ................ ['accuracy']
[2022-05-12 21:55:32.869991] valid_epochs ............... 1
[2022-05-12 21:55:32.869995] variance_epsilon ........... 5e-06
[2022-05-12 21:55:32.869998] vocab_size ................. 30
[2022-05-12 21:55:32.870001] warmup_pct ................. 0.01
[2022-05-12 21:55:32.870003] weight_decay ............... 0.0
==================================================
[2022-05-12 21:55:32.870327] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-12 22:00:05.352016] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-12 22:05:18.088178] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 22:12:09.672923] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 22:12:09.681973] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 22:12:09.962300] batch_size ................. 4096
[2022-05-12 22:12:09.962332] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 22:12:09.962339] cuda ....................... True
[2022-05-12 22:12:09.962343] data_path .................. data/apps/lsapp.tsv
[2022-05-12 22:12:09.962347] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 22:12:09.962351] device ..................... 2
[2022-05-12 22:12:09.962354] device_num ................. 0
[2022-05-12 22:12:09.962358] disable_tqdm ............... True
[2022-05-12 22:12:09.962362] do_test .................... False
[2022-05-12 22:12:09.962365] do_valid ................... True
[2022-05-12 22:12:09.962369] dont_print_args ............ True
[2022-05-12 22:12:09.962374] dont_shuffle ............... None
[2022-05-12 22:12:09.962382] dropout .................... 0.3
[2022-05-12 22:12:09.962388] estimate_type .............. <function beam_search_lower_bound at 0x7f98854b38b0>
[2022-05-12 22:12:09.962393] excluded_terms ............. [1]
[2022-05-12 22:12:09.962398] finetune ................... False
[2022-05-12 22:12:09.962402] grad_clip .................. 1.0
[2022-05-12 22:12:09.962405] hidden_size ................ 512
[2022-05-12 22:12:09.962408] hist_len ................... 18
[2022-05-12 22:12:09.962412] interp_func ................ <function lin_interp at 0x7f98854b3790>
[2022-05-12 22:12:09.962416] log_interval ............... 100
[2022-05-12 22:12:09.962420] lr ......................... 0.001
[2022-05-12 22:12:09.962423] lr_decay_style ............. constant
[2022-05-12 22:12:09.962427] masked_lm .................. False
[2022-05-12 22:12:09.962431] max_num_mc_samples ......... 100000
[2022-05-12 22:12:09.962434] max_num_queries ............ 1000
[2022-05-12 22:12:09.962437] min_num_mc_samples ......... 10000
[2022-05-12 22:12:09.962441] min_phase_shift ............ 0
[2022-05-12 22:12:09.962445] min_var_reduction .......... 0.1
[2022-05-12 22:12:09.962449] min_variance ............... True
[2022-05-12 22:12:09.962452] model_budget_filepath ...... None
[2022-05-12 22:12:09.962456] needs_encoding ............. True
[2022-05-12 22:12:09.962460] num_beams .................. 0.0
[2022-05-12 22:12:09.962463] num_layers ................. 2
[2022-05-12 22:12:09.962466] num_mc_samples ............. 100
[2022-05-12 22:12:09.962469] num_workers ................ 0
[2022-05-12 22:12:09.962473] optimizer .................. adam
[2022-05-12 22:12:09.962476] proposal_func .............. <function lm_proposal at 0x7f988549f790>
[2022-05-12 22:12:09.962479] rnn_type ................... LSTM
[2022-05-12 22:12:09.962482] save_epochs ................ 1
[2022-05-12 22:12:09.962485] seed ....................... 42
[2022-05-12 22:12:09.962489] seq_len .................... 15
[2022-05-12 22:12:09.962492] shuffle .................... True
[2022-05-12 22:12:09.962495] store_intermediate_lbs ..... True
[2022-05-12 22:12:09.962499] sub_estimates .............. []
[2022-05-12 22:12:09.962502] text_dict .................. None
[2022-05-12 22:12:09.962505] top_k ...................... 0
[2022-05-12 22:12:09.962508] top_p ...................... 0
[2022-05-12 22:12:09.962511] total_seq_len .............. 20
[2022-05-12 22:12:09.962515] train_data_pct ............. 0.9
[2022-05-12 22:12:09.962518] train_epochs ............... 40
[2022-05-12 22:12:09.962522] use_gpt2 ................... False
[2022-05-12 22:12:09.962525] val_data_pct ............... 0.001
[2022-05-12 22:12:09.962529] val_metrics ................ ['accuracy']
[2022-05-12 22:12:09.962532] valid_epochs ............... 1
[2022-05-12 22:12:09.962537] variance_epsilon ........... 5e-06
[2022-05-12 22:12:09.962541] vocab_size ................. 88
[2022-05-12 22:12:09.962544] warmup_pct ................. 0.01
[2022-05-12 22:12:09.962548] weight_decay ............... 0.0
==================================================
[2022-05-12 22:12:09.962866] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-12 22:16:47.840057] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 8 | Total Seq Length 15

....................................................................................................
==================================================
[2022-05-12 22:22:59.135013] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 5 | Total Seq Length 15

....................................................................................................
==================================================
==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 22:31:00.709029] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 22:31:00.712072] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 22:31:00.712267] batch_size ................. 4096
[2022-05-12 22:31:00.712275] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 22:31:00.712281] cuda ....................... True
[2022-05-12 22:31:00.712285] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 22:31:00.712288] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 22:31:00.712292] device ..................... 2
[2022-05-12 22:31:00.712295] device_num ................. 0
[2022-05-12 22:31:00.712299] disable_tqdm ............... True
[2022-05-12 22:31:00.712304] do_test .................... False
[2022-05-12 22:31:00.712308] do_valid ................... True
[2022-05-12 22:31:00.712311] dont_print_args ............ True
[2022-05-12 22:31:00.712316] dont_shuffle ............... None
[2022-05-12 22:31:00.712324] dropout .................... 0.3
[2022-05-12 22:31:00.712329] estimate_type .............. <function beam_search_lower_bound at 0x7f98854b38b0>
[2022-05-12 22:31:00.712334] excluded_terms ............. [1]
[2022-05-12 22:31:00.712339] finetune ................... False
[2022-05-12 22:31:00.712343] grad_clip .................. 1.0
[2022-05-12 22:31:00.712347] hidden_size ................ 128
[2022-05-12 22:31:00.712350] hist_len ................... 18
[2022-05-12 22:31:00.712355] interp_func ................ <function lin_interp at 0x7f98854b3790>
[2022-05-12 22:31:00.712358] log_interval ............... 100
[2022-05-12 22:31:00.712363] lr ......................... 0.001
[2022-05-12 22:31:00.712366] lr_decay_style ............. constant
[2022-05-12 22:31:00.712370] masked_lm .................. False
[2022-05-12 22:31:00.712373] max_num_mc_samples ......... 100000
[2022-05-12 22:31:00.712377] max_num_queries ............ 1000
[2022-05-12 22:31:00.712380] min_num_mc_samples ......... 10000
[2022-05-12 22:31:00.712384] min_phase_shift ............ 0
[2022-05-12 22:31:00.712388] min_var_reduction .......... 0.1
[2022-05-12 22:31:00.712392] min_variance ............... True
[2022-05-12 22:31:00.712396] model_budget_filepath ...... None
[2022-05-12 22:31:00.712400] num_beams .................. 0.0
[2022-05-12 22:31:00.712403] num_layers ................. 2
[2022-05-12 22:31:00.712406] num_mc_samples ............. 100
[2022-05-12 22:31:00.712410] num_workers ................ 0
[2022-05-12 22:31:00.712413] optimizer .................. adam
[2022-05-12 22:31:00.712417] proposal_func .............. <function lm_proposal at 0x7f988549f790>
[2022-05-12 22:31:00.712420] rnn_type ................... LSTM
[2022-05-12 22:31:00.712424] save_epochs ................ 1
[2022-05-12 22:31:00.712427] seed ....................... 42
[2022-05-12 22:31:00.712430] seq_len .................... 100
[2022-05-12 22:31:00.712434] shuffle .................... True
[2022-05-12 22:31:00.712438] store_intermediate_lbs ..... True
[2022-05-12 22:31:00.712441] sub_estimates .............. []
[2022-05-12 22:31:00.712445] text_dict .................. None
[2022-05-12 22:31:00.712448] top_k ...................... 0
[2022-05-12 22:31:00.712452] top_p ...................... 0
[2022-05-12 22:31:00.712455] total_seq_len .............. 20
[2022-05-12 22:31:00.712459] train_data_pct ............. 0.9
[2022-05-12 22:31:00.712463] train_epochs ............... 40
[2022-05-12 22:31:00.712467] use_gpt2 ................... False
[2022-05-12 22:31:00.712471] val_data_pct ............... 0.05
[2022-05-12 22:31:00.712475] val_metrics ................ ['accuracy']
[2022-05-12 22:31:00.712478] valid_epochs ............... 1
[2022-05-12 22:31:00.712484] variance_epsilon ........... 5e-06
[2022-05-12 22:31:00.712487] vocab_size ................. 68
[2022-05-12 22:31:00.712491] warmup_pct ................. 0.01
[2022-05-12 22:31:00.712495] weight_decay ............... 0.0
==================================================
[2022-05-12 22:31:00.712858] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 16 | Total Seq Length 20

....................................................................................................
==================================================
[2022-05-12 23:06:07.919099] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 12 | Total Seq Length 20

..............................................................................................