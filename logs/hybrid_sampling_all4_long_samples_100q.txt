==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 13:07:36.188304] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 13:07:36.192548] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 13:07:36.198554] batch_size ................. 4096
[2022-05-12 13:07:36.198573] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 13:07:36.198587] cuda ....................... True
[2022-05-12 13:07:36.198594] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 13:07:36.198601] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:07:36.198608] device ..................... 2
[2022-05-12 13:07:36.198615] device_num ................. 0
[2022-05-12 13:07:36.198623] disable_tqdm ............... True
[2022-05-12 13:07:36.198630] do_test .................... False
[2022-05-12 13:07:36.198637] do_valid ................... True
[2022-05-12 13:07:36.198644] dont_print_args ............ True
[2022-05-12 13:07:36.198652] dont_shuffle ............... None
[2022-05-12 13:07:36.198664] dropout .................... 0.3
[2022-05-12 13:07:36.198675] estimate_type .............. <function beam_search_lower_bound at 0x7f2f8fc84700>
[2022-05-12 13:07:36.198686] excluded_terms ............. [1]
[2022-05-12 13:07:36.198694] finetune ................... False
[2022-05-12 13:07:36.198702] grad_clip .................. 1.0
[2022-05-12 13:07:36.198709] hidden_size ................ 128
[2022-05-12 13:07:36.198716] hist_len ................... 18
[2022-05-12 13:07:36.198725] interp_func ................ <function lin_interp at 0x7f2f8fc845e0>
[2022-05-12 13:07:36.198732] log_interval ............... 100
[2022-05-12 13:07:36.198740] lr ......................... 0.001
[2022-05-12 13:07:36.198747] lr_decay_style ............. constant
[2022-05-12 13:07:36.198754] masked_lm .................. False
[2022-05-12 13:07:36.198761] max_num_mc_samples ......... 100000
[2022-05-12 13:07:36.198768] max_num_queries ............ 100
[2022-05-12 13:07:36.198775] min_num_mc_samples ......... 10000
[2022-05-12 13:07:36.198781] min_phase_shift ............ 0
[2022-05-12 13:07:36.198789] min_var_reduction .......... 0.1
[2022-05-12 13:07:36.198796] min_variance ............... True
[2022-05-12 13:07:36.198803] model_budget_filepath ...... None
[2022-05-12 13:07:36.198810] num_beams .................. 0.0
[2022-05-12 13:07:36.198817] num_layers ................. 2
[2022-05-12 13:07:36.198823] num_mc_samples ............. 100
[2022-05-12 13:07:36.198830] num_workers ................ 0
[2022-05-12 13:07:36.198836] optimizer .................. adam
[2022-05-12 13:07:36.198844] proposal_func .............. <function lm_proposal at 0x7f2f8fc70700>
[2022-05-12 13:07:36.198851] rnn_type ................... LSTM
[2022-05-12 13:07:36.198857] save_epochs ................ 1
[2022-05-12 13:07:36.198864] seed ....................... 42
[2022-05-12 13:07:36.198870] seq_len .................... 100
[2022-05-12 13:07:36.198877] shuffle .................... True
[2022-05-12 13:07:36.198884] store_intermediate_lbs ..... True
[2022-05-12 13:07:36.198891] sub_estimates .............. []
[2022-05-12 13:07:36.198898] text_dict .................. None
[2022-05-12 13:07:36.198904] top_k ...................... 0
[2022-05-12 13:07:36.198911] top_p ...................... 0
[2022-05-12 13:07:36.198917] total_seq_len .............. 20
[2022-05-12 13:07:36.198925] train_data_pct ............. 0.9
[2022-05-12 13:07:36.198931] train_epochs ............... 40
[2022-05-12 13:07:36.198940] use_gpt2 ................... False
[2022-05-12 13:07:36.198956] val_data_pct ............... 0.05
[2022-05-12 13:07:36.198963] val_metrics ................ ['accuracy']
[2022-05-12 13:07:36.198968] valid_epochs ............... 1
[2022-05-12 13:07:36.198977] variance_epsilon ........... 5e-06
[2022-05-12 13:07:36.198982] vocab_size ................. 68
[2022-05-12 13:07:36.198988] warmup_pct ................. 0.01
[2022-05-12 13:07:36.198994] weight_decay ............... 0.0
==================================================
[2022-05-12 13:07:36.199591] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 16 | Total Seq Length 20

..........
==================================================
[2022-05-12 13:08:43.219100] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 12 | Total Seq Length 20

..........
==================================================
[2022-05-12 13:09:35.474451] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 10 | Total Seq Length 20

..........
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 13:11:31.747019] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 13:11:31.759598] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 13:11:31.938380] batch_size ................. 4096
[2022-05-12 13:11:31.938405] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 13:11:31.938416] cuda ....................... True
[2022-05-12 13:11:31.938421] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 13:11:31.938424] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:11:31.938429] device ..................... 2
[2022-05-12 13:11:31.938433] device_num ................. 0
[2022-05-12 13:11:31.938437] disable_tqdm ............... True
[2022-05-12 13:11:31.938441] do_test .................... False
[2022-05-12 13:11:31.938445] do_valid ................... True
[2022-05-12 13:11:31.938448] dont_print_args ............ True
[2022-05-12 13:11:31.938454] dont_shuffle ............... None
[2022-05-12 13:11:31.938462] dropout .................... 0.3
[2022-05-12 13:11:31.938468] estimate_type .............. <function beam_search_lower_bound at 0x7f2f8fc84700>
[2022-05-12 13:11:31.938473] excluded_terms ............. [1]
[2022-05-12 13:11:31.938481] finetune ................... False
[2022-05-12 13:11:31.938486] grad_clip .................. 1.0
[2022-05-12 13:11:31.938489] hidden_size ................ 512
[2022-05-12 13:11:31.938493] hist_len ................... 18
[2022-05-12 13:11:31.938498] interp_func ................ <function lin_interp at 0x7f2f8fc845e0>
[2022-05-12 13:11:31.938501] log_interval ............... 100
[2022-05-12 13:11:31.938505] lr ......................... 0.001
[2022-05-12 13:11:31.938509] lr_decay_style ............. constant
[2022-05-12 13:11:31.938540] masked_lm .................. False
[2022-05-12 13:11:31.938544] max_num_mc_samples ......... 100000
[2022-05-12 13:11:31.938548] max_num_queries ............ 100
[2022-05-12 13:11:31.938551] min_num_mc_samples ......... 10000
[2022-05-12 13:11:31.938555] min_phase_shift ............ 0
[2022-05-12 13:11:31.938561] min_var_reduction .......... 0.1
[2022-05-12 13:11:31.938564] min_variance ............... True
[2022-05-12 13:11:31.938568] model_budget_filepath ...... None
[2022-05-12 13:11:31.938572] num_beams .................. 0.0
[2022-05-12 13:11:31.938575] num_layers ................. 2
[2022-05-12 13:11:31.938578] num_mc_samples ............. 100
[2022-05-12 13:11:31.938584] num_workers ................ 0
[2022-05-12 13:11:31.938587] optimizer .................. adam
[2022-05-12 13:11:31.938591] proposal_func .............. <function lm_proposal at 0x7f2f8fc70700>
[2022-05-12 13:11:31.938595] rnn_type ................... LSTM
[2022-05-12 13:11:31.938598] save_epochs ................ 1
[2022-05-12 13:11:31.938602] seed ....................... 42
[2022-05-12 13:11:31.938606] seq_len .................... 15
[2022-05-12 13:11:31.938611] shuffle .................... True
[2022-05-12 13:11:31.938615] store_intermediate_lbs ..... True
[2022-05-12 13:11:31.938619] sub_estimates .............. []
[2022-05-12 13:11:31.938623] text_dict .................. None
[2022-05-12 13:11:31.938626] top_k ...................... 0
[2022-05-12 13:11:31.938630] top_p ...................... 0
[2022-05-12 13:11:31.938633] total_seq_len .............. 20
[2022-05-12 13:11:31.938638] train_data_pct ............. 0.9
[2022-05-12 13:11:31.938641] train_epochs ............... 40
[2022-05-12 13:11:31.938645] use_gpt2 ................... False
[2022-05-12 13:11:31.938649] val_data_pct ............... 0.0001
[2022-05-12 13:11:31.938654] val_metrics ................ ['accuracy']
[2022-05-12 13:11:31.938657] valid_epochs ............... 1
[2022-05-12 13:11:31.938662] variance_epsilon ........... 5e-06
[2022-05-12 13:11:31.938666] vocab_size ................. 30
[2022-05-12 13:11:31.938670] warmup_pct ................. 0.01
[2022-05-12 13:11:31.938674] weight_decay ............... 0.0
==================================================
[2022-05-12 13:11:31.938912] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..........
==================================================
[2022-05-12 13:12:02.057757] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 8 | Total Seq Length 15

..........
==================================================
[2022-05-12 13:12:40.222913] | Dataset: amazon | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 5 | Total Seq Length 15

..........
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-12 13:13:25.264354] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-12 13:13:25.267477] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-12 13:13:25.344856] batch_size ................. 4096
[2022-05-12 13:13:25.344874] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-12 13:13:25.344881] cuda ....................... True
[2022-05-12 13:13:25.344887] data_path .................. data/moocs/mooc.csv
[2022-05-12 13:13:25.344893] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:13:25.344899] device ..................... 2
[2022-05-12 13:13:25.344904] device_num ................. 0
[2022-05-12 13:13:25.344910] disable_tqdm ............... True
[2022-05-12 13:13:25.344916] do_test .................... False
[2022-05-12 13:13:25.344921] do_valid ................... True
[2022-05-12 13:13:25.344927] dont_print_args ............ True
[2022-05-12 13:13:25.344934] dont_shuffle ............... None
[2022-05-12 13:13:25.344945] dropout .................... 0.3
[2022-05-12 13:13:25.344953] estimate_type .............. <function beam_search_lower_bound at 0x7f2f8fc84700>
[2022-05-12 13:13:25.344962] excluded_terms ............. [1]
[2022-05-12 13:13:25.344969] finetune ................... False
[2022-05-12 13:13:25.344975] grad_clip .................. 1.0
[2022-05-12 13:13:25.344981] hidden_size ................ 128
[2022-05-12 13:13:25.344986] hist_len ................... 18
[2022-05-12 13:13:25.344993] interp_func ................ <function lin_interp at 0x7f2f8fc845e0>
[2022-05-12 13:13:25.344998] log_interval ............... 100
[2022-05-12 13:13:25.345005] lr ......................... 0.001
[2022-05-12 13:13:25.345010] lr_decay_style ............. constant
[2022-05-12 13:13:25.345016] masked_lm .................. False
[2022-05-12 13:13:25.345022] max_num_mc_samples ......... 100000
[2022-05-12 13:13:25.345027] max_num_queries ............ 100
[2022-05-12 13:13:25.345033] min_num_mc_samples ......... 10000
[2022-05-12 13:13:25.345038] min_phase_shift ............ 0
[2022-05-12 13:13:25.345044] min_var_reduction .......... 0.1
[2022-05-12 13:13:25.345050] min_variance ............... True
[2022-05-12 13:13:25.345055] model_budget_filepath ...... None
[2022-05-12 13:13:25.345061] needs_encoding ............. False
[2022-05-12 13:13:25.345067] num_beams .................. 0.0
[2022-05-12 13:13:25.345072] num_layers ................. 2
[2022-05-12 13:13:25.345093] num_mc_samples ............. 100
[2022-05-12 13:13:25.345099] num_workers ................ 0
[2022-05-12 13:13:25.345104] optimizer .................. adam
[2022-05-12 13:13:25.345110] proposal_func .............. <function lm_proposal at 0x7f2f8fc70700>
[2022-05-12 13:13:25.345116] rnn_type ................... LSTM
[2022-05-12 13:13:25.345121] save_epochs ................ 1
[2022-05-12 13:13:25.345126] seed ....................... 42
[2022-05-12 13:13:25.345133] seq_len .................... 15
[2022-05-12 13:13:25.345138] shuffle .................... True
[2022-05-12 13:13:25.345144] store_intermediate_lbs ..... True
[2022-05-12 13:13:25.345149] sub_estimates .............. []
[2022-05-12 13:13:25.345155] text_dict .................. None
[2022-05-12 13:13:25.345160] top_k ...................... 0
[2022-05-12 13:13:25.345165] top_p ...................... 0
[2022-05-12 13:13:25.345172] total_seq_len .............. 20
[2022-05-12 13:13:25.345178] train_data_pct ............. 0.9
[2022-05-12 13:13:25.345183] train_epochs ............... 40
[2022-05-12 13:13:25.345188] use_gpt2 ................... False
[2022-05-12 13:13:25.345194] val_data_pct ............... 0.01
[2022-05-12 13:13:25.345201] val_metrics ................ ['accuracy']
[2022-05-12 13:13:25.345207] valid_epochs ............... 1
[2022-05-12 13:13:25.345215] variance_epsilon ........... 5e-06
[2022-05-12 13:13:25.345221] vocab_size ................. 98
[2022-05-12 13:13:25.345227] warmup_pct ................. 0.01
[2022-05-12 13:13:25.345232] weight_decay ............... 0.0
==================================================
[2022-05-12 13:13:25.345929] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..........
==================================================
[2022-05-12 13:13:59.961993] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 8 | Total Seq Length 15

..........
==================================================
[2022-05-12 13:14:45.618229] | Dataset: moocs | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 5 | Total Seq Length 15

..........
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 13:15:57.137305] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 13:15:57.145682] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 13:15:57.463289] batch_size ................. 4096
[2022-05-12 13:15:57.463311] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 13:15:57.463317] cuda ....................... True
[2022-05-12 13:15:57.463321] data_path .................. data/apps/lsapp.tsv
[2022-05-12 13:15:57.463324] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:15:57.463328] device ..................... 2
[2022-05-12 13:15:57.463331] device_num ................. 0
[2022-05-12 13:15:57.463334] disable_tqdm ............... True
[2022-05-12 13:15:57.463338] do_test .................... False
[2022-05-12 13:15:57.463341] do_valid ................... True
[2022-05-12 13:15:57.463344] dont_print_args ............ True
[2022-05-12 13:15:57.463349] dont_shuffle ............... None
[2022-05-12 13:15:57.463356] dropout .................... 0.3
[2022-05-12 13:15:57.463362] estimate_type .............. <function beam_search_lower_bound at 0x7f2f8fc84700>
[2022-05-12 13:15:57.463368] excluded_terms ............. [1]
[2022-05-12 13:15:57.463372] finetune ................... False
[2022-05-12 13:15:57.463376] grad_clip .................. 1.0
[2022-05-12 13:15:57.463379] hidden_size ................ 512
[2022-05-12 13:15:57.463382] hist_len ................... 18
[2022-05-12 13:15:57.463386] interp_func ................ <function lin_interp at 0x7f2f8fc845e0>
[2022-05-12 13:15:57.463389] log_interval ............... 100
[2022-05-12 13:15:57.463393] lr ......................... 0.001
[2022-05-12 13:15:57.463396] lr_decay_style ............. constant
[2022-05-12 13:15:57.463400] masked_lm .................. False
[2022-05-12 13:15:57.463403] max_num_mc_samples ......... 100000
[2022-05-12 13:15:57.463406] max_num_queries ............ 100
[2022-05-12 13:15:57.463409] min_num_mc_samples ......... 10000
[2022-05-12 13:15:57.463412] min_phase_shift ............ 0
[2022-05-12 13:15:57.463416] min_var_reduction .......... 0.1
[2022-05-12 13:15:57.463419] min_variance ............... True
[2022-05-12 13:15:57.463422] model_budget_filepath ...... None
[2022-05-12 13:15:57.463425] needs_encoding ............. True
[2022-05-12 13:15:57.463429] num_beams .................. 0.0
[2022-05-12 13:15:57.463432] num_layers ................. 2
[2022-05-12 13:15:57.463435] num_mc_samples ............. 100
[2022-05-12 13:15:57.463438] num_workers ................ 0
[2022-05-12 13:15:57.463441] optimizer .................. adam
[2022-05-12 13:15:57.463445] proposal_func .............. <function lm_proposal at 0x7f2f8fc70700>
[2022-05-12 13:15:57.463448] rnn_type ................... LSTM
[2022-05-12 13:15:57.463451] save_epochs ................ 1
[2022-05-12 13:15:57.463454] seed ....................... 42
[2022-05-12 13:15:57.463457] seq_len .................... 15
[2022-05-12 13:15:57.463460] shuffle .................... True
[2022-05-12 13:15:57.463463] store_intermediate_lbs ..... True
[2022-05-12 13:15:57.463466] sub_estimates .............. []
[2022-05-12 13:15:57.463469] text_dict .................. None
[2022-05-12 13:15:57.463472] top_k ...................... 0
[2022-05-12 13:15:57.463475] top_p ...................... 0
[2022-05-12 13:15:57.463478] total_seq_len .............. 20
[2022-05-12 13:15:57.463482] train_data_pct ............. 0.9
[2022-05-12 13:15:57.463485] train_epochs ............... 40
[2022-05-12 13:15:57.463488] use_gpt2 ................... False
[2022-05-12 13:15:57.463491] val_data_pct ............... 0.001
[2022-05-12 13:15:57.463495] val_metrics ................ ['accuracy']
[2022-05-12 13:15:57.463498] valid_epochs ............... 1
[2022-05-12 13:15:57.463503] variance_epsilon ........... 5e-06
[2022-05-12 13:15:57.463506] vocab_size ................. 88
[2022-05-12 13:15:57.463509] warmup_pct ................. 0.01
[2022-05-12 13:15:57.463512] weight_decay ............... 0.0
==================================================
[2022-05-12 13:15:57.463898] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 11 | Total Seq Length 15

..........
==================================================
[2022-05-12 13:16:29.975897] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 8 | Total Seq Length 15

..........
==================================================
[2022-05-12 13:17:09.405781] | Dataset: apps | Sample type: beam_search_is_hybrid | Num samples: 1000 | Hist length 5 | Total Seq Length 15

..........
==================================================
