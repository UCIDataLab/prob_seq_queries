==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 14:00:22.613654] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 14:00:22.617214] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 14:00:22.621287] batch_size ................. 4096
[2022-05-12 14:00:22.621302] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 14:00:22.621310] cuda ....................... True
[2022-05-12 14:00:22.621316] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 14:00:22.621321] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:00:22.621327] device ..................... 7
[2022-05-12 14:00:22.621333] device_num ................. 0
[2022-05-12 14:00:22.621339] disable_tqdm ............... True
[2022-05-12 14:00:22.621345] do_test .................... False
[2022-05-12 14:00:22.621351] do_valid ................... True
[2022-05-12 14:00:22.621356] dont_print_args ............ True
[2022-05-12 14:00:22.621363] dont_shuffle ............... None
[2022-05-12 14:00:22.621374] dropout .................... 0.3
[2022-05-12 14:00:22.621381] estimate_type .............. <function beam_search_lower_bound at 0x7fdba759d820>
[2022-05-12 14:00:22.621389] excluded_terms ............. [1]
[2022-05-12 14:00:22.621396] finetune ................... False
[2022-05-12 14:00:22.621402] grad_clip .................. 1.0
[2022-05-12 14:00:22.621407] hidden_size ................ 128
[2022-05-12 14:00:22.621413] hist_len ................... 18
[2022-05-12 14:00:22.621419] interp_func ................ <function lin_interp at 0x7fdba759d700>
[2022-05-12 14:00:22.621425] log_interval ............... 100
[2022-05-12 14:00:22.621432] lr ......................... 0.001
[2022-05-12 14:00:22.621437] lr_decay_style ............. constant
[2022-05-12 14:00:22.621443] masked_lm .................. False
[2022-05-12 14:00:22.621449] max_num_mc_samples ......... 100000
[2022-05-12 14:00:22.621454] max_num_queries ............ 100
[2022-05-12 14:00:22.621459] min_num_mc_samples ......... 10000
[2022-05-12 14:00:22.621465] min_phase_shift ............ 0
[2022-05-12 14:00:22.621471] min_var_reduction .......... 0.1
[2022-05-12 14:00:22.621477] min_variance ............... True
[2022-05-12 14:00:22.621482] model_budget_filepath ...... None
[2022-05-12 14:00:22.621488] num_beams .................. 0.0
[2022-05-12 14:00:22.621494] num_layers ................. 2
[2022-05-12 14:00:22.621499] num_mc_samples ............. 100
[2022-05-12 14:00:22.621504] num_workers ................ 0
[2022-05-12 14:00:22.621510] optimizer .................. adam
[2022-05-12 14:00:22.621516] proposal_func .............. <function lm_proposal at 0x7fdba758a820>
[2022-05-12 14:00:22.621521] rnn_type ................... LSTM
[2022-05-12 14:00:22.621527] save_epochs ................ 1
[2022-05-12 14:00:22.621532] seed ....................... 42
[2022-05-12 14:00:22.621537] seq_len .................... 100
[2022-05-12 14:00:22.621543] shuffle .................... True
[2022-05-12 14:00:22.621549] store_intermediate_lbs ..... True
[2022-05-12 14:00:22.621554] sub_estimates .............. []
[2022-05-12 14:00:22.621560] text_dict .................. None
[2022-05-12 14:00:22.621565] top_k ...................... 0
[2022-05-12 14:00:22.621570] top_p ...................... 0
[2022-05-12 14:00:22.621576] total_seq_len .............. 20
[2022-05-12 14:00:22.621582] train_data_pct ............. 0.9
[2022-05-12 14:00:22.621587] train_epochs ............... 40
[2022-05-12 14:00:22.621593] use_gpt2 ................... False
[2022-05-12 14:00:22.621599] val_data_pct ............... 0.05
[2022-05-12 14:00:22.621605] val_metrics ................ ['accuracy']
[2022-05-12 14:00:22.621611] valid_epochs ............... 1
[2022-05-12 14:00:22.621618] variance_epsilon ........... 5e-06
[2022-05-12 14:00:22.621624] vocab_size ................. 68
[2022-05-12 14:00:22.621630] warmup_pct ................. 0.01
[2022-05-12 14:00:22.621635] weight_decay ............... 0.0
==================================================
[2022-05-12 14:00:22.622105] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 14:00:35.355169] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 12 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 14:00:54.837883] | Dataset: shakespeare | Sample type: pseudo_gt | Num samples: 1000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: True | Model Budget: False

..........
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 14:01:42.901761] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 14:01:42.910993] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 14:01:43.220365] batch_size ................. 4096
[2022-05-12 14:01:43.220388] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 14:01:43.220394] cuda ....................... True
[2022-05-12 14:01:43.220398] data_path .................. data/apps/lsapp.tsv
[2022-05-12 14:01:43.220401] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:01:43.220406] device ..................... 7
[2022-05-12 14:01:43.220409] device_num ................. 0
[2022-05-12 14:01:43.220412] disable_tqdm ............... True
[2022-05-12 14:01:43.220418] do_test .................... False
[2022-05-12 14:01:43.220422] do_valid ................... True
[2022-05-12 14:01:43.220425] dont_print_args ............ True
[2022-05-12 14:01:43.220430] dont_shuffle ............... None
[2022-05-12 14:01:43.220437] dropout .................... 0.3
[2022-05-12 14:01:43.220442] estimate_type .............. <function beam_search_lower_bound at 0x7fdba759d820>
[2022-05-12 14:01:43.220448] excluded_terms ............. [1]
[2022-05-12 14:01:43.220463] finetune ................... False
[2022-05-12 14:01:43.220467] grad_clip .................. 1.0
[2022-05-12 14:01:43.220471] hidden_size ................ 512
[2022-05-12 14:01:43.220474] hist_len ................... 18
[2022-05-12 14:01:43.220479] interp_func ................ <function lin_interp at 0x7fdba759d700>
[2022-05-12 14:01:43.220483] log_interval ............... 100
[2022-05-12 14:01:43.220488] lr ......................... 0.001
[2022-05-12 14:01:43.220491] lr_decay_style ............. constant
[2022-05-12 14:01:43.220495] masked_lm .................. False
[2022-05-12 14:01:43.220498] max_num_mc_samples ......... 100000
[2022-05-12 14:01:43.220502] max_num_queries ............ 100
[2022-05-12 14:01:43.220506] min_num_mc_samples ......... 10000
[2022-05-12 14:01:43.220509] min_phase_shift ............ 0
[2022-05-12 14:01:43.220518] min_var_reduction .......... 0.1
[2022-05-12 14:01:43.220522] min_variance ............... True
[2022-05-12 14:01:43.220525] model_budget_filepath ...... None
[2022-05-12 14:01:43.220529] needs_encoding ............. True
[2022-05-12 14:01:43.220532] num_beams .................. 0.0
[2022-05-12 14:01:43.220536] num_layers ................. 2
[2022-05-12 14:01:43.220539] num_mc_samples ............. 100
[2022-05-12 14:01:43.220543] num_workers ................ 0
[2022-05-12 14:01:43.220547] optimizer .................. adam
[2022-05-12 14:01:43.220550] proposal_func .............. <function lm_proposal at 0x7fdba758a820>
[2022-05-12 14:01:43.220554] rnn_type ................... LSTM
[2022-05-12 14:01:43.220557] save_epochs ................ 1
[2022-05-12 14:01:43.220560] seed ....................... 42
[2022-05-12 14:01:43.220566] seq_len .................... 15
[2022-05-12 14:01:43.220569] shuffle .................... True
[2022-05-12 14:01:43.220573] store_intermediate_lbs ..... True
[2022-05-12 14:01:43.220576] sub_estimates .............. []
[2022-05-12 14:01:43.220580] text_dict .................. None
[2022-05-12 14:01:43.220583] top_k ...................... 0
[2022-05-12 14:01:43.220586] top_p ...................... 0
[2022-05-12 14:01:43.220590] total_seq_len .............. 20
[2022-05-12 14:01:43.220594] train_data_pct ............. 0.9
[2022-05-12 14:01:43.220598] train_epochs ............... 40
[2022-05-12 14:01:43.220601] use_gpt2 ................... False
[2022-05-12 14:01:43.220605] val_data_pct ............... 0.001
[2022-05-12 14:01:43.220609] val_metrics ................ ['accuracy']
[2022-05-12 14:01:43.220612] valid_epochs ............... 1
[2022-05-12 14:01:43.220617] variance_epsilon ........... 5e-06
[2022-05-12 14:01:43.220621] vocab_size ................. 88
[2022-05-12 14:01:43.220625] warmup_pct ................. 0.01
[2022-05-12 14:01:43.220629] weight_decay ............... 0.0
==================================================
[2022-05-12 14:01:43.220996] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 14:02:22.078311] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 14:03:19.327045] | Dataset: apps | Sample type: pseudo_gt | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 14:05:39.619075] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 14:05:39.627405] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 14:05:39.797481] batch_size ................. 4096
[2022-05-12 14:05:39.797508] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 14:05:39.797513] cuda ....................... True
[2022-05-12 14:05:39.797518] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 14:05:39.797521] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:05:39.797525] device ..................... 7
[2022-05-12 14:05:39.797529] device_num ................. 0
[2022-05-12 14:05:39.797533] disable_tqdm ............... True
[2022-05-12 14:05:39.797537] do_test .................... False
[2022-05-12 14:05:39.797540] do_valid ................... True
[2022-05-12 14:05:39.797544] dont_print_args ............ True
[2022-05-12 14:05:39.797548] dont_shuffle ............... None
[2022-05-12 14:05:39.797555] dropout .................... 0.3
[2022-05-12 14:05:39.797560] estimate_type .............. <function beam_search_lower_bound at 0x7fdba759d820>
[2022-05-12 14:05:39.797567] excluded_terms ............. [1]
[2022-05-12 14:05:39.797576] finetune ................... False
[2022-05-12 14:05:39.797581] grad_clip .................. 1.0
[2022-05-12 14:05:39.797584] hidden_size ................ 512
[2022-05-12 14:05:39.797588] hist_len ................... 18
[2022-05-12 14:05:39.797593] interp_func ................ <function lin_interp at 0x7fdba759d700>
[2022-05-12 14:05:39.797596] log_interval ............... 100
[2022-05-12 14:05:39.797601] lr ......................... 0.001
[2022-05-12 14:05:39.797604] lr_decay_style ............. constant
[2022-05-12 14:05:39.797613] masked_lm .................. False
[2022-05-12 14:05:39.797616] max_num_mc_samples ......... 100000
[2022-05-12 14:05:39.797620] max_num_queries ............ 100
[2022-05-12 14:05:39.797623] min_num_mc_samples ......... 10000
[2022-05-12 14:05:39.797627] min_phase_shift ............ 0
[2022-05-12 14:05:39.797632] min_var_reduction .......... 0.1
[2022-05-12 14:05:39.797636] min_variance ............... True
[2022-05-12 14:05:39.797639] model_budget_filepath ...... None
[2022-05-12 14:05:39.797643] num_beams .................. 0.0
[2022-05-12 14:05:39.797646] num_layers ................. 2
[2022-05-12 14:05:39.797650] num_mc_samples ............. 100
[2022-05-12 14:05:39.797654] num_workers ................ 0
[2022-05-12 14:05:39.797657] optimizer .................. adam
[2022-05-12 14:05:39.797661] proposal_func .............. <function lm_proposal at 0x7fdba758a820>
[2022-05-12 14:05:39.797664] rnn_type ................... LSTM
[2022-05-12 14:05:39.797667] save_epochs ................ 1
[2022-05-12 14:05:39.797671] seed ....................... 42
[2022-05-12 14:05:39.797674] seq_len .................... 15
[2022-05-12 14:05:39.797678] shuffle .................... True
[2022-05-12 14:05:39.797681] store_intermediate_lbs ..... True
[2022-05-12 14:05:39.797685] sub_estimates .............. []
[2022-05-12 14:05:39.797688] text_dict .................. None
[2022-05-12 14:05:39.797691] top_k ...................... 0
[2022-05-12 14:05:39.797694] top_p ...................... 0
[2022-05-12 14:05:39.797697] total_seq_len .............. 20
[2022-05-12 14:05:39.797702] train_data_pct ............. 0.9
[2022-05-12 14:05:39.797705] train_epochs ............... 40
[2022-05-12 14:05:39.797709] use_gpt2 ................... False
[2022-05-12 14:05:39.797712] val_data_pct ............... 0.0001
[2022-05-12 14:05:39.797717] val_metrics ................ ['accuracy']
[2022-05-12 14:05:39.797720] valid_epochs ............... 1
[2022-05-12 14:05:39.797725] variance_epsilon ........... 5e-06
[2022-05-12 14:05:39.797728] vocab_size ................. 30
[2022-05-12 14:05:39.797733] warmup_pct ................. 0.01
[2022-05-12 14:05:39.797736] weight_decay ............... 0.0
==================================================
[2022-05-12 14:05:39.797965] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 14:06:24.024885] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 14:07:12.912584] | Dataset: amazon | Sample type: pseudo_gt | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-12 14:08:17.516457] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-12 14:08:17.519755] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-12 14:08:17.590712] batch_size ................. 4096
[2022-05-12 14:08:17.590730] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-12 14:08:17.590738] cuda ....................... True
[2022-05-12 14:08:17.590744] data_path .................. data/moocs/mooc.csv
[2022-05-12 14:08:17.590749] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 14:08:17.590758] device ..................... 7
[2022-05-12 14:08:17.590763] device_num ................. 0
[2022-05-12 14:08:17.590769] disable_tqdm ............... True
[2022-05-12 14:08:17.590775] do_test .................... False
[2022-05-12 14:08:17.590781] do_valid ................... True
[2022-05-12 14:08:17.590786] dont_print_args ............ True
[2022-05-12 14:08:17.590793] dont_shuffle ............... None
[2022-05-12 14:08:17.590803] dropout .................... 0.3
[2022-05-12 14:08:17.590810] estimate_type .............. <function beam_search_lower_bound at 0x7fdba759d820>
[2022-05-12 14:08:17.590818] excluded_terms ............. [1]
[2022-05-12 14:08:17.590829] finetune ................... False
[2022-05-12 14:08:17.590835] grad_clip .................. 1.0
[2022-05-12 14:08:17.590841] hidden_size ................ 128
[2022-05-12 14:08:17.590846] hist_len ................... 18
[2022-05-12 14:08:17.590853] interp_func ................ <function lin_interp at 0x7fdba759d700>
[2022-05-12 14:08:17.590859] log_interval ............... 100
[2022-05-12 14:08:17.590865] lr ......................... 0.001
[2022-05-12 14:08:17.590871] lr_decay_style ............. constant
[2022-05-12 14:08:17.590879] masked_lm .................. False
[2022-05-12 14:08:17.590884] max_num_mc_samples ......... 100000
[2022-05-12 14:08:17.590890] max_num_queries ............ 100
[2022-05-12 14:08:17.590895] min_num_mc_samples ......... 10000
[2022-05-12 14:08:17.590900] min_phase_shift ............ 0
[2022-05-12 14:08:17.590907] min_var_reduction .......... 0.1
[2022-05-12 14:08:17.590913] min_variance ............... True
[2022-05-12 14:08:17.590918] model_budget_filepath ...... None
[2022-05-12 14:08:17.590924] needs_encoding ............. False
[2022-05-12 14:08:17.590930] num_beams .................. 0.0
[2022-05-12 14:08:17.590935] num_layers ................. 2
[2022-05-12 14:08:17.590942] num_mc_samples ............. 100
[2022-05-12 14:08:17.590947] num_workers ................ 0
[2022-05-12 14:08:17.590952] optimizer .................. adam
[2022-05-12 14:08:17.590958] proposal_func .............. <function lm_proposal at 0x7fdba758a820>
[2022-05-12 14:08:17.590963] rnn_type ................... LSTM
[2022-05-12 14:08:17.590969] save_epochs ................ 1
[2022-05-12 14:08:17.590974] seed ....................... 42
[2022-05-12 14:08:17.590980] seq_len .................... 15
[2022-05-12 14:08:17.590986] shuffle .................... True
[2022-05-12 14:08:17.590991] store_intermediate_lbs ..... True
[2022-05-12 14:08:17.590997] sub_estimates .............. []
[2022-05-12 14:08:17.591003] text_dict .................. None
[2022-05-12 14:08:17.591008] top_k ...................... 0
[2022-05-12 14:08:17.591013] top_p ...................... 0
[2022-05-12 14:08:17.591019] total_seq_len .............. 20
[2022-05-12 14:08:17.591025] train_data_pct ............. 0.9
[2022-05-12 14:08:17.591030] train_epochs ............... 40
[2022-05-12 14:08:17.591036] use_gpt2 ................... False
[2022-05-12 14:08:17.591041] val_data_pct ............... 0.01
[2022-05-12 14:08:17.591048] val_metrics ................ ['accuracy']
[2022-05-12 14:08:17.591053] valid_epochs ............... 1
[2022-05-12 14:08:17.591061] variance_epsilon ........... 5e-06
[2022-05-12 14:08:17.591068] vocab_size ................. 98
[2022-05-12 14:08:17.591073] warmup_pct ................. 0.01
[2022-05-12 14:08:17.591079] weight_decay ............... 0.0
==================================================
[2022-05-12 14:08:17.591821] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 14:08:32.741403] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
[2022-05-12 14:08:52.180696] | Dataset: moocs | Sample type: pseudo_gt | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: True | Model Budget: False

..........
==================================================
