==================================================
* Running for dataset shakespeare
==================================================
[2022-05-12 13:27:19.500208] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-12 13:27:19.503612] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-12 13:27:19.506796] batch_size ................. 4096
[2022-05-12 13:27:19.506810] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-12 13:27:19.506821] cuda ....................... True
[2022-05-12 13:27:19.506828] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-12 13:27:19.506835] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:27:19.506842] device ..................... 7
[2022-05-12 13:27:19.506848] device_num ................. 0
[2022-05-12 13:27:19.506853] disable_tqdm ............... True
[2022-05-12 13:27:19.506859] do_test .................... False
[2022-05-12 13:27:19.506865] do_valid ................... True
[2022-05-12 13:27:19.506870] dont_print_args ............ True
[2022-05-12 13:27:19.506877] dont_shuffle ............... None
[2022-05-12 13:27:19.506889] dropout .................... 0.3
[2022-05-12 13:27:19.506897] estimate_type .............. <function beam_search_lower_bound at 0x7f6203fc2820>
[2022-05-12 13:27:19.506904] excluded_terms ............. [1]
[2022-05-12 13:27:19.506911] finetune ................... False
[2022-05-12 13:27:19.506917] grad_clip .................. 1.0
[2022-05-12 13:27:19.506923] hidden_size ................ 128
[2022-05-12 13:27:19.506928] hist_len ................... 18
[2022-05-12 13:27:19.506947] interp_func ................ <function lin_interp at 0x7f6203fc2700>
[2022-05-12 13:27:19.506953] log_interval ............... 100
[2022-05-12 13:27:19.506961] lr ......................... 0.001
[2022-05-12 13:27:19.506967] lr_decay_style ............. constant
[2022-05-12 13:27:19.506974] masked_lm .................. False
[2022-05-12 13:27:19.506982] max_num_mc_samples ......... 100000
[2022-05-12 13:27:19.506988] max_num_queries ............ 100
[2022-05-12 13:27:19.506995] min_num_mc_samples ......... 10000
[2022-05-12 13:27:19.507001] min_phase_shift ............ 0
[2022-05-12 13:27:19.507009] min_var_reduction .......... 0.1
[2022-05-12 13:27:19.507018] min_variance ............... True
[2022-05-12 13:27:19.507026] model_budget_filepath ...... None
[2022-05-12 13:27:19.507035] num_beams .................. 0.0
[2022-05-12 13:27:19.507042] num_layers ................. 2
[2022-05-12 13:27:19.507049] num_mc_samples ............. 100
[2022-05-12 13:27:19.507055] num_workers ................ 0
[2022-05-12 13:27:19.507062] optimizer .................. adam
[2022-05-12 13:27:19.507069] proposal_func .............. <function lm_proposal at 0x7f6203faf820>
[2022-05-12 13:27:19.507076] rnn_type ................... LSTM
[2022-05-12 13:27:19.507082] save_epochs ................ 1
[2022-05-12 13:27:19.507089] seed ....................... 42
[2022-05-12 13:27:19.507095] seq_len .................... 100
[2022-05-12 13:27:19.507103] shuffle .................... True
[2022-05-12 13:27:19.507110] store_intermediate_lbs ..... True
[2022-05-12 13:27:19.507117] sub_estimates .............. []
[2022-05-12 13:27:19.507124] text_dict .................. None
[2022-05-12 13:27:19.507130] top_k ...................... 0
[2022-05-12 13:27:19.507137] top_p ...................... 0
[2022-05-12 13:27:19.507143] total_seq_len .............. 20
[2022-05-12 13:27:19.507150] train_data_pct ............. 0.9
[2022-05-12 13:27:19.507157] train_epochs ............... 40
[2022-05-12 13:27:19.507163] use_gpt2 ................... False
[2022-05-12 13:27:19.507170] val_data_pct ............... 0.05
[2022-05-12 13:27:19.507177] val_metrics ................ ['accuracy']
[2022-05-12 13:27:19.507184] valid_epochs ............... 1
[2022-05-12 13:27:19.507194] variance_epsilon ........... 5e-06
[2022-05-12 13:27:19.507206] vocab_size ................. 68
[2022-05-12 13:27:19.507219] warmup_pct ................. 0.01
[2022-05-12 13:27:19.507244] weight_decay ............... 0.0
==================================================
[2022-05-12 13:27:19.507991] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 1000 | Hist length 16 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

..........
==================================================
[2022-05-12 13:27:21.445954] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 1000 | Hist length 12 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

..........
==================================================
[2022-05-12 13:27:25.056058] | Dataset: shakespeare | Sample type: importance_sampling | Num samples: 1000 | Hist length 10 | Total Seq Length 20 | Pseudo GT: False | Model Budget: True

..........
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-12 13:28:02.582940] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-12 13:28:02.602372] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-12 13:28:03.019588] batch_size ................. 4096
[2022-05-12 13:28:03.019642] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-12 13:28:03.019655] cuda ....................... True
[2022-05-12 13:28:03.019659] data_path .................. data/apps/lsapp.tsv
[2022-05-12 13:28:03.019663] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:28:03.019669] device ..................... 7
[2022-05-12 13:28:03.019673] device_num ................. 0
[2022-05-12 13:28:03.019676] disable_tqdm ............... True
[2022-05-12 13:28:03.019682] do_test .................... False
[2022-05-12 13:28:03.019686] do_valid ................... True
[2022-05-12 13:28:03.019689] dont_print_args ............ True
[2022-05-12 13:28:03.019695] dont_shuffle ............... None
[2022-05-12 13:28:03.019706] dropout .................... 0.3
[2022-05-12 13:28:03.019715] estimate_type .............. <function beam_search_lower_bound at 0x7f6203fc2820>
[2022-05-12 13:28:03.019725] excluded_terms ............. [1]
[2022-05-12 13:28:03.019730] finetune ................... False
[2022-05-12 13:28:03.019734] grad_clip .................. 1.0
[2022-05-12 13:28:03.019738] hidden_size ................ 512
[2022-05-12 13:28:03.019741] hist_len ................... 18
[2022-05-12 13:28:03.019747] interp_func ................ <function lin_interp at 0x7f6203fc2700>
[2022-05-12 13:28:03.019751] log_interval ............... 100
[2022-05-12 13:28:03.019755] lr ......................... 0.001
[2022-05-12 13:28:03.019759] lr_decay_style ............. constant
[2022-05-12 13:28:03.019766] masked_lm .................. False
[2022-05-12 13:28:03.019770] max_num_mc_samples ......... 100000
[2022-05-12 13:28:03.019774] max_num_queries ............ 100
[2022-05-12 13:28:03.019778] min_num_mc_samples ......... 10000
[2022-05-12 13:28:03.019781] min_phase_shift ............ 0
[2022-05-12 13:28:03.019786] min_var_reduction .......... 0.1
[2022-05-12 13:28:03.019790] min_variance ............... True
[2022-05-12 13:28:03.019794] model_budget_filepath ...... None
[2022-05-12 13:28:03.019797] needs_encoding ............. True
[2022-05-12 13:28:03.019802] num_beams .................. 0.0
[2022-05-12 13:28:03.019805] num_layers ................. 2
[2022-05-12 13:28:03.019809] num_mc_samples ............. 100
[2022-05-12 13:28:03.019813] num_workers ................ 0
[2022-05-12 13:28:03.019816] optimizer .................. adam
[2022-05-12 13:28:03.019820] proposal_func .............. <function lm_proposal at 0x7f6203faf820>
[2022-05-12 13:28:03.019824] rnn_type ................... LSTM
[2022-05-12 13:28:03.019827] save_epochs ................ 1
[2022-05-12 13:28:03.019830] seed ....................... 42
[2022-05-12 13:28:03.019835] seq_len .................... 15
[2022-05-12 13:28:03.019838] shuffle .................... True
[2022-05-12 13:28:03.019842] store_intermediate_lbs ..... True
[2022-05-12 13:28:03.019845] sub_estimates .............. []
[2022-05-12 13:28:03.019849] text_dict .................. None
[2022-05-12 13:28:03.019852] top_k ...................... 0
[2022-05-12 13:28:03.019855] top_p ...................... 0
[2022-05-12 13:28:03.019861] total_seq_len .............. 20
[2022-05-12 13:28:03.019865] train_data_pct ............. 0.9
[2022-05-12 13:28:03.019868] train_epochs ............... 40
[2022-05-12 13:28:03.019871] use_gpt2 ................... False
[2022-05-12 13:28:03.019875] val_data_pct ............... 0.001
[2022-05-12 13:28:03.019880] val_metrics ................ ['accuracy']
[2022-05-12 13:28:03.019884] valid_epochs ............... 1
[2022-05-12 13:28:03.019890] variance_epsilon ........... 5e-06
[2022-05-12 13:28:03.019894] vocab_size ................. 88
[2022-05-12 13:28:03.019898] warmup_pct ................. 0.01
[2022-05-12 13:28:03.019902] weight_decay ............... 0.0
==================================================
[2022-05-12 13:28:03.020393] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
[2022-05-12 13:28:06.548276] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
[2022-05-12 13:28:11.270001] | Dataset: apps | Sample type: importance_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-12 13:29:19.335907] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-12 13:29:19.347575] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-12 13:29:19.517484] batch_size ................. 4096
[2022-05-12 13:29:19.517517] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-12 13:29:19.517531] cuda ....................... True
[2022-05-12 13:29:19.517538] data_path .................. /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-12 13:29:19.517544] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:29:19.517551] device ..................... 7
[2022-05-12 13:29:19.517557] device_num ................. 0
[2022-05-12 13:29:19.517563] disable_tqdm ............... True
[2022-05-12 13:29:19.517569] do_test .................... False
[2022-05-12 13:29:19.517575] do_valid ................... True
[2022-05-12 13:29:19.517580] dont_print_args ............ True
[2022-05-12 13:29:19.517586] dont_shuffle ............... None
[2022-05-12 13:29:19.517594] dropout .................... 0.3
[2022-05-12 13:29:19.517600] estimate_type .............. <function beam_search_lower_bound at 0x7f6203fc2820>
[2022-05-12 13:29:19.517607] excluded_terms ............. [1]
[2022-05-12 13:29:19.517612] finetune ................... False
[2022-05-12 13:29:19.517617] grad_clip .................. 1.0
[2022-05-12 13:29:19.517620] hidden_size ................ 512
[2022-05-12 13:29:19.517624] hist_len ................... 18
[2022-05-12 13:29:19.517630] interp_func ................ <function lin_interp at 0x7f6203fc2700>
[2022-05-12 13:29:19.517634] log_interval ............... 100
[2022-05-12 13:29:19.517638] lr ......................... 0.001
[2022-05-12 13:29:19.517641] lr_decay_style ............. constant
[2022-05-12 13:29:19.517662] masked_lm .................. False
[2022-05-12 13:29:19.517666] max_num_mc_samples ......... 100000
[2022-05-12 13:29:19.517669] max_num_queries ............ 100
[2022-05-12 13:29:19.517673] min_num_mc_samples ......... 10000
[2022-05-12 13:29:19.517676] min_phase_shift ............ 0
[2022-05-12 13:29:19.517682] min_var_reduction .......... 0.1
[2022-05-12 13:29:19.517685] min_variance ............... True
[2022-05-12 13:29:19.517689] model_budget_filepath ...... None
[2022-05-12 13:29:19.517693] num_beams .................. 0.0
[2022-05-12 13:29:19.517697] num_layers ................. 2
[2022-05-12 13:29:19.517700] num_mc_samples ............. 100
[2022-05-12 13:29:19.517704] num_workers ................ 0
[2022-05-12 13:29:19.517707] optimizer .................. adam
[2022-05-12 13:29:19.517711] proposal_func .............. <function lm_proposal at 0x7f6203faf820>
[2022-05-12 13:29:19.517715] rnn_type ................... LSTM
[2022-05-12 13:29:19.517718] save_epochs ................ 1
[2022-05-12 13:29:19.517721] seed ....................... 42
[2022-05-12 13:29:19.517725] seq_len .................... 15
[2022-05-12 13:29:19.517729] shuffle .................... True
[2022-05-12 13:29:19.517732] store_intermediate_lbs ..... True
[2022-05-12 13:29:19.517736] sub_estimates .............. []
[2022-05-12 13:29:19.517739] text_dict .................. None
[2022-05-12 13:29:19.517743] top_k ...................... 0
[2022-05-12 13:29:19.517746] top_p ...................... 0
[2022-05-12 13:29:19.517749] total_seq_len .............. 20
[2022-05-12 13:29:19.517755] train_data_pct ............. 0.9
[2022-05-12 13:29:19.517759] train_epochs ............... 40
[2022-05-12 13:29:19.517762] use_gpt2 ................... False
[2022-05-12 13:29:19.517766] val_data_pct ............... 0.0001
[2022-05-12 13:29:19.517771] val_metrics ................ ['accuracy']
[2022-05-12 13:29:19.517774] valid_epochs ............... 1
[2022-05-12 13:29:19.517780] variance_epsilon ........... 5e-06
[2022-05-12 13:29:19.517783] vocab_size ................. 30
[2022-05-12 13:29:19.517788] warmup_pct ................. 0.01
[2022-05-12 13:29:19.517791] weight_decay ............... 0.0
==================================================
[2022-05-12 13:29:19.518068] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
[2022-05-12 13:29:22.771819] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
[2022-05-12 13:29:28.730022] | Dataset: amazon | Sample type: importance_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
==================================================
* Running for dataset moocs
==================================================
[2022-05-12 13:29:38.397691] Checkpoint path [/home/showalte/research/prob_seq_queries/models/moocs/] does exist.
[2022-05-12 13:29:38.401089] Loaded model from /home/showalte/research/prob_seq_queries/models/moocs/model_999.pt
==================================================
[2022-05-12 13:29:38.471410] batch_size ................. 4096
[2022-05-12 13:29:38.471436] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/moocs/
[2022-05-12 13:29:38.471446] cuda ....................... True
[2022-05-12 13:29:38.471452] data_path .................. data/moocs/mooc.csv
[2022-05-12 13:29:38.471457] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-12 13:29:38.471464] device ..................... 7
[2022-05-12 13:29:38.471470] device_num ................. 0
[2022-05-12 13:29:38.471476] disable_tqdm ............... True
[2022-05-12 13:29:38.471482] do_test .................... False
[2022-05-12 13:29:38.471488] do_valid ................... True
[2022-05-12 13:29:38.471494] dont_print_args ............ True
[2022-05-12 13:29:38.471500] dont_shuffle ............... None
[2022-05-12 13:29:38.471511] dropout .................... 0.3
[2022-05-12 13:29:38.471519] estimate_type .............. <function beam_search_lower_bound at 0x7f6203fc2820>
[2022-05-12 13:29:38.471527] excluded_terms ............. [1]
[2022-05-12 13:29:38.471535] finetune ................... False
[2022-05-12 13:29:38.471542] grad_clip .................. 1.0
[2022-05-12 13:29:38.471547] hidden_size ................ 128
[2022-05-12 13:29:38.471553] hist_len ................... 18
[2022-05-12 13:29:38.471560] interp_func ................ <function lin_interp at 0x7f6203fc2700>
[2022-05-12 13:29:38.471573] log_interval ............... 100
[2022-05-12 13:29:38.471581] lr ......................... 0.001
[2022-05-12 13:29:38.471586] lr_decay_style ............. constant
[2022-05-12 13:29:38.471603] masked_lm .................. False
[2022-05-12 13:29:38.471608] max_num_mc_samples ......... 100000
[2022-05-12 13:29:38.471614] max_num_queries ............ 100
[2022-05-12 13:29:38.471619] min_num_mc_samples ......... 10000
[2022-05-12 13:29:38.471625] min_phase_shift ............ 0
[2022-05-12 13:29:38.471632] min_var_reduction .......... 0.1
[2022-05-12 13:29:38.471637] min_variance ............... True
[2022-05-12 13:29:38.471643] model_budget_filepath ...... None
[2022-05-12 13:29:38.471648] needs_encoding ............. False
[2022-05-12 13:29:38.471654] num_beams .................. 0.0
[2022-05-12 13:29:38.471660] num_layers ................. 2
[2022-05-12 13:29:38.471666] num_mc_samples ............. 100
[2022-05-12 13:29:38.471672] num_workers ................ 0
[2022-05-12 13:29:38.471677] optimizer .................. adam
[2022-05-12 13:29:38.471684] proposal_func .............. <function lm_proposal at 0x7f6203faf820>
[2022-05-12 13:29:38.471689] rnn_type ................... LSTM
[2022-05-12 13:29:38.471695] save_epochs ................ 1
[2022-05-12 13:29:38.471700] seed ....................... 42
[2022-05-12 13:29:38.471707] seq_len .................... 15
[2022-05-12 13:29:38.471712] shuffle .................... True
[2022-05-12 13:29:38.471718] store_intermediate_lbs ..... True
[2022-05-12 13:29:38.471724] sub_estimates .............. []
[2022-05-12 13:29:38.471730] text_dict .................. None
[2022-05-12 13:29:38.471735] top_k ...................... 0
[2022-05-12 13:29:38.471741] top_p ...................... 0
[2022-05-12 13:29:38.471747] total_seq_len .............. 20
[2022-05-12 13:29:38.471753] train_data_pct ............. 0.9
[2022-05-12 13:29:38.471758] train_epochs ............... 40
[2022-05-12 13:29:38.471764] use_gpt2 ................... False
[2022-05-12 13:29:38.471770] val_data_pct ............... 0.01
[2022-05-12 13:29:38.471776] val_metrics ................ ['accuracy']
[2022-05-12 13:29:38.471782] valid_epochs ............... 1
[2022-05-12 13:29:38.471790] variance_epsilon ........... 5e-06
[2022-05-12 13:29:38.471796] vocab_size ................. 98
[2022-05-12 13:29:38.471802] warmup_pct ................. 0.01
[2022-05-12 13:29:38.471808] weight_decay ............... 0.0
==================================================
[2022-05-12 13:29:38.473299] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 11 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
[2022-05-12 13:29:40.530140] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 8 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
[2022-05-12 13:29:44.484078] | Dataset: moocs | Sample type: importance_sampling | Num samples: 1000 | Hist length 5 | Total Seq Length 15 | Pseudo GT: False | Model Budget: True

..........
==================================================
