==================================================
* Running for dataset shakespeare
==================================================
[2022-05-20 16:22:22.438210] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-20 16:22:22.441686] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-20 16:22:22.443834] batch_size ................. 8000
[2022-05-20 16:22:22.443855] bs_ablation ................ False
[2022-05-20 16:22:22.443860] bs_ablation_max_beams ...... 10000
[2022-05-20 16:22:22.443864] checkpoint_path ............ /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-20 16:22:22.443867] cuda ....................... True
[2022-05-20 16:22:22.443871] data_path .................. data/shakespeare/shakespeare_input.txt
[2022-05-20 16:22:22.443875] dataset .................... shakespeare
[2022-05-20 16:22:22.443878] dataset_phase_shift_path ... /srv/disk00/samshow/amazon/amazon_phase_trans.pkl
[2022-05-20 16:22:22.443881] device ..................... 0
[2022-05-20 16:22:22.443885] device_num ................. 0
[2022-05-20 16:22:22.443888] disable_tqdm ............... True
[2022-05-20 16:22:22.443892] do_test .................... False
[2022-05-20 16:22:22.443896] do_valid ................... True
[2022-05-20 16:22:22.443899] dont_print_args ............ True
[2022-05-20 16:22:22.443903] dont_shuffle ............... None
[2022-05-20 16:22:22.443911] dropout .................... 0.3
[2022-05-20 16:22:22.443916] estimate_type .............. <function beam_search_lower_bound at 0x7f87b7739ca0>
[2022-05-20 16:22:22.443922] excluded_terms ............. [1]
[2022-05-20 16:22:22.443926] excluded_terms_list ........ [[]]
[2022-05-20 16:22:22.443929] finetune ................... False
[2022-05-20 16:22:22.443933] frequentist_test ........... False
[2022-05-20 16:22:22.443937] grad_clip .................. 1.0
[2022-05-20 16:22:22.443940] hidden_size ................ 128
[2022-05-20 16:22:22.443943] hist_len ................... 18
[2022-05-20 16:22:22.443947] hybrid_max_num_beams ....... 1500
[2022-05-20 16:22:22.443952] interp_func ................ <function lin_interp at 0x7f87b7739b80>
[2022-05-20 16:22:22.443956] log_interval ............... 100
[2022-05-20 16:22:22.443960] lr ......................... 0.001
[2022-05-20 16:22:22.443963] lr_decay_style ............. constant
[2022-05-20 16:22:22.443967] masked_lm .................. False
[2022-05-20 16:22:22.443970] max_k ...................... None
[2022-05-20 16:22:22.443974] max_num_mc_samples ......... 100000
[2022-05-20 16:22:22.443977] max_num_queries ............ 1000
[2022-05-20 16:22:22.443981] min_num_mc_samples ......... 10000
[2022-05-20 16:22:22.443984] min_phase_shift ............ 0
[2022-05-20 16:22:22.443988] min_var_reduction .......... 0.1
[2022-05-20 16:22:22.443992] min_variance ............... True
[2022-05-20 16:22:22.443995] model_budget_filepath ...... None
[2022-05-20 16:22:22.443999] needs_dl ................... True
[2022-05-20 16:22:22.444002] num_beams .................. 0.0
[2022-05-20 16:22:22.444006] num_layers ................. 2
[2022-05-20 16:22:22.444009] num_mc_samples ............. 100
[2022-05-20 16:22:22.444012] num_workers ................ 0
[2022-05-20 16:22:22.444016] optimizer .................. adam
[2022-05-20 16:22:22.444019] proposal_func .............. <function lm_proposal at 0x7f87b7725b80>
[2022-05-20 16:22:22.444023] rnn_type ................... LSTM
[2022-05-20 16:22:22.444026] save_epochs ................ 1
[2022-05-20 16:22:22.444029] seed ....................... 42
[2022-05-20 16:22:22.444033] seq_len .................... 100
[2022-05-20 16:22:22.444036] shuffle .................... True
[2022-05-20 16:22:22.444039] store_intermediate_lbs ..... True
[2022-05-20 16:22:22.444043] sub_estimates .............. []
[2022-05-20 16:22:22.444046] tau_a_excl_terms ........... []
[2022-05-20 16:22:22.444050] tau_b_excl_terms ........... []
[2022-05-20 16:22:22.444053] terms_of_interest .......... []
[2022-05-20 16:22:22.444056] text_dict .................. None
[2022-05-20 16:22:22.444060] top_k ...................... 0
[2022-05-20 16:22:22.444063] top_p ...................... 0
[2022-05-20 16:22:22.444066] total_seq_len .............. 20
[2022-05-20 16:22:22.444070] train_data_pct ............. 0.9
[2022-05-20 16:22:22.444073] train_epochs ............... 40
[2022-05-20 16:22:22.444076] use_gpt2 ................... False
[2022-05-20 16:22:22.444080] val_data_pct ............... 0.05
[2022-05-20 16:22:22.444088] val_metrics ................ ['accuracy']
[2022-05-20 16:22:22.444092] valid_epochs ............... 1
[2022-05-20 16:22:22.444097] variance_epsilon ........... 5e-06
[2022-05-20 16:22:22.444101] vocab_size ................. 68
[2022-05-20 16:22:22.444104] warmup_pct ................. 0.01
[2022-05-20 16:22:22.444108] weight_decay ............... 0.0
==================================================
[2022-05-20 16:22:22.444652] | Dataset: shakespeare | Sample type: beam_search_is_hybrid | Num samples: 10000 | Hist length 10 | Total Seq Length 20 | Max num queries: 1000

..................................................................................