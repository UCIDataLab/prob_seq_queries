==================================================
* Running for dataset shakespeare
==================================================
[2022-05-05 12:48:41.119250] Checkpoint path [/home/showalte/research/prob_seq_queries/models/shakespeare/] does exist.
[2022-05-05 12:48:41.123822] Loaded model from /home/showalte/research/prob_seq_queries/models/shakespeare/shakespeare_model.pt
==================================================
[2022-05-05 12:48:41.126274] batch_size .......... 4096
[2022-05-05 12:48:41.126291] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/shakespeare/
[2022-05-05 12:48:41.126297] cuda ................ True
[2022-05-05 12:48:41.126302] data_path ........... data/shakespeare/shakespeare_input.txt
[2022-05-05 12:48:41.126306] device .............. 1
[2022-05-05 12:48:41.126309] device_num .......... 0
[2022-05-05 12:48:41.126313] disable_tqdm ........ True
[2022-05-05 12:48:41.126317] do_test ............. False
[2022-05-05 12:48:41.126321] do_valid ............ True
[2022-05-05 12:48:41.126324] dont_print_args ..... True
[2022-05-05 12:48:41.126328] dont_shuffle ........ None
[2022-05-05 12:48:41.126337] dropout ............. 0.3
[2022-05-05 12:48:41.126344] estimate_type ....... <function beam_search_lower_bound at 0x7f92d2298790>
[2022-05-05 12:48:41.126350] excluded_terms ...... [1]
[2022-05-05 12:48:41.126353] finetune ............ False
[2022-05-05 12:48:41.126360] grad_clip ........... 1.0
[2022-05-05 12:48:41.126363] hidden_size ......... 128
[2022-05-05 12:48:41.126367] hist_len ............ 18
[2022-05-05 12:48:41.126371] interp_func ......... <function lin_interp at 0x7f92d2298670>
[2022-05-05 12:48:41.126374] log_interval ........ 100
[2022-05-05 12:48:41.126379] lr .................. 0.001
[2022-05-05 12:48:41.126383] lr_decay_style ...... constant
[2022-05-05 12:48:41.126387] masked_lm ........... False
[2022-05-05 12:48:41.126391] min_var_reduction ... 0.9
[2022-05-05 12:48:41.126395] min_variance ........ False
[2022-05-05 12:48:41.126399] num_beams ........... 1.0
[2022-05-05 12:48:41.126402] num_layers .......... 2
[2022-05-05 12:48:41.126406] num_mc_samples ...... 100
[2022-05-05 12:48:41.126409] num_workers ......... 0
[2022-05-05 12:48:41.126412] optimizer ........... adam
[2022-05-05 12:48:41.126416] proposal_func ....... <function lm_proposal at 0x7f92d22928b0>
[2022-05-05 12:48:41.126419] rnn_type ............ LSTM
[2022-05-05 12:48:41.126423] save_epochs ......... 1
[2022-05-05 12:48:41.126426] seed ................ 1234321
[2022-05-05 12:48:41.126429] seq_len ............. 100
[2022-05-05 12:48:41.126433] shuffle ............. True
[2022-05-05 12:48:41.126437] sub_estimates ....... []
[2022-05-05 12:48:41.126440] text_dict ........... None
[2022-05-05 12:48:41.126443] top_k ............... 0
[2022-05-05 12:48:41.126447] top_p ............... 0
[2022-05-05 12:48:41.126450] total_seq_len ....... 20
[2022-05-05 12:48:41.126454] train_data_pct ...... 0.9
[2022-05-05 12:48:41.126457] train_epochs ........ 40
[2022-05-05 12:48:41.126461] val_data_pct ........ 0.05
[2022-05-05 12:48:41.126466] val_metrics ......... ['accuracy']
[2022-05-05 12:48:41.126469] valid_epochs ........ 1
[2022-05-05 12:48:41.126472] vocab_size .......... 68
[2022-05-05 12:48:41.126476] warmup_pct .......... 0.01
[2022-05-05 12:48:41.126481] weight_decay ........ 0.0
==================================================
Dataset: shakespeare | Sample type: ground_truth | Hist length 18 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
Dataset: shakespeare | Sample type: ground_truth | Hist length 17 | Total Seq Length 20

.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset amazon
==================================================
[2022-05-05 13:10:34.887382] Checkpoint path [/home/showalte/research/prob_seq_queries/models/amazon/] does exist.
[2022-05-05 13:10:34.899000] Loaded model from /home/showalte/research/prob_seq_queries/models/amazon/model_100.pt
==================================================
[2022-05-05 13:10:35.325050] batch_size .......... 4096
[2022-05-05 13:10:35.325084] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/amazon/
[2022-05-05 13:10:35.325092] cuda ................ True
[2022-05-05 13:10:35.325095] data_path ........... /srv/disk00/samshow/amazon/amazon_text_dict.pkl
[2022-05-05 13:10:35.325099] device .............. 1
[2022-05-05 13:10:35.325103] device_num .......... 0
[2022-05-05 13:10:35.325106] disable_tqdm ........ True
[2022-05-05 13:10:35.325110] do_test ............. False
[2022-05-05 13:10:35.325113] do_valid ............ True
[2022-05-05 13:10:35.325117] dont_print_args ..... True
[2022-05-05 13:10:35.325122] dont_shuffle ........ None
[2022-05-05 13:10:35.325133] dropout ............. 0.3
[2022-05-05 13:10:35.325139] estimate_type ....... <function beam_search_lower_bound at 0x7f92d2298790>
[2022-05-05 13:10:35.325146] excluded_terms ...... [1]
[2022-05-05 13:10:35.325150] finetune ............ False
[2022-05-05 13:10:35.325167] grad_clip ........... 1.0
[2022-05-05 13:10:35.325170] hidden_size ......... 512
[2022-05-05 13:10:35.325174] hist_len ............ 18
[2022-05-05 13:10:35.325178] interp_func ......... <function lin_interp at 0x7f92d2298670>
[2022-05-05 13:10:35.325184] log_interval ........ 100
[2022-05-05 13:10:35.325188] lr .................. 0.001
[2022-05-05 13:10:35.325192] lr_decay_style ...... constant
[2022-05-05 13:10:35.325195] masked_lm ........... False
[2022-05-05 13:10:35.325204] min_var_reduction ... 0.9
[2022-05-05 13:10:35.325207] min_variance ........ False
[2022-05-05 13:10:35.325211] num_beams ........... 1.0
[2022-05-05 13:10:35.325214] num_layers .......... 2
[2022-05-05 13:10:35.325217] num_mc_samples ...... 100
[2022-05-05 13:10:35.325221] num_workers ......... 0
[2022-05-05 13:10:35.325224] optimizer ........... adam
[2022-05-05 13:10:35.325229] proposal_func ....... <function lm_proposal at 0x7f92d22928b0>
[2022-05-05 13:10:35.325232] rnn_type ............ LSTM
[2022-05-05 13:10:35.325235] save_epochs ......... 1
[2022-05-05 13:10:35.325239] seed ................ 1234321
[2022-05-05 13:10:35.325243] seq_len ............. 15
[2022-05-05 13:10:35.325246] shuffle ............. True
[2022-05-05 13:10:35.325250] sub_estimates ....... []
[2022-05-05 13:10:35.325254] text_dict ........... None
[2022-05-05 13:10:35.325257] top_k ............... 0
[2022-05-05 13:10:35.325260] top_p ............... 0
[2022-05-05 13:10:35.325264] total_seq_len ....... 20
[2022-05-05 13:10:35.325270] train_data_pct ...... 0.9
[2022-05-05 13:10:35.325274] train_epochs ........ 40
[2022-05-05 13:10:35.325278] val_data_pct ........ 0.0001
[2022-05-05 13:10:35.325282] val_metrics ......... ['accuracy']
[2022-05-05 13:10:35.325286] valid_epochs ........ 1
[2022-05-05 13:10:35.325289] vocab_size .......... 30
[2022-05-05 13:10:35.325293] warmup_pct .......... 0.01
[2022-05-05 13:10:35.325298] weight_decay ........ 0.0
==================================================
Dataset: amazon | Sample type: ground_truth | Hist length 13 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
Dataset: amazon | Sample type: ground_truth | Hist length 12 | Total Seq Length 15

..........................................................................................................................................................................................................................................................................................................................................................................................................................
.....................................................................................................................................................................................................................................
==================================================
==================================================
* Running for dataset apps
==================================================
[2022-05-05 13:27:07.693288] Checkpoint path [/home/showalte/research/prob_seq_queries/models/apps/] does exist.
[2022-05-05 13:27:07.705213] Loaded model from /home/showalte/research/prob_seq_queries/models/apps/model_100.pt
==================================================
[2022-05-05 13:27:07.705396] batch_size .......... 4096
[2022-05-05 13:27:07.705404] checkpoint_path ..... /home/showalte/research/prob_seq_queries/models/apps/
[2022-05-05 13:27:07.705411] cuda ................ True
[2022-05-05 13:27:07.705416] data_path ........... data/apps/lsapp.tsv
[2022-05-05 13:27:07.705420] device .............. 1
[2022-05-05 13:27:07.705425] device_num .......... 0
[2022-05-05 13:27:07.705430] disable_tqdm ........ True
[2022-05-05 13:27:07.705435] do_test ............. False
[2022-05-05 13:27:07.705440] do_valid ............ True
[2022-05-05 13:27:07.705444] dont_print_args ..... True
[2022-05-05 13:27:07.705450] dont_shuffle ........ None
[2022-05-05 13:27:07.705462] dropout ............. 0.3
[2022-05-05 13:27:07.705469] estimate_type ....... <function beam_search_lower_bound at 0x7f92d2298790>
[2022-05-05 13:27:07.705476] excluded_terms ...... [1]
[2022-05-05 13:27:07.705480] finetune ............ False
[2022-05-05 13:27:07.705497] grad_clip ........... 1.0
[2022-05-05 13:27:07.705502] hidden_size ......... 512
[2022-05-05 13:27:07.705506] hist_len ............ 18
[2022-05-05 13:27:07.705511] interp_func ......... <function lin_interp at 0x7f92d2298670>
[2022-05-05 13:27:07.705516] log_interval ........ 100
[2022-05-05 13:27:07.705522] lr .................. 0.001
[2022-05-05 13:27:07.705526] lr_decay_style ...... constant
[2022-05-05 13:27:07.705531] masked_lm ........... False
[2022-05-05 13:27:07.705536] min_var_reduction ... 0.9
[2022-05-05 13:27:07.705541] min_variance ........ False
[2022-05-05 13:27:07.705546] num_beams ........... 1.0
[2022-05-05 13:27:07.705550] num_layers .......... 2
[2022-05-05 13:27:07.705555] num_mc_samples ...... 100
[2022-05-05 13:27:07.705560] num_workers ......... 0
[2022-05-05 13:27:07.705565] optimizer ........... adam
[2022-05-05 13:27:07.705570] proposal_func ....... <function lm_proposal at 0x7f92d22928b0>
[2022-05-05 13:27:07.705574] rnn_type ............ LSTM
[2022-05-05 13:27:07.705579] save_epochs ......... 1
[2022-05-05 13:27:07.705583] seed ................ 1234321
[2022-05-05 13:27:07.705588] seq_len ............. 15
[2022-05-05 13:27:07.705593] shuffle ............. True
[2022-05-05 13:27:07.705598] sub_estimates ....... []
[2022-05-05 13:27:07.705602] text_dict ........... None
[2022-05-05 13:27:07.705606] top_k ............... 0
[2022-05-05 13:27:07.705611] top_p ............... 0
[2022-05-05 13:27:07.705615] total_seq_len ....... 20
[2022-05-05 13:27:07.705621] train_data_pct ...... 0.9
[2022-05-05 13:27:07.705626] train_epochs ........ 40
[2022-05-05 13:27:07.705631] val_data_pct ........ 0.001
[2022-05-05 13:27:07.705637] val_metrics ......... ['accuracy']
[2022-05-05 13:27:07.705642] valid_epochs ........ 1
[2022-05-05 13:27:07.705646] vocab_size .......... 88
[2022-05-05 13:27:07.705652] warmup_pct .......... 0.01
[2022-05-05 13:27:07.705659] weight_decay ........ 0.0
==================================================
Dataset: apps | Sample type: ground_truth | Hist length 13 | Total Seq Length 15

..............................................................................................................................................................................................................................................................................................................................................................................
==================================================
Dataset: apps | Sample type: ground_truth | Hist length 12 | Total Seq Length 15

.................................